{"meta":{"title":"Liu Tao","subtitle":"A little older, a little wiser, but happy to see you.","description":"A blog of Liu Tao","author":"Liu Tao","url":"https://tao93.top"},"pages":[{"title":"About","date":"2018-09-26T07:47:46.696Z","updated":"2018-09-26T07:47:46.695Z","comments":false,"path":"about/index.html","permalink":"https://tao93.top/about/index.html","excerpt":"","text":"Github: Tao93 Email: heyustc@gmail.com"}],"posts":[{"title":"Elliptic curve related groups and fields","slug":"Elliptic curve group","date":"2020-01-04T23:08:02.268Z","updated":"2020-01-05T22:36:25.226Z","comments":true,"path":"2020/01/04/Elliptic curve group/","link":"","permalink":"https://tao93.top/2020/01/04/Elliptic curve group/","excerpt":"","text":"This is my first post about cryptography. Recently I learnt basics about public key encryption and the TLS handshake. But the key exhange in the TLS handshake inspected by Wireshark, i.e. ECDH(Elliptic-curve Diffieâ€“Hellman) troubled me for a while. This this the first time I knew Elliptic curve. After some investigation, Iâ€™m recording those knowledges in case that I forget them. Note: in the following several posts, I would record more things I learnt about cryptography and its application in the computer network and Internet. First glanceA elliptic curve could be defined as: y^2 = x^3 + ax + bwhere 4a^3 + 27b^2 \\ne 0Some examples of elliptic curves are like: equation for red line is y^{2}=x^{3}+4x+4, equation for purple line is y^{2}=x^{3}-3x GroupNow lets review the Group) concept. A group G is a set with a binary operation we define on the it, when 4 conditions are met. Usually we denote the operation as plus, then the 4 conditions are: Closure: m + n is always in G as long as m and n in G. Associativity: for all m, n and r in G, (m+n)+r = m+(n+r). Identity element: there is a element 0 in G such that m + 0 = 0 + m = m for any m in G. Inverse element: for any m in G, there is an element n in G such that m + n = 0, and we say n = -m A group is a Abelian group if the follwoing condition is also met: commutation: for any m and n in G, there is m + n = n + m Aparently the set of all real numbers R could be an Abelian group with the arithmetic adding operation. Define group on the elliptic curvesFirst, the set consists of all points in a elliptic curve. The Identity element 0 would be a little special, itâ€™s defined as the infinitely far points of the curve. Now, lets define the operation. For any points a and b in the curve: if m = n and y_m = 0, then m + n =0 if m = n and y_m \\ne 0, then m + n is the other intersection of the curve and the line tangent to the curve in m. if m \\ne n and x_m = x_n, then m + n = n + m = 0 if m \\ne n and x_m \\ne x_n, then -(m+n) equals -(m + n) and is the 3rd intersection of the curve and the line cross m and n. From the 3rd and4th cases above, we know the relation between m + n and m, n would be like: It can be proved that such a group is an Abelian group. Scalar multiplicationWe can also defin a scalar multiplication based on the plus operation upon the elliptic curve groups: dm = \\sum_{i=1}^d mwhere d is a positive integer and m is a element in the group. The above expression could be calculated in time complexity of O(logn) by disassembling the d into factors that are powers of 2. The logrithm problemIn last section, we see given d and m, itâ€™s easy to get dm. However, given the m and result of dm, with some cleverly constructed instances it would be very hard to know the value of d, i.e. the times of operation performed to get the dm. And this hard problem is called logrithm problem. FieldField) is a set on which addition and multiplication are defined. The two kinds of operations are closed, associative and commutative. Moreover, there are two identity elements for both kinds of operations respectively. Finally, there is distributiveness, i.e. m(n+r) = mn + mr. Finite field on primeFor a prime P, the set of integers from 0 to P-1 could be a field. And the addition and multiplication are defined as: (m+n)\\mod P(mn)\\mod pAnd the behavior or identity elements are: (m + (-m)) \\mod P = 0(m(m^{-1})) \\mod P = 1Absolutely, arithmetic negation is the additional reverse in this field. But the multipilicational reverse is not that easy, actually the extended Euclidean algorithm tell us this could be done in time complexity of O(logP). As an example, 4 and 2 are mutual multipilicational reverse when P is 7 since 4*2 \\mod 8 = 1. Elliptic curve over finite fieldsPreviously the elliptic curves consist of points with coordinates of real numbers. But now we restrict the curve upon a finite field which only contains integers betwen 0 and p-1. y^2 \\equiv x^3 + ax + b \\mod PWhen 4a^3 + 27b^2 \\not\\equiv 0 \\mod PWhere P is a prime number, x, y, a and b are integers, and 0\\le x, y\\le P-1. Here is an example graph of y^2 \\equiv x^3 - 7x + 10 \\mod 19: Note that most of the points in the above graph are symmetrical over the line y=P/2 except the points on line y=0. Group on the elliptic curve over finite fieldsTo define a group, firstly we need to define the plus operation on the elliptic curve over finite fields. The plus operation is similar to the operation we defined previously for elliptic curve over real numbers. The identity element is same as before. The reverse pair of elements are symmectircal over the line y = p/2. For any pointers m and n on the discrete curve and x_m \\ne x_n, m+n is the reverse proint of the 3rd intersection between the discrete curve points and the lines denoted by: y \\equiv kx + t \\mod Pwhen the lines cross m and n, and k, t are constants. It could be proved with such a addition operation defined, a group is generated on the discrete elliptic curve over a finite field from prime P. The number of points in such a group is called the order of the group. Similar with previous continuous elliptic curve, we can perform scalar multipilication: dm = \\sum_{i=1}^d mwhere d is a positive integer and m is a element in the group. For any m in such a group G, the smallest integer d such that dm equals the identity element point is called the order of the subgroup which contains m, 2m, 3m, â€¦, (d-1)m and the identity element point. The subgroup is cyclic. And the number of elements in a subgroup is called order of the subgroup. Letâ€™s say the order of the parent group isD.According to Lagrangeâ€™s theorem), the order of a subgroup is a diviser of D. Hence for any m in the parent group, we can check the divisers of D one by one to find out the order of subgroup based on m. On the contrary, for any prime diviser d of D, any element point m such that (D/d)m not equal the identity element is the base point to form a subgroup. (Hint: Dm is always the identity element.) Given m and n in such a group G, getting a k such that km=n is also very harder for some instances, just like the logrithm problem we mentioned previously. Elliptic curve cryptography applicationsTo leverage elliptic curve group over finite fileds on primes, there are some parameters called domain parameters to determine the concrete instances. a and b, real numbers to determine the y^2 = x^3 + ax + b equation p$$, a prime that determine the finite field of 1, 2, 3, ..., $$p-1 G, a base point in the discrete elliptic curve to form a cyclic subgroup of G, 2G, 3G, â€¦, identity element n, which is order of the subgroup based on G, hence nG is the identity element h, called cofactor, which is result of n divides the number points of the parent group. The above (p, a, b, G, n, h) consists the domain parameters that determine the concrete instances. In the Elliptic curve cryptography, The private key is a random number d such that 1 \\le d \\le n-1. The public key is the result of dG. EC Diffie-Hellman key exchange algorithmIn EC Diffie-Hellman key exchange algorithm. Alice and Bob have their private keys d_A and d_B. With the public domain parameters, they would compute d_A G and d_B G and exchange these two values. Finally, they would compute d_A d_B G and d_B d_A G respectively as the shared secret key. Of course d_A d_B G = d_B d_A G. The EC Diffie-Hellman key exchange is based on that given the domain parameters, itâ€™s hard to know d_A d_B G given d_A G and d_B G, and smae for d_A and d_B. While the original Diffie-Hellman key exchange algorithm is based on exponential modular. Private keys are random numbers d_A and d_B, public keys are k^{d_A} \\mod p and k^{d_B} \\mod p, and the shared secret key is k^{d_A} \\mod p. The shared secret key in EC Diffie-Hellman key exchange algorithm are coordinates of the point d_A d_B G, which could be used to perform symmectirc encryption just like TLS does. Actually in TLS, we often see ECDHE in which the ending E means ephemeral. Actually when TLS uses ECDHE, during the handshake procedure, the public and private keys generated in ECDHE wonâ€™t be used for encryption. TLS just want both sides to generate a shared private symmectric encryption key, which is really for encryption of application data. EC digital signature algorithmAlice could use her private key d_A to generate a signature for digest of a message. Bob would be able to verify the signature by using public key of Alice, i.e. d_A G. ECC and RSAECC(clliptic curve cryptography) is better than RSA in that key size of ECC is smaller to achieve same security level. Moreover, the security level improved by doubling key size of RSA is less than ECC.","categories":[],"tags":[{"name":"Math","slug":"Math","permalink":"https://tao93.top/tags/Math/"},{"name":"Cryptography","slug":"Cryptography","permalink":"https://tao93.top/tags/Cryptography/"}]},{"title":"Kotlin Summary","slug":"Kotlin Summary","date":"2019-11-04T16:44:56.826Z","updated":"2019-11-14T20:47:38.904Z","comments":true,"path":"2019/11/04/Kotlin Summary/","link":"","permalink":"https://tao93.top/2019/11/04/Kotlin Summary/","excerpt":"","text":"Table of Contents Before all Types Conditionals Functions Anonymous functions Null Safety and Exceptions Collections Class definition Object initialization Inheritance Objects Generics Extensions Java Interoperability Corutines Functional Programming Basics References 1. Before all Whatâ€™s Kotlin By Jetbrains which created Intellij IDEA Targeting JVM and more, interoperatable with Java Concise and safe, with many modern features the REPL(read, evaluate, print, loop)Install Kotlin commandline tools in macOS: 1brew install kotlin Execute kotlinc to start REPL 2. Types Built-in typesString, Char, Boolean, Int, Double, List&lt;T&gt;, Set&lt;T&gt;, Map&lt;K, V&gt;, Array&lt;T&gt; Not like Java, Kotlin has no primitives (int, float etc.) hence avoids the boxing between primitives and objects. However, in byte code generated by Kotlin, primitives are used to improve performance. 3. Conditionals Conditional operators Operator Description &lt; Evaluates whether the value on the left is less than the value on the right. &lt;= Evaluates whether the value on the left is less than or equal to the value on the right. &gt; Evaluates whether the value on the left is greater than the value on the right. &gt;= Evaluates whether the value on the left is greater than or equal to the value on the right. == Evaluates whether the value on the left is equal to the value on the right (like equals in Java). != Evaluates whether the value on the left is not equal to the value on the right. === Evaluates whether the two instances point to the same reference (like == in Java). !== Evaluates whether the two instances do not point to the same reference. 4. Functions Kotlin supports file level functions12345fun main() &#123; println(fileLevelFunc())&#125;fun fileLevelFunc() = \"file level\" // expression function Default value of parameters1234567fun main() &#123; greeting(\"Earth\") // default value for 2nd parameter&#125;fun greeting(name: String, greeting: String = \"good morning\") &#123; println(\"$&#123;greeting.capitalize()&#125;! $name.\") // e.g. Good morning! Saturn.&#125; Named function parameters1234567fun main() &#123; greeting(greeting = \"Hello\", name = \"Earth\") // named parameters&#125;fun greeting(name: String, greeting: String = \"good morning\") &#123; println(\"$&#123;greeting.capitalize()&#125;! $name.\") // e.g. Good morning! Saturn.&#125; Function names in backticksItâ€™s said this is useful to call Java methods whose names are reserved words in Kotlin, or to name some special methods. 12345fun `ğŸ˜‚`() &#123; &#125;fun main() &#123; `ğŸ˜‚`() // call a function&#125; Inline functionsKotlin support inline functions, which is good for performance. 1234567inline fun factorial(n: Int): Int &#123; return if (n &gt; 2) &#123; n * factorial(n - 1) // wrong, no recursion inside inline functions &#125; else &#123; n &#125;&#125; 5. Anonymous functions The complete structure of an anoymous function should be like: 12345val funcVariable: (ParamType1, ParamType2) -&gt; ReturnType = &#123; param1: ParamType1, param2: ParamType2 -&gt; ... expr_to_be_returned // no return keyword, only the returned expression&#125; An example of anoymous function: 1234val numLetters = \"Mississippi\".count(&#123; letter -&gt; letter == 's'&#125;)print(numLetters) // would Prints 4 12345678/** * Returns the number of characters matching the given [predicate]. */public inline fun CharSequence.count(predicate: (Char) -&gt; Boolean): Int &#123; var count = 0 for (element in this) if (predicate(element)) ++count return count&#125; Parameter types are usually omitted when they caould be inferred. Single parameterâ€™s name could be omitted if its type could ba inferred, and we take it as the parameter name. Unused parameter name could be marked as _. Examples: 12345678val numLetters = \"Mississippi\".count(&#123; it == 's'&#125;)val afterFilter = \"Mississippi\".filterIndexed(&#123; _, char-&gt; char != 's'&#125;)print(afterFilter) // prints Miiippi Note: an anonymous function must be called immediately, assigned to a variable, or be passed as a parameter. Anonymous functions as parameter is often in a different style when it is required as the last parameter in another function: 123456789101112131415// count starting from a specified index.fun count(str: String, startIdx: Int, predicate: (Char) -&gt; Boolean): Int &#123; return str.substring(startIdx).count(predicate)&#125;// style 1count(\"Mississippi\", 5, &#123; it == 's'&#125;)// style 2, looks like definition of count, // but actually it's anonymous function as parametercount(\"Mississippi\", 5) &#123; it == 's'&#125; Want to declare a function type that returns something like void in Java? You need the Unit. You can also refer a non anonymous function as parameter in call to another function by using ::. But I donâ€™t think this is common. 12345fun isS(char: Char): Boolean &#123; return char == 's'&#125; val numLetters = \"Mississippi\".count(::isS) 6. Null Safety and Exceptions For nullable variables, there are some common solutions to handle potential null pointer exceptions. Safe call operator: 1var beverage = readLine()?.capitalize() // the beverage would be String?. Nonnull assertion: 1var beverage = readLine()!!.capitalize() // only if you're really confident Check before use: 123456val result = readLine()var beverage = if (result != null) &#123; // type of beverage would be String. result.capitalize() + result.toLowerCase()&#125; else &#123; \"\"&#125; However, check before use isnâ€™t always safe, e.g. a field of an object might be assigned null by another thread between your null checking and usage of the field. For such case, you would need a local variable to get rid of this risk: 123456val localVar = a.bif (localVar != null) &#123; // do something refers localVar&#125; else &#123; ...&#125; Elvis operator: 1var beverage = readLine()?.capitalize() ?: \"\" // beverage would be String. Exceptions in KotlinKotlin doesnâ€™t require handling of those checked Exceptions of Java. Therefore you can do IO operations without try-catch and exception declaration in the method signature. 7. Collections destructuring123val (type, name, price) = aList // fetch the leading 3 elements from a list.val (type, _, price) = aList // skip elements in specified indexes. protection of immutable list is not valid at runtime123val a = listOf(1, 2, 3)(a as MutableList&lt;Int&gt;).set(0, 100)println(a) // would print [100, 2, 3] 8. Class definition Visibility modifiers of class members Modifier Description public (default) The function or property will be accessible by code outside of the class. By default, functions and properties without a visibility modifier are public. private The function or property will be accessible only within the same class. protected The function or property will be accessible only within the same class or its subclass. internal The function or property will be accessible within the same module. Class fieldsFor class fields, default getter is available for val and var fields. But setter is only for var fields. Yet we can override the default setter and getter: 1234567891011121314class X(_name: String, _age: Int) &#123; // a field always return capitalized string when you get it val name = _name get() = field.capitalize() // a field only allows increasing var age = _age set(value) &#123; if (value &gt; field) &#123; field = value &#125; &#125;&#125; You can override the visibility of a setter to make it less permissive then fieldâ€™s visibility. E.g., you want to make a field readable everywhere but only writable in the file: 123456789class X(_age: Int) &#123; // a field only allows increasing in current file. var age = _age private set(value) &#123; if (value &gt; field) &#123; field = value &#125; &#125;&#125; Computed fieldsHas getter or/and setter but no real fields to store values. 1234class Dice() &#123; val rolledValue get() = (1..6).shuffled().first()&#125; 9. Object initialization The primary contructorAdd parameter list inside a pair of parenthesis after the class name, make it looks like a method. For fields using default getter and setter, you can declare them inside the parameter list by adding var or val: 12// visibility modifier and default values are also availableclass X(val name: String, private var age: Int = 0) secondary constructorMust call the primary constructor or another secondary constructor(of course no cycle call) 1234class X(val name: String, private var age: Int = 0) &#123; // call primary constructor with default parameter constructor(): this(\"Unknown\")&#125; Apart from default parameter values, named parameters are also available for constructors. Lazy initializationOnly initialize a field when itâ€™s accessed (by the getter) 12345class X &#123; val number: Int by lazy &#123; (0 until 10).shuffled().first() // not good example &#125;&#125; 10. Inheritance In Java, we only override methods. But in Kotlin, both class functions and fields could be overridden. Also, in Kotlin, classes, functions and fields must be marked open explicity to make them inheritable or able to be overridden. 1234567891011121314open class Room(val name: String) &#123; protected open val dangerLevel = 5 fun description() = \"Room: $name\\n\" + \"Danger level: $dangerLevel\" open fun load() = \"Nothing much to see here...\"&#125;class TownSquare : Room(\"Town Square\") &#123; override val dangerLevel = super.dangerLevel - 3 final override fun load() = \"The villagers cheer as you enter!\"&#125; Functions are final by default unless they are inherited from an open class. To prevent inherited functions from being overriden again, we can mark it final. In Kotlinâ€™s inheritance, we always have: However, when compiled into bytecode, the class Room doesnâ€™t inherits the class Any in JVM rule. 11. Objects singleton by object keyword123456789101112fun main() &#123; UserManager.getUser(2)&#125;// constructors are not allowed for such objectsobject UserManager &#123; private val users = mutableListOf&lt;String&gt;(\"A\", \"B\") fun getUser(idx: Int): String? &#123; return users.getOrNull(idx) &#125;&#125; Anonymous inner classIn java, we often implement interfaces or extend simple classes as anonymous inner class, such as click listeners and view adapters. In Kotlin, they could be divided into 2 categories. For interfaces with only one method and declared in Java, we can use a format called Lambda: 1234567891011generateButton.setOnClickListener &#123; view -&gt; fetchData()&#125;fun useI(i: I) &#123;&#125;useI(I &#123; // ...&#125;) 1234// I.javapublic interface I &#123; void f();&#125; For other cases, the format is like this: 1234567891011121314151617listView.adapter = object : BaseAdapter() &#123; // call the constructor here. override fun getView(pos: Int, view: View?, parent: ViewGroup?): View &#123; // ... &#125; override fun getItem(pos: Int): Any &#123; // ... &#125; override fun getItemId(pos: Int): Long &#123; // ... &#125; override fun getCount(): Int &#123; // ... &#125;&#125; Nested classes by default cannot access members of the outer class, unless they are marked inner: 12345678910111213141516171819202122232425class Outer &#123; fun outerFunc() = \"1\" class Nested &#123; init &#123; outerFunc() // wrong, unable to access &#125; &#125; inner class Inner &#123; init &#123; outerFunc() // ok &#125; &#125;&#125;object UserManager &#123; private val users = mutableListOf&lt;String&gt;(\"A\", \"B\") class User &#123; init &#123; users // ok. this is nested class inside an object class. &#125; &#125;&#125; Data classesData classes are suitable for model, thatâ€™s what the data means. 123data class Coordinate(var x: Int, var y: Int) &#123; val inFirstQuadrant = (x &gt;0 &amp;&amp; y &gt; 0)&#125; when use the data classes: Implementation of toString, equal and copy regarding the fields declared in the primary constructor; Must have a primary constructor whose all parameters are marked with val or var; Cannot be abstract, open, or inner. Operator overloading123456789data class Coordinate(var x: Int, var y: Int) &#123; operator fun plusAssign(another: Coordinate) &#123; x += another.x y += another.y &#125; &#125;val coo = Coordinate(1, 2)coo += Coordinate(2, 3) 12345678910object Fact &#123; operator fun invoke(n: Int): Int &#123; return if (n &gt; 2) n * this(n-1) else n &#125;&#125;println(Fact(5)) 12 Generics 1234567891011121314151617open class Book(val name: String)class Novel(name: String): Book(name)class Textbook(name: String): Book(name)class Bookshelf&lt;T: Book&gt;(vararg val books: T)val shelf1 = Bookshelf(Novel(\"A song of Ice &amp; Fire\"), Novel(\"The load of the rings\"))val shelf2 = Bookshelf(Novel(\"A song of Ice &amp; Fire\"), Textbook(\"Introduction to Algorithms\"))fun &lt;T: CharSequence&gt; count(cs: T, startIdx: Int, char: Char) = cs.substring(startIdx).count &#123; it == char &#125; 123val list1: List&lt;Book&gt; = listOf&lt;Novel&gt;(Novel(\"A\"), Novel(\"B\"))// the following line is wrong!val list2: MutableList&lt;Book&gt; = mutableListOf&lt;Novel&gt;(Novel(\"A\"), Novel(\"B\")) Actually the List interface is like this: 123public interface List&lt;out E&gt; : Collection&lt;E&gt; &#123; ...&#125; Here out means: any fields of a List whih the generic type E must be val. Thus E is a type only for readable fields. On the other hand, there is in, which means a generic type is only for writable variables: 123456789class A&lt;in T&gt; &#123; // no fields of type T can be available to outside private var item: T? = null fun setItem(newItem: T) &#123; item = newItem &#125;&#125;val a: A&lt;Novel&gt; = A&lt;Book&gt;() The wildcard in Java generics has some similarities with the in and out in Kotlin, but they are not equivalent concepts. 13. Extensions Based on anonymous function and generics, Kotlin brings the extensions, which enable us to extend classes with new functions and fields without inheritance. The Kotlin standard library contains a large numbers of extensions. The code below 123456fun count(str: String, startIdx: Int, predicate: (Char) -&gt; Boolean) = str.substring(startIdx).count(predicate) count(\"Mississippi\", 5) &#123; it == 's'&#125; could be refactored as 1234567// just like we have extended the String class, a final class.fun String.count(startIdx: Int, predicate: (Char) -&gt; Boolean) = substring(startIdx).count(predicate)\"Mississippi\".count(5) &#123; it == 's'&#125; Extend with fields is also available: 1234val String.countS get() = count &#123; it == 's' || it == 'S' &#125;println(\"Mississippi\".countS) // would print 4 Like computed properties, extended fields have no backing fields, actually the extended fields has no essential differences with extended methods. Visibility modifiers are also valid for the extensions. Extensions on nullable types: 12345678910111213141516fun &lt;T&gt; T?.chkNull(block1: (T) -&gt; Unit, block2: () -&gt; Unit) &#123; if (this != null) &#123; // for such extension, the this is nullable block1(this) &#125; else &#123; block2() &#125;&#125;class C(val x: String? = listOf&lt;String?&gt;(\"s\", null).shuffled().first())val c = C()c.x.chkNull(&#123; // no need to write c.x?. even that c.x is nullable. // it ...&#125;, &#123;&#125;) Generics in extensions: 12345fun &lt;T&gt; T.prt() &#123; println(this)&#125;(1 + 1).prt() Extensions in Kotlin standard library: 1234567891011121314/** * Calls the specified function [block] with `this` value as its argument * and returns its result. * * For detailed usage information see the documentation for [scope functions] * (https://kotlinlang.org/docs/reference/scope-functions.html#let). */@kotlin.internal.InlineOnlypublic inline fun &lt;T, R&gt; T.let(block: (T) -&gt; R): R &#123; contract &#123; callsInPlace(block, InvocationKind.EXACTLY_ONCE) &#125; return block(this)&#125; Usage of the let: 123456789101112class Y(val pair: Pair&lt;String, String&gt;?)val y = Y(Pair(\"hello\", \"world\"))y.pair?.let &#123; println(it.first + \" \" + it.second)&#125;val p = y.pairif (p != null) &#123; println(p.first + \" \" + p.second)&#125; Extension function type: 12345val greetings: String.() -&gt; Unit = &#123; println(\"Hello \" + this.capitalize())&#125;\"Mississippi\".greetings() Another extension in Kotlin standard library: 1234567891011121314151617181920/** * Calls the specified function [block] with `this` value as its receiver * and returns its result. * * For detailed usage information see the documentation for [scope functions] * (https://kotlinlang.org/docs/reference/scope-functions.html#run). */@kotlin.internal.InlineOnlypublic inline fun &lt;T, R&gt; T.run(block: T.() -&gt; R): R &#123; contract &#123; callsInPlace(block, InvocationKind.EXACTLY_ONCE) &#125; return block()&#125;File(\"x.txt\").run &#123; setReadable(true) setWritable(true) setExecutable(false)&#125; 14. Java Interoperability Nullity1234567891011// in java side, mark non-private fields, return type and parameter type// with annotations, thus helps Kotlin side handle nullityclass JavaClass &#123; @NotNull public String x = \"x\"; @Nullable public String f(@NotNull String y) &#123; return null; &#125;&#125; Jetbrains created their annotations like this: While the annotations by Google is like this: File level Kotlin membersLetâ€™s say we have a kotlin file Hello.kt which is: 1234567// in Hello.kt file// by default, the Hello.kt would generate a JVM class as HelloKt, // but we can change it like the following line.@file:JvmName(\"Hello\")// file level members would be static members in generated JVM classfun f() = \"hello from kotlin.\" Kotlin functions with default parameter values12345// add this annotation to make it generates several overloaded JVM methods@JvmOverloadsfun f(name: String = \"Unknown\", age: Int = 0) &#123;&#125; Access members of companion object in Java123456789class H &#123; companion object &#123; @JvmField // then H.x is ok in Java, or we need H.companion.x val x = 10 @JvmStatic // then H.f is ok in Java fun f()&#123; &#125; &#125;&#125; ExceptionsAs we said earlier, Kotlin doesnâ€™t require we to try-catch code blocks which may throw checked Java Exceptions or add a throws declaration in the method signatures. So if a Java method is called with throws declaration is called in kotlin, we might missed the exceptions warning by the Java method. For Kotlin methods which would be called by Java and might throw checked exceptions, marked it with annotation: 1234@Throws(IOException::class)fun f() &#123; throw FileNotFoundException()&#125; Referred functions of Kotlin1234// in Test.kt fileval translator = &#123; utterance: String -&gt; println(utterance.toLowerCase().capitalize())&#125; 123456public class JavaClass &#123; public static void main(String[] args) &#123; Function1&lt;String, Unit&gt; translator = RoomKt.getTranslator(); translator.invoke(\"MONey\"); &#125;&#125; Whatâ€™s the Function1: 12345/** A function that takes 1 argument. */public interface Function1&lt;in P1, out R&gt; : Function&lt;R&gt; &#123; /** Invokes the function with the specified argument. */ public operator fun invoke(p1: P1): R&#125; 15. Corutines what are coroutines coroutines are more lightweight than threads a thread can schedule between multiple coroutines a coroutine can switch between threads async &amp; launchthe most common ways to create coroutines 12345678910public fun CoroutineScope.launch( context: CoroutineContext = EmptyCoroutineContext, start: CoroutineStart = CoroutineStart.DEFAULT, block: suspend CoroutineScope.() -&gt; Unit): Jobpublic interface Job : CoroutineContext.Element &#123; public suspend fun join() ...&#125; 12345678910public fun &lt;T&gt; CoroutineScope.async( context: CoroutineContext = EmptyCoroutineContext, start: CoroutineStart = CoroutineStart.DEFAULT, block: suspend CoroutineScope.() -&gt; T): Deferred&lt;T&gt;public interface Deferred&lt;out T&gt; : Job &#123; public suspend fun await(): T ...&#125; Deferred&lt;T&gt; is also a job, only that we can call its await to fetch an result returned by that coroutine. e.g: 12345678910111213141516171819202122private fun fetchData() &#123; GlobalScope.launch(Dispatchers.Main) &#123; // type of result: Deferred&lt;CharacterData&gt; val result = GlobalScope.async(Dispatchers.Default) &#123; val (race, name, dex, wis, str) = URL( \"https://chargen-api.herokuapp.com/\").readText().split(\",\") CharacterData(race, name, dex, wis, str) &#125; characterData = result.await() displayCharacterData() // use the fetched characterData &#125;&#125;private fun displayCharacterData() &#123; characterData.run &#123; nameTextView.text = name raceTextView.text = race dexterityTextView.text = dex wisdomTextView.text = wis strengthTextView.text = str &#125;&#125; suspend functionsIn my oppnion, a function with suspend means 3 things: it might takes a not short period of time to finish it (but not blocking a thread); if declared in kotlinx.coroutines, then itâ€™s a cancelable point; might be a schedule point for threads. The most common suspend method, delay, fulfills the 3 conclusions, so does the Deferred.await method. the cancelable pointAble to cancel: 12345678fun main() = runBlocking &#123; val job = launch &#123; delay(3000) println(\"You won't see me since I would be canceled.\") &#125; delay(100) job.cancel()&#125; Unable to cancel: 12345678910111213141516171819fun main() = runBlocking &#123; val job = launch &#123; compute() println(\"No way to cancel me!\") &#125; delay(100) job.cancel()&#125;fun compute() &#123; val startTime = System.currentTimeMillis() var lastTime = startTime while (lastTime - startTime &lt; 3_000) &#123; if (System.currentTimeMillis() - lastTime &gt;= 1000) &#123; lastTime += 1000 println((lastTime - startTime) / 1000) &#125; &#125;&#125; Note: runBlocking would be explained later. Coroutine context12345fun main() = runBlocking&lt;Unit&gt; &#123; launch(Dispatchers.Default + CoroutineName(\"test\")) &#123; println(\"I'm working in thread $&#123;Thread.currentThread().name&#125;\") &#125;&#125; Coroutine scopescope is just like variables have scope in most programming languages 12345fun func() &#123; if (1 + 1 == 2) &#123; val x = 3 // x belongs to the if scope &#125;&#125; the CoroutineScope interface 123public interface CoroutineScope &#123; public val coroutineContext: CoroutineContext&#125; In kotlin, CoroutineScope is implemented by AbstractCoroutine, hence a coroutine means a CoroutineScope, but not vice versa. Parent coroutine and child coroutine: 123456GlobalScope.launch &#123; // only inside a coroutine can we call launch &amp; async directly. launch &#123; &#125;&#125; Direct calls of launch &amp; async also means children coroutines inherits Dispatchers from parent unless override by providing a Dispatchers parameter. 123456GlobalScope.launch(Dispatchers.Main) &#123; // only inside a coroutine can we call launch &amp; async directly. launch(Dispatchers.Default) &#123; &#125;&#125; Normally, parent finish after all children finish. But there is a extension method of CoroutineScope naming cancel. When itâ€™s called, the whole coroutine tree are canceled. 12345678/** * Cancels this scope, including its job and all its children with an * optional cancellation [cause]. * A cause can be used to specify an error message or to provide other * details on a cancellation reason for debugging purposes. * Throws [IllegalStateException] if the scope does not have a job in it. */public fun CoroutineScope.cancel(cause: CancellationException? = null) In kotlin, we have a GlobalScope which is an object singleton. Coroutines directly created from GlobalScope can last long as long as the JVM is on. GlobalScope is convenient for demo, however we may want coroutines to be canceled when an Activity is destroyed, for example. 12345678910111213141516171819class MyActivity : AppCompatActivity() &#123; private val mainScope = MainScope() override fun onDestroy() &#123; super.onDestroy() mainScope.cancel() &#125; mainScope.launch(Dispatchers.Main) &#123; // type of result: Deferred&lt;CharacterData&gt; val result = mainScope.async(Dispatchers.Default) &#123; val (race, name, dex, wis, str) = URL( \"https://chargen-api.herokuapp.com/\").readText().split(\",\") CharacterData(race, name, dex, wis, str) &#125; characterData = result.await() displayCharacterData() // use the fetched characterData &#125;&#125; Now letâ€™s go back to explain runBlocking. runBlocking also starts a coroutine from GlobeSope, only that runBlocking coroutines prevent JVM from ending. the coroutineScope(block) method1suspend fun &lt;R&gt; coroutineScope(block: suspend CoroutineScope.() -&gt; R): R We can create a new scope with this coroutineScope method. The most common usage would be like this: 123456789101112suspend fun doSomeThing(): Int = coroutineScope &#123; val deferred = async(Dispatchers.IO) &#123; delay(500) 3 &#125; deferred.await()&#125;GlobalScope.launch(Dispatchers.Main) &#123; val result = doSomeThing() // use the result&#125; In the above code, we created a scope with coroutineScope. When doSomeThing is called from another coroutine, the scope we created would inherit context from the outer coroutine scope. More importantly, when the outer scope is cancelled, this scope would also be canceled. In next section, we would see the coroutineScope has important role in exception handling. Exception in coroutinesFirst, what is a crash in Android app? (excluding ANR). The simplest and best way to handle exceptions, is catching exceptions locally, i.e. donâ€™t let exceptions be passed between coroutines. Like the following: 123456789101112suspend fun doSomeThing(): Int = coroutineScope &#123; val deferred: Deferred&lt;Int&gt; = async(Dispatchers.IO) &#123; try &#123; // ... the regular code block. 3 // assume 3 is a valid return &#125; catch (e: IndexOutOfBoundsException) &#123; // do something to handle 0 // assume 0 is a default return &#125; &#125; deferred.await()&#125; Itâ€™s simple, but why best? Because when an exception is not caught inside a coroutine, the exception would mostly cancel the whole coroutine tree. 1234567891011121314151617fun main() &#123; // all coroutines would be canceled, and the thread would crash GlobalScope.launch &#123; launch &#123; delay(200) println(\"You won't see me since I would be canceled.\") &#125; launch &#123; throw IndexOutOfBoundsException() &#125; delay(200) println(\"You won't see me since I would be canceled.\") &#125; runBlocking &#123; delay(500) &#125;&#125; However, with the coroutineScope method, we can do more. 123456789101112131415161718192021222324252627282930suspend fun doSomeThing(): Int = coroutineScope &#123; val deferred: Deferred&lt;Int&gt; = async(Dispatchers.IO) &#123; throw IndexOutOfBoundsException() &#125; launch &#123; // this would be canceled delay(200) println(\"You won't see me since I would be canceled.\") &#125; deferred.await()&#125;fun main() &#123; GlobalScope.launch &#123; launch &#123; delay(200) println(\"I wouldn't be canceled.\") &#125; launch &#123; try &#123; doSomeThing() &#125; // doSomeThing throws the exception catch (e: IndexOutOfBoundsException) &#123; println(\"caught the exception: $e\") &#125; &#125; delay(200) println(\"I wouldn't be canceled, either.\") &#125; runBlocking &#123; delay(500) &#125;&#125; the CancellationExceptionIt is thrown when a coroutine is canceled, but wonâ€™t crash the JVM thread. just like nothing happen: 1234567fun main() &#123; // just like nothing happen GlobalScope.launch &#123; throw CancellationException() &#125; runBlocking &#123; delay(500) &#125;&#125; JVM thread would crash: 123456fun main() &#123; GlobalScope.launch &#123; throw IndexOutOfBoundsException() &#125; runBlocking &#123; delay(500) &#125;&#125; CancellationException seems useless, but it can be caught if you want. Just surround the cancel point inside a coroutine with try-catch. 12345678910111213141516171819fun main() &#123; // just like nothing happen GlobalScope.launch &#123; launch &#123; delay(100) throw IndexOutOfBoundsException() &#125; try &#123; delay(50) &#125; catch (e: CancellationException) &#123; println(\"caught 1: $e\") throw e // usually you should throw it again &#125; try &#123; delay(60) &#125; catch (e: CancellationException) &#123; println(\"caught 2: $e\") throw e // usually you should throw it again &#125; // ... &#125; runBlocking &#123; delay(500) &#125;&#125; Look the the code above, if you donâ€™t throw again the CancellationException again, the coroutine would continue executing, which usually is abnormal. the CoroutineExceptionHandlerWe can set an CoroutineExceptionHandler to the root scope or the root coroutine to let the handler handle exceptions throws inside all coroutines. 1234567891011121314fun main() &#123; val ceh = CoroutineExceptionHandler &#123; _, e -&gt; println(\"Handled crash: $e\") &#125; //CoroutineScope(Dispatchers.IO).launch(ceh) &#123; // this also works CoroutineScope(Dispatchers.IO + ceh).launch &#123; launch(Dispatchers.Default) &#123; throw IndexOutOfBoundsException() &#125; &#125; runBlocking &#123; delay(500) &#125;&#125; 1234567891011121314// would crash!!fun main() &#123; val ceh = CoroutineExceptionHandler &#123; _, e -&gt; println(\"Handled crash: $e\") &#125; CoroutineScope(Dispatchers.IO).launch &#123; launch(Dispatchers.Default + ceh) &#123; throw IndexOutOfBoundsException() &#125; &#125; runBlocking &#123; delay(500) &#125;&#125; If a coroutine is created from async, the await function would also throw the exception escaped from the coroutine: 123456789101112131415161718192021fun main() &#123; val ceh = CoroutineExceptionHandler &#123; _, e -&gt; println(\"Handled crash: $e\") &#125; CoroutineScope(Dispatchers.IO).launch(ceh) &#123; val d: Deferred&lt;Int&gt; = async() &#123; oops(); 3 &#125; try &#123; println(d.await()) &#125; catch (e: IndexOutOfBoundsException) &#123; println(\"caught: $e\") &#125; &#125; runBlocking &#123; delay(500) &#125;&#125;fun oops() &#123; throw IndexOutOfBoundsException()&#125; 16. Functional Programming Basics TransformsA transform function works on the contents of a collection by walking through the collection and transforming each item with a transformer function provided as an argument. the map method 123456789/** * Returns a list containing the results of applying the given [transform] * function to each element in the original collection. * * @sample samples.collections.Collections.Transformations.map */public inline fun &lt;T, R&gt; Iterable&lt;T&gt;.map(transform: (T) -&gt; R): List&lt;R&gt; &#123; return mapTo(ArrayList&lt;R&gt;(collectionSizeOrDefault(10)), transform)&#125; FiltersA filter function accepts a predicate function that checks each element in a collection against a condition and returns either true or false. the filter method 123456/** * Returns a list containing only elements matching the given [predicate]. */public inline fun &lt;T&gt; Iterable&lt;T&gt;.filter(predicate: (T) -&gt; Boolean): List&lt;T&gt; &#123; return filterTo(ArrayList&lt;T&gt;(), predicate)&#125; CombinesCombining functions take different collections and merge them into a new one. the zip method 12345678910111213/** * Returns a sequence of values built from the elements of `this` sequence * and the [other] sequence with the same index. * The resulting sequence ends as soon as the shortest input sequence ends. * * The operation is _intermediate_ and _stateless_. * * @sample samples.collections.Sequences.Transformations.zip */public infix fun &lt;T, R&gt; Sequence&lt;T&gt;.zip(other: Sequence&lt;R&gt;): Sequence&lt;Pair&lt;T, R&gt;&gt; &#123; return MergingSequence(this, other) &#123; t1, t2 -&gt; t1 to t2 &#125;&#125; Examples 12345678910111213// get primes(2..1000).filter &#123; num-&gt; (2 until num).filter &#123; num % it == 0 &#125;.isEmpty()&#125;// get primes with the noneval primes = (2..1000).filter &#123; num-&gt; (2 until num).none &#123; num % it == 0 &#125;&#125; References Kotlin Programming: The Big Nerd Ranch Guide, awailable in the Oâ€™Reilly Learning platform. Official Kotlin coroutine guide. Exceptional Exceptions for Coroutines made easyâ€¦?","categories":[],"tags":[{"name":"Kotlin","slug":"Kotlin","permalink":"https://tao93.top/tags/Kotlin/"}]},{"title":"5 åˆ†é’Ÿæé«˜ macOS ä½¿ç”¨æ•ˆç‡","slug":"macOS æ•ˆç‡","date":"2019-08-09T07:57:21.000Z","updated":"2019-10-10T23:22:36.697Z","comments":true,"path":"2019/08/09/macOS æ•ˆç‡/","link":"","permalink":"https://tao93.top/2019/08/09/macOS æ•ˆç‡/","excerpt":"","text":"å‰è¨€æèµ· macOSï¼Œå¤§å®¶å¯èƒ½ä¼šæƒ³åˆ°ç²¾è‡´ã€å¹¿å‘Šå°‘ã€è½¯ç¡¬æ­é…æä½³ã€Unix ç­‰ç­‰ï¼Œè¿™äº›ä¹Ÿæ˜¯ macOS é€æ¸åœ¨è½¯ä»¶å¼€å‘è€…ã€è®¾è®¡å¸ˆã€æ–‡å­—å·¥ä½œè€…ç­‰ç¾¤é‡Œä¸­æˆä¸ºã€Œæ ‡é…ã€çš„åŸå› ã€‚ç„¶è€Œæ€»ç»“æˆ‘è¿™å‡ å¹´çš„ä½¿ç”¨ç»éªŒï¼Œæˆ‘è®¤ä¸ºæœ‰è®¸å¤šå·¥å…·å’Œæ–¹æ³•ï¼Œå¯ä»¥åœ¨é»˜è®¤çš„ macOS åŸºç¡€ä¸Šï¼Œæ›´è¿›ä¸€æ­¥æé«˜æˆ‘ä»¬çš„æ•ˆç‡ã€‚æœ¬æ–‡åŸºäº macOS 10.14.6ï¼Œä¸æ¯”è¾ƒ macOS å’Œå…¶å®ƒç³»ç»Ÿå­°ä¼˜å­°åŠ£ï¼Œè€Œæ˜¯é’ˆå¯¹ã€Œæ‰€æœ‰ç”¨æˆ·ã€å’Œã€Œç¨‹åºå‘˜ã€ä¸¤ä¸ªç¾¤ä½“åˆ†åˆ«åˆ†äº«ä¸€äº›æˆ‘çš„ç»éªŒï¼Œæ¬¢è¿è®¨è®ºå’Œäº¤æµã€‚å¦å¤–ï¼Œæœ¬æ–‡æ¨èçš„å‡ ä¹éƒ½æ˜¯å…è´¹æˆ–è€…å¼€æºçš„å·¥å…·ï¼Œå—¯ï¼Œæˆ‘å°±æ˜¯è¿™ä¹ˆä¸ºå¤§å®¶çš„é’±åŒ…ç€æƒ³ï¼ˆæˆ‘å¯ä¸ä¼šè¯´æ˜¯å› ä¸ºæˆ‘ç©·ï¼‰ã€‚ å¯¹æ‰€æœ‰ç”¨æˆ·å‰ªè´´æ¿ç®¡ç†å‰ªè´´æ¿ç®¡ç†å·¥å…·å¸®æˆ‘ä»¬ç»´æŠ¤æ–‡æœ¬å’Œå›¾ç‰‡çš„å¤åˆ¶å†å²ï¼Œä»è€Œè®©æˆ‘ä»¬èƒ½ç²˜è´´ä¸Šä¸Šä¸Šä¸Šä¸Šä¸Šä¸Šä¸Šä¸Šä¸Šä¸Šä¸Š(è¯·ä¸è¦è¯´æˆ‘å‡‘å­—æ•°)â€¦æ¬¡å¤åˆ¶çš„å†…å®¹ã€‚æ˜¾è€Œæ˜“è§è¿™æ˜¯å¯¹ä»»ä½•äººéƒ½éå¸¸æœ‰ç”¨ enhancementï¼Œè¿™ä¹Ÿæ˜¯ä¸ºå•¥æˆ‘æŠŠå®ƒæ”¾åœ¨ç¬¬ä¸€ä¸ªä»‹ç»ã€‚ç°åœ¨ Alfred ç­‰å·¥å…·å·²é›†æˆäº†å‰ªè´´æ¿ç®¡ç†çš„åŠŸèƒ½ï¼Œä¸è¿‡ï¼Œæœ¬ç€å¼€æºä¼˜å…ˆ(å…è´¹)çš„åŸåˆ™ï¼Œæˆ‘è¦æ¨èçš„æ˜¯ GitHub ä¸Šçš„ Clipyï¼Œå®‰è£…å¹¶ç¨å¾®è®¾ç½®åï¼ŒæŒ‰ä¸‹è®¾å®šå¥½çš„å¿«æ·é”®ï¼Œå°±èƒ½å‡ºç°ä¸‹å›¾çš„å¼¹æ¡†ï¼š ç„¶ååªéœ€è¦æŒ‰ä¸Šä¸‹æ–¹å‘é”®é€‰æ‹©ï¼Œå°±å¯ä»¥ç²˜è´´ä¸Šä¸Šä¸Šä¸Šâ€¦æ¬¡å¤åˆ¶è¿‡çš„å†…å®¹äº†ã€‚ä¸è¿‡éœ€è¦å¼ºè°ƒçš„æ˜¯ï¼Œåœ¨ Clipy çš„ä¸‹è½½é¡µé¢ï¼ŒåŠ¡å¿…ä¸‹è½½ 1.15 ç‰ˆæœ¬ï¼Œå› ä¸º 1.2.0 å’Œ 1.2.1 éƒ½æœ‰ä¸€ä¸ª bug ä½¿å¾—å®ƒæ— æ³•å°†å¤åˆ¶çš„å›¾ç‰‡çº³å…¥ç®¡ç†ã€‚ è½¯ä»¶å¸è½½ä¼—æ‰€å‘¨çŸ¥ï¼ŒmacOS ä¸Šå®‰è£…è½¯ä»¶ä¸€èˆ¬æ˜¯å°†ä¸€ä¸ª XXX.app æ‹–åˆ°ä¸€ä¸ª Applications ç›®å½•ä¸­ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªæ‹·è´çš„åŠ¨ä½œï¼Œå®Œæˆè¿™ä¸ªåï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡ Spotlight æœç´¢æˆ–è€…åœ¨ Launchpad ç‚¹å‡»å›¾æ ‡æ¥æ‰“å¼€å®ƒã€‚äº‹å®ä¸Šï¼ŒXXX.app å…¶å®æ˜¯ä¸€ä¸ªç›®å½•ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªåç¼€ä¸º app çš„æ–‡ä»¶ï¼Œè¿™å¯ä»¥é€šè¿‡åœ¨ XXX.app ä¸Šå³é”®ï¼Œç„¶åç‚¹å‡»Show Package contentsï¼Œå¦‚å›¾ï¼š XXX.app ç›®å½•åŒ…å«ä¸€ä¸ªè½¯ä»¶è¿è¡Œèµ·æ¥æ‰€éœ€çš„æ‰€æœ‰æ–‡ä»¶ï¼Œä½†å½“æˆ‘ä»¬æ‰“å¼€ä¸€ä¸ªæ–°å®‰è£…çš„è½¯ä»¶ï¼Œå®ƒå¾€å¾€ä¼šåœ¨ä¸€äº›åˆ«çš„åœ°æ–¹ (ä¸åœ¨ Applications ä¹Ÿä¸åœ¨ XXX.app ä¸­) ç”Ÿæˆä¸€äº›é…ç½®æ–‡ä»¶ã€‚æ‰€ä»¥ä»…ä»…åœ¨ Applications ä¸­åˆ é™¤ XXX.app å¹¶ä¸èƒ½ç§»é™¤ç”Ÿæˆçš„é…ç½®æ–‡ä»¶ï¼Œä»è€Œå¦‚æœå“ªå¤©å†æ¬¡å®‰è£…è¿™ä¸ªè½¯ä»¶ï¼Œè€çš„é…ç½®ä¾ç„¶ä¼šäº§ç”Ÿä½œç”¨ã€‚è‹¥è¦å½»åº•å¸è½½è½¯ä»¶ï¼Œå¯ä»¥ä½¿ç”¨è½»é‡çº§çš„ AppCleanerï¼Œå®ƒå¯ä»¥å¸®æˆ‘ä»¬æœç´¢å‡ºéœ€å¸è½½è½¯ä»¶çš„æœ¬ä½“å’Œæ‰€æœ‰é…ç½®æ–‡ä»¶ï¼Œç„¶åæˆ‘ä»¬é€‰æ‹©åˆ é™¤å“ªäº›ï¼š è§£å‹ç¼©å¯¹äºè½¯ä»¶ï¼Œå…¶å®æˆ‘æ˜¯èƒ½ç”¨ç³»ç»Ÿè‡ªå¸¦çš„å°±ç”¨ç³»ç»Ÿè‡ªå¸¦çš„ï¼Œç„¶è€Œ macOS ä¸Šé¢çš„ Archive Utility.app è§£å‹æŸäº›æ ¼å¼æ—¶ä¼šå‡ºé”™ï¼Œä¹Ÿä¸èƒ½é€‰æ‹©æ–‡æœ¬ç¼–ç ï¼Œæ‰€ä»¥å°±æœ‰å¿…è¦ä½¿ç”¨ç¬¬ä¸‰æ–¹è§£å‹è½¯ä»¶äº†ï¼Œæ¯”å¦‚è½»é‡çš„ The Unarchiver äº†ã€‚ æ–‡æœ¬ç¼–è¾‘å™¨åŒæ ·çš„ï¼ŒmacOS çš„ TextEdit.app ä¹Ÿæ˜¯ä¸å ªé‡ä»»ï¼Œå°±å¥½æ¯”æ˜¯ Windows ä¸Šçš„è®°äº‹æœ¬ä¸€æ ·ã€‚å¦‚æœä½ ä¹Ÿä¸çŸ¥é“è‡ªå·±è¯¥ç”¨ä»€ä¹ˆæ–‡æœ¬ç¼–è¾‘å™¨ï¼Œé‚£ Sublime Text æ˜¯ä¸ªå¾ˆä¸é”™çš„é€‰æ‹©ã€‚è½»é‡ã€åŠŸèƒ½å¼ºå¤§ã€å®šåˆ¶è¡Œå¼ºã€æ”¯æŒå„ç§èŠ±å¼çš„æ’ä»¶ï¼Œè¿™å°±æ˜¯ Sublime Textã€‚æˆ‘æœ€å–œæ¬¢å®ƒçš„ä¸€ä¸ªåŠŸèƒ½æ˜¯ï¼Œåœ¨å®ƒçš„ä¸€ä¸ª tab ä¸­å†™ç‚¹ä¸œè¥¿ï¼Œä¸ç”¨ä¿å­˜ä¸ºæ–‡ä»¶å°±å¯ä»¥é€€å‡ºè½¯ä»¶ç”šè‡³å…³æœºï¼Œç­‰ä¸‹æ¬¡æ‰“å¼€å®ƒï¼Œä¸€åˆ‡å†…å®¹éƒ½æ¢å¤äº†ï¼Œè¿™ç‰¹åˆ«é€‚åˆç”¨æ¥è®°ç‚¹ä¸œè¥¿ã€‚ çª—å£ç®¡ç†çª—å£ç®¡ç†ä¹Ÿå°±æ˜¯æŠŠçª—å£æ”¾å¤§ç¼©å†™å’ŒæŒªåŠ¨çš„æ“ä½œã€‚macOS é»˜è®¤çš„çª—å£æ“ä½œè¢«ä¸€äº›äººè®¤ä¸ºä¸å¦‚ Windows å¥½ç”¨ï¼Œå…¶å®æˆ‘è®¤ä¸ºç¨å¾®è®¾ç½®ä¸€ä¸‹ï¼Œå°±èƒ½è®©è¿™äº›äººçš„ğŸ¤å•¦ã€‚é¦–å…ˆï¼ŒmacOS å…¶å®ä¸éœ€è¦æˆ‘ä»¬ç»å¸¸å›åˆ°æ¡Œé¢ï¼Œè¿™æœ‰åˆ«äº Windows çš„ç»å¸¸å›åˆ°æ¡Œé¢ç‚¹å‡»å›¾æ ‡å¯åŠ¨è½¯ä»¶ã€‚macOS ä¸­ï¼Œå½“éœ€è¦åˆ‡æ¢åˆ°åˆ«çš„è½¯ä»¶æ—¶ï¼Œä¸åº”è¯¥ç”¨æœ€å°åŒ– (å¿«æ·é”® Cmd+M) çš„æ“ä½œï¼Œå› ä¸ºæ°¸è¿œä¸çŸ¥é“æœ€å°åŒ–åéœ²å‡ºæ¥çš„æ˜¯å“ªä¸€ä¸ªè½¯ä»¶ï¼Œæ‰€ä»¥åº”è¯¥ç›´æ¥ç‚¹å‡»æˆ– Cmd+Tab å‰å¾€æƒ³è¦å»çš„è½¯ä»¶ï¼Œé™¤éä½ çš„æŸä¸ªè½¯ä»¶çœŸçš„æœ‰è§ä¸å¾—äººçš„ä¸œè¥¿ï¼Œåˆ«äººæ¥åˆ°ä½ ç”µè„‘å‰æ—¶ä½ å¯ä»¥ç–¾é€Ÿåœ°æŒ‰ä¸‹ Cmd+M ç»„åˆé”®ã€‚æ›´åˆ«ææœ€å°åŒ–åï¼Œé”®ç›˜æ“ä½œå°†ä¸èƒ½æŠŠè¯¥çª—å£æ‹‰å›æ¥ï¼Œè€Œåªèƒ½é ç‚¹ å‡» (é¼ æ ‡æˆ–è§¦æ‘¸æ¿)ï¼Œè€Œé€šå¸¸é”®ç›˜æ“ä½œæ›´å¿«é€Ÿã€‚ æ‰¯è¿œäº†ï¼Œå›åˆ°çª—å£ç®¡ç†ï¼Œå¦‚æœæ„¿æ„ä»˜è´¹ï¼Œå¯ä»¥é€‰ç”¨ Moom æˆ– BetterSnapTool ä¸¤æ¬¾ä»˜è´¹è½¯ä»¶ï¼Œå½“ç„¶ä»–ä»¬éƒ½å¯å…è´¹è¯•ç”¨ã€‚å®ƒä»¬æä¾›è¶³å¤Ÿçš„åŠŸèƒ½è®©æˆ‘ä»¬èŠ±å¼ç®¡ç†çª—å£ï¼Œå¿«æ·é”®ä¹Ÿå¥½ï¼Œè§¦å‘è§’ä¹Ÿç½¢ã€‚å¦‚æœä½ ä¸æƒ³å¤§åŠ¨å¹²æˆˆï¼Œå…¶å®æˆ‘ä»¬æœ€éœ€è¦çš„åªæœ‰ä¸¤ä¸ªæ“ä½œï¼šçª—å£æœ€å¤§åŒ–(ä¸æ˜¯å¼€å¯å…¨å±è§†å›¾)å’Œçª—å£å¤§å°å›é€€ã€‚å‰è€…è®©æˆ‘ä»¬å°†å½“å‰è½¯ä»¶å¡«æ»¡å±å¹•ï¼Œä»è€Œèšç²¾ä¼šç¥å·¥ä½œ(æ‘¸é±¼)ï¼›åè€…æ„æ€æ˜¯è®©çª—å£ä»æœ€å¤§åŒ–å˜å›æœ¬æ¥çš„å¤§å°ã€‚è¿™ä¸¤ä¸ªæ“ä½œä¸€èˆ¬å¯ä»¥é€šè¿‡ macOS è‡ªå¸¦çš„ Zoom æ“ä½œï¼Œä¹Ÿå°±æ˜¯ menu bar ä¸­ Window èœå•ä¸‹çš„ Zoomã€‚è¿™ä¸ª Zoom é»˜è®¤æ²¡æœ‰å¿«æ·é”®ï¼Œä¸è¿‡æˆ‘ä»¬å¯ä»¥åœ¨ç³»ç»Ÿä¸­è®¾ç½®ï¼šSystem Preferences.app &gt; Keyboard &gt; Shortcuts &gt; App Shortcutsï¼Œç„¶åç‚¹+æŒ‰é’®å¹¶å¦‚ä¸‹æ·»åŠ ï¼š æ­¤åæŒ‰ä¸Šé¢è®¾ç½®çš„å¿«æ·é”®ï¼Œå°±èƒ½æœ€å¤§çª—å£åŒ–å’Œå›é€€çª—å£äº†ã€‚ å¿«æ·é”®å¿«æ·é”®çš„ä¸–ç•Œçº·ç¹å¤æ‚ï¼Œæœ‰æ—¶å€™ç”šè‡³ä¸å°å¿ƒè§¦å‘äº†ä¸ªä»€ä¹ˆå¿«æ·é”®å´ä¸çŸ¥æƒ…ï¼Œç„¶åä¸€è„¸ğŸ˜³ã€‚è¨€å½’æ­£ä¼ ï¼Œé€‚ç”¨æœ€å¹¿ï¼Œä½¿ç”¨é¢‘ç‡æœ€é«˜çš„å°‘æ•°åŸºæœ¬å¿«æ·é”®æ‰æ˜¯æœ€å€¼å¾—æçš„ï¼š å¿«æ·é”® ä½œç”¨ Cmd + N ä¸€èˆ¬æ˜¯æ–°å»ºçª—å£ Cmd + T ä¸€èˆ¬æ˜¯æ–°å»º Tab æ ‡ç­¾é¡µ Cmd + ` (ESC ä¸‹æ–¹æŒ‰é”®) åœ¨å½“å‰è½¯ä»¶çš„ä¸åŒçª—å£é—´åˆ‡æ¢ Cmd + Shift + [ å½“å‰çª—å£å‘å·¦ä¾§ Tab åˆ‡æ¢ Cmd + Shift + ] å½“å‰çª—å£å‘å³ä¾§ Tab åˆ‡æ¢ Cmd + W å…³é—­å½“å‰ Tab æˆ–å½“å‰çª—å£ Cmd + Q å½»åº•é€€å‡ºè½¯ä»¶ Ctrl + Cmd + Space å–èŒæ—¶å¯ç”¨ï¼Œè¯•è¯•ä½ å°±çŸ¥é“äº† Option + Cmd + C å¤åˆ¶æ–‡ä»¶æˆ–ç›®å½•çš„è·¯å¾„ Cmd + L Safari ä¸ Chrome ä¸­ focus åœ°å€æ  Option + Cmd + Delete æ°¸ä¹…åˆ é™¤ç›®å½•æˆ–æ–‡ä»¶ F11 æ‰’å¼€æ‰€æœ‰çª—å£çœ‹ä¸‹æ¡Œé¢ Cmd + , è¿›åå¥½è®¾ç½®ï¼Œå¯¹å‡ ä¹æ‰€æœ‰è½¯ä»¶æœ‰æ•ˆ macOS æœ‰ Mission Control å’Œ App ExposÃ© ä¸¤ä¸ªåŠŸèƒ½ï¼Œåˆ†åˆ«æœ‰é»˜è®¤çš„å¿«æ·é”® Cmd + â†‘ å’Œ Cmd + â†“ï¼Œå‰è€…æ˜¾ç¤ºæ‰€æœ‰çª—å£ï¼Œåè€…æ˜¾ç¤ºå½“å‰è½¯ä»¶çš„æ‰€æœ‰çª—å£ã€‚å½“ç„¶ï¼Œå®ƒä»¬è¿˜å¯ä»¥åœ¨è§¦æ‘¸æ¿è®¾ç½®ä¸­é€šè¿‡è®¾ç½®æ‰‹åŠ¿æ¥è§¦å‘ã€‚ Windows ä¸­å‡ºç°ä¸€ä¸ªå¼¹æ¡†æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥æŒ‰ Tab é”®æ¥åˆ‡æ¢ focus åˆ°ä¸åŒæŒ‰é’®ä¸Šï¼Œç„¶åæŒ‰ Enter æˆ–ç©ºæ ¼æ¥ä»£æ›¿ç‚¹å‡»æŒ‰é’®ã€‚macOS å…¶å®ä¹Ÿå¯ä»¥ï¼Œä½†é»˜è®¤æœªå¼€å¯ï¼Œå¼€å¯æ–¹æ³•æ˜¯ï¼šSystem Preferences.app &gt; Keyboard &gt; Shortcutsï¼Œç„¶å Full Keyboard Access é€‰ä¸­ All controls å³å¯ã€‚ åœ¨ä¸€äº›å¤§é”®ç›˜ä¸Šï¼Œå³ä¾§ä¼šæœ‰å¾ˆå¤šæ²¡æœ‰å­˜åœ¨æ„Ÿçš„æŒ‰é”®ï¼Œæ¯”å¦‚ Home å’Œ Endã€‚å…¶å®å®ƒä»¬çš„ä½œç”¨ä¹‹ä¸€æ˜¯å°†å…‰æ ‡ç§»åŠ¨åˆ°è¡Œé¦–/è¡Œæœ«ï¼Œæ‰€ä»¥å®ƒä»¬æ­é…ä¸Š Shift æŒ‰é”®ï¼Œå°±å¯ä»¥å¿«é€Ÿé€‰ä¸­å½“å‰å…‰æ ‡è‡³è¡Œé¦–/è¡Œæœ«çš„æ–‡æœ¬ï¼Œå³å¿«æ·é”® Home/End + Shiftã€‚è€Œè¦é€‰ä¸­æ•´è¡Œï¼Œä¹Ÿå¯å…ˆ Home ç„¶å End + Shift å³å¯ã€‚macOS ä¸­ï¼ŒHome å’Œ End å¯åˆ†åˆ«ç”± Cmd + â† å’Œ Cmd + â†’ å®ç°ï¼Œå¦‚æ­¤ä¸€æ¥ï¼ŒæŒ‰ä¸‹ Cmd å’Œ Shift å†æŒ‰å·¦å³æ–¹å‘é”®å³å¯ã€‚ æœ‰æ—¶å€™æˆ‘ä»¬æƒ³å¼ºé€€ä¸€äº›æ— å“åº”çš„è½¯ä»¶ï¼Œå¯ä»¥æŒ‰ Option + Cmd + ESC ç„¶ååœ¨çª—å£ä¸­å¼ºé€€æŸä¸ªè½¯ä»¶ã€‚å¦‚æœä½ ä¸è®°å¾—è¿™ä¸ªå¿«æ·é”®ï¼Œé€šå¸¸åœ¨ Dock ä¸­å³é”®å›¾æ ‡ä¹Ÿä¼šæœ‰å¼ºé€€çš„é€‰é¡¹ã€‚æåˆ° ESCï¼Œé¡ºä¾¿è¯´ä¸€ä¸‹ï¼Œç»å¤§éƒ¨åˆ†å„å¼å„æ ·çš„å°å¼¹æ¡†ï¼Œéƒ½å¯ä»¥é€šè¿‡æŒ‰ ESC æ¥æŠŠå¼¹æ¡†å…³é—­æ‰ã€‚ å…‰æ ‡è¦å¿«å¦‚æœä½ è®¤ä¸ºæˆ‘è¯´çš„æ˜¯å…‰æ ‡éšé¼ æ ‡æˆ–æ‰‹æŒ‡åœ¨è§¦æ‘¸æ¿ä¸Šç§»åŠ¨é€Ÿåº¦çš„å¿«æ…¢ï¼Œé‚£ä½ å°±é”™å•¦ï¼è™½ç„¶æˆ‘çš„ç¡®å»ºè®®å‰é¢è¯´çš„è¿™ä¸ªå¿«æ…¢å¯ä»¥â€¦æå¿«ç‚¹ï¼ˆæ¯•ç«Ÿè¿™æ ·å¯ä»¥å‡å°‘æœ‰æ—¶å€™åœ¨è§¦æ‘¸æ¿ä¸Šæ‰‹æŒ‡æ»‘åŠ¨ä¸€æ¬¡è¿˜æ²¡åˆ°ç›®çš„åœ°ï¼Œéœ€è¦æŠ¬èµ·æ‰‹æŒ‡æ¥åŠ›ç»§ç»­æ»‘åŠ¨)ï¼Œå¯æˆ‘æ›´æƒ³è¯´çš„æ˜¯é•¿æŒ‰é”®ç›˜çš„å·¦å³æ–¹å‘é”®æ—¶ï¼Œå…‰æ ‡åœ¨å­—ç¬¦ä¹‹é—´ç§»åŠ¨çš„é€Ÿåº¦ã€‚é¦–æ¬¡ä½¿ç”¨ Mac æ—¶ï¼Œæˆ‘å°±å‘ç°è¿™ä¸ªç§»åŠ¨é€Ÿåº¦å¤ªæ…¢ï¼Œä»¤äººæŠ“ç‹‚ï¼å¹¸è€Œä¸å°±æˆ‘å°±å¾—çŸ¥åœ¨ System Preferences.app &gt; Keyboard ä¸­æŠŠ Key Repeat å’Œ Delay Until Repeat éƒ½è®¾ç½®åˆ°æœ€å³ä¾§ï¼Œå°±èƒ½é•¿æŒ‰å·¦å³æ–¹å‘é”®æ—¶ï¼Œå…‰æ ‡æ¯”è¾ƒå¿«åœ°ç§»åŠ¨äº†ã€‚ ä»€ä¹ˆï¼Ÿä½ è¿˜è¦æ›´å¿«ï¼Ÿå—¯ï¼ŒåŠæ³•ä¹Ÿæ˜¯æœ‰çš„ï¼ŒæŒ‰ä½ Option çš„åŒæ—¶ï¼Œé•¿æŒ‰æˆ–è¿å‡»å·¦å³æ–¹å‘é”®ï¼Œå…‰æ ‡å°†ä»¥è‹±æ–‡ word ä¸ºå•ä½ç§»åŠ¨ï¼Œæ‰€ä»¥ç§»åŠ¨é€Ÿåº¦ä¼šæ›´å¿«ã€‚ é»˜è®¤æ‰“å¼€æ–¹å¼è¯´åˆ°è¿™ä¸ªå°±æƒ³èµ· Xcodeï¼Œä½†å‡¡å’Œä»£ç æœ‰ç‚¹å…³ç³»çš„æ–‡ä»¶ï¼ŒmacOS éƒ½ä¼šé»˜è®¤è®© Xcode æ‰“å¼€ã€‚å‘ç”Ÿè¿™ç§æƒ…å†µæ—¶ï¼Œæˆ‘éƒ½æ˜¯ç–¾é€Ÿåœ° Cmd+Q é€€å‡º Xcode ç„¶ååœ¨ Finder ä¸­å³é”®åˆšåˆšæ‰“å¼€çš„æ–‡ä»¶ï¼Œæ­¤æ—¶æŒ‰ä½ Option å¹¶åœ¨ Always Open With èœå•ä¸­é€‰æ‹©æˆ‘æƒ³è¦çš„è½¯ä»¶ï¼Œæ¯”å¦‚ Sublime Textï¼Œåˆ°è¿™ï¼ŒXcode å†ä¹Ÿæ— æ³•æŸ“æŒ‡è¿™ä¸ªæ–‡ä»¶æ ¼å¼äº† ğŸ˜ã€‚ ç®€å•ç®¡ç†å¯åŠ¨é¡¹Windows ä¸­æˆ‘ä»¬å¾€å¾€ç”¨å„ç§ç”µè„‘ç®¡å®¶æ¥é™åˆ¶æŸäº›è½¯ä»¶å¼€æœºè‡ªå¯çš„æµæ°“è¡Œä¸ºï¼ŒmacOS ä¸­è¿™æ ·çš„æµæ°“å°‘å¾ˆå¤šï¼Œä½†å½“çœŸçš„æœ‰äº†çš„æ—¶å€™ï¼Œæˆ–è€…æˆ‘ä»¬åè¦æŠŠæŸäº›è½¯ä»¶è®¾ç½®è‡ªå¯ (æ¯”å¦‚æˆ‘ä¼šæŠŠé‚®ä»¶å®¢æˆ·ç«¯è®¾ç½®å¼€æœºè‡ªå¯ï¼Œè¿™æ ·ç”µè„‘é‡å¯åï¼Œæˆ‘ä¸ä¼šå¿˜è®°æ‰“å¼€å®ƒè€Œé”™è¿‡é‚®ä»¶é€šçŸ¥ï¼Œå—¯ï¼Œæˆ‘å°±æ˜¯çƒ­çˆ±å·¥ä½œ)ã€‚æ“ä½œå¾ˆç®€å•ï¼ŒSystem Preferences.app &gt; Users &amp; Groups &gt; Login Itemsï¼Œç„¶åä¸æƒ³è¦çš„ login item åˆ æ‰ï¼Œæƒ³å¢åŠ çš„åŠ ä¸Šï¼ŒOKã€‚æ¨èæŠŠæ¯å¤©éƒ½ç”¨çš„å·¥å…·è½¯ä»¶åŠ ä¸Šå»ï¼Œæ¯”å¦‚å‰é¢è¯´çš„ Clipyã€‚ æˆªå±ä¸å½•å±macOS ç³»ç»Ÿè‡ªå¸¦çš„æˆªå±åŠŸèƒ½ï¼Œåœ¨ System Preferences.app &gt; Keyboard &gt; Shortcuts &gt; Screenshots ä¸­å¯ä¸€è§ˆæ— é—ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š æœ‰æˆªå–å…¨å±å’Œæˆªå–é€‰ä¸­åŒºåŸŸå¹¶æ”¾åˆ°å‰ªè´´æ¿ï¼›ä¹Ÿæœ‰æˆªå–å…¨å±å’Œæˆªå–é€‰ä¸­åŒºåŸŸå¹¶ä½œä¸ºæ–‡ä»¶ä¿å­˜åˆ°æ¡Œé¢ï¼Œå¹¶ä¸”è¿™ç§æ–¹å¼ä¸‹ï¼Œæˆªå›¾åˆšå®Œæˆæ—¶æ¡Œé¢å³ä¸‹è§’ä¼šå’Œ iOS ä¸€æ ·çŸ­æ—¶é—´å†…æ˜¾ç¤ºä¸€ä¸ªç¼©ç•¥å›¾ï¼Œç‚¹å‡»å®ƒçš„è¯å¯ä»¥ç¼–è¾‘åˆšåˆšçš„æˆªå›¾ã€‚ä»¥ä¸ŠåŠŸèƒ½æ— æ³•æˆªå›¾åˆ°å‰ªè´´æ¿åŒæ—¶æä¾›ç¼–è¾‘åŠŸèƒ½ï¼Œæ­¤å¤–å½•å±åŠŸèƒ½ä¹Ÿæ˜¯ç¼ºå¤±çš„ï¼Œæ‰€ä»¥å®‰è£…ç¬¬ä¸‰æ–¹æˆªå›¾è½¯ä»¶åŠ¿åœ¨å¿…è¡Œã€‚ è¯´å‡ºæ¥å¯èƒ½æœ‰ç‚¹ lowï¼Œå…¶å®æˆ‘æˆªå±å’Œå½•å±ä¸€ç›´æ˜¯ç”¨ QQ å†…åµŒçš„æˆªå›¾åŠŸèƒ½ã€‚å¯¹ï¼Œå°±æ˜¯è…¾è®¯é‚£ä¸ª QQã€‚ç®€å•æ¥è¯´ï¼ŒQQ è¿™ä¸ªæˆªå›¾å·¥å…·æ˜¯å¯ä»¥å•ç‹¬è¿è¡Œçš„ï¼Œå¹¶ä¸ä¾èµ– QQ çš„è¿è¡Œï¼Œæˆ‘æŠŠè¿™ä¸ªå·¥å…·æŒ‰ä¸Šä¸€æ¡ã€Œç®€å•ç®¡ç†å¯åŠ¨é¡¹ã€ä¸­çš„æ–¹æ³•è®¾ç½®ä¸ºå¼€æœºè‡ªå¯ã€‚è¿™æ ·ä¸ç”¨ç®¡ QQ çš„æ­»æ´»å°±å¯ä»¥ä¸€ç›´ä½¿ç”¨å®ƒäº†ã€‚ æ­¥éª¤æ˜¯ï¼š æ‰“å¼€ QQ &gt; Cmd + , è¿›å…¥è®¾ç½® &gt; Function &gt; ç‚¹ Capture &amp; Record Screen å³è¾¹çš„ Preferencesï¼Œè¿™æ—¶æ˜¾ç¤ºä¸‹é¢çš„è®¾ç½®ç•Œé¢ï¼š è®¾ç½®å¥½ä½ æƒ³è¦çš„æˆªå±å¿«æ·é”®å’Œå½•å±å¿«æ·é”®ï¼Œå¹¶ç¡®ä¿Runs in background after you quit QQ å‹¾é€‰ä¸Šäº†ã€‚ åœ¨ Applications çš„ QQ.app ä¸Šå³é”®å†ç‚¹ Show Package Contentsï¼Œç„¶åæŒ‰å¦‚ä¸‹è·¯å¾„æ‰¾åˆ° QQ jietu plugin.appï¼Œæœ€åå°†å®ƒæ‹–è¿› Login Items å³å¯ï¼š è‡³æ­¤ï¼ŒæŒ‰ä¸‹ä¹‹å‰è®¾ç½®çš„æˆªå›¾å¿«æ·é”®ï¼Œä¼šå‡ºç° Screenshotï¼ŒScreen Recording å’Œ Recognition ä¸‰ä¸ªé€‰é¡¹ï¼Œåˆ†åˆ«æ˜¯æˆªå±ã€å½•å±ã€è¯†åˆ«å›¾ç‰‡ä¸­çš„æ–‡æœ¬ï¼ŒåŠŸèƒ½è¿˜ç®—å¤Ÿç”¨çš„ã€‚ Finderå…³äº Finderï¼Œæœ‰ä¸€ä¸‹å‡ ç‚¹å»ºè®®ï¼š åœ¨ Finder çš„è®¾ç½®ä¸­ï¼Œå°† New Finder windows show æ”¹ä¸ºä½¿ç”¨é¢‘ç‡æœ€é«˜çš„ç›®å½•ï¼Œæ¯”å¦‚ Download æˆ–ä¸ªäººå·¥ä½œç›®å½•ï¼š åœ¨ Finder çš„è®¾ç½®ä¸­ï¼Œå°†æœç´¢è®¾ç½®ä¸ºæœç´¢å½“å‰ç›®å½• (é»˜è®¤å±…ç„¶æ˜¯æœç´¢æ•´ä¸ª Mac ğŸ˜¢)ï¼š åœ¨æµè§ˆç›®å½•æˆ–æ–‡ä»¶æ—¶ï¼Œå»ºè®®ç”¨ä¸‹é¢çš„è§†å›¾ å»ºè®®å¤šä½¿ç”¨ Tab æ ‡ç­¾é¡µï¼Œè€Œä¸æ˜¯æ‰“å¼€æ–°çš„ Finder çª—å£ã€‚ å¯¹ç¨‹åºå‘˜ä»¥ä¸‹æ˜¯é¢å‘ç¨‹åºå‘˜çš„å†…å®¹ï¼Œéæˆ˜æ–—äººå‘˜è¯·é€Ÿé€Ÿæ’¤é€€ã€‚ Terminalç½‘ä¸Šå¾ˆå¤šæ–‡ç« ä¸€ä¸Šæ¥å°±æ˜¯ iTerm2ï¼Œä¸è¿‡æˆ‘å€’æ˜¯è§‰å¾— macOS è‡ªå¸¦çš„ Terminal å·²ç»å¤Ÿå¼ºå¤§äº†ï¼Œå¹¶ä¸”å­—ä½“æ›´å¥½çœ‹ç‚¹ï¼Œå†è¯´æœ¬ç€èƒ½ç”¨ç³»ç»Ÿè‡ªå¸¦å°±ä¸ç”¨ç¬¬ä¸‰æ–¹ï¼Œæˆ‘å°±ä¸€ç›´é»˜è®¤ä½¿ç”¨ Terminalã€‚ macOS ä¸Š Terminal çª—å£é»˜è®¤å¤ªå°äº†ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å…¶è®¾ç½® &gt; Profiles &gt; Window &gt; Window Size ä¸­è®¾ç½®æ›´å¤§çš„è¡Œåˆ—æ•°ï¼Œä»è€Œå……åˆ†åˆ©ç”¨æˆ‘ä»¬çš„å±å¹•ï¼Œçœå»æ‹–æ‹½çª—å£è¾¹ç¼˜çš„è¡Œä¸ºã€‚ å¦‚æœæ—¶å¸¸ä½¿ç”¨ Terminalï¼Œä»¥ä¸‹å¿«æ·é”®æ˜¯éå¸¸ Life Saving çš„ï¼š å¿«æ·é”® ä½œç”¨ Ctrl + U æ¸…é™¤å·²è¾“å…¥çš„å†…å®¹ Ctrl + A å…‰æ ‡ç§»åŠ¨åˆ°è¡Œé¦– Ctrl + E å…‰æ ‡ç§»åŠ¨åˆ°è¡Œæœ« Ctrl + K åˆ é™¤å…‰æ ‡ä¹‹åçš„å†…å®¹ ç»†å¿ƒçš„è¯»è€…å¯èƒ½ä¼šå‘ç°ä¸Šé¢å¿«æ·é”®éƒ½æ˜¯ä½¿ç”¨åäººç±»çš„ Ctrl è€Œä¸æ˜¯ Mac ä¸Šçš„ Cmdï¼Œå…¶å®ä¸Šé¢çš„å¿«æ·é”®å†å²éå¸¸æ‚ ä¹… (é‚£æ—¶å¯èƒ½è¿˜æ²¡æœ‰è‹¹æœå…¬å¸)ï¼Œæ˜¯ä»æ—©æœŸ Unix ç³»ç»Ÿæµä¼ ä¸‹æ¥ï¼Œæ‰€ä»¥åŒæ ·é€‚ç”¨äº Linux (å¯èƒ½ä¼šæœ‰ç»†å¾®å·®åˆ«)ã€‚å¦å¤–ï¼Œä¹‹å‰ã€Œå…‰æ ‡è¦å¿«ã€è®²çš„æŒ‰ä½ Option æ—¶æŒ‰å·¦å³æ–¹å‘é”®æ¥å¿«é€Ÿç§»åŠ¨å…‰æ ‡ï¼Œåœ¨æ­¤åŒæ ·é€‚ç”¨ã€‚ é¡ºå¸¦è¯´ä¸‹å¯èƒ½å¤§å®¶ä¸çŸ¥é“çš„ä¸¤ä¸ªéå¸¸æœ‰ç”¨çš„å‘½ä»¤ï¼Œfile å’Œ typeã€‚å‰è€…å¯æ ¹æ®æ–‡ä»¶ meta data åˆ¤æ–­æ–‡ä»¶ç±»å‹ï¼Œåè€…å¯å‘ŠçŸ¥ä½ ä¸€ä¸ªå‘½ä»¤æ˜¯ä»¥ä¸‹æ¥æºä¸­çš„å“ªä¸€ç§ï¼šå†…å»ºå‘½ä»¤ (æ¯”å¦‚ type, cd ç­‰)ã€æŒ‡å®šè·¯å¾„ä¸‹çš„å¯æ‰§è¡Œæ–‡ä»¶ã€ç¬¦å·é“¾æ¥ã€‚å¦å¤–å¦‚æœç”µè„‘ä¸­ä¸å°å¿ƒæœ‰ä¸¤ä¸ªæŸå‘½ä»¤(æ¯”å¦‚ä¸¤ä¸ª python)ä¸”éƒ½åŠ å…¥äº† PATH ç¯å¢ƒå˜é‡ï¼Œtype xxx ä¼šæ˜¾ç¤ºå½“å‰ä½¿ç”¨çš„ xxx çš„è·¯å¾„ï¼Œè€Œ which -a xxx åˆ™æ˜¾ç¤ºæ‰€æœ‰å·²åŠ å…¥ PATH ç¯å¢ƒå˜é‡ çš„ xxxã€‚ Oh My ZshOh My Zsh æ˜¯ä¹…è´Ÿç››åçš„å¼€æºé¡¹ç›®ï¼Œå®ƒå‡ ä¹è®© macOS ä¸­ Zsh çš„ä¸Šæ‰‹éš¾åº¦å˜ä¸ºäº† 0ã€‚é¦–å…ˆå•°å—¦ä¸€ä¸‹ï¼ŒmacOS ä¸€ç›´ä½¿ç”¨ bash ä½œä¸ºé»˜è®¤ Shellï¼Œè¿™ä¹Ÿæ˜¯å¸¸è§ Linux å‘è¡Œç‰ˆçš„åšæ³•ã€‚ æˆ‘ä¸ªäººæœ€å–œæ¬¢ On My Zsh çš„ä¸€ä¸‹ç‰¹æ€§ï¼š æŒ‰å·²è¾“å…¥æ–‡æœ¬æœç´¢å†å²å‘½ä»¤ã€‚å¤§å®¶éƒ½çŸ¥é“ bash ä¸­æŒ‰å‘ä¸Šæ–¹å‘é”®å¯ä»¥ä¸€æ¡æ¡æ˜¾ç¤ºå†å²å‘½ä»¤ï¼Œè€Œ On My Zsh åˆ™å¯ä»¥æ¯”å¦‚è¾“å…¥ adb shell åæŒ‰å‘ä¸Šæ–¹å‘é”®ï¼Œæ˜¾ç¤ºçš„å…¨éƒ¨æ˜¯ adb shell å¼€å¤´çš„å†å²å‘½ä»¤ï¼Œè¿™è®©æˆ‘ä»¬æ›´å¿«æ‰¾åˆ°æƒ³è¦çš„å†å²å‘½ä»¤ã€‚ æ›´ç®€å•çš„ç›®å½•é€‰æ‹©ã€‚æ¯”å¦‚è¾“å…¥ ls åï¼ŒæŒ‰ tab é”®ï¼Œä¼šæ˜¾ç¤ºå½“å‰ç›®å½•æ‰€æœ‰ itemï¼Œç„¶åå¯ä»¥ç›´æ¥æŒ‰ä¸Šæ–¹å‘é”®é€‰ä¸­ item å†æŒ‰å›è½¦ç¡®è®¤ã€‚ å¦‚æœå½“å‰ç›®å½•åœ¨ Git é¡¹ç›®ä¸­ï¼Œä¼šæ˜¾ç¤ºå½“å‰åˆ†æ”¯ï¼Œä»¥åŠæ˜¯å¦æœ‰æœªæäº¤æ”¹åŠ¨çš„å°å‰å‰ã€‚ æ›´ä¸°å¯Œçš„é«˜äº®è‰²å’Œä¸»é¢˜å®šåˆ¶åŠŸèƒ½ã€‚ å¦‚æœä¸Šé¢æœ‰ä½ æƒ³è¦åŠŸèƒ½ï¼Œè¯·è‡ªè¡Œå®‰è£… ğŸ˜ HomebrewHomebrew æ˜¯åˆä¸€ä¸ªä¸Šä¸‡ star çš„å¼€æºé¡¹ç›®ï¼Œå¤§å®¶å¯èƒ½æ—©å°±çŸ¥é“äº†å®ƒï¼Œæ‰€ä»¥æˆ‘å°±åªç®€å•è¯´è¯´ã€‚ Homebrew è‡ªç§°æ˜¯ macOS ä¸Šç¼ºå¤±çš„åŒ…ç®¡ç†å™¨ï¼Œçš„ç¡®å¦‚æ­¤ï¼ŒLinux å‘è¡Œç‰ˆæœ‰å„ç§ç®¡ç†å‘½ä»¤è¡Œè½¯ä»¶åŒ…çš„åŒ…ç®¡ç†å™¨ï¼Œè€Œ macOS é»˜è®¤æ²¡æœ‰ã€‚ Homebrew çš„ core repo ä¸ºæ¯ä¸ªåŒ…ç»´æŠ¤ä¸€ä¸ª ruby è„šæœ¬æ–‡ä»¶ï¼Œæ”¹æ–‡ä»¶è®°å½•äº†è¿™ä¸ªåŒ…çš„ä¾èµ–ä¿¡æ¯ï¼Œç‰ˆæœ¬æ›´è¿­ä¿¡æ¯ï¼Œä»å“ªé‡Œè·å– binary åŒ…æˆ–è€…æºä»£ç ã€ç¼–è¯‘æ–¹æ³•ç­‰ç­‰ä¿¡æ¯ã€‚æœ‰äº†è¿™äº›ä¿¡æ¯ï¼ŒHomebrew å°±å¯ä»¥ç®¡ç†åŒ…çš„å®‰è£…(åŒ…æ‹¬ä¸‹è½½æºç ç¼–è¯‘çš„æ–¹å¼)ã€å‡çº§ã€å¸è½½ã€ä¾èµ–ä¸‹è½½ç­‰ï¼Œä¹Ÿå°±å®ç°äº†åŒ…ç®¡ç†å™¨çš„åŠŸèƒ½ã€‚è¿™ä¸ª core repo åœ¨æˆ‘ä»¬æœ¬åœ°ä¹Ÿæœ‰ä¸€ä»½ï¼ŒHomebrew çš„ updating å…¶å®æœ¬åœ°çš„ repo pull è¿œç¨‹çš„å˜åŒ–ï¼Œä¹Ÿå°±æ˜¯è¿™äº› ruby è„šæœ¬çš„å¢åˆ æ”¹ç»™ pull è¿‡æ¥ã€‚è½¯ä»¶åŒ…çš„åå­—æ˜¯å”¯ä¸€æ€§çš„ï¼Œå› è€Œä¸Šè¿° ruby è„šæœ¬ç›´æ¥ä»¥è½¯ä»¶åŒ…çš„åå­—å‘½åï¼Œä¹Ÿæ˜¯ä¸ä¼šé‡å¤çš„ã€‚ å€¼å¾—ä¸€æçš„æ˜¯ï¼ŒHomebrew æŠŠ core repo å’Œåé¢è®²åˆ°çš„ cask repo å«åš tapï¼Œè€Œ tap é‡Œé¢ç®¡ç†çš„ä¾èµ–åŒ…ï¼Œå«åš formulaï¼Œäº†è§£è¿™äº›æœ¯è¯­æœ‰åˆ©äºçœ‹æ‡‚ Homebrew çš„æç¤ºã€‚ Homebrew å®‰è£…è½¯ä»¶åŒ…ï¼Œé€šå¸¸æ˜¯åœ¨ /usr/local ç›®å½•ä¸­ä»¥è¯¥è½¯ä»¶åŒ…åå­—ä¸ºåå»ºç«‹ç›®å½•ï¼Œç„¶åå…¶ä¸­å†ä»¥ç‰ˆæœ¬å·ä¸ºåå»ºç«‹ç›®å½•ï¼Œç‰ˆæœ¬å·ç›®å½•ä¸­å«æœ‰è¯¥ç‰ˆæœ¬çš„æ‰€æœ‰æ–‡ä»¶ï¼Œä¸”å¾€å¾€æœ‰ä¸ª bin ç›®å½•æ¥åŒ…å«è½¯ä»¶åŒ…çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒHomebrew å¯ä»¥åŒäº‹ç»´æŠ¤å¤šä¸ªç‰ˆæœ¬ã€‚è€ŒçœŸæ­£åŠ å…¥åˆ° PATH ç¯å¢ƒå˜é‡çš„å…¶å®æ˜¯ /usr/local/bin ç›®å½•ã€‚Homebrew æ¯æ›´æ–°æˆ–å®‰è£…ä¸€ä¸ªè½¯ä»¶åŒ…ï¼Œ/usr/local/bin ä¸­éƒ½ä¼šæ›´æ–°æˆ–æ–°å»ºä¸€ä¸ªç¬¦å·é“¾æ¥ï¼Œæ¥æŒ‡å‘æ­¤è½¯ä»¶åŒ…æœ€æ–°çš„ç‰ˆæœ¬çš„çœŸæ­£å¯æ‰§è¡Œæ–‡ä»¶ã€‚ä»è€Œæˆ‘ä»¬æ‰§è¡Œæ­¤ç¬¦å·é“¾æ¥ï¼Œå°±å¯ä»¥è¿è¡Œæœ€æ–°çš„è½¯ä»¶åŒ…ã€‚ Homebrew ç®¡ç†çš„å‘½ä»¤è¡Œè½¯ä»¶ï¼Œå¾ˆå¤šæ˜¯ GNU å¼€æºè½¯ä»¶ï¼Œè¿™äº›è½¯ä»¶çš„åˆ†å‘åœ¨å›½å†…æœ‰ä¸å°‘é•œåƒï¼Œä»è€Œèƒ½åŠ å¿«æˆ‘ä»¬çš„ä¸‹è½½é€Ÿåº¦ã€‚ä¸ºæ­¤ï¼Œcore repo åœ¨å›½å†…ä¹Ÿæœ‰é•œåƒ (æ¯”å¦‚ä¸­å›½ç§‘å¤§çš„é•œåƒ)ï¼Œåªä¸è¿‡è¿™ä¸ªé•œåƒå¹¶éå’Œ Homebrew å®˜æ–¹çš„ repo å®Œå…¨ä¸€è‡´ï¼Œè€Œæ˜¯ä¸‹è½½é“¾æ¥æŒ‡å‘å›½å†…çš„ä¸€äº›è½¯ä»¶æºé•œåƒï¼Œä¹Ÿåªæœ‰è¿™æ ·æ‰èƒ½çœŸæ­£åŠ å¿«ä¸‹è½½è½¯ä»¶åŒ…çš„é€Ÿåº¦ã€‚ æ­¤å¤–ï¼ŒHomebrew ä¹Ÿæ”¯æŒä¸€äº› GUI è½¯ä»¶ (å¦‚ Google Chrome å’Œ Sublime Text ç­‰) çš„ç®¡ç†ã€‚GUI è½¯ä»¶çš„ç®¡ç†ï¼Œæ˜¯ç”± cask repo æ¥æ”¯æ’‘çš„ã€‚ä½¿ç”¨ Homebrew å®‰è£… GUI è½¯ä»¶ï¼Œé€šå¸¸ä¹Ÿä¼šåœ¨ /usr/local/bin ä¸­æ–°å»ºç¬¦å·é“¾æ¥æ¥ï¼Œä½¿æˆ‘ä»¬å¯ä»¥åœ¨ Shell ä¸­å¯åŠ¨ GUI è½¯ä»¶ã€‚æ¯”å¦‚ Sublime Text å®‰è£…å¥½åï¼Œå°±ä¼šæœ‰ subl è¿™ä¸ªç¬¦å·é“¾æ¥ï¼š æˆ‘ä»¬ç›´æ¥æ‰§è¡Œ subl å³å¯æ‰“å¼€ Sublime Textï¼Œè€Œ subl åŠ ä¸Šæ–‡ä»¶åï¼Œè¿˜å¯æ‰“å¼€æŒ‡å®šæ–‡ä»¶ã€‚ æ­£åˆ™è¡¨è¾¾å¼æ­£åˆ™è¡¨è¾¾å¼åœ¨æˆ‘ä»¬æœç´¢ã€æ›¿æ¢ç»“æ„å¤æ‚çš„æ–‡æœ¬æ—¶éå¸¸æœ‰ç”¨ã€‚è¿‡å»ï¼Œç¨‹åºå‘˜åªèƒ½ç”¨ grep å’Œ sed å‘½ä»¤æ¥ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æŸ¥æ‰¾ã€æ›¿æ¢æ–‡æœ¬ï¼Œè€Œç°åœ¨ï¼Œè®¸å¤š IDE å’Œæ–‡æœ¬ç¼–è¾‘å™¨éƒ½æ”¯æŒåœ¨æŸ¥æ‰¾å’Œæ›¿æ¢æ—¶ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼ã€‚ æœ€åçš„æœ€åæ•ˆç‡ï¼Œåœ¨æ—¥å¸¸ç”Ÿæ´»ä¸­æ˜¯æŒ‡åŒæ ·æ—¶é—´å†…å®Œæˆå·¥ä½œçš„å¤šå°‘ã€‚è¿½æ±‚æ•ˆç‡æ˜¯æ— å¯åšéçš„ï¼Œç„¶è€Œå¤„åœ¨è¿™æ ·ä¸€ä¸ªå¿«èŠ‚å¥çš„ç°ä»£ç¤¾ä¼šä¸­ï¼Œæœ‰æ—¶å€™æˆ‘ä»¬ä¹Ÿéœ€è¦æ…¢ä¸‹æ¥ï¼Œæ‚ ç„¶å’Œç¼“çš„æ“æŒæˆ‘ä»¬çš„ç”µè„‘ï¼Œäº«å—ä»»åŠ¡å®Œæˆåçš„ä¸€åˆ»å®é™ï¼Œä¸ç„¶åˆ«äººä»¥ä¸ºäº¤ç»™æˆ‘ä»¬çš„ä»»åŠ¡å¤ªç®€å•äº†ã€‚","categories":[],"tags":[{"name":"macOS","slug":"macOS","permalink":"https://tao93.top/tags/macOS/"}]},{"title":"ç»™ä¸‰æ˜Ÿ tablet SM-T830 åˆ·æœº","slug":"Flash stock firmware in SM-T830","date":"2019-07-11T03:54:34.000Z","updated":"2019-07-11T03:54:34.000Z","comments":true,"path":"2019/07/10/Flash stock firmware in SM-T830/","link":"","permalink":"https://tao93.top/2019/07/10/Flash stock firmware in SM-T830/","excerpt":"","text":"èƒŒæ™¯å‰å¤©å…¬å¸å‘ç»™æˆ‘ä¸€éƒ¨ä¸‰æ˜Ÿ tablet ä½œä¸ºæµ‹è¯•æœºï¼Œæ˜¯ Tab S4 wifi ç‰ˆï¼Œå…·ä½“å‹å·æ˜¯ SM-T830ï¼Œè™½ç„¶ä¸æ˜¯æˆ‘æœŸå¾…çš„ Pixel 3 XLï¼Œä½†æ˜¯é…ç½®ä¹Ÿè¿˜ä¸é”™ï¼ŒåŠ ä¸Šå±å¹•ä¹Ÿæ¯”è¾ƒå¤§ã€‚ä½†æ˜¯å‘å°±å‘åœ¨ï¼Œè¿™æ˜¯ä¸€éƒ¨å›½è¡Œçš„æœºå™¨ï¼Œæ²¡æœ‰ Google Mobile Service (GMS) ä¸è¯´ï¼Œè¿˜å……æ–¥äº†ä¸å°‘å›½å†…ç”Ÿæ€çš„æ‚ç‰©ï¼Œæ¯”å¦‚ç³»ç»Ÿè®¾ç½®ä¸­çš„ device storage ç•Œé¢ï¼Œå±…ç„¶å†™ç€ã€Œpowered by 360ã€ï¼Œè¿˜æœ‰ä¸€äº›é¢„è£…çš„å›½å†…åº”ç”¨ã€‚ è¿™æ—¶æ‘†åœ¨æˆ‘å‰é¢çš„æœ‰ä¸‰ç§æ–¹æ³•ï¼šç¬¬ä¸€ï¼Œåˆ·æœºåˆ·å…¥ä¸€ä¸ªåŸç”Ÿ Android ç³»ç»Ÿï¼Œè¿™å½“ç„¶æ˜¯æœ€å®Œç¾çš„ï¼›ç¬¬äºŒï¼Œæ‰¾ä¸€ä¸ªä¸‰æ˜Ÿå®˜æ–¹çš„ä½†æ˜¯æ˜¯å›½å¤–ç‰ˆçš„ç³»ç»Ÿåˆ·å…¥ï¼Œè¿™ç§ç³»ç»Ÿä¼šæœ‰ GMSï¼›ç¬¬ä¸‰ï¼Œè‡ªå·±æŠŠç¡®å®çš„ Google æœåŠ¡å®‰è£…ä¸Šå»ï¼Œå‡‘æ´»ç€ç”¨ã€‚ ä»¥ä¸Šç¬¬ä¸€ç§æ–¹æ³•ï¼Œæˆ‘åœ¨ç½‘ä¸ŠæŸ¥äº†æŸ¥ï¼Œå‡ ä¹ä¸å¯èƒ½ï¼Œå› ä¸ºè¿™ä¸ª æœºå‹æ¯”è¾ƒå°ä¼—ï¼Œç½‘ä¸Šæ ¹æœ¬æ²¡æœ‰ç»™å®ƒåˆ·åŸç”Ÿç³»ç»Ÿçš„æ–¹æ³•ï¼Œå°±è¿ LineageOS ä¹Ÿæ²¡æœ‰æ”¯æŒè¿™ä¸ªæœºå‹ã€‚ç¬¬äºŒç§æ–¹æ³•ï¼Œæ˜¯æ¯”è¾ƒå¯è¡Œçš„ï¼Œè¿™æ¬¾ tablet å³ä½¿å°ä¼—ï¼Œä¹Ÿæ˜¯åœ¨å…¨çƒé”€å”®çš„ï¼Œå›½å¤–ç»å¤§éƒ¨åˆ†åœ°åŒºé”€å”®çš„éƒ½æ˜¯å¸¦æœ‰ GMS çš„ï¼Œæ­¤å¤–è¿™æ˜¯ä¸ª WiFi ç‰ˆæœºå‹ï¼Œä¹Ÿä¸ç”¨æ‹…å¿ƒè¿è¥å•†å’Œç½‘ç»œåˆ¶å¼çš„é—®é¢˜ï¼Œæ‰€ä»¥åˆ·æˆåŠŸçš„è¯ï¼Œè™½ä¸æ˜¯åŸç”Ÿ Androidï¼Œä½†ä¹Ÿæœ‰å®Œæ•´å¯é çš„ GMS å…¨ä»¶å¥—ã€‚ç¬¬ä¸‰ç§æ–¹æ³•ï¼Œæ”¹åŠ¨æœ€å°ï¼Œä½†æ˜¯ä¹Ÿå¯èƒ½æœ‰åé—ç—‡ï¼Œå› ä¸ºè¿™æ ·è‡ªè¡Œè¡¥å……å®‰è£… Google service çš„æ–¹å¼æœ‰å¯èƒ½æ˜¯ä¸å®Œå¤‡å¯é çš„ï¼ŒæŒ‡ä¸å®šå•¥æ—¶å€™å°±å‡ºç‚¹ bugã€‚ æ‰€ä»¥æˆ‘å°±å¼€å§‹å®æ–½ç¬¬äºŒç§æ–¹æ³•ï¼šåˆ·å…¥ä¸‰æ˜Ÿå®˜æ–¹å›ºä»¶çš„å›½å¤–ç‰ˆæœ¬ï¼Œæœ€åè¿™ä»¶äº‹æŠ˜è…¾äº†æˆ‘ä¸€å¤©å¤šã€‚ ä¸‹è½½ (é”™è¯¯çš„) å›ºä»¶åŒ…é¦–å…ˆæ˜¯è·å–å›ºä»¶åŒ…ï¼Œåœ¨ç½‘ä¸Šæ‰¾äº†ä¸€é€šï¼Œæ‰¾åˆ°äº† xda ä¸Šçš„è¿™ä¸ªå¸–å­ï¼Œé‡Œé¢è´´å‡ºäº†å­˜æ”¾åœ¨ Google drive çš„é€‚ç”¨äº SM-T830 çš„ä¸¤ä¸ªå®˜æ–¹å›ºä»¶çš„é“¾æ¥ï¼Œä¸€ä¸ªæ˜¯æ³•å›½ç‰ˆï¼Œå¦ä¸€ä¸ªæ˜¯é˜¿æ‹‰ä¼¯è”åˆé…‹é•¿å›½ç‰ˆã€‚å¸–å­çš„ä½œè€…è¿˜è¯´ï¼Œä»–å¯¹åˆ·æœºå¯èƒ½å‡ºç°çš„åæœä¸è´Ÿä»»ä½•è´£ä»»ï¼Œæä¾›è¿™ä¸¤ä¸ªåŒ…åªæ˜¯è®©å¤§å®¶å…æ”¶ä¸€äº›ç½‘ç«™è¦æ”¶è´¹æ‰èƒ½ä¸‹è½½å›ºä»¶åŒ…æˆ–è€…æ˜¯ä»˜è´¹æ‰èƒ½æé€Ÿä¸‹è½½çš„æ¶å¿ƒã€‚è¯è¯´ï¼ŒSM-T830 çš„å°ä¼—ï¼Œä»æˆ‘æœé xda ä¹Ÿæ²¡æ‰¾åˆ°å‡ ä¸ªå’Œå®ƒç›¸å…³çš„å¸–å­å³å¯ç•¥è§ä¸€æ–‘ã€‚ å›ºä»¶åŒ…å¤§å°çº¦æ˜¯ 3.6 GBï¼Œèµ·å…ˆæˆ‘ä»æµè§ˆå™¨ç›´æ¥ä¸‹è½½ Google drive ä¸Šçš„å›ºä»¶åŒ…ï¼Œç½‘é€Ÿå¾ˆæ…¢åªæœ‰ 100KB/S çš„æ ·å­ï¼Œä¸‹äº†æŒºä¹…æœ€åéƒ½å¤±è´¥äº†ã€‚åé¢æˆ‘å‘ç°ï¼Œå…ˆæŠŠå›ºä»¶æ·»åŠ åˆ°æˆ‘è‡ªå·±çš„ Google drive ç©ºé—´ï¼Œç„¶ååœ¨æ‰‹æœºä¸Šçš„ Google drive åº”ç”¨ä¸­ä¸‹è½½ï¼Œé…åˆå…¬å¸çš„ç½‘ç»œç¯å¢ƒï¼Œé€Ÿåº¦å¯ä»¥å¾ˆå¿«ï¼Œå·®ä¸å¤šåŠä¸ªå°æ—¶å°±ä¸‹è½½å¥½äº†ã€‚ ä¼å›¾ç”¨è™šæ‹Ÿæœºï¼Œå¤±è´¥ä¸‰æ˜Ÿçš„å†…éƒ¨åˆ·æœºå·¥å…· odinï¼Œåªèƒ½ç”¨ Windows è¿è¡Œï¼Œæˆ‘æ‰‹é‡Œåªæœ‰ Macï¼Œæ‰€ä»¥æˆ‘ä¸€å¼€å§‹å¸Œæœ›ç”¨ virtual box ä¸­çš„ win10 è™šæ‹Ÿæœºæ¥æ“ä½œã€‚æˆ‘ä»ç¡¬ç›˜é‡Œé¢æŠŠå¾ˆä¹…å‰å¤‡ä»½çš„ win10 çš„ virtual disk image (ä¹Ÿå°±æ˜¯ä¸€ä¸ª .vdi æ–‡ä»¶) æ‹·è´åˆ°ç”µè„‘ï¼Œç„¶åä»¥æ­¤æ–°å»ºä¸€ä¸ªè™šæ‹Ÿæœºï¼ŒæˆåŠŸçš„è¿è¡Œï¼Œä½†æ˜¯é¼“æ£äº†åŠå¤©ï¼Œä¹Ÿæ— æ³•è®©è¿™ä¸ªè™šæ‹Ÿæœºè¿æ¥ USB è®¾å¤‡ï¼Œåˆ«è¯´è¿™å° tablet ä¸è¡Œï¼Œè¿ U ç›˜éƒ½ä¸è¡Œã€‚VirtualBox VM Extension Pack å®‰è£…äº†ï¼Œåœ¨ win10 é‡Œé¢ä¹Ÿå®‰è£…äº† Guest Additionsï¼ŒUSB device filters ä¹Ÿé…ç½®äº†ï¼Œå°±æ˜¯ä¸è¡Œï¼Œåªèƒ½æ”¾å¼ƒï¼Œæ‰¾åŒäº‹å€Ÿç”¨ Windows å°å¼æœºã€‚ 2019å¹´1æœˆ1æ—¥æ›´æ–°ï¼šæˆ‘åé¢ VirtualBox è£… Windows è™šæ‹Ÿæœºæ˜¯å¯ä»¥è¿æ¥åˆ° Android è®¾å¤‡çš„ï¼Œå¹¶ä¸”å¯ä»¥åˆ·æœºï¼Œè§ç»™ä¸‰æ˜Ÿ tablet SM-T830 åˆ·æœº[ç»­] çš„æœ€åä¸€éƒ¨åˆ† å¤±è´¥çš„åˆ·æœºåœ¨åŒäº‹çš„å°å¼æœºä¸Šæ“ä½œä¹‹å‰ï¼Œæˆ‘åœ¨ç½‘ä¸Šå·²ç»çœ‹äº†ä¸€æ®µè®²è§£åˆ·æœºè¿‡ç¨‹çš„è§†é¢‘ï¼Œæ„Ÿè§‰æŒºç®€å•çš„ï¼Œå°±å‡ ä¸ªæ­¥éª¤è€Œå·²ã€‚ç­‰åˆ°å¼€å§‹åœ¨ Windows ä¸Šé¢å¼€å§‹å¼„ï¼Œæˆ‘æŠŠå›ºä»¶åŒ…è§£å‹ï¼Œç„¶åç”¨ odin å¼€å§‹ï¼Œè¿™æ‰å‘ç°é‚£ä¸ªè§†é¢‘å…¶å®è¿‡æ—¶äº†ï¼Œè§†é¢‘ä¸­å›ºä»¶åŒ…è§£å‹ååªæœ‰ä¸€ä¸ªæ–‡ä»¶ï¼Œä½†æ˜¯æˆ‘è§£å‹åå…¶å®æœ‰ 4 ä¸ªæ–‡ä»¶ã€‚å…¶å®è¿™ä¸€ç‚¹ Odin ä¸­éƒ½å·²ç»æç¤ºäº†ï¼Œnew model éœ€è¦ 4 ä¸ªæ–‡ä»¶ï¼š æ‰€ä»¥æˆ‘çš„å›ºä»¶åŒ…æ˜¯æ¯”è¾ƒæ–°çš„ï¼Œæ‰€ä»¥æœ‰å¤šä¸ªæ–‡ä»¶ï¼Œä½†æ˜¯ä»”ç»†å¯¹æ¯”å‘ç°æœ‰ç‚¹é—®é¢˜ï¼Œodin éœ€è¦çš„æ˜¯ BL, AP, CP, HOME_CSC 4 éƒ¨åˆ†ï¼Œä½†æ˜¯æˆ‘çš„å›ºä»¶åŒ…è§£å‹å 4 ä¸ªæ–‡ä»¶çš„æ–‡ä»¶åæ˜¯å¦‚ä¸‹æ‰€ç¤º (æ–‡ä»¶æˆ‘å·²ç»åˆ æ‰äº†ï¼Œæ‰€ä»¥æ²¡æ³•è´´å‡ºå®Œæ•´æ–‡ä»¶å)ï¼š BLâ€¦APâ€¦CSCâ€¦HOME_CSCâ€¦ ç›¸å½“äºæ²¡æœ‰ CP å¼€å¤´çš„ï¼Œåè€Œä¼¼ä¹æœ‰ä¸¤ä¸ª CSC çš„ï¼Œè¿™æ—¶æˆ‘ä¹Ÿæ²¡å¤ºå¤šç®¡ï¼Œä¾æ¬¡ç‚¹å‡» odin ä¸­çš„ BL, AP, CP, CSC å››ä¸ªå®‰è£…ï¼Œç„¶åæŠŠ 4 ä¸ªæ–‡ä»¶éƒ½æ·»åŠ è¿›å»ï¼Œç„¶åå°±ç‚¹ start äº†ï¼Œç„¶åå°±å¤±è´¥äº†ã€‚äºæ˜¯æˆ‘æŠŠ CP å’Œ CSC éœ€è¦çš„æ–‡ä»¶è°ƒæ¢äº†ä¸€ä¸‹ï¼Œè¿˜æ˜¯å¤±è´¥ã€‚ è¿™æ—¶å€™æˆ‘å°±æŸ¥äº†ä¸€ä¸‹ä¸ºå•¥å°‘äº† CP å¼€å¤´çš„æ–‡ä»¶ï¼Œè¿™æ‰å‘ç°ï¼ŒåŸæ¥ WiFi ç‰ˆå°±æ˜¯æ²¡æœ‰ CP æ–‡ä»¶ï¼Œè¿™æ˜¯å’ŒåŸºå¸¦ç›¸å…³çš„ï¼Œåªæœ‰å¯æ’å¡ä¸Šç½‘çš„ç‰ˆæœ¬æ‰æœ‰ã€‚é¡ºä¾¿ä¹Ÿå‘ç°äº†æˆ‘çš„ CSCâ€¦ å’Œ HOME_CSCâ€¦ ä¸¤ä¸ªæ–‡ä»¶çš„åŒºåˆ«ï¼Œæ®è¯´å‰è€…æ˜¯å½»åº•æ¸…ç©ºæ•°æ®ï¼Œåè€…ä¼šä¿ç•™ç”¨æˆ·æ•°æ®ï¼Œæ‰€ä»¥è¿™ä¸¤ä¸ªæ–‡ä»¶å…¶å®ä½œç”¨æ˜¯ç±»ä¼¼çš„ï¼Œå…¶å®æˆ‘ä¹Ÿæ³¨æ„åˆ°å®ƒä»¬å¤§å°ä¹Ÿéå¸¸ç›¸è¿‘ï¼Œéƒ½æ˜¯ 180MB å·¦å³ã€‚ äºæ˜¯æˆ‘å°±ç©ºå‡º CP é‚£é‡Œä¸æ·»åŠ æ–‡ä»¶ï¼Œå…¶ä½™ 3 ä¸ªæ·»åŠ ä¸Šï¼Œç„¶å startï¼Œç»“æœå·¦è¾¹æ–‡æœ¬æ¡†åœç•™åœ¨ â€˜setupconnection..â€™ï¼Œæˆ‘ä¸€æŸ¥ï¼Œå‘ç°å¾ˆå¤šè¯´å¡åœ¨è¿™ä¸€æ­¥çš„ï¼Œçº·çº·åœ¨æ±‚ helpã€‚æ²¡åŠæ³•æˆ‘å°±åªèƒ½ç»§ç»­æŸ¥ï¼Œæœ‰è¯´è¦å…ˆè¿è¡Œ odin åè¿æ¥ USB æ•°æ®çº¿çš„(è¯•äº†ä¸è¡Œ)ã€‚æŸ¥äº†ä¸€é˜µï¼Œç»ˆäºæŸ¥åˆ°ä¸€ä¸ªçœ‹èµ·æ¥æ¯”è¾ƒé è°±çš„æ–¹æ³•ï¼Œä¾ç„¶æ˜¯ xda è®ºå›ä¸Šçš„ï¼š æˆ‘æŒ‰ç…§ä¸Šé¢è¯´çš„ä¸€æ­¥ä¸€æ­¥èµ°ï¼Œä¾ç„¶å¤±è´¥ï¼Œä½†æ˜¯æ²¡å†å¡åœ¨ setupconnection äº†ã€‚æˆ‘æ€»ç»“å‘ç°ï¼Œodin åº”è¯¥ç¡®å®æœ‰ bugï¼Œæ˜æ˜è®¾å¤‡è¿æ¥æ­£å¸¸ï¼Œå®ƒå°±æ˜¯å¡åœ¨è¿™ä¸€æ­¥ï¼Œè¿™æ—¶å€™å¯ä»¥è¿™ä¹ˆåšï¼š1. é‡æ–°å¯åŠ¨è®¾å¤‡ï¼Œ1. æ–­å¼€ USB è¿æ¥ï¼Œ3. è¿›å…¥ downloading modeï¼Œ4. è¿æ¥ USB ç„¶åå†åœ¨ odin ä¸­ startï¼Œå°±ä¸ä¼šå¡åœ¨é‚£ä¸€æ­¥äº†ã€‚ è¿›å…¥ Download æ¨¡å¼çš„æ–¹æ³•ï¼šå…ˆå…³æœºï¼Œç„¶ååŒæ—¶æŒ‰ä½ Volumn Up å’Œ Power é”®ï¼Œç­‰å±å¹•äº®åç«‹å³æ¾æ‰‹ï¼Œæ­¤æ—¶ä¼šè¿›å…¥ Recovery mode (ä¸‰æ˜Ÿè‡ªå·±çš„ recovery æˆ–è€…ç¬¬ä¸‰æ–¹ recovery æ¯”å¦‚ TWRP)ã€‚å¦‚æœæ˜¯ä¸‰æ˜Ÿçš„ recoveryï¼Œé€‰æ‹© boot to bootloader å³å¯ï¼Œå¦‚æœæ˜¯ TWRPï¼Œé€‰æ‹©è¿›å…¥ Download æ¨¡å¼å³å¯ã€‚ å›åˆ°åˆšåˆšè¯´çš„ï¼Œè™½ç„¶æ²¡å¡åœ¨ setupconnection äº†ï¼Œä½†æ˜¯ä¾ç„¶å¤±è´¥ï¼Œæç¤ºå¤§æ¦‚æ˜¯ï¼š abl.elf FAIL! (Auth) Complete(Write) operation failed. All threads completed. (succeed 0 / failed 1) ä»¥ abl.elf ä¸ºå…³é”®å­—åˆæ˜¯ä¸€ç•ªåœ¨ç½‘ä¸Šæœç´¢ï¼Œæœ€åå‘ç°è¿™ä¸ªå¸–å­æœ‰äººé‡åˆ°è¿™ä¸ªé—®é¢˜æœ€åè§£å†³äº†ï¼š èµ·åˆæˆ‘å¯¹ã€Œå›ºä»¶ç‰ˆæœ¬è½åäºç°æœ‰ç‰ˆæœ¬ã€è¿™å¥è¯ä¸ä»¥ä¸ºç„¶ï¼Œå› ä¸ºæˆ‘è§‰å¾—è¿™ä¸å°±æ„å‘³ç€åªèƒ½å‡çº§ä¸èƒ½é™çº§å˜›ï¼Œä¸ç§‘å­¦ã€‚ä½†åé¢æˆ‘å¿½ç„¶æƒ³åˆ°ï¼Œè¿™å¥è¯æ„æ€å¯èƒ½æ˜¯åˆ·æœºä¸èƒ½åˆ·é‚£äº›ç‰ˆæœ¬æ¯”è®¾å¤‡å‡ºå‚æ—¶ç³»ç»Ÿç‰ˆæœ¬è¿˜æ›´æ—§çš„å›ºä»¶ï¼Œå°±ä¸Šè¿™ä¸ªäººç¡®å®è§£å†³äº†é—®é¢˜ï¼Œå¹¶ä¸”æˆ‘å‰é¢ä¸‹çš„å›ºä»¶åŒ…éƒ½æ˜¯ 2018 å¹´ 8 æœˆä»½çš„ï¼Œç¡®å®æœ‰ç‚¹æ—§ï¼Œæ‰€ä»¥æˆ‘å¼€å§‹æƒ³æ€ä¹ˆä¸‹æœ€æ–°çš„ç”¨äº SM-T830 çš„å›ºä»¶ã€‚ ä¸‹è½½æœ€æ–°çš„å›ºä»¶åŒ…è¿™æ—¶ï¼Œå°±åˆå›åˆ°å¼€å§‹æ‰¾å›ºä»¶åŒ…çš„æ­¥éª¤äº†ï¼Œç½‘ä¸Šæ»¡æ˜¯å‡é“¾æ¥ï¼Œæˆ–è€…æ˜¯è¦æ³¨å†Œï¼Œè¦äº¤è´¹çš„ï¼Œæ‰¾å¾—äººå¿ƒç´¯ã€‚ä¸è¿‡ï¼Œæœ€åç«Ÿç„¶æ‰¾åˆ°ä¸€ä¸ªå« SamFirm tool çš„ç¥å™¨ï¼Œè¿™ä¸ªç¥å™¨å¯ä»¥ç›´æ¥é«˜é€Ÿä¸‹è½½æƒ³è¦çš„æœ€æ–°å›ºä»¶ï¼Œç®€ç›´ä¸èƒ½æ›´æ£’ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œè¾“å…¥ç³»ç»Ÿå‹å·ï¼Œç„¶åé€‰æ‹© auto æ¨¡å¼æ¥æŸ¥æ‰¾ï¼Œå°±èƒ½æ‰¾åˆ°æœ€æ–°çš„å›ºä»¶ï¼Œå¹¶ä¸”ä¸‹è½½é€Ÿåº¦è¿˜å¾ˆå¿«ï¼è¿™ä¸ªå¸–å­å¯ä»¥ä¸‹è½½åˆ°è¿™ä¸ªç¥å™¨ã€‚ å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œå‡†ç¡®åœ°å¡«å…¥å‹å·ï¼Œå¡«å…¥è¦ä¸‹è½½çš„å›ºä»¶çš„å›½å®¶æˆ–åœ°åŒºä»£å·ï¼ˆè¿™é‡Œæˆ‘è¦å¡«çš„å°±æ˜¯æŸä¸ªå¤–å›½æˆ–å›½å¤–åœ°åŒºï¼Œè¿™æ ·å›ºä»¶åŒ…æ‰ä¼šæœ‰ GMSï¼‰ã€‚è¿™ä¸ªå›½å®¶æˆ–åœ°åŒºä»£å·å¯ä»¥ä»è¿™é‡Œæ‰¾åˆ°ï¼Œæˆ‘åœ¨ä¸Šä¸€å¼ å›¾ä¸­å¡«å…¥çš„æ˜¯ XEFï¼Œå…¶å®å°±æ˜¯ä»£è¡¨æ³•å›½ã€‚å¡«å¥½åå‹¾é€‰ Autoï¼Œç„¶åç‚¹å‡» Check Updateï¼Œå³å¯æ£€æŸ¥åˆ°æœ€æ–°å›ºä»¶åŒ…çš„ä¿¡æ¯ï¼Œæˆ‘åœ¨ä»Šå¤©ï¼ˆ2018å¹´12æœˆ8æ—¥ï¼‰æ£€æŸ¥åˆ°çš„ SM-T830 çš„æ³•å›½ç‰ˆæœ€æ–°å›ºä»¶åŒ…å¦‚ä¸Šå›¾ç®­å¤´æ‰€ç¤ºï¼Œæ˜¯ 2018å¹´10æœˆ24æ—¥æ›´æ–°çš„ã€‚ç„¶åå°±å¯ä»¥åœ¨ SamFirm å³è¾¹ç‚¹ä¸‹è½½äº†ã€‚å»ºè®®å‹¾é€‰ Decrypt automaticallyï¼Œå¦åˆ™ ä¸‹è½½å¥½å›ºä»¶åŒ…åè¿˜éœ€è¦é‡æ–°è§£å¯†ï¼Œè´¹æ—¶é—´ã€‚ å›½å®¶æˆ–åœ°åŒºä»£å·æˆªå›¾ï¼š æˆåŠŸåˆ·æœºä¸‹è½½åˆ°æœ€æ–°å›ºä»¶åï¼Œè§£å‹ï¼Œç„¶åç”¨ odin ä¾æ¬¡å¡«å…¥ BL AP CSC ä¸‰ä¸ªåœ°æ–¹çš„æ–‡ä»¶ï¼Œç‚¹ startï¼Œç»§ç»­å¡åœ¨ setupconnectionï¼ŒæŒ‰ç…§æˆ‘ä¹‹å‰çš„æ€»ç»“è·³è¿‡è¿™ä¸ª setupconnectionï¼Œç„¶åçœŸæ­£å¼€å§‹åˆ·æœºï¼Œå¤§æ¦‚ 10 åˆ†é’Ÿä¸åˆ°å°±åˆ·å¥½äº†ã€‚ å†™åœ¨æœ€ååˆ·ä¸ªæœºé‡åˆ°çš„å‘è¿˜çœŸæ˜¯æŒºå¤šï¼ŒæŠŠè¿™äº›è®°å½•ä¸‹æ¥ï¼Œè¯´ä¸å®šä»¥åå…¬å¸çš„å›½è¡Œè®¾å¤‡éœ€è¦åˆ·æœºï¼Œè¿™äº›è®°å½•å°±èƒ½æ´¾ä¸Šç”¨åœºäº†ã€‚","categories":[],"tags":[{"name":"Android","slug":"Android","permalink":"https://tao93.top/tags/Android/"},{"name":"Firmware","slug":"Firmware","permalink":"https://tao93.top/tags/Firmware/"},{"name":"Samsung","slug":"Samsung","permalink":"https://tao93.top/tags/Samsung/"}]},{"title":"å†æ¬¡å°† hexo blog æ”¾ç½®åˆ° Github Pages","slug":"å†æ¬¡å°† hexo blog æ”¾ç½®åˆ° Github Pages","date":"2019-07-06T02:59:53.000Z","updated":"2019-10-10T23:35:18.419Z","comments":true,"path":"2019/07/05/å†æ¬¡å°† hexo blog æ”¾ç½®åˆ° Github Pages/","link":"","permalink":"https://tao93.top/2019/07/05/å†æ¬¡å°† hexo blog æ”¾ç½®åˆ° Github Pages/","excerpt":"","text":"æ’è¯ç”µè„‘æ¢äº†åï¼Œæˆ‘æŠŠ hexo blog æ•´ä¸ªç›®å½•æ‹·è´åˆ°æ–°ç”µè„‘ï¼Œç„¶åæ–°ç”µè„‘å®‰è£… nodeï¼Œå®‰è£… hexoï¼Œç”¨ npm å®‰è£…ä¸»é¢˜æ‰€éœ€çš„ä¾èµ–ï¼Œç„¶å generate å‡ºæ¥çš„ç½‘é¡µæ–‡ä»¶æ ·å¼æœ‰é—®é¢˜ï¼Œæœ€åå›é€€åˆ° node v10 æ‰è§£å†³ã€‚ä¼¼ä¹ node å¯¹å†å²ç‰ˆæœ¬çš„å…¼å®¹æ€§ä¸ä½³ï¼Œä¹Ÿå¯èƒ½æ˜¯ç”¨ npm å®‰è£…çš„ä¸€äº›ä¾èµ–æ²¡é€‚é…æœ€æ–°çš„ nodeï¼Œç¥å‘ï¼ ç¼˜èµ·ç§Ÿäº†ä¸€å¹´çš„é˜¿é‡Œäº‘ä½äºé¦™æ¸¯çš„ VPS åˆ°æœŸäº†ï¼Œä½†åˆ°æœŸä¸æ˜¯å…³é”®ï¼Œå…³é”®æ˜¯å¤§çº¦ä¸€ä¸ªå¤šæœˆå‰ï¼Œæˆ‘çš„ VPS å½»åº•è¢«å±è”½äº†ï¼Œåœ¨å›½å†… ping IP éƒ½å®Œå…¨ä¸é€šï¼Œåªæœ‰å¢ƒå¤–æ‰èƒ½æ­£å¸¸è®¿é—®ã€‚å‘é˜¿é‡Œäº‘åé¦ˆï¼Œå¯¹æ–¹å»ºè®®æˆ‘é‡æ–° deploy ä¸€ä¸ª VPSã€‚æˆ‘ä»¥ä¸ºé‡æ–° deploy ä¸€ä¸‹å¾ˆç®€å•ï¼Œç„¶è€Œäº‹å®æ˜¯é‡æ–° deploy éœ€è¦æˆ‘é‡æ–°ä¸‹è®¢å•ï¼Œç„¶åç”¨æ–°è®¢å•æ¥ deployï¼ŒåŸæœ‰è®¢å•å°±å½“åºŸäº†ã€‚è€Œé˜¿é‡Œäº‘åªæä¾›æ•°æ®å¤‡ä»½å’Œæ¢å¤æœåŠ¡ï¼Œç”¨äºå°†åŸ VPS çš„æ•°æ®è¿ç§»åˆ°æ–° VPSï¼Œå¹¶ä¸”è¿™é¡¹æœåŠ¡ä¹Ÿæ˜¯æ”¶è´¹çš„ã€‚è¿™æ˜¯åœ¨è®©äººå¿æ— å¯å¿ã€‚è¿˜å¥½åŸè®¢å•å½“æ—¶åªå‰©ä¸€ä¸ªå¤šæœˆï¼Œæ‰€ä»¥æˆ‘æ‰“å®šæ³¨æ„ä¸ç”¨é˜¿é‡Œäº‘äº†ã€‚ å¦å¤–æˆ‘ç®€å•è¯•äº†ä¸€ä¸‹ Vultr çš„æœåŠ¡ï¼Œå…ˆè¯•äº†ä¸ª $2.5/Mo çš„ï¼Œç»“æœå‘ç°åªæœ‰ IPv6 è€Œæ²¡æœ‰ IPv4ã€‚åé¢æˆ‘ç”³è¯·é€€æ¬¾ï¼Œé€€æ¬¾å€’æ˜¯å¾ˆè¿…é€Ÿï¼Œåªæ˜¯æ‰£æ‰äº†æˆ‘ä½™é¢çš„ä¸€éƒ¨åˆ†ï¼Œå·¥å•é‡Œé¢è¯¢é—®ï¼Œå¯¹æ–¹ä¹Ÿåªæ˜¯è¯´è¿™ä¸ªæ˜¯åè®®è§„å®šï¼Œæ—¢ç„¶æ‚¨å·²ä½¿ç”¨æˆ‘ä»¬çš„äº§å“ã€åŒæ„çš„åè®®ï¼Œé‚£ä¹ˆåªèƒ½è¯·æ‚¨è°…è§£ã€‚äºæ˜¯æˆ‘å¯¹ Vultr ä¹Ÿæ— å¥½æ„Ÿäº†ã€‚ åŠ ä¹‹å¬æˆ‘çš„åŒå­¦è®²èµ·äº†åˆ«çš„å¥½ä½¿çš„ç¿»å¢™æ–¹å¼ï¼Œäºæ˜¯ç”¨ VPS ç¿»å¢™çš„éœ€æ±‚ä¹Ÿæ²¡ä»€ä¹ˆäº†ï¼Œäºæ˜¯æˆ‘æƒ³åˆ°äº†ç”¨ Github Pages æ¥ host æˆ‘çš„ hexo blogã€‚ å‰å¥å¦‚æˆ‘åœ¨ åšå®¢ç³»ç»Ÿè¿ç§»è®°å½• ä¸­æ‰€è¯´ï¼Œæˆ‘ä½¿ç”¨è‡ªå·±å†™çš„ä¸€ä¸ª deploy.sh è„šæœ¬ï¼Œè¿™ä¸ªè„šæœ¬ä¼šå°†æˆ‘çš„ Markdown æ–‡ä»¶çš„æ”¹åŠ¨ push åˆ° VPS ä¸Šï¼ˆä»¥ä½œå¤‡ä»½ï¼Œé¿å…æœ¬åœ°ç”µè„‘æ•°æ®ä¸¢å¤±ï¼‰ï¼Œç„¶åè°ƒç”¨ hexo åœ¨ public ç›®å½•ç”Ÿæˆç½‘é¡µæ–‡ä»¶ï¼Œå¹¶ commit å† push åˆ° VPSï¼Œä»è€Œè®© blog ç½‘é¡µåˆ·æ–°ï¼Œæœ€åæˆ‘ blog ä¸­ç”¨åˆ°çš„å›¾ç‰‡ï¼Œæˆ‘éƒ½æ˜¯æ”¾ç½®åˆ° VPSï¼Œç„¶åè‡ªåŠ¨ç”Ÿæˆ image url å¹¶æ’å…¥åˆ° Markdown ä¸­çš„ï¼Œå› æ­¤ä¸ºé˜² VPS æ•°æ®ä¸¢å¤±ï¼Œè¿™ä¸ªè„šæœ¬è¿˜æŠŠ VPS ä¸­çš„å›¾ç‰‡ç›®å½• commitï¼Œç„¶ååœ¨æœ¬åœ°æŠŠå›¾ç‰‡ç›®å½• pull ä¸‹æ¥ã€‚è¿™æ ·ä¸€æ¥ï¼Œå›¾ç‰‡å’ŒåŸå§‹çš„ Markdown æ–‡ä»¶ï¼Œå°±éƒ½åœ¨æœ¬åœ°å’Œ VPS ä¸­éƒ½æœ‰å®Œæ•´å¤‡ä»½ï¼Œä¸€æ–¹æ•°æ®ä¸¢å¤±æ—¶ï¼Œå¦ä¸€æ–¹å¯ä»¥è¢«ç”¨æ¥æ¢å¤æ•°æ®ã€‚ å½“æ—¶èƒ½æœ‰è¿™ç§å¤‡ä»½æ€æƒ³ï¼Œä¹Ÿæ˜¯å› ä¸ºæ›¾ç›®ç¹ä¸€ä¸ªæœ‹å‹çš„äº‹æ•…ã€‚è¿™ä¸ªæœ‹å‹ä¹Ÿæ˜¯ç”¨ VPS æ¥ host hexo blogï¼Œè€Œ Markdown æ–‡ä»¶åªåœ¨æœ¬åœ°æœ‰ä¸€ä»½ï¼ŒæŸå¤©ä»–æœ¬åœ°æ•°æ®ä¸¢å¤±äº†ï¼Œæœ€åä»–ä¸å¾—ä¸å€ŸåŠ© VPS ä¸Šçš„ç½‘é¡µæ–‡ä»¶æ¥é‡å†™ Markdown æ–‡ä»¶ï¼Œè€Œä»–åˆæ˜¯ blog é«˜äº§ç”¨æˆ·ï¼Œå¯æƒ³è€ŒçŸ¥è¿™æ˜¯å¤šä¹ˆç¹çã€‚ è¿‡ç¨‹ä¹‹å‰æˆ‘æœ‰ 3 git repoï¼Œåˆ†åˆ«æ˜¯åŒ…å« Markdown æ–‡ä»¶çš„ sourceï¼ŒåŒ…å«ç”Ÿæˆçš„ç½‘é¡µæ–‡ä»¶çš„ publicï¼Œè¿˜æœ‰å°±æ˜¯ Imageã€‚å‰ä¸¤è€…éƒ½æ˜¯æˆ‘æœ¬åœ° commitï¼Œç„¶å push åˆ° VPSï¼Œæœ€åçš„ Image åˆ™æ˜¯ VPS ä¸Šä¸æ–­å¢åŠ æ–°å›¾ç‰‡ï¼Œç„¶å VPS ä¸Š commitï¼Œæœ¬åœ°å† pullã€‚ ç°åœ¨æ”¹ç”¨ Github Pages åï¼Œæˆ‘åªèƒ½æœ‰ä¸€ä¸ª repo (https://github.com/Tao93/Tao93.github.io)æ¥ host blog æ‰€éœ€è¦çš„ç½‘é¡µæ–‡ä»¶å’Œé‚£äº›å›¾ç‰‡ï¼Œæ‰€ä»¥æˆ‘å°±æŠŠ Image å…¨éƒ¨æ”¾è¿› public ä¸­äº†ï¼Œè¿™æ ·å°±å°‘äº† Image è¿™ä¸ª git repoã€‚å¦å¤–ï¼ŒGithub Pages æ˜¯ https çš„ï¼Œæ‰€ä»¥æˆ‘è¿˜éœ€è¦åœ¨ hexo config ä¸­æŠŠ http æ”¹ä¸º httpsã€‚ å¦å¤–ï¼Œä¸ºäº†å¤‡ä»½ Markdown æ–‡ä»¶ï¼Œæˆ‘å¦å¤–å¼€äº† https://github.com/Tao93/hexo-blog-post è¿™ä¸ª repo æ¥ä¿å­˜æˆ‘çš„ Markdown æ–‡ä»¶ã€‚ å¾€åï¼Œæˆ‘æ›´æ–° blog çš„æµç¨‹å°±æ˜¯ï¼šæœ¬åœ° source repo ä¸­æ–°å¢æˆ–ä¿®æ”¹ Markdown æ–‡ä»¶ï¼Œæ–‡ä»¶ä¸­éœ€è¦æ’å…¥å›¾ç‰‡æ—¶ï¼ŒæŠŠå›¾ç‰‡æ”¾å…¥ public/Images ä¸­æŒ‡å®šè·¯å¾„ï¼Œç„¶åä»¥æ­¤è·¯å¾„å¾—åˆ° image url å¹¶ä½¿ç”¨è¯¥ url æ¥æ’å…¥å›¾ç‰‡ï¼Œæœ€ååœ¨ source repo ä¸­ commitï¼›ç„¶å deploy.sh è„šæœ¬å…ˆå°† source repo push åˆ° https://github.com/Tao93/hexo-blog-postï¼Œç„¶åè°ƒç”¨ hexo åœ¨ public ä¸­ç”Ÿæˆç½‘é¡µæ–‡ä»¶ï¼Œæœ€åå°† public repo push åˆ° https://github.com/Tao93/Tao93.github.ioï¼Œè‡³æ­¤ blog ç½‘é¡µå°±æ›´æ–°äº†ã€‚ ä»ä¸Šé¢æ‰€è®²å¯çŸ¥ï¼ŒMarkdown æ–‡ä»¶å’Œ Image éƒ½æ˜¯ Github å’Œæœ¬åœ°éƒ½æœ‰ï¼Œäº’ä¸ºå¤‡ä»½ï¼Œç¡®ä¿å®‰å…¨ã€‚å¦å¤–ä¸Šé¢çš„æ’å…¥å›¾ç‰‡ï¼Œä¾ç„¶æ˜¯ä½¿ç”¨æˆ‘åœ¨ åšå®¢ç³»ç»Ÿè¿ç§»è®°å½• è¯´çš„ upload_pic è„šæœ¬ï¼Œè¿™ä¸ªè„šæœ¬å¯ä»¥è‡ªåŠ¨å°†æˆ‘å¤åˆ¶çš„å›¾ç‰‡æ–‡ä»¶æˆ–è€…æ˜¯æˆªå›¾å†…å®¹å¤åˆ¶åˆ° public/images çš„æŒ‰æ—¥æœŸå‘½åçš„ç›®å½•å¹¶ç”¨æ—¶é—´æˆ³å‘½åï¼Œç„¶åå† generate ä¸€ä¸ªç”Ÿæˆçš„ url å¹¶æŠŠ url å¤åˆ¶åˆ°æˆ‘çš„å‰ªè´´æ¿ã€‚å› æ­¤æˆ‘åªéœ€è¦å¤åˆ¶æˆ–æˆªå›¾ï¼Œç„¶åå†è°ƒç”¨ upload_picï¼Œå°±å¯ä»¥å¾—åˆ°ä¸€ä¸ª url ç”¨äºåœ¨ Markdown ä¸­æ’å…¥å›¾ç‰‡ã€‚ æœ€åï¼Œä¸€å¹´å‰ä¹°äº†é˜¿é‡Œäº‘ 3 å¹´çš„åŸŸå tao93.topï¼Œæˆ‘è®©å®ƒæŒ‡å‘ tao93.github.io äº†ã€‚ æœ€åçš„æœ€åï¼Œæ’å…¥ä¸¤å¼ å›¾ç‰‡æµ‹è¯•ä¸€ä¸‹ï¼Œä¸€å¼ æ˜¯æˆªå›¾ï¼Œå¦ä¸€å¼ æ˜¯å¤åˆ¶å›¾ç‰‡æ–‡ä»¶ã€‚ &lt;å®Œ&gt;","categories":[],"tags":[{"name":"Hexo Blog","slug":"Hexo-Blog","permalink":"https://tao93.top/tags/Hexo-Blog/"}]},{"title":"Android è‡ªå®šä¹‰ç®€æ˜“ PickerView","slug":"Android è‡ªå®šä¹‰ç®€æ˜“ PickerView","date":"2019-04-07T12:28:04.685Z","updated":"2019-07-05T14:01:31.229Z","comments":true,"path":"2019/04/07/Android è‡ªå®šä¹‰ç®€æ˜“ PickerView/","link":"","permalink":"https://tao93.top/2019/04/07/Android è‡ªå®šä¹‰ç®€æ˜“ PickerView/","excerpt":"","text":"æœ€è¿‘çš„åšçš„ä¸€é¡¹ feature ä¸­ï¼Œéœ€è¦ä½¿ç”¨ç±»ä¼¼äº iOS çš„ UIPickerView çš„æ§ä»¶ï¼ŒåŠŸèƒ½æ˜¯é€šè¿‡æ»šåŠ¨ item æ¥é€‰æ‹©å…¶ä¸­ä¸€ä¸ªï¼Œä¹Ÿå°±æ˜¯ä¸‹å›¾è¿™æ ·çš„ï¼š Android SDK å€’æ˜¯æœ‰ä¸€ä¸ª NumberPicker å’Œè¿™ä¸ªéå¸¸ç±»ä¼¼ï¼Œä¸è¿‡ NumberPicker è®¾è®¡æœ‰ç‚¹é—®é¢˜ï¼Œæ»šåŠ¨å¾ˆæ…¢ï¼Œå³ä½¿æ˜¯æ‰‹æŒ‡å¿«é€Ÿæ»‘åŠ¨ï¼Œä¹Ÿåªèƒ½æ»šåŠ¨äº”å…­ä¸ª itemsï¼Œè€Œ Github ä¸Šç¡®å®æœ‰ä¸å°‘ä¼˜ç§€çš„å®ç°ï¼Œå¯ä»¥å’Œ iOS çš„ UIPickerView éå¸¸ç›¸ä¼¼ï¼Œä¸è¿‡å…¶ä»£ç æœ‰äº›å¤æ‚ï¼Œä»¥è‡³äºæƒ³è¦é€Ÿè¯»ä»£ç ç„¶åè‡ªå·±å†™ä¸€ä»½ä¹Ÿæ¯”è¾ƒè´¹æ—¶é—´ã€‚æ‰€ä»¥ï¼Œæˆ‘å°±æƒ³åˆ°è‡ªå·±åŸºäº Android çš„ ListView å†™ä¸€ä¸ªç®€å•çš„è‡ªå®šä¹‰ PickerViewã€‚ æ—¢ç„¶ä½¿ç”¨ ListViewï¼Œé‚£ä¹ˆé¦–å…ˆéœ€è¦è§£å†³é—®é¢˜æœ‰å¦‚ä¸‹å‡ ä¸ªï¼š å¦‚ä½•è®©æ‰€æœ‰ item éƒ½èƒ½é€šè¿‡æ»‘åŠ¨è€Œæ»šåŠ¨åˆ°è§†å›¾ä¸­é—´ï¼Œä»è€Œè¡¨ç¤ºè¯¥ item è¢«é€‰ä¸­ï¼Ÿ å¦‚æœè®© ListView çš„ idle çŠ¶æ€å˜ä¸ºç¦»æ•£çš„ï¼Œè€Œéæœ¬æ¥çš„ä»»æ„æ»šåŠ¨çŠ¶æ€éƒ½å¯ä»¥ä¸º idleï¼Ÿ æ€ä¹ˆè·å–å½“å‰é€‰ä¸­çš„ item çš„åºå·ï¼Ÿ ç¬¬ä¸€ä¸ªé—®é¢˜æ¯”è¾ƒå¥½åŠï¼Œåœ¨ list çš„é¦–å°¾å„å¡«å……ä¸€äº›ç©ºç™½çš„ itemï¼Œè¿™æ ·å°±èƒ½è®©ç”¨æˆ·å¯è§çš„æ‰€æœ‰ item éƒ½èƒ½æ»‘åŠ¨åˆ°æ­£ä¸­é—´ã€‚ç¬¬äºŒä¸ªé—®é¢˜ï¼Œæˆ‘çš„åšæ³•æ˜¯ï¼Œå¦‚æœæ‰‹æŒ‡ç¦»å¼€æ—¶ï¼ŒListView ç¼“æ…¢æ»‘åŠ¨ï¼Œé‚£ä¹ˆå°±åœ¨é€Ÿåº¦ä½äºæŸä¸ªé˜ˆå€¼æ—¶ï¼Œè®©å®ƒæ»‘åŠ¨åˆ°æ°å¥½å°†ä¸€äº› item æ˜¾ç¤ºå‡ºæ¥è€Œä¸è¦æœ‰æŸä¸ª item åªæ˜¾ç¤ºä¸€éƒ¨åˆ†ï¼›è€Œå¦‚æœæ‰‹æŒ‡ç¦»å¼€æ—¶ ListView å¿«é€Ÿæ»‘åŠ¨ï¼Œé‚£ä¹ˆå°±åœ¨ ListView åˆšåˆšå˜ä¸º idle çŠ¶æ€æ—¶ï¼Œè®©å®ƒå°±è¿‘æ»‘åŠ¨åˆ°ã€Œæ°å¥½å°†ä¸€äº› item æ˜¾ç¤ºå‡ºæ¥ã€çš„çŠ¶æ€ã€‚ç¬¬ä¸‰ä¸ªé—®é¢˜å¥½åŠï¼Œè®¡ç®—ä¸€ä¸‹å½“å‰æ˜¾ç¤ºçš„æ‰€æœ‰ item çš„ position å°±èƒ½çŸ¥é“æœ€ä¸­é—´æ˜¾ç¤ºçš„ item çš„ positionã€‚ å¦å¤–è¿˜æœ‰ä¸€äº›ç»†èŠ‚é—®é¢˜ï¼š éœ€è¦åœ¨ä¸­é—´ç»˜åˆ¶ä¸Šä¸¤æ¡ç°è‰²æ°´å¹³çº¿ï¼› éœ€è¦åœ¨ canvas çš„æœ€ä¸Šå±‚ç»˜åˆ¶ä¸æ˜¯æ­£ä¸­é—´åŒºåŸŸç»˜åˆ¶åŠé€æ˜çŸ©å½¢ï¼Œä»è€Œè®©éé€‰ä¸­çš„ item çœ‹èµ·æ¥æ˜¯ç°è‰²çš„ï¼› ç‚¹å‡»éé€‰ä¸­çš„ item æ—¶ï¼Œéœ€è¦æ»šåŠ¨ ListView è®©è¯¥ item æ»‘åŠ¨åˆ°æ­£ä¸­é—´ã€‚ å®ç°çš„ä»£ç å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224/** * The Adapter interface for &#123;@link PickerView&#125; which is like UIPickerView on iOS. */public interface PickerAdapter &#123; /** get resource id of layout for each item of the picker view. */ @LayoutRes int getItemLayoutResource(); /** count of items in the picker view. */ int getItemCount(); /** text string for the item at the specified position. */ String getItemAt(int pos);&#125;/** * A view to let users to choose one item from a list, like UIPickerView on iOS. */public class PickerView extends FrameLayout &#123; /** the listView which is used to implement this PickerView */ private ListView listView; /** the count of visible items, must be odd numbers, the middle item would be the the selected one. */ private int visibleCount = 5; // 5 items visible by default private float itemHeight; Paint dividerLinePaint; Paint greyLayerPaint; /** adapter for this pickerView */ PickerAdapter adapter; private float dividerThickness; private float dividerMarginLeft; private float dividerMarginRight; private float velocityThreshold; private VelocityTracker velocityTracker = VelocityTracker.obtain(); public PickerView(@NonNull Context context) &#123; this(context, null); &#125; public PickerView(@NonNull Context context, @Nullable AttributeSet attrs) &#123; this(context, attrs, 0); &#125; public PickerView(@NonNull Context context, @Nullable AttributeSet attrs, final int defStyleAttr) &#123; super(context, attrs, defStyleAttr); setWillNotDraw(false); itemHeight = getResources().getDimension(R.dimen.picker_view_item_height); velocityThreshold = getResources().getDisplayMetrics().density * 260; TypedArray ta = context.obtainStyledAttributes(attrs, R.styleable.PickerView); dividerThickness = ta.getDimension(R.styleable.PickerView_divider_thickness, getResources().getDisplayMetrics().density); dividerMarginLeft = ta.getDimension(R.styleable.PickerView_divider_margin_left, 0); dividerMarginRight = ta.getDimension(R.styleable.PickerView_divider_margin_right, 0); int dividerColor = ta.getColor(R.styleable.PickerView_divider_color, Color.LTGRAY); ta.recycle(); dividerLinePaint = new Paint(); dividerLinePaint.setColor(dividerColor); dividerLinePaint.setStyle(Paint.Style.STROKE); dividerLinePaint.setStrokeWidth(dividerThickness); greyLayerPaint = new Paint(); greyLayerPaint.setColor(0xb0ffffff); &#125; public void setAdapter(PickerAdapter adapter) &#123; setAdapter(adapter, 0, 0); &#125; public void setAdapter(PickerAdapter adapter, int initPos) &#123; setAdapter(adapter, 0, initPos); &#125; /** * set adapter and other two parameters. * @param visibleCount count of visible items in the picker, must be odd numbers. * @param initPos position of the initially selected item, 0 means the first item would be selected. */ public void setAdapter(PickerAdapter adapter, int visibleCount, int initPos) &#123; if (adapter.getItemCount() &lt;= 0) &#123; return; &#125; if (visibleCount &gt; 0 &amp;&amp; visibleCount % 2 != 0) &#123; this.visibleCount = visibleCount; &#125; this.adapter = adapter; listView = new ListView(getContext()); addView(listView, new LinearLayout.LayoutParams(ViewGroup.LayoutParams.MATCH_PARENT, (int) (itemHeight * this.visibleCount))); listView.setOverScrollMode(View.OVER_SCROLL_NEVER); // remove over scroll effects. listView.setVerticalScrollBarEnabled(false); listView.setDivider(null); // remove listView's dividers listView.setOnScrollListener(new AbsListView.OnScrollListener() &#123; @Override public void onScrollStateChanged(AbsListView view, int scrollState) &#123; if (scrollState == AbsListView.OnScrollListener.SCROLL_STATE_IDLE) &#123; // scroll to nearest place that fit the selection properly. scrollToNearest(); &#125; &#125; @Override public void onScroll(AbsListView view, int firstVisibleItem, int visibleItemCount, int totalItemCount) &#123; &#125; &#125;); listView.setAdapter(new InnerAdapter()); if (initPos &gt; 0 &amp;&amp; initPos &lt; adapter.getItemCount()) &#123; listView.setSelection(initPos); &#125; &#125; /** * @return the position of the currently selected item, starting from 0. */ public int getSelectedPosition() &#123; listView.getFirstVisiblePosition(); View firstChild = listView.getChildAt(0); if (Math.abs(firstChild.getTop()) &lt; firstChild.getHeight() / 10) &#123; return listView.getFirstVisiblePosition(); &#125; else &#123; return listView.getFirstVisiblePosition() + 1; &#125; &#125; @Override public boolean dispatchTouchEvent(MotionEvent ev) &#123; boolean superResult = super.dispatchTouchEvent(ev); velocityTracker.addMovement(ev); if (ev.getActionMasked() == MotionEvent.ACTION_UP) &#123; velocityTracker.computeCurrentVelocity(1000); float yVelocity = velocityTracker.getYVelocity(); // scroll to nearest proper place directly if the fling is very slow if (Math.abs(yVelocity) &lt; velocityThreshold) &#123; scrollToNearest(); &#125; &#125; return superResult; &#125; /** scroll the listView to fit the nearest proper position */ private void scrollToNearest() &#123; View firstChild = listView.getChildAt(0); if (Math.abs(firstChild.getTop()) &gt; Math.abs(firstChild.getBottom())) &#123; listView.smoothScrollToPosition(listView.getLastVisiblePosition()); &#125; else &#123; listView.smoothScrollToPosition(listView.getFirstVisiblePosition()); &#125; &#125; @Override protected void onDetachedFromWindow() &#123; velocityTracker.recycle(); super.onDetachedFromWindow(); &#125; @Override public void draw(Canvas canvas) &#123; super.draw(canvas); //canvas.drawRect(0, itemHeight * 2, getWidth(), itemHeight * 3, dividerLinePaint); canvas.drawLine(dividerMarginLeft, itemHeight * 2 - dividerThickness, getWidth() - dividerMarginRight, itemHeight * 2 - dividerThickness, dividerLinePaint); canvas.drawLine(dividerMarginLeft, itemHeight * 3 + dividerThickness, getWidth() - dividerMarginRight, itemHeight * 3 + dividerThickness, dividerLinePaint); // draw two transparent rectangles to make not selected items looks grey canvas.drawRect(0, 0, getWidth(), itemHeight * 2 - dividerThickness, greyLayerPaint); canvas.drawRect(0, getHeight() - 2 * itemHeight + dividerThickness, getWidth(), getBottom(), greyLayerPaint); &#125; /** * the adapter for the listView */ private class InnerAdapter extends BaseAdapter &#123; @Override public int getCount() &#123; // we would add visibleCount - 1 empty strings to the list View, so the count should plus visibleCount - 1. return adapter.getItemCount() + visibleCount - 1; &#125; @Override public Object getItem(int position) &#123; // there're visibleCount - 1 items with empty text, they would be equally put at the starting and ending. if (position &lt; visibleCount / 2 || position &gt;= getCount() - visibleCount / 2) &#123; return \"\"; &#125; return adapter.getItemAt(position - visibleCount / 2); &#125; @Override public long getItemId(int position) &#123; return position; &#125; @Override public View getView(final int position, View convertView, ViewGroup parent) &#123; if (convertView == null) &#123; convertView = View.inflate(getContext(), adapter.getItemLayoutResource(), null); convertView.setBackgroundColor(Color.WHITE); // to avoid the default touch effect of listView item &#125; // select a item when it's clicked by users convertView.setOnClickListener(new OnClickListener() &#123; @Override public void onClick(View v) &#123; int cur = getSelectedPosition() + visibleCount / 2; if (position &gt; cur) &#123; listView.smoothScrollToPosition(position + visibleCount / 2); &#125; else if (position &lt; cur) &#123; listView.smoothScrollToPosition(position - visibleCount / 2); &#125; &#125; &#125;); TextView textView = convertView.findViewById(R.id.picker_text_view); textView.setText((String) getItem(position)); return convertView; &#125; &#125;&#125; è¿˜æœ‰ä¸€äº›å°ç»†èŠ‚ã€‚æ¯”å¦‚ ListView çš„é«˜åº¦éœ€è¦æ­£å¥½æ˜¯ itemView çš„å¥‡æ•°å€ï¼Œè¿™æ ·æ‰èƒ½æ°å¥½åªæ˜¾ç¤ºä¸€äº› itemï¼Œå¹¶ä¸”æœ€ä¸­é—´æ˜¾ç¤ºå…¶ä¸­ä¸€ä¸ª itemã€‚å†æ¯”å¦‚ä¸ºäº†é¿å… ListView è‡ªå¸¦çš„ç‚¹å‡» item æ—¶çš„è§†è§‰æ•ˆæœï¼Œéœ€è¦ç»™ itemView è®¾ç½®çº¯ç™½è‰²èƒŒæ™¯ã€‚ è‡³æ­¤ï¼Œä¸€ä¸ªç®€æ˜“çš„ PickerView å°±å®Œæˆäº†ã€‚","categories":[],"tags":[{"name":"Android","slug":"Android","permalink":"https://tao93.top/tags/Android/"}]},{"title":"ä¸€ä¸ªä¸ä¸€æ ·çš„ ANR","slug":"ä¸€ä¸ªä¸ä¸€æ ·çš„ ANR","date":"2019-01-18T13:04:23.787Z","updated":"2019-07-05T14:03:18.662Z","comments":true,"path":"2019/01/18/ä¸€ä¸ªä¸ä¸€æ ·çš„ ANR/","link":"","permalink":"https://tao93.top/2019/01/18/ä¸€ä¸ªä¸ä¸€æ ·çš„ ANR/","excerpt":"","text":"æœ€è¿‘ç¢°åˆ°ä¸€ä¸ª ANR é—®é¢˜ï¼Œæ‹¿åˆ° traces æ–‡ä»¶åï¼Œæ˜¾ç¤ºä¸»çº¿ç¨‹çš„å †æ ˆæ˜¯ä¸‹é¢è¿™æ ·çš„ï¼š 1234567at android.os.MessageQueue.nativePollOnce(Native method)at android.os.MessageQueue.next(MessageQueue.java:323)at android.os.Looper.loop(Looper.java:135)at android.app.ActivityThread.main(ActivityThread.java:5417)at java.lang.reflect.Method.invoke!(Native method)at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:726)at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:616) è¿™æ ·ä¸€æ®µå †æ ˆï¼Œåœ¨å¾ˆå¤šæƒ…å†µä¸‹è¡¨æ˜ä¸»çº¿ç¨‹æ˜¯æ­£å¸¸çš„ï¼Œå³å¤„åœ¨ç­‰å¾…åŒºä¸‹ä¸€æ¡ä¸»çº¿ç¨‹æ¶ˆæ¯çš„è¿‡ç¨‹ä¸­ï¼Œè€Œä¸æ˜¯é™·åœ¨æŸä¸ªè€—æ—¶ç‰¹åˆ«é•¿çš„æ¶ˆæ¯ä¸­ã€‚ ç»è¿‡åå¤æµ‹è¯•ï¼Œæœ€åç¡®è®¤è¿™ä¸ª ANR å’Œè®¾ç½®äº† Default UncaughtExceptionHandler æœ‰å…³ï¼Œé—®é¢˜ä»£ç å¯ä»¥ç®€åŒ–æˆä¸‹é¢çš„æ ·å­ï¼š 123456789101112131415161718192021222324252627282930313233public class MainActivity extends AppCompatActivity &#123; static &#123; Thread.setDefaultUncaughtExceptionHandler(new Thread.UncaughtExceptionHandler() &#123; @Override public void uncaughtException(final Thread t, Throwable e) &#123; Log.i(\"uncaught\", Thread.currentThread().toString()); Log.i(\"uncaught\", t.toString()); &#125; &#125;); &#125; private Thread thread; @Override protected void onCreate(Bundle savedInstanceState) &#123; super.onCreate(savedInstanceState); setContentView(R.layout.activity_main); findViewById(R.id.btn).setOnClickListener(new View.OnClickListener() &#123; @Override public void onClick(View v) &#123; new Thread(new Runnable() &#123; @Override public void run() &#123; throw new RuntimeException(\"hello world\"); &#125; &#125;).start(); //throw new RuntimeException(\"hello world!!\"); &#125; &#125;); &#125;&#125; ä¸Šé¢çš„ä»£ç çš„è¡¨ç°æ˜¯ï¼Œå¦‚æœåªè®©ç¬¬ 26 è¡ŒæŠ›å‡ºå¼‚å¸¸ï¼Œé‚£ä¹ˆä¸€åˆ‡çœ‹èµ·æ¥éƒ½æ­£å¸¸ï¼Œä½†æ˜¯å¦‚æœè®©ç¬¬ 29 è¡ŒæŠ›å‡ºå¼‚å¸¸ï¼Œé‚£ä¹ˆåº”ç”¨ç›´æ¥å°±æ— å“åº”äº†ã€‚ ç»è¿‡ä¸€ç•ªæŸ¥æ‰¾ä¸éªŒè¯ï¼Œæˆ‘å‘ç°åŸå› å¤§è‡´æ˜¯ï¼Œå½“ä¸€ä¸ª Java çº¿ç¨‹æŠ›å‡ºäº†æœªæ•è·çš„å¼‚å¸¸æ—¶ï¼ŒJVM å…ˆä¼šè°ƒç”¨åˆ° UncaughtExceptionHandlerï¼Œç„¶åå†ä¼šæŠŠæ­¤çº¿ç¨‹åœæ­¢æ‰ã€‚æ‰€ä»¥è¿™æ®µä»£ç ä¸­ï¼Œå¦‚æœä¸»çº¿ç¨‹æŠ›å‡ºå¼‚å¸¸ï¼Œé‚£ä¹ˆç¬¬ 6 è¡Œçš„æ–¹æ³•ç»“æŸåï¼Œä¸»çº¿ç¨‹å°±ä¼šè¢« JVM ç»™åœæ­¢æ‰ï¼Œæ—¢ç„¶ä¸»çº¿ç¨‹éƒ½åœæ­¢æ‰äº†ï¼Œé‚£è‡ªç„¶å°±æ— å“åº”äº†ï¼Œä¹Ÿå°±ä¼šå‘ç”Ÿ ANR äº†ã€‚ äº‹å®ä¸Šï¼Œä¸€èˆ¬æˆ‘ä»¬è®¾ç½®è‡ªå®šä¹‰ UncaughtExceptionHandler æ—¶ï¼Œéƒ½ä¼šåœ¨è‡ªå®šä¹‰çš„ uncaughtException æ–¹æ³•æœ€åå†è°ƒç”¨ä¸€éè¢«æˆ‘ä»¬é¡¶æ›¿æ‰çš„ç³»ç»Ÿé»˜è®¤çš„ UncaughtExceptionHandlerï¼Œä»¥ä¾¿æŠŠåº”ç”¨ kill æ‰ï¼Œè€Œè¿™ä¸ªä¾‹å­ï¼Œå……åˆ†çš„æ˜¾ç¤ºäº†ï¼Œå½“æœªæ•è·å¼‚å¸¸å‘ç”Ÿåï¼Œå°±ç®—èµ–ç€ä¸ kill æ‰åº”ç”¨ä¹Ÿæ˜¯ä¸è¡Œçš„ï¼Œå› ä¸ºå¯èƒ½ä¸»çº¿ç¨‹éƒ½å·²ç»è¢«åœæ‰äº†ã€‚ å…³äº JVM å…ˆè°ƒç”¨ UncaughtExceptionHandler ç„¶åæŠŠå‘ç”Ÿæœªæ•è·å¼‚å¸¸çš„çº¿ç¨‹åœæ­¢æ‰çš„è¯´æ³•ï¼Œè§äº Java Language Specification 11.3ï¼Œå¦‚ä¸‹æ‰€ç¤ºçš„ç‰‡æ®µï¼š é‚£ä¹ˆä¸»çº¿ç¨‹è¢«åœæ­¢æ‰ï¼Œæ˜¯ä¸ªä»€ä¹ˆæ ·çš„çŠ¶æ€å‘¢ï¼Œæˆ‘ç”¨ä¸‹é¢çš„ä»£ç ï¼ŒæŠŠä¸»çº¿ç¨‹çš„çŠ¶æ€ç»™è¾“å‡ºæ¥ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445public class MainActivity extends AppCompatActivity &#123; static &#123; Thread.setDefaultUncaughtExceptionHandler(new Thread.UncaughtExceptionHandler() &#123; @Override public void uncaughtException(final Thread t, Throwable e) &#123; Log.i(\"uncaught\", Thread.currentThread().toString()); Log.i(\"uncaught\", t.toString()); &#125; &#125;); &#125; private Thread thread; @Override protected void onCreate(Bundle savedInstanceState) &#123; super.onCreate(savedInstanceState); setContentView(R.layout.activity_main); findViewById(R.id.btn).setOnClickListener(new View.OnClickListener() &#123; @Override public void onClick(View v) &#123; final Thread mainThread = Thread.currentThread(); Log.i(\"&lt;&lt;&lt;\", mainThread.getState().toString()); if (thread == null) &#123; thread = new Thread(new Runnable() &#123; @Override public void run() &#123; for (int i = 0; i &lt; 3; ++i) &#123; try &#123; Thread.sleep(1000); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; Log.i(\"&lt;&lt;&lt;\", mainThread.getState().toString()); &#125; &#125; &#125;); thread.start(); &#125; throw new RuntimeException(\"hello world!!\"); &#125; &#125;); &#125;&#125; ä¸Šé¢ä»£ç çš„ç¬¬ 24 è¡Œå’Œç¬¬ 35 è¡Œä¸€å…±ä¼š 4 æ­¤è¾“å‡ºä¸»çº¿ç¨‹çš„çŠ¶æ€ï¼Œç»“æœå¦‚ä¸‹é¢æ‰€ç¤ºï¼š 123401-18 21:00:24.308 14533 14533 I &lt;&lt;&lt; : RUNNABLE01-18 21:00:25.309 14533 14570 I &lt;&lt;&lt; : NEW01-18 21:00:26.310 14533 14570 I &lt;&lt;&lt; : NEW01-18 21:00:27.311 14533 14570 I &lt;&lt;&lt; : NEW ä»ä¸Šé¢ä»£ç å¯çŸ¥ï¼Œä¸»çº¿ç¨‹ä» RUNNABLE çŠ¶æ€å˜æˆäº† NEW çŠ¶æ€ï¼Œä¸ºä»€ä¹ˆæ˜¯ NEW çŠ¶æ€ï¼Œæˆ‘ä¹Ÿä¸æ¸…æ¥šï¼Œä¹Ÿè®¸å°†æ¥å¯¹ JVM äº†è§£æ›´å¤šäº†ï¼Œä¼šæ¸…é™¤å§ã€‚ å›åˆ°è¿™ä¸ª ANR æ¥ï¼Œè¿™ä¸ªä¾‹å­è¯´æ˜ï¼Œæˆ‘ä»¬å¦‚æœä½¿ç”¨è‡ªå®šä¹‰çš„ UncaughtExceptionHandlerï¼Œè®°å¾—è¦æŠŠåº”ç”¨ kill æ‰ï¼Œè¿˜æœ‰ default çš„ UncaughtExceptionHandler æ˜¯å…¨å±€å…¬ç”¨çš„ï¼Œå¾ˆå®¹æ˜“ä¼šå‡ºç°è¢«é¡¶æ›¿ (è¦†ç›–)ï¼Œæ‰€ä»¥åˆ‡è®°åˆ«éšæ„è°ƒç”¨ï¼Œå…å¾—å‡ºç°æ„æ–™ä¹‹å¤–çš„é—®é¢˜ã€‚ ä¿®å¤è¿™æ ·çš„ ANRï¼Œåˆ†æˆä¸¤éƒ¨åˆ†ï¼Œç¬¬ä¸€éƒ¨åˆ†æ˜¯å…ˆç§»é™¤æˆ–è€…ä¿®æ”¹ä¸æ°å½“çš„è®¾ç½® UncaughtExceptionHandler çš„ä»£ç ï¼Œå…ˆæ¶ˆé™¤ ANRï¼Œç„¶åè¿˜éœ€è¦æŠŠå¼•å‘ ANR çš„å¦ä¸€ä¸ªåŸå› ï¼Œä¹Ÿå°±æ˜¯æœªæ•è·çš„å¼‚å¸¸ç»™ä¿®å¤æ‰ï¼Œä¸ç„¶åº”ç”¨ä¸ä¼š ANR äº†ä½†æ˜¯ä¼š Crashã€‚","categories":[],"tags":[{"name":"Android","slug":"Android","permalink":"https://tao93.top/tags/Android/"}]},{"title":"Android ç»˜åˆ¶åœ†å½¢å›¾ç‰‡","slug":"Android ç»˜åˆ¶åœ†å½¢å›¾ç‰‡","date":"2019-01-12T10:38:32.256Z","updated":"2019-01-12T10:38:33.385Z","comments":true,"path":"2019/01/12/Android ç»˜åˆ¶åœ†å½¢å›¾ç‰‡/","link":"","permalink":"https://tao93.top/2019/01/12/Android ç»˜åˆ¶åœ†å½¢å›¾ç‰‡/","excerpt":"","text":"è®°å½•ä¸€ä¸‹ï¼Œä»¥å…å¿˜è®°ï¼Œä»¥å¤‡ä½¿ç”¨ã€‚ æ–¹æ³•ä¸€ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142public class MyView extends View &#123; Paint paint = new Paint(); Shader shader; Matrix mat = new Matrix(); Bitmap bitmap; public MyView(Context context) &#123; this(context, null); &#125; public MyView(Context context, @Nullable AttributeSet attrs) &#123; this(context, attrs, 0); &#125; public MyView(Context context, @Nullable AttributeSet attrs, int defStyleAttr) &#123; super(context, attrs, defStyleAttr); // create a bitmap from the image resource what we want to draw bitmap = BitmapFactory.decodeResource(getResources(), R.drawable.dossier_icon); // a bitmap shader, would be set into paint, here we use repeat tile mode, but since we'll // scale to make the bitmap fill the canvas just right, so there would be no repeat. shader = new BitmapShader(bitmap, Shader.TileMode.REPEAT, Shader.TileMode.REPEAT); // after this, the paint would contains this bitmap. paint.setShader(shader); &#125; @Override protected void onLayout(boolean changed, int left, int top, int right, int bottom) &#123; super.onLayout(changed, left, top, right, bottom); // scale to make bitmap fill the canvas mat.setScale((float)getWidth() / bitmap.getWidth(), (float)getHeight() / bitmap.getHeight()); shader.setLocalMatrix(mat); &#125; @Override protected void onDraw(Canvas canvas) &#123; super.onDraw(canvas); // draw a circle with the paint. canvas.drawCircle(getWidth() / 2, getHeight() / 2, getWidth() / 2, paint); &#125;&#125; æ–¹æ³•äºŒï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142public class MyView2 extends View &#123; private Path mPath; private Drawable mDrawable; public MyView2(Context context) &#123; this(context, null); &#125; public MyView2(Context context, @Nullable AttributeSet attrs) &#123; this(context, attrs, 0); &#125; public MyView2(Context context, @Nullable AttributeSet attrs, int defStyleAttr) &#123; super(context, attrs, defStyleAttr); mPath = new Path(); mDrawable = getResources().getDrawable(R.drawable.dossier_icon); &#125; @Override protected void onLayout(boolean changed, int left, int top, int right, int bottom) &#123; super.onLayout(changed, left, top, right, bottom); // make the path to be a circle whose diameter is width of the view. mPath.reset(); mPath.addCircle(getWidth() / 2, getHeight() / 2, getWidth() / 2, Path.Direction.CW); // drawable must setBounds before draw mDrawable.setBounds(0, 0, getWidth(), getHeight()); &#125; @Override protected void onDraw(Canvas canvas) &#123; super.onDraw(canvas); // save current (default) clip canvas.save(); // make the clip to be the circle canvas.clipPath(mPath); // draw the bitmapDrawable mDrawable.draw(canvas); // restore default clip canvas.restore(); &#125;&#125; æ–¹æ³•ä¸‰ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445public class MyView3 extends View &#123; Paint mPaint = new Paint(); Paint whitePaint = new Paint(); private Bitmap bitmap; private Matrix mat = new Matrix(); private Xfermode mXfermode; public MyView3(Context context) &#123; this(context, null); &#125; public MyView3(Context context, @Nullable AttributeSet attrs) &#123; this(context, attrs, 0); &#125; public MyView3(Context context, @Nullable AttributeSet attrs, int defStyleAttr) &#123; super(context, attrs, defStyleAttr); mXfermode = new PorterDuffXfermode(PorterDuff.Mode.SRC_IN); whitePaint.setColor(Color.RED); bitmap = BitmapFactory.decodeResource(getResources(), R.drawable.dossier_icon); &#125; @Override protected void onLayout(boolean changed, int left, int top, int right, int bottom) &#123; super.onLayout(changed, left, top, right, bottom); mat.setScale((float)getWidth() / bitmap.getWidth(), (float)getHeight() / bitmap.getHeight()); &#125; @Override protected void onDraw(Canvas canvas) &#123; super.onDraw(canvas); // save current layer and create a new layer int count = canvas.saveLayer(0, 0, getWidth(), getHeight(), mPaint); // draw a white circle in the new layer canvas.drawCircle(getWidth() / 2, getHeight() / 2, getWidth() / 2, whitePaint); // this xfer mode is src_in type, which could make image to be drawn in only previous white circle area. mPaint.setXfermode(mXfermode); // draw bitmap in new layer canvas.drawBitmap(bitmap, mat, mPaint); // this is necessary, or the influence would last mPaint.setXfermode(null); // back to previous layer. canvas.restoreToCount(count); &#125;&#125; ä¸‰ä¸ªæ–¹æ³•ä¸­ï¼Œæ–¹æ³•äºŒæœ€ç®€ä¾¿æ˜“ç”¨ï¼Œæ–¹æ³•ä¸‰æœ€ä¸æ¨èï¼Œå› ä¸ºæ–°å¢ä¸€ä¸ª canvas layer æ˜¯å¼€é”€å¾ˆå¤§çš„ï¼Œè¿™ä¸€ç‚¹ saveLayerAlpha æ–¹æ³•çš„æ³¨é‡Šæœ‰è¯´æ˜ã€‚","categories":[],"tags":[{"name":"Android","slug":"Android","permalink":"https://tao93.top/tags/Android/"}]},{"title":"ç»™ä¸‰æ˜Ÿ tablet SM-T830 åˆ·æœº[ç»­]","slug":"ç»™ä¸‰æ˜Ÿ tablet SM-T830 åˆ·æœº[ç»­]","date":"2019-01-01T13:20:54.004Z","updated":"2019-07-05T14:04:33.387Z","comments":true,"path":"2019/01/01/ç»™ä¸‰æ˜Ÿ tablet SM-T830 åˆ·æœº[ç»­]/","link":"","permalink":"https://tao93.top/2019/01/01/ç»™ä¸‰æ˜Ÿ tablet SM-T830 åˆ·æœº[ç»­]/","excerpt":"","text":"äº‹æƒ…çš„èµ·å› æ˜¯ï¼Œä» xda ä¸Šé¢è¿™ä¸ªå¸–å­ çœ‹åˆ°ï¼Œæœ‰äººåœ¨ä¸‰æ˜Ÿ Tab S4 å¹³æ¿ä¸Šé¢åˆ·äº†ä¸ªç±»åŸç”Ÿ Android çš„ç³»ç»Ÿï¼Œä»–è¡¨ç¤ºç”¨èµ·æ¥æŒºå¥½ï¼Œåªä¸è¿‡ 4 ä¸ªæ‰¬å£°å™¨åªæœ‰åº•éƒ¨ä¸¤ä¸ªå¯ä»¥å‘å£°ã€‚çœ‹åˆ°è¿™ä¸ªæˆ‘å¿ƒé‡Œå°±ç—’ç—’ï¼Œå› ä¸ºä¸‰æ˜Ÿçš„å®˜æ–¹ rom æˆ‘å¹¶ä¸å–œæ¬¢ï¼Œé‡Œé¢æœ‰ä¸‰æ˜Ÿçš„ app storeï¼Œè¿˜æœ‰ä¸‰æ˜Ÿçš„ä¸€å¥—è´¦æˆ·ç³»ç»Ÿï¼Œè°ƒè¯•åˆ°ç³»ç»Ÿä»£ç çš„æ—¶å€™ï¼Œè¡Œå·ä¹Ÿå®Œå…¨å¯¹ä¸ä¸Š(Pixelæ˜¯å¯ä»¥å¯¹ä¸Šè¡Œå·çš„)ï¼Œæ‰€ä»¥æˆ‘ä¹Ÿæƒ³ç»™æ‰‹é‡Œçš„ Tab S4 å¹³æ¿åˆ·ä¸€ä¸ªç±»åŸç”Ÿç³»ç»Ÿã€‚ ç„¶åæˆ‘å°±åœ¨ xda ä¸Šé¢æŸ¥äº†æŸ¥ï¼Œå‘ç°æˆ‘åº”è¯¥éœ€è¦å…ˆåˆ·å…¥ä¸€ä¸ª TWRP recoveryï¼Œç„¶åå†ä½¿ç”¨ TWRP åˆ·å…¥ç±»åŸç”Ÿç³»ç»Ÿã€‚å¦å¤–æˆ‘ä¹Ÿæ³¨æ„åˆ°ï¼Œä¹‹æ‰€ä»¥èƒ½åˆ·å¹¶æ²¡æœ‰é€‚é… Tab S4 çš„ ROMï¼Œå¾—å½’åŠŸäº Project Trableã€‚è°·æ­Œæå‡º Project Trable æ˜¯ä¸ºäº†è®© Android ç³»ç»Ÿçš„å¼€å‘å’Œåº•å±‚é©±åŠ¨çš„å¼€å‘åˆ†ç¦»å¼€ï¼Œä¸¤è€…åªè¦æ»¡è¶³åè®®ï¼Œå°±å¯ä»¥ç»„åˆåœ¨ä¸€èµ·ï¼Œè¿™æ ·å°±å¯å‡å° Android ç³»ç»Ÿå‡çº§æ—¶å‚å•†å¼€å‘é©±åŠ¨çš„å·¥ä½œï¼Œä»è€Œè®©è®¾å¤‡æ›´å¿«å‡çº§ Android ç³»ç»Ÿã€‚Project Trable ä¹Ÿä½¿å¾—é‚£äº›ç¬¦åˆè¦æ±‚çš„è®¾å¤‡ï¼Œå¯ä»¥åˆ·å¤§é‡æ»¡è¶³ Project Trable è¦æ±‚çš„ General System Image (GSI)ã€‚Tab S4 å°±æ˜¯ç¬¦åˆ Project Trable è¦æ±‚çš„ï¼Œæ‰€ä»¥æˆ‘å°±æ˜¯è¦ç»™å®ƒåˆ· GSIã€‚ å›åˆ°å‰é¢è¯´çš„ TWRP çš„äº‹æƒ…ï¼ŒTWRP å®˜æ–¹å¹¶æ²¡æœ‰é€‚é… Tab S4 çš„ç‰ˆæœ¬ï¼Œä¸è¿‡æˆ‘åœ¨è¿™ä¸ªå¸–å­é‡Œé¢å‘ç°äº†ç”¨äº Tab S4 çš„éå®˜æ–¹ TWRPï¼Œå¹¶å†™å‡ºäº†æ­¥éª¤ï¼š ç¡®è®¤ OEM å·²è§£é”ï¼› è®¾å¤‡è¿›å…¥ download æ¨¡å¼ï¼› ä½¿ç”¨ odin çš„ AP slot æ¥åˆ·å…¥ TWRP å‹ç¼©åŒ…ï¼Œè®°å¾—è¦å–æ¶ˆå‹¾é€‰ã€ŒAuto Rebootã€; å…³æœºï¼Œç„¶åå†è¿›å…¥ TWRPï¼› è¿›å…¥ TWRPï¼Œç„¶ååˆ·å…¥ Forced encryption disabler patchï¼Œformat DATA ä¸€ä¸‹ï¼› è¿›å…¥ TWRPï¼Œåˆ·å…¥ Magisk å‹ç¼©åŒ…ï¼Œäºæ˜¯è®¾å¤‡å°± root äº†ã€‚ æ­¥éª¤å…¶å®å¾ˆç®€å•ï¼Œä¸è¿‡æˆ‘åœ¨è¿™é‡ŒæŠ˜è…¾äº† 3 å¤©ã€‚æˆ‘å…ˆæŒ‰ç…§ä¸Šé¢çš„æ­¥éª¤æ¥ï¼Œç»“æœå‘ç°è¿› TWRP åå°±æ— æ³•è®¿é—® internal storageï¼Œè‡ªç„¶å°±åˆ·ä¸äº† Forced encryption disabler patchã€‚æˆ‘è¯•äº†éå¸¸å¤šæƒ³æ³•ï¼Œæ¯”å¦‚é‡åˆ·ä¸‰æ˜Ÿå®˜æ–¹å›ºä»¶ï¼Œåˆ·æ›´æ—§çš„å®˜æ–¹å›ºä»¶(åŸå› æ˜¯è¿™ä¸ªå¸–å­é‡Œé¢å·¥å…·å‘å‡ºæ¥æ—¶ï¼Œå®˜æ–¹å›ºä»¶è¿˜æ›´æ—§ä¸€äº›ï¼Œè€Œæˆ‘çœ‹åˆ°è¿™å¸–å­æ—¶å·²ç»æ›´æ–°åˆ°æ¯”è¾ƒæ–°äº†)ï¼Œåˆ·å›½è¡Œçš„å®˜æ–¹å›ºä»¶ï¼Œéƒ½ä¸è¡Œï¼Œå…¶ä¸­åˆ·æ›´ä½ç‰ˆæœ¬çš„å›ºä»¶è¿˜æœ‰é™åˆ¶å³ BootLoader ä¸èƒ½é™çº§ï¼Œæ‰€ä»¥å…¶å®å®˜æ–¹å›ºä»¶é™ä¸äº†å¤šå°‘çº§ã€‚æˆ‘è¿˜çœ‹åˆ°äº†è¿™ç§å¸–å­ï¼Œé‡Œé¢å‘Šè¯‰æˆ‘è¯´ï¼Œéœ€è¦å…ˆåˆ·ä¸€ä¸ª DM-Verity patched bootï¼Œæˆ‘ä¹Ÿè¯•äº†ï¼Œå‘ç°åˆ·å®Œè¿™ä¸ª DM-Verity patched boot åç›´æ¥æ— æ³•è¿›å…¥ç³»ç»Ÿï¼ŒæŠ¥ Verification Failed é”™è¯¯ï¼Œå¿…é¡»é‡ç½®è®¾å¤‡æ‰è¡Œã€‚ç¿»é xda é‚£ä¸ª 40 å‡ é¡µçš„å¸–å­åï¼Œæˆ‘å‘ç°å…¶å®è¿™ä¸ªå¸–å­å°±æ˜¯æŠ„ xda é‚£ä¸ªå¸–å­ï¼Œåªä¸è¿‡æŠ„çš„æ—¶å€™ï¼Œxda å¸–å­ä¸Šé¢çš„æ­¥éª¤ç¡®å®ç¬¬ä¸€æ­¥æ˜¯åˆ· DM-Verity patched bootï¼Œä¸è¿‡åæ¥ xda å¸–å­æ­¥éª¤æ›´æ–°äº†ï¼Œæˆäº†ç°åœ¨è¿™æ ·çš„ã€‚ ä¸æ˜¯æ— æ³•è®¿é—® internal storage å˜›ï¼Œåæ¥æˆ‘ä¹°äº†ä¸ª micro SD å¡ï¼Œæ’è¿›è®¾å¤‡ï¼Œåœ¨ TWRP ä¸­è¿™ä¸ª micro SD æ˜¯å¯ä»¥è®¿é—®çš„ï¼Œæ‰€ä»¥æˆ‘å°±å¯ä»¥ç»§ç»­åˆ·å…¥ Forced encryption disabler patch å¹¶ format DATAï¼Œç„¶åæˆ‘å°± boot loop äº†ï¼ŒçœŸæ°”äººã€‚å³ä½¿æˆ‘å†åˆ·å…¥ GSIï¼Œä¾ç„¶æ˜¯ boot loopã€‚ åæ¥é‚£ä¸ª xda å¸–å­çš„ä½œè€…å›å¤æˆ‘è¯´ã€Œå…¨ç¨‹æ²¡çœ‹åˆ°æˆ‘åˆ· Magisk çš„æè¿°ï¼Œä½† Magisk æ˜¯å¿…è¦çš„ï¼Œå¦åˆ™ä¼š boot loopã€ã€‚æˆ‘ç¡®å®æ²¡åˆ· Magiskï¼Œå› ä¸ºæˆ‘å¹¶æ²¡æœ‰åƒ rootï¼Œæˆ‘åªæƒ³æä¸ª TWRP ç„¶ååˆ· GSI è€Œå·²ã€‚äºæ˜¯æˆ‘å°±åˆ·äº† Magiskï¼Œå‘ç°ä¸åœ¨ boot loop äº†ï¼Œç„¶åå†è¿™é‡Œ ä¸‹è½½äº† system-arm64-aonly-gapps-su.img.xz è¿™ä¸ª GSI å¹¶åˆ·å…¥ï¼Œè¿™æ¬¡ç»ˆäºæˆåŠŸäº†ï¼Œè¿›å…¥äº†ä¸€ä¸ªç±»ä¼¼ AOSP user-debug ç±»å‹çš„ aosp ç³»ç»Ÿï¼Œå¾ˆç®€é™‹ï¼Œè¿ Contactï¼ŒSettingsï¼Œç­‰è¿™äº›åº”ç”¨éƒ½æ˜¯ aosp ç‰ˆæœ¬çš„ï¼Œå’Œæ­£å¸¸çš„å¾ˆä¸ä¸€æ ·ï¼Œç›¸æœºåº”ç”¨åˆ™ç›´æ¥æ‰“å¼€å°± crashã€‚é¡ºä¾¿è®°å½•ä¸€ä¸‹ TWRP åˆ· GSI çš„æ–¹æ³•ï¼Œå¾ˆç®€å•ï¼š è¿›å…¥ TWRPï¼Œwipe ä¸€ä¸‹ï¼› è¿›å…¥ installï¼Œåˆ‡æ¢åˆ° install image æ¨¡å¼ï¼Œæ‰¾åˆ° GSIï¼› partition é€‰æ‹© system imageï¼Œflashï¼› é‡å¯ å…³é”®æ˜¯ï¼Œè¿™ä¸ª aosp ç³»ç»Ÿæœ‰äº› bugï¼Œæœ€å—ä¸äº†çš„ bug æ˜¯ï¼Œé”å±ã€æ—‹è½¬æ—¶å±å¹•éƒ½ä¼šå˜å½¢ä¸€ä¸‹ï¼Œæˆªå±å¾—åˆ°çš„å›¾ç‰‡ä¹Ÿæ˜¯ä¼šå˜å½¢ä¸€ä¸‹ã€‚è¿™å’Œæˆ‘æœ€åˆçœ‹åˆ°çš„ xda å¸–å­é‡Œé¢é‚£äººè¯´çš„åªæ˜¯æ‰¬å£°å™¨æ²¡æœ‰å…¨éƒ¨å‘å£°å·®è¿œäº†ã€‚æ‰€ä»¥æˆ‘å°±æƒ³æ‰¾æ›´å¥½äº›çš„ GSIã€‚é—®äº†é‚£ä¸ªäººï¼Œç»“æœæ²¡å›å¤æˆ‘ã€‚ æœ€åæ‰¾åˆ°äº† Pixel Experience ï¼Œè™½ç„¶ä¾ç„¶æœ‰ä¸€äº› bugï¼Œä¸è¿‡æ„Ÿè§‰è¿˜å¯ä»¥ã€‚ æ”¾å‡ å¼ æˆªå›¾ï¼š æœ€åè¿˜æœ‰ä¸€ç‚¹ï¼Œè¿™æ¬¡æˆ‘æ˜¯ç”¨ Virtual Box ä¸­çš„ Win 10 è™šæ‹Ÿæœºåˆ·çš„ï¼Œè®© VirtualBox ä¸­çš„ Win 10 è™šæ‹Ÿæœºè¿æ¥ä¸Š Android è®¾å¤‡ï¼Œéœ€è¦ç»™ VirtualBox å®‰è£… extension packï¼Œåœ¨ Win 10 è™šæ‹Ÿæœºä¸­å®‰è£… guest additionsï¼Œç„¶åè¿˜éœ€è¦åœ¨æ­¤ win 10 è™šæ‹Ÿæœºçš„è®¾ç½®ä¸­æ·»åŠ å¯¹åº”çš„ USB filter (éœ€è¦è®¾å¤‡è¿æ¥ä¸Šåæ‰èƒ½æ·»åŠ )ï¼Œå¹¶æŒ‰ç…§ USB ç±»å‹å‹¾é€‰ USB 2.0 è¿˜æ˜¯ 3.0ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š æœ€åï¼Œåœ¨è®¾å¤‡è¿æ¥ä¸Šç”µè„‘åï¼ŒæŠŠ win 10 çš„çª—å£æ”¾åœ¨æœ€å‰é¢ï¼Œç„¶åå† macOS çš„èœå•æ å‹¾é€‰å¯¹åº”çš„ USB deviceï¼Œå‹¾é€‰çš„è¯ï¼Œå°±æ˜¯ win 10 è™šæ‹Ÿæœºè¿æ¥è¯ USB è®¾å¤‡ï¼Œå¦åˆ™é©¾é©¶ macOS è¿æ¥æ­¤ USB deviceï¼Œå¦‚ä¸‹å›¾ï¼š 2019 å¹´ 5 æœˆ 29 æ—¥æ›´æ–° æœ€è¿‘å¾—çŸ¥ä¸‰æ˜Ÿå·²ç»ç»™ä¸€äº›è®¾å¤‡æ¨é€äº† Android Pie çš„æ›´æ–°ï¼Œè€Œç»„é‡Œé¢å‡ éƒ¨ Tab S4 éƒ½æ˜¯è¿è¡Œå›½å†…ç‰ˆç³»ç»Ÿçš„å›½è¡Œæœºå™¨ï¼Œæ‰€ä»¥æ²¡æœ‰æ”¶åˆ°æ›´æ–°é€šçŸ¥ï¼Œæ‰€ä»¥æˆ‘å°±æœ‰äº†æŠŠæˆ‘æ‰‹é‡Œçš„ Tab S4 åˆ·å›åŸºäº Android Pie çš„å›½å¤–ç‰ˆä¸‰æ˜Ÿç³»ç»Ÿã€‚ æ­¥éª¤å¾ˆç®€å•ï¼Œå…ˆç”¨ SamFirm tool ä¸‹è½½åŸºäº Android Pie çš„ stock firmware åŒ…ï¼Œç„¶åè®¾å¤‡å…ˆè¿›å…¥ TWRP recovery (æˆ‘ä¹‹å‰åˆ·äº† TWRPï¼Œæ‰€ä»¥æœ‰è¿™ä¸ª)ï¼Œç„¶åç‚¹ Reboot å†ç‚¹ Download å³å¯è¿›å…¥ä¸‰æ˜Ÿè®¾å¤‡çš„ Download æ¨¡å¼ï¼Œç„¶åå°±æ˜¯å¾ˆç®€å•åœ°ä½¿ç”¨ odin å·¥å…·æŠŠç³»ç»Ÿåˆ·è¿›å»å°±å¥½äº†ã€‚ æ³¨æ„ Download æ¨¡å¼å’Œ Recovery æ˜¯ä¸ä¸€æ ·çš„ã€‚TWRP æ˜¯ custom recoveryï¼Œè€Œä¸‰æ˜Ÿè‡ªå¸¦çš„ recovery æ˜¯ç±»ä¼¼ä¸‹é¢è¿™æ ·çš„: å³ä½¿ç”¨ TWRP å–ä»£äº†è‡ªå¸¦çš„ Recoveryï¼Œæˆ‘ä»¬ä¾ç„¶å¯ä»¥è¿›å…¥ Download æ¨¡å¼ï¼Œä»è€Œç”¨ odin åˆ·å›åˆ°å®˜æ–¹ firmwareã€‚","categories":[],"tags":[{"name":"GSI","slug":"GSI","permalink":"https://tao93.top/tags/GSI/"},{"name":"Project Treble","slug":"Project-Treble","permalink":"https://tao93.top/tags/Project-Treble/"}]},{"title":"Android Toast ä¸¤ä¸ª Crash","slug":"Android Toast ä¸¤ä¸ª Crash","date":"2018-12-22T15:05:48.751Z","updated":"2019-07-05T14:01:06.385Z","comments":true,"path":"2018/12/22/Android Toast ä¸¤ä¸ª Crash/","link":"","permalink":"https://tao93.top/2018/12/22/Android Toast ä¸¤ä¸ª Crash/","excerpt":"","text":"Toast æ˜¯ Android ç³»ç»Ÿä¸€ç§éå¸¸ç®€å•çš„æç¤ºæ€§å°å·¥å…·ï¼Œæœ€è¿‘æˆ‘å°è¯•ä¿®å¤ Toast ç›¸å…³çš„ä¸¤ç§ Crashï¼Œæ‰€ä»¥æŠŠç›¸å…³çš„åŸå§”å’Œè¿‡ç¨‹è®°å½•äº†ä¸‹æ¥ã€‚å…ˆæ¥çœ‹ä¸€ä¸‹ç¬¬ä¸€ç§ Crash çš„ log: 12345678910android.view.WindowManager$BadTokenException: Unable to add window -- token android.os.BinderProxy@e2815e is not valid; is your activity running? at android.view.ViewRootImpl.setView(ViewRootImpl.java:679) at android.view.WindowManagerGlobal.addView(WindowManagerGlobal.java:342) at android.view.WindowManagerImpl.addView(WindowManagerImpl.java:93) at android.widget.Toast$TN.handleShow(Toast.java:459) at android.widget.Toast$TN$2.handleMessage(Toast.java:342) at android.os.Handler.dispatchMessage(Handler.java:102) at android.os.Looper.loop(Looper.java:154) at android.app.ActivityThread.main(ActivityThread.java:6119) at java.lang.reflect.Method.invoke(Native Method) ä¸Šé¢çš„ stack trace ä¸­çš„ä»£ç å…¨éƒ¨æ˜¯å…³äº UI çº¿ç¨‹ä¸­å¤„ç†ä¸€ä¸ªæ¶ˆæ¯çš„ï¼Œè¿™ä¸ªæ¶ˆæ¯éœ€è¦åšçš„æ˜¯æŠŠ Toast éœ€è¦æ˜¾ç¤ºçš„ view æ·»åŠ åˆ° WindowManager ä¸­ï¼Œä»è€Œå¯ä»¥æ˜¾ç¤ºå‡ºæ¥ã€‚è¿™æ ·çš„ crash æ˜¯æ²¡æœ‰ä»»ä½• app ä»£ç ç‰µæ¶‰å…¶ä¸­çš„ï¼Œæ‰€ä»¥æ— æ³•ç¡®å®šæ˜¯ app ä½•å¤„çš„ä»£ç å¯¼è‡´çš„è¿™ä¸ª crashã€‚æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹ Toast æ˜¾ç¤ºçš„å¤§è‡´è¿‡ç¨‹ã€‚ é¦–å…ˆæ˜¯é€šè¿‡ Toast#makeText æ–¹æ³•æˆ–è€… Toast æ„é€ å‡½æ•°åˆ›å»º Toast å¯¹è±¡ï¼Œç„¶åå°±å¯ä»¥è°ƒç”¨å®ƒçš„ show æ–¹æ³•äº†ã€‚ä¸è¿‡æ­¤æ–¹æ³•æ˜¯å¼‚æ­¥çš„ï¼Œå®ƒä»…ä»…æ˜¯å°†è¯¥ toast æ·»åŠ åˆ°ä¸€ä¸ªé˜Ÿåˆ—ä¸­ï¼Œç­‰å¾…æ˜¾ç¤ºï¼Œå³æ­¤æ–¹æ³•ä¸ç­‰ toast çœŸæ­£æ˜¾ç¤ºå°±å·²ç»è¿”å›äº†ï¼Œè€Œ toast çš„æ˜¾ç¤ºéœ€è¦ç”¨ä¸€ä¸ªæ–°çš„ UI çº¿ç¨‹æ¶ˆæ¯ä¸­çš„ä»£ç æ¥æ˜¾ç¤ºå‡ºæ¥ã€‚ Toast#show æ–¹æ³•ï¼š 12345678910111213141516171819/** * Show the view for the specified duration. */public void show() &#123; if (mNextView == null) &#123; throw new RuntimeException(\"setView must have been called\"); &#125; INotificationManager service = getService(); String pkg = mContext.getOpPackageName(); TN tn = mTN; tn.mNextView = mNextView; try &#123; service.enqueueToast(pkg, tn, mDuration); &#125; catch (RemoteException e) &#123; // Empty &#125;&#125; ä¸Šé¢ä»£ç çš„ç¬¬ 15 è¡Œæ˜¯ä¸€ä¸ªè·¨è¿›ç¨‹è°ƒç”¨äº† NotificationServiceManager çš„æ–¹æ³•ï¼Œè€Œä½œä¸ºå‚æ•°çš„ TN å¯¹è±¡æ˜¯å®ç°äº† IInterface çš„ï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡ Binder ä¼ ç»™å…¶ä»–è¿›ç¨‹ã€‚Toast çœŸæ­£çš„æ˜¾ç¤ºï¼Œéœ€è¦ç­‰ NotificationServiceManager å›è°ƒå›æ¥ï¼Œè¿™ä¸ªå›è°ƒä¹Ÿå°±æ˜¯è°ƒç”¨ Toast å†…éƒ¨ç±» TN çš„ show æ–¹æ³•ã€‚è€Œä» api 25 å¼€å§‹ï¼Œæ­¤æ–¹æ³•è¿˜ä¼šå°† NotificationServiceManager äº§ç”Ÿçš„ä¸€ä¸ª window token ä¼ é€’è¿‡æ¥ã€‚ api 25 ä¸­çš„ TN#show æ–¹æ³•ï¼š 12345678/** * schedule handleShow into the right thread */@Overridepublic void show(IBinder windowToken) &#123; if (localLOGV) Log.v(TAG, \"SHOW: \" + this); mHandler.obtainMessage(0, windowToken).sendToTarget();&#125; api 24 ä¸­çš„ TN#show æ–¹æ³•ï¼š 12345678/** * schedule handleShow into the right thread */@Overridepublic void show() &#123; if (localLOGV) Log.v(TAG, \"SHOW: \" + this); mHandler.post(mShow);&#125; æ­¤ TN#show æ–¹æ³•æ˜¯è¢«è¿œç¨‹è°ƒç”¨çš„ï¼Œæ‰€ä»¥å®é™…ä¼šè¿è¡Œåœ¨ app çš„ Binder çº¿ç¨‹æ± çš„çº¿ç¨‹ä¸­ï¼Œæ‰€ä»¥æ­¤æ–¹æ³•å‘ä¸»çº¿ç¨‹å‘äº†ä¸€ä¸ªæ¶ˆæ¯ï¼Œè¿™ä¸ªæ¶ˆæ¯æ‰æ˜¯çœŸæ­£è®© toast æ˜¾ç¤ºçš„åœ°æ–¹ã€‚ä¸åŒçš„æ˜¯ api 25 çš„ä»£ç è¿˜ä¼šæŠŠ window token ä¹Ÿä¼ é€’åˆ°æ¶ˆæ¯ä¸­ã€‚å¤„ç†è¿™ä¸ªæ¶ˆæ¯çš„ä»£ç ï¼Œä¼šè°ƒç”¨ TN#handleShow æ–¹æ³•ï¼Œè¿™ä¸ª handleShow æ˜¯ä¸‹é¢è¿™æ ·çš„ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940public void handleShow() &#123; if (localLOGV) Log.v(TAG, \"HANDLE SHOW: \" + this + \" mView=\" + mView + \" mNextView=\" + mNextView); if (mView != mNextView) &#123; // remove the old view if necessary handleHide(); mView = mNextView; Context context = mView.getContext().getApplicationContext(); String packageName = mView.getContext().getOpPackageName(); if (context == null) &#123; context = mView.getContext(); &#125; mWM = (WindowManager)context.getSystemService(Context.WINDOW_SERVICE); // We can resolve the Gravity here by using the Locale for getting // the layout direction final Configuration config = mView.getContext().getResources().getConfiguration(); final int gravity = Gravity.getAbsoluteGravity(mGravity, config.getLayoutDirection()); mParams.gravity = gravity; if ((gravity &amp; Gravity.HORIZONTAL_GRAVITY_MASK) == Gravity.FILL_HORIZONTAL) &#123; mParams.horizontalWeight = 1.0f; &#125; if ((gravity &amp; Gravity.VERTICAL_GRAVITY_MASK) == Gravity.FILL_VERTICAL) &#123; mParams.verticalWeight = 1.0f; &#125; mParams.x = mX; mParams.y = mY; mParams.verticalMargin = mVerticalMargin; mParams.horizontalMargin = mHorizontalMargin; mParams.packageName = packageName; mParams.removeTimeoutMilliseconds = mDuration == Toast.LENGTH_LONG ? LONG_DURATION_TIMEOUT : SHORT_DURATION_TIMEOUT; if (mView.getParent() != null) &#123; if (localLOGV) Log.v(TAG, \"REMOVE! \" + mView + \" in \" + this); mWM.removeView(mView); &#125; if (localLOGV) Log.v(TAG, \"ADD! \" + mView + \" in \" + this); mWM.addView(mView, mParams); trySendAccessibilityEvent(); &#125;&#125; ä¸Šé¢ä»£ç çš„ç¬¬ 37 è¡Œï¼Œæ‰æ˜¯çœŸæ­£æŠŠ toast çš„ view æ·»åŠ åˆ° WindowManagerï¼Œä¹Ÿå°±æ˜¯è®© toast æ˜¾ç¤ºå‡ºæ¥ï¼Œè‡³æ­¤ç†äº†ä¸€é toast æ˜¾ç¤ºçš„æµç¨‹ã€‚è€Œæœ€å‰é¢çš„ crash log è¡¨æ˜ï¼Œcrash æ˜¯å‘ç”Ÿåœ¨ ViewRootImpl#setView æ–¹æ³•ä¸­çš„ï¼Œå¹¶ä¸”æç¤º window token invalidã€‚è¿™å…¶å®å°±æ˜¯æç¤º ä» NotificationManagerService ä¼ è¿‡æ¥ç»™ TN çš„ token å¯¹è±¡å¤±æ•ˆäº†ã€‚è€Œå¤±æ•ˆçš„åŸå› ï¼Œå…¶å®å¾—ä» NotificationManagerService ä¸­æ‰¾ã€‚ NotificationManagerService#showNextToastLocked æ–¹æ³•ï¼š 12345678910111213141516171819202122232425void showNextToastLocked() &#123; ToastRecord record = mToastQueue.get(0); while (record != null) &#123; if (DBG) Slog.d(TAG, \"Show pkg=\" + record.pkg + \" callback=\" + record.callback); try &#123; record.callback.show(record.token); scheduleTimeoutLocked(record); return; &#125; catch (RemoteException e) &#123; Slog.w(TAG, \"Object died trying to show notification \" + record.callback + \" in package \" + record.pkg); // remove it from the list and let the process die int index = mToastQueue.indexOf(record); if (index &gt;= 0) &#123; mToastQueue.remove(index); &#125; keepProcessAliveIfNeededLocked(record.pid); if (mToastQueue.size() &gt; 0) &#123; record = mToastQueue.get(0); &#125; else &#123; record = null; &#125; &#125; &#125;&#125; æ­¤æ–¹æ³•å°±æ˜¯ NotificationManagerService å‘èµ·æ˜¾ç¤ºä¸‹ä¸€ä¸ª toast çš„ä»£ç ï¼Œæ³¨æ„åˆ°ç¬¬ 6 è¡Œè°ƒç”¨çš„ show æ–¹æ³•ï¼Œå…¶å®å°±æ˜¯è¿œç¨‹è°ƒç”¨ TN å¯¹è±¡çš„ show æ–¹æ³•ï¼Œè€Œç¬¬ 6 è¡Œçš„ callback å…¶å®å°±æ˜¯ TN å¯¹è±¡æ‰€å¯¹åº”çš„è¿œç¨‹ä»£ç†å¯¹è±¡ã€‚ç´§æ¥ç€ç¬¬ 7 è¡Œè°ƒç”¨çš„ scheduleTimeoutLocked æ–¹æ³•ï¼Œå…¶å®è®¾å®šäº†ä¸€ä¸ªå¤±æ•ˆé™åˆ¶ï¼Œä½¿å¾—ç¬¬ 6 è¡Œä¼ é€’çš„ token ä¼šåœ¨å‡ ç§’å†…å¤±æ•ˆã€‚ scheduleTimeoutLocked æ–¹æ³• 1234567private void scheduleTimeoutLocked(ToastRecord r)&#123; mHandler.removeCallbacksAndMessages(r); Message m = Message.obtain(mHandler, MESSAGE_TIMEOUT, r); long delay = r.duration == Toast.LENGTH_LONG ? LONG_DELAY : SHORT_DELAY; mHandler.sendMessageDelayed(m, delay);&#125; ä¸Šé¢ä»£ç å‘é€ä¸€ä¸ª delayed æ¶ˆæ¯(æˆªæ­¢ api 27ï¼Œæ­¤ delay æ—¶é•¿æ˜¯ 2 ç§’æˆ– 3.5 ç§’ï¼‰ï¼Œå¤„ç†ä¸Šé¢æ–¹æ³•å‘é€çš„æ¶ˆæ¯çš„ä»£ç ï¼š 1234567891011@Overridepublic void handleMessage(Message msg)&#123; switch (msg.what) &#123; case MESSAGE_TIMEOUT: handleTimeout((ToastRecord)msg.obj); break; ... &#125;&#125; ä¸Šé¢è¢«è°ƒç”¨çš„ handleTimeOut æ–¹æ³•ï¼š 12345678910private void handleTimeout(ToastRecord record)&#123; if (DBG) Slog.d(TAG, \"Timeout pkg=\" + record.pkg + \" callback=\" + record.callback); synchronized (mToastQueue) &#123; int index = indexOfToastLocked(record.pkg, record.callback); if (index &gt;= 0) &#123; cancelToastLocked(index); &#125; &#125;&#125; ä¸Šé¢ç¬¬ 7 è¡Œè¢«è°ƒç”¨çš„ cancelToastLocked æ–¹æ³•ï¼š 12345678910111213141516171819202122 void cancelToastLocked(int index) &#123; ToastRecord record = mToastQueue.get(index); try &#123; record.callback.hide(); &#125; catch (RemoteException e) &#123; Slog.w(TAG, \"Object died trying to hide notification \" + record.callback + \" in package \" + record.pkg); // don't worry about this, we're about to remove it from // the list anyway &#125; ToastRecord lastToast = mToastQueue.remove(index); mWindowManagerInternal.removeWindowToken(lastToast.token, true, DEFAULT_DISPLAY); keepProcessAliveIfNeededLocked(record.pid); if (mToastQueue.size() &gt; 0) &#123; // Show the next one. If the callback fails, this will remove // it from the list, so don't assume that the list hasn't changed // after this point. showNextToastLocked(); &#125;&#125; ä¸Šé¢ç¬¬ 13 è¡Œå°±æ˜¯ä½¿ window token å¤±æ•ˆçš„ä»£ç ã€‚è‡³æ­¤å¯çŸ¥ï¼ŒNotificationServiceManager è¿œç¨‹è°ƒç”¨ TN#show æ–¹æ³•åå‡ ç§’å†…ï¼Œæ­¤ token å°±ä¼šå¤±æ•ˆï¼Œåœ¨è¿™å‡ ç§’å†…å¦‚æœ toast æ²¡æœ‰çœŸæ­£æ·»åŠ åˆ° WindowManagerï¼Œé‚£ä¹ˆç­‰æ·»åŠ çš„æ—¶å€™ï¼Œå°±ä¼šå‡ºç° BadTokenExceptionï¼Œåº”ç”¨å°±ä¼š crashã€‚è€Œé˜»ç¢ toast çš„ view è¢«æ·»åŠ åˆ° WindowManagerï¼Œåªæœ‰ UI çº¿ç¨‹çš„å¿™ç¢Œï¼Œä¹Ÿå°±æ˜¯å¦‚æœ UI çº¿ç¨‹å·²ç»åœ¨æ‰§è¡Œæˆ–è€…é©¬ä¸Šè¦æ‰§è¡Œçš„å…¶ä»–æ¶ˆæ¯æ¯”è¾ƒè€—æ—¶ï¼Œé‚£ä¹ˆ toast çš„ view å°±æ— æ³•åŠæ—¶æ·»åŠ ã€‚ ä¸è¿‡ï¼ŒGoogle ä¹Ÿæ„è¯†åˆ°è¿™ç§ UI çº¿ç¨‹ block ä¸åˆ° ANR æ—¶é•¿å°± crash çš„ç°è±¡äº†ï¼Œæ‰€ä»¥åœ¨ api 26 ä¸­ï¼Œæ­¤ BadTokenException ç›´æ¥è¢«æ•è·äº†ï¼Œä¹Ÿå°±æ˜¯ä¸‹é¢çš„ç¬¬ 42 è¡Œï¼š 1234567891011121314151617public void handleShow(IBinder windowToken) &#123; ... if (mView != mNextView) &#123; ... if (localLOGV) Log.v(TAG, \"ADD! \" + mView + \" in \" + this); // Since the notification manager service cancels the token right // after it notifies us to cancel the toast there is an inherent // race and we may attempt to add a window after the token has been // invalidated. Let us hedge against that. try &#123; mWM.addView(mView, mParams); trySendAccessibilityEvent(); &#125; catch (WindowManager.BadTokenException e) &#123; /* ignore */ &#125; &#125;&#125; æ‰€ä»¥æ­¤ crashï¼Œä»…ä»…å‘ç”Ÿåœ¨ api 25 çš„ç³»ç»Ÿä¸­ï¼Œè¦ä¿®å¤è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥å‚è€ƒ github ä¸Šçš„ ToastCompat ä¸­çš„æ–¹æ³•ã€‚ å†æ¥çœ‹ä¸€ä¸‹å¦ä¸€ç§ Crash logï¼š 1234567891011121314java.lang.IllegalStateException: View android.widget.LinearLayout&#123;41a97eb8 V.E..... ......ID 0,0-540,105 #7f0b020d app:id/toast_layout_root&#125; has already been added to the window manager. at android.view.WindowManagerGlobal.addView(WindowManagerGlobal.java:223) at android.view.WindowManagerImpl.addView(WindowManagerImpl.java:69) at android.widget.Toast$TN.handleShow(Toast.java:402) at android.widget.Toast$TN$1.run(Toast.java:310) at android.os.Handler.handleCallback(Handler.java:730) at android.os.Handler.dispatchMessage(Handler.java:92) at android.os.Looper.loop(Looper.java:137) at android.app.ActivityThread.main(ActivityThread.java:5136) at java.lang.reflect.Method.invokeNative(Method.java) at java.lang.reflect.Method.invoke(Method.java:525) at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:737) at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:553) at dalvik.system.NativeStart.main(NativeStart.java) è¿™ä¸ª crash åŸå› æ˜¯åŒä¸€ä¸ª view è¢«é‡å¤æ·»åŠ åˆ° WindowManager å¯¼è‡´çš„ã€‚æŠ›å‡ºå¼‚å¸¸çš„åœ°æ–¹æ˜¯ WindowManagerGlobal#addView æ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯ä¸‹é¢çš„ä»£ç ç¬¬ 15 è¡Œï¼š 1234567891011121314151617181920public void addView(View view, ViewGroup.LayoutParams params, Display display, Window parentWindow) &#123; if (view == null) &#123; throw new IllegalArgumentException(\"view must not be null\"); &#125; if (display == null) &#123; throw new IllegalArgumentException(\"display must not be null\"); &#125; ... int index = findViewLocked(view, false); if (index &gt;= 0) &#123; if (mDyingViews.contains(view)) &#123; // Don't wait for MSG_DIE to make it's way through root's queue. mRoots.get(index).doDie(); &#125; else &#123; throw new IllegalStateException(\"View \" + view + \" has already been added to the window manager.\"); &#125; // The previous removeView() had not completed executing. Now it has. &#125; ä»ä¸Šé¢ä»£ç å¯çŸ¥ï¼Œç¬¬ 10 è¡Œ index éè´Ÿï¼Œä¸” mDyingViews åŒ…å«éœ€æ·»åŠ çš„ viewï¼Œåˆ™ä¼šæŠ›å‡ºæ­¤å¼‚å¸¸ã€‚ç¬¬ 10 è¡Œ index éè´Ÿçš„åŸå› ï¼Œæ˜¯ mViews åŒ…å«æ­¤ viewï¼Œå¦‚ä¸‹é¢ä»£ç æ‰€ç¤ºï¼š 1234567private int findViewLocked(View view, boolean required) &#123; final int index = mViews.indexOf(view); if (required &amp;&amp; index &lt; 0) &#123; throw new IllegalArgumentException(\"View=\" + view + \" not attached to window manager\"); &#125; return index;&#125; æ‰€ä»¥ï¼Œä¹Ÿå°±æ˜¯å½“éœ€è¦æ·»åŠ ä¸€ä¸ª view æ—¶ï¼Œå¦‚æœæ­¤ view åœ¨ mViews ä¸­å´ä¸åœ¨ mDyingViews ä¸­ï¼Œé‚£å°±ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚ç°åœ¨æˆ‘ä»¬çœ‹ä¸€ä¸‹ Toast#TN#handleShow æ–¹æ³•ï¼š 123456789101112131415161718192021public void handleShow(IBinder windowToken) &#123; ... if (mView != mNextView) &#123; ... if (mView.getParent() != null) &#123; if (localLOGV) Log.v(TAG, \"REMOVE! \" + mView + \" in \" + this); mWM.removeView(mView); &#125; if (localLOGV) Log.v(TAG, \"ADD! \" + mView + \" in \" + this); // Since the notification manager service cancels the token right // after it notifies us to cancel the toast there is an inherent // race and we may attempt to add a window after the token has been // invalidated. Let us hedge against that. try &#123; mWM.addView(mView, mParams); trySendAccessibilityEvent(); &#125; catch (WindowManager.BadTokenException e) &#123; /* ignore */ &#125; &#125;&#125; ä¸Šé¢ä»£ç æ˜¾ç¤ºï¼Œå®é™…ä¸Šï¼ŒToast è¢«ç°å®æ—¶ï¼Œå…¶å®ä¼šå…ˆæŠŠ view ä» WindowManager ç§»é™¤ï¼ˆæ³¨æ„ä¸€ä¸‹ç§»é™¤çš„å‰ææ˜¯ view çš„ parent ä¸ç©ºï¼‰ï¼Œç„¶åå†å°è¯•æ·»åŠ ã€‚æˆ‘ä»¬çœ‹çœ‹ WindowManagerGlobal#removeView æ–¹æ³•ï¼š 1234567891011121314151617public void removeView(View view, boolean immediate) &#123; if (view == null) &#123; throw new IllegalArgumentException(\"view must not be null\"); &#125; synchronized (mLock) &#123; int index = findViewLocked(view, true); View curView = mRoots.get(index).getView(); removeViewLocked(index, immediate); if (curView == view) &#123; return; &#125; throw new IllegalStateException(\"Calling with view \" + view + \" but the ViewAncestor is attached to \" + curView); &#125;&#125; éœ€è¦æ³¨æ„ä¸Šé¢æ–¹æ³•æœ‰ä¸ª immediate å‚æ•°ï¼Œä¸è¿‡ä» Toast#TN#handleShow è°ƒç”¨è¿‡æ¥æ—¶ï¼Œè¿™ä¸ªå‚æ•°ä¼šæ˜¯ falseã€‚ç°åœ¨å‡è®¾ view åŒ…å«åœ¨ mViews ä¸­ï¼Œé‚£ä¹ˆä¸Šé¢ç¬¬ 7 è¡Œ index å°†éè´Ÿï¼Œä¸Šé¢ç¬¬ 9 è¡Œè°ƒç”¨äº† removeViewLocked æ–¹æ³•ï¼š 123456789101112131415161718private void removeViewLocked(int index, boolean immediate) &#123; ViewRootImpl root = mRoots.get(index); View view = root.getView(); if (view != null) &#123; InputMethodManager imm = InputMethodManager.getInstance(); if (imm != null) &#123; imm.windowDismissed(mViews.get(index).getWindowToken()); &#125; &#125; boolean deferred = root.die(immediate); if (view != null) &#123; view.assignParent(null); if (deferred) &#123; mDyingViews.add(view); &#125; &#125;&#125; ä¸Šé¢ä»£ç  ç¬¬ 11 è¡Œå› ä¸º immediate ä¸º falseï¼Œæ‰€ä»¥è¿”å›çš„ deferred æ˜¯ trueï¼Œé‚£ä¹ˆç¬¬ 15 è¡Œå°±ä¼šæŠŠ view æ·»åŠ åˆ° mDyingViewsã€‚ è‡³æ­¤æ€»ç»“ä¸€ä¸‹ï¼Œåªè¦ view çš„ parent ä¸ç©ºï¼Œé‚£ä¹ˆå®ƒå°±ä¼šå°è¯•è¢«ç§»é™¤ï¼Œå¦‚æœ mViewæ˜¯ä¸­æœ‰æ¬¡ viewï¼Œåˆ™å°è¯•ç§»é™¤çš„ç»“æœå°±æ˜¯ mDyingViews ä¹Ÿä¼šåŒ…å«æ­¤ viewï¼Œåˆ™ crash ä¸ä¼šå‘ç”Ÿã€‚ ç»è¿‡åˆ†æç³»ç»Ÿä»£ç ï¼Œæˆ‘å‘ç°ç»™ view è®¾ç½® parent æ˜¯åœ¨ ViewRootImpl ä¸­çš„ setView æ–¹æ³•è°ƒç”¨ view.assignParent(this) åšåˆ°çš„ï¼Œè€Œ ViewRootImpl #setView æ˜¯åœ¨ WindowManagerGlobal#addView è°ƒç”¨çš„ã€‚ç½®ç©º parent åˆ™æ˜¯åœ¨ WindowManagerGlobal#removeViewLocked åšçš„ï¼Œè€Œä» mViews ç§»é™¤ view æ˜¯åœ¨ WindowManagerGlobal#doRemoveView åšçš„ï¼š 1234567891011121314void doRemoveView(ViewRootImpl root) &#123; synchronized (mLock) &#123; final int index = mRoots.indexOf(root); if (index &gt;= 0) &#123; mRoots.remove(index); mParams.remove(index); final View view = mViews.remove(index); mDyingViews.remove(view); &#125; &#125; if (ThreadedRenderer.sTrimForeground &amp;&amp; ThreadedRenderer.isAvailable()) &#123; doTrimForeground(); &#125;&#125; ç”±äºè¿™äº›æ–¹æ³•éƒ½æ˜¯åœ¨ä¸»çº¿ç¨‹è°ƒç”¨çš„ï¼Œæ‰€ä»¥å¯ä»¥è‚¯å®šï¼Œåœ¨ addView æ—¶ï¼ŒmView åŒ…å« view æ—¶ï¼Œåˆ™æ­¤ view çš„ parentä¸ç©ºã€‚è€Œ mView ä¸åŒ…å« view æ—¶ï¼Œå®ƒçš„ parent ä¸ºç©ºã€‚çœ‹èµ·æ¥ä¼¼ä¹æ— æ‡ˆå¯å‡»ï¼Œç³»ç»Ÿä»£ç ç¡®ä¿äº† toast çš„æ˜¾ç¤ºä¸ä¼šå‡ºç°é‡å¤æ·»åŠ  view å¯¼è‡´çš„ IllegalStateExceptionã€‚ä½†æ˜¯æ˜æ˜ crash å°±æ˜¯å‘ç”Ÿäº†ï¼Œåˆ†æå †æ ˆä¹Ÿå¯çŸ¥å°±æ˜¯å‡ºç°äº† view åœ¨ mViews ä¸­ä½†å´ä¸åœ¨ mDyingViews ä¸­çš„æƒ…å†µã€‚ ç»è¿‡åˆ†æï¼Œæˆ‘å¯èƒ½æ‰¾åˆ°äº†ä¸€ç§åŸå› ã€‚å…ˆæ¥çœ‹ WindowManagerGlobal#addView æ–¹æ³•ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940public void addView(View view, ViewGroup.LayoutParams params, Display display, Window parentWindow) &#123; ... ViewRootImpl root; View panelParentView = null; synchronized (mLock) &#123; ... int index = findViewLocked(view, false); if (index &gt;= 0) &#123; if (mDyingViews.contains(view)) &#123; // Don't wait for MSG_DIE to make it's way through root's queue. mRoots.get(index).doDie(); &#125; else &#123; throw new IllegalStateException(\"View \" + view + \" has already been added to the window manager.\"); &#125; // The previous removeView() had not completed executing. Now it has. &#125; ... root = new ViewRootImpl(view.getContext(), display); view.setLayoutParams(wparams); mViews.add(view); mRoots.add(root); mParams.add(wparams); // do this last because it fires off messages to start doing things try &#123; root.setView(view, wparams, panelParentView); &#125; catch (RuntimeException e) &#123; // BadTokenException or InvalidDisplayException, clean up. if (index &gt;= 0) &#123; removeViewLocked(index, true); &#125; throw e; &#125; &#125; &#125; é¦–å…ˆä¸Šé¢ä»£ç å¯èƒ½å­˜åœ¨ä¸€å¤„æ¼æ´ã€‚å‡è®¾ view ä¹‹å‰ä»æœªæ·»åŠ è¿‡ï¼Œé‚£ä¹ˆä½ 9 è¡Œè¿”å› -1ï¼Œç¬¬ 25 è‡³ 27 è¡ŒæŠŠ view æ·»åŠ åˆ°äº† mViews ä¸­ï¼Œç„¶åå‡è®¾æ­¤ view æ·»åŠ è¿‡ç¨‹ä¸­å¤±è´¥äº†ï¼Œå³ç¬¬ 31 è¡ŒæŠ›å‡ºäº†å¼‚å¸¸ï¼Œå¯æ˜¯æ­¤æ—¶ index æ˜¯ -1ï¼Œæ‰€ä»¥ç¬¬ 15 è¡Œä¼å›¾ç§»é™¤æ­¤ view æ˜¯åšä¸åˆ°çš„ï¼Œäºæ˜¯æ­¤ view å°±ç•™åœ¨äº† mViews ä¸­ï¼Œè¿™å¯èƒ½æ˜¯ç³»ç»Ÿçš„ç§»é™¤æ¼æ´ã€‚å¦ä¸€ç§æƒ…å†µï¼Œå‡è®¾ç¬¬ 9 è¡Œè¿”å›éè´Ÿå€¼ï¼Œé‚£ä¹ˆæ­¤ view åœ¨ç¬¬ 13 è¡Œä¼šç«‹å³ç§»é™¤ï¼Œç¬¬ 25 è¡Œé‡æ–°æ·»åŠ åˆ° mView ä¸­æ—¶ï¼Œæ­¤ view æ–°çš„ index å·²ç»ä¸æ˜¯ç¬¬ 9 è¡Œçš„å€¼äº†ï¼Œç„¶åå¦‚æœç¬¬ 31 è¡Œæ·»åŠ å¤±è´¥ï¼Œé‚£ä¹ˆç¬¬ 35 è¡Œå°†ä¼šè¢«æ‰§è¡Œï¼Œå¯æ˜¯ index æ˜¯é”™è¯¯çš„ï¼Œè¿™å°†ä¼šå¯¼è‡´é”™è¯¯çš„ view è¢«ç§»é™¤ï¼ ä¸Šé¢å¯èƒ½çš„æ¼æ´è¦å‘ç”Ÿï¼Œéœ€è¦ç¬¬ 35 è¡ŒæŠ›å‡ºå¼‚å¸¸ï¼Œè€ŒæŸ¥çœ‹ ViewRootImpl#setView æ–¹æ³•å¯çŸ¥ï¼Œå¦‚æœå¼‚å¸¸æŠ›å‡ºï¼Œé‚£ä¹ˆ view çš„ parent å°†å°šæœªè®¾ç½®: 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657public void setView(View view, WindowManager.LayoutParams attrs, View panelParentView) &#123; synchronized (this) &#123; if (mView == null) &#123; ... if (res &lt; WindowManagerGlobal.ADD_OKAY) &#123; mAttachInfo.mRootView = null; mAdded = false; mFallbackEventHandler.setView(null); unscheduleTraversals(); setAccessibilityFocus(null, null); switch (res) &#123; case WindowManagerGlobal.ADD_BAD_APP_TOKEN: case WindowManagerGlobal.ADD_BAD_SUBWINDOW_TOKEN: throw new WindowManager.BadTokenException( \"Unable to add window -- token \" + attrs.token + \" is not valid; is your activity running?\"); case WindowManagerGlobal.ADD_NOT_APP_TOKEN: throw new WindowManager.BadTokenException( \"Unable to add window -- token \" + attrs.token + \" is not for an application\"); case WindowManagerGlobal.ADD_APP_EXITING: throw new WindowManager.BadTokenException( \"Unable to add window -- app for token \" + attrs.token + \" is exiting\"); case WindowManagerGlobal.ADD_DUPLICATE_ADD: throw new WindowManager.BadTokenException( \"Unable to add window -- window \" + mWindow + \" has already been added\"); case WindowManagerGlobal.ADD_STARTING_NOT_NEEDED: // Silently ignore -- we would have just removed it // right away, anyway. return; case WindowManagerGlobal.ADD_MULTIPLE_SINGLETON: throw new WindowManager.BadTokenException(\"Unable to add window \" + mWindow + \" -- another window of type \" + mWindowAttributes.type + \" already exists\"); case WindowManagerGlobal.ADD_PERMISSION_DENIED: throw new WindowManager.BadTokenException(\"Unable to add window \" + mWindow + \" -- permission denied for window type \" + mWindowAttributes.type); case WindowManagerGlobal.ADD_INVALID_DISPLAY: throw new WindowManager.InvalidDisplayException(\"Unable to add window \" + mWindow + \" -- the specified display can not be found\"); case WindowManagerGlobal.ADD_INVALID_TYPE: throw new WindowManager.InvalidDisplayException(\"Unable to add window \" + mWindow + \" -- the specified window type \" + mWindowAttributes.type + \" is not valid\"); &#125; throw new RuntimeException( \"Unable to add window -- unknown error code \" + res); &#125; ... view.assignParent(this); ... &#125; &#125;&#125; ä»ä¸Šé¢ä»£ç å¯çŸ¥ï¼Œå¦‚æœæŠ›å‡ºå¼‚å¸¸ï¼Œview.assignParent(this) å°†æœªè¢«è°ƒç”¨ã€‚ è‡³æ­¤ï¼Œå¯å°†æˆ‘çš„çŒœæµ‹æ€»ç»“ä¸ºï¼šå½“ä½¿ç”¨åŒä¸€ä¸ª view å¤šæ¬¡æ˜¾ç¤º toast æ—¶ï¼Œå¯èƒ½æŸä¸€æ¬¡æ·»åŠ å¤±è´¥ï¼Œå¯¼è‡´ view ç•™åœ¨ mViews ä¸­ï¼Œå¯æ˜¯ view çš„ parent åˆå› ä¸ºæ·»åŠ å¤±è´¥è€Œä¸ºç©ºï¼Œæ‰€ä»¥ Toast#TN#handleShow æ–¹æ³•æ²¡æœ‰è°ƒç”¨ä» WindowManager ç§»é™¤æ­¤ view çš„ä»£ç ï¼Œæ‰€ä»¥ WindowManagerGlobal#addView è¢«è°ƒç”¨æ—¶ï¼Œview ä¸åœ¨ mDyingViews ä¸­ï¼Œæ‰€ä»¥ crash å‘ç”Ÿäº†ã€‚ å¯æ˜¯è¿™åªæ˜¯çŒœæµ‹ï¼Œæ— æ³•éªŒè¯çŒœæµ‹æ˜¯å¦æ­£ç¡®ã€‚ ----- ä»¥ä¸‹æ˜¯ 2019 å¹´ 1 æœˆ 11 æ—¥çš„æ›´æ–° ------ ç°å·²å‘ç°å¤ç°ç¬¬äºŒç§ crash (IllegalStateException: view has already been added to the window manager) çš„æ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯å¦‚ä¸‹çš„ä»£ç ï¼š 123456789101112131415161718192021222324public class MainActivity extends AppCompatActivity &#123; private View toastLayout; @Override protected void onCreate(Bundle savedInstanceState) &#123; super.onCreate(savedInstanceState); toastLayout = LayoutInflater.from(this).inflate(R.layout.connection_toast, null); findViewById(R.id.btn).setOnClickListener(new View.OnClickListener() &#123; @Override public void onClick(View v) &#123; Toast toast = new Toast(MainActivity.this); toast.setView(toastLayout); toast.show(); try &#123; Thread.sleep(1980); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; &#125; &#125; &#125;&#125; ä¸Šé¢çš„ä»£ç ï¼Œç‚¹å‡»å‡ æ¬¡æŒ‰é’®æ¥æ‰§è¡Œ onClick æ–¹æ³•ï¼Œå°±å¯ä»¥å¤ç° crashã€‚å¤ç°æ€è·¯æ˜¯ï¼Œå…ˆè®©å‰ä¸€ä¸ª toast æŠŠ view æ·»åŠ åˆ° WindowManagerï¼Œä½†è¦è®©å®ƒæ·»åŠ å¤±è´¥ï¼Œç„¶åç¬¬äºŒæ¬¡å¦ä¸€ä¸ª toast å†æ·»åŠ æ­¤ viewï¼Œæ­¤æ¬¡å‘ç”Ÿ crashï¼Œè¿™ä¸ªæ€è·¯ä¹Ÿæ˜¯æŒ‰ç…§å‰é¢çš„çŒœæƒ³æ¥çš„ã€‚é¦–å…ˆï¼Œä¸Šé¢çš„ä»£ç æ˜¯å°†åŒä¸€ä¸ª view æ·»åŠ åˆ°ä¸åŒçš„ toast å¯¹è±¡å» showï¼Œå½“æ·»åŠ åˆ°ç¬¬ä¸€ä¸ª toast è°ƒç”¨ show æ–¹æ³•åï¼Œä¸»çº¿ç¨‹ sleep 1980 æ¯«ç§’ï¼Œè¿™ä¸ªæ—¶é—´æ˜¯å¾ˆå¾®å¦™çš„ï¼Œæ¥è¿‘ 2000 æ¯«ç§’ä½†æ˜¯å´ç•¥å°‘ã€‚è¿™ä¸ªæ—¶é—´å¯ä»¥ä½¿å¾—ä¸»çº¿ç¨‹é†’æ¥æ—¶ï¼Œtoast çš„ token å³å°†å¤±æ•ˆã€‚ä¸èƒ½ç”¨æ›´é•¿çš„ sleep æ—¶é—´æ˜¯å› ä¸ºé‚£æ ·çš„è¯ï¼Œä¸»çº¿ç¨‹è¿˜åœ¨ sleep ä¸­ token å·²å¤±æ•ˆï¼Œtoken çš„å¤±æ•ˆæ˜¯åœ¨ NotificationManagerService ä¸­äº§ç”Ÿçš„ï¼Œå¤±æ•ˆåï¼ŒNotificationManagerService ä¼šå¤„ç† MESSAGE_DURATION_REACHED æ¶ˆæ¯ï¼Œæœ€ç»ˆä¼šè·¨è¿›ç¨‹è°ƒç”¨åˆ° Toast#TN#hide æ–¹æ³•ï¼Œè€Œè¿™ä¸ªæ–¹æ³•ä¼šè®©æˆ‘ä»¬ app çš„ä¸»çº¿ç¨‹æ¶ˆæ¯é˜Ÿåˆ—å¢åŠ ä¸€ä¸ª HIDE æ¶ˆæ¯ï¼š å¦‚æ­¤ä¸€æ¥ï¼Œå½“ä¸»çº¿ç¨‹ sleep ç»“æŸæ‰§è¡Œ Toast#TN#handleShow æ–¹æ³•æ—¶ï¼Œå°±ä¼šå› æ¶ˆæ¯é˜Ÿåˆ—å·²æœ‰ HIDE æ¶ˆæ¯è€Œæå‰è¿”å›: æ—¢ç„¶éƒ½æå‰è¿”å›äº†ï¼Œview ä¹Ÿå°±ä¸ä¼šè¢«ç¬¬ä¸€ä¸ª toast æ·»åŠ åˆ° WindowManagerï¼Œé‚£ä¹ˆä¹Ÿå°±ä¸ç¬¦åˆæˆ‘ä»¬çš„æ€è·¯ä¸­ã€Œè®©ç¬¬ä¸€ä¸ª toast æŠŠ view æ·»åŠ åˆ° WindowManager æ˜¯å‘ç”Ÿå¼‚å¸¸ã€çš„æƒ³æ³•ã€‚ æ‰€ä»¥ï¼Œéœ€è¦ 1980 æ¯«ç§’è¿™æ ·ä¸€ä¸ªæ—¶é—´ï¼Œè¿™ä¸ªæ—¶é—´ä½¿å¾—ä¸»çº¿ç¨‹é†’æ¥æ‰§è¡Œåˆ°ç¬¬ä¸€ä¸ª toast çš„ Toast#TN#handleShow æ—¶ï¼Œtoken è¿˜æ²¡å¤±æ•ˆï¼Œæ‰€ä»¥ handleShow æ–¹æ³•ä¸ä¼šæå‰è¿”å›ï¼Œæ‰€ä»¥ view ä¼šç»§ç»­å¾€ WindowManager æ·»åŠ ï¼Œä½†æ˜¯ 20 æ¯«ç§’ä¸è¶³ä»¥è®©è¿™ä¸ªæ·»åŠ é¡ºåˆ©å®Œæˆï¼Œç›¸åï¼Œå¾ˆå¯èƒ½æ·»åŠ æ—¶ token å¤±æ•ˆäº†ï¼Œ äºæ˜¯æ·»åŠ å¤±è´¥ï¼Œå‘ç”Ÿç¬¬ä¸€ç§ crash çš„ BadTokenException (Anddroid 8 ä»¥ä¸Šæ­¤å¼‚å¸¸ä¼šè¢«æ•è·ï¼Œå‰æ–‡å·²æè¿°)ï¼Œè¿™æ ·å°±ç¬¦åˆæˆ‘ä»¬çš„æ€è·¯äº†ã€‚ä¸‹é¢æˆªå›¾è¯æ˜äº†ç¡®å®å‘ç”Ÿäº† BadTokenExceptionï¼š è‡³æ­¤ï¼ŒæŒ‰ç…§å‰é¢çš„æ€è·¯ï¼Œæ­¤ view å°†ä¼šæ—  parentï¼Œä½†æ˜¯å´ç•™åœ¨äº† WindowManagerGlobal çš„ mViews ä¸­ï¼Œå´åˆä¸åœ¨ mDyingViews ä¸­ï¼Œäºæ˜¯ï¼Œå½“å†æ¬¡æŒ‰ä¸‹æŒ‰é’®ï¼Œæ‰§è¡Œå¦ä¸€ä¸ª toast æ·»åŠ æ­¤ view çš„ä»£ç æ—¶ï¼ŒWindowManagerGlobal#addView ä¸­å°†å‘ç”Ÿ IllegalStateExceptionï¼Œcrash ä¹Ÿå°±å¤ç°äº†ï¼Œæˆªå›¾ä¸ºè¯ï¼š è‡³æ­¤ï¼Œtoast crash çš„åˆ†æç®—æ˜¯æœ‰äº†ä¸€ä¸ªæ¯”è¾ƒå®Œæ»¡çš„ç»“å°¾ã€‚å¯¹äºæœ¬æ–‡ä¸­ 2019 å¹´ 1 æœˆ 11 æ—¥æ›´æ–°çš„éƒ¨åˆ†ï¼Œåœ¨æ­¤æ„Ÿè°¢åˆ˜æˆåŒå­¦æä¾›çš„å¸®åŠ©ï¼Œä»–æœ¬æ¥ç”¨æ¥å¤ç°é—®é¢˜çš„æ–¹å¼æ˜¯ã€Œå…ˆè°ƒä¸€ä¸ª toast çš„ showï¼Œsleep ä¸‰å››ç§’ï¼Œç„¶åå†ç”¨åŒä¸€ä¸ª view è°ƒå¦ä¸€ä¸ª toast çš„ showã€ï¼Œè¿™ä¸ªæ–¹å¼å› ä¸ºå‰é¢è®²çš„åŸå› è€Œæ— æ³•å¤ç° crashï¼Œä½†å´ç»™äº†æˆ‘çµæ„Ÿï¼Œè®©æˆ‘æƒ³åˆ°äº† 1980 æ¯«ç§’è¿™ä¸ªæ—¶é—´ï¼Œæœ€ç»ˆæˆåŠŸå¤ç°äº† crashã€‚","categories":[],"tags":[{"name":"Android","slug":"Android","permalink":"https://tao93.top/tags/Android/"}]},{"title":"Java Comparable Contracts","slug":"Java Comparable Contracts","date":"2018-12-22T13:10:08.148Z","updated":"2019-07-05T14:02:09.750Z","comments":true,"path":"2018/12/22/Java Comparable Contracts/","link":"","permalink":"https://tao93.top/2018/12/22/Java Comparable Contracts/","excerpt":"","text":"å®ç° Java ä¸­çš„ Comparable æ¥å£çš„å¯¹è±¡ï¼Œå¯ä»¥ç”¨åœ¨ Collections#sort ç­‰æ–¹æ³•ä¸­è¿›è¡Œæ’åºç­‰ã€‚é€šå¸¸æ¥è¯´ï¼ŒComparable æ¥å£çš„ compareTo æ–¹æ³•éƒ½æ˜¯å†™èµ·æ¥æ¯”è¾ƒç®€å•çš„ã€‚ä¸è¿‡ï¼Œå¶å°”è¿˜æ˜¯å¯èƒ½ç¿»è½¦çš„ã€‚æ¯”å¦‚ä¸‹é¢çš„ crash logï¼Œå°±æ˜¯ç¿»è½¦çš„ç°åœºï¼š 12345678java.lang.IllegalArgumentException: Comparison method violates its general contract! at java.util.TimSort.mergeHi(TimSort.java:868) at java.util.TimSort.mergeAt(TimSort.java:485) at java.util.TimSort.mergeCollapse(TimSort.java:408) at java.util.TimSort.sort(TimSort.java:214) at java.util.TimSort.sort(TimSort.java:173) at java.util.Arrays.sort(Arrays.java:659) at java.util.Collections.sort(Collections.java:217) å¼‚å¸¸æ˜¾ç¤ºè¿åäº† general contractï¼Œè¿™äº› contract å…¶å®åœ¨ Comparable#compareTo æ–¹æ³•çš„æ³¨é‡Šä¸­å°±è®²åˆ°äº†ï¼Œä¸»è¦å°±æ˜¯ç›¸åæ€§ã€ä¼ é€’æ€§ã€ç­‰ä»·æ€§ä¸‰æ¡ contractã€‚è¿™äº› contract å¯ä»¥å†™æˆä¸‹é¢è¿™æ ·çš„å½¢å¼ï¼š $sgn(x.compareTo(y)) = -sgn(y.compareTo(x)) $ $sgn(x.compareTo(y)) &gt; 0$ and $sgn(y.compareTo(z)) &gt; 0$ implies $sgn(x.compareTo(z)) &gt; 0$ $sgn(x.compareTo(y)) = 0$ implies sgn(x.compareTo(z)) = sgn(y.compareTo(z))$ ä¸Šé¢çš„ $sgn$ å‡½æ•°å°±æ˜¯ä¸‹é¢è¿™æ ·çš„ï¼š æ‰€ä»¥ç¬¬ä¸€æ¡çš„æ„æ€æ˜¯ x ä¸ y çš„æ¯”è¾ƒç»“æœå’Œ y ä¸ x çš„æ¯”è¾ƒç»“æœå¿…é¡»ç›¸åï¼›ç¬¬äºŒæ¡çš„æ„æ€æ˜¯ï¼Œæ¯”è¾ƒç»“æœæ˜¯å…·æœ‰ä¼ é€’æ€§çš„ï¼Œç¬¬ 3 æ¡æ˜¯å¦‚æœ x å’Œ y çš„æ¯”è¾ƒç»“æœæ˜¯ç›¸ç­‰çš„ï¼Œé‚£ä¹ˆå®ƒä»¬ä¸ä»»ä½• z çš„æ¯”è¾ƒç»“æœç›¸åŒã€‚ ç®€å•å®ç°çš„ compareTo æ–¹æ³•é€šå¸¸ä¸ä¼šè¿èƒŒä¸Šé¢çš„åè®®ï¼Œä¸è¿‡ï¼Œç¨å¾®å¤æ‚ç‚¹çš„ï¼Œå°±ä¸ä¸€å®šäº†ã€‚æ¯”å¦‚ä¸‹é¢çš„ä¾‹å­ï¼š 1234567891011@Overridepublic int compareTo(Object o2) &#123; Data d2 = (Data) o2 if (isSortByName()) &#123; return getName().compareTo(d2.getName()); &#125; else if (isSortByAge()) &#123; return getAge() - d2.getAge(); &#125; else &#123; return 0; &#125;&#125; ä»¥ä¸Šé¢ä»£ç æ¥å®ç° Comparable æ¥å£çš„å¯¹è±¡ï¼Œç„¶åè¿›è¡Œæ’åºï¼Œæ˜¯å¯èƒ½å­˜åœ¨çš„é—®é¢˜çš„ã€‚åœ¨ä¸€æ¬¡å®Œæ•´çš„æ’åºè¿‡ç¨‹ä¸­ï¼Œä¸Šé¢çš„ compareTo æ–¹æ³•éœ€è¦è°ƒç”¨å¤šæ¬¡ï¼Œä½†æ˜¯ä¸Šé¢çš„ isSortByName å’Œ isSortByAge æ–¹æ³•çš„è¿”å›æ˜¯å¯èƒ½å˜åŒ–çš„ï¼Œæ¯”å¦‚å¤šçº¿ç¨‹æƒ…å†µä¸‹å…¶ä»–çº¿ç¨‹å¯èƒ½ä¿®æ”¹äº† isSortByName æ–¹æ³•æ‰€ä½¿ç”¨çš„å˜é‡çš„å€¼ã€‚å½“ isSortByName çš„ç»“æœå˜åŒ–æ—¶ï¼Œæ„å‘³ç€æ’åºçš„æ¯”è¾ƒæ ‡å‡†ä¹Ÿå˜äº†ï¼Œè‡ªç„¶éå¸¸å®¹æ˜“è¿åå‰é¢è¯´åˆ°çš„ contractã€‚ è€Œä¸‹é¢çš„ä»£ç ç‰‡æ®µï¼ŒåŒæ ·æ˜¯æœ‰é—®é¢˜çš„ï¼š 12345678910111213141516171819@Overridepublic int compareTo(Object o2) &#123; Data d2 = (Data) o2 boolean date1Empty = TextUtils.isEmpty(getDateStr()); boolean date2Empty = TextUtils.isEmpty(d2.getDateStr()); if (date1Empty &amp;&amp; date2Empty) &#123; return 0; &#125; if (! date1Empty &amp;&amp; ! date2Empty) &#123; SimpleDateFormat format = new SimpleDateFormat(\"....\"); try &#123; Date date1 = format.format(getDateStr()); Date date2 = format.format(d2.getDateStr()); return date1.compareTo(date2); &#125; catch(ParseException e) &#123; return 0; &#125; &#125;&#125; ä¸Šé¢ä»£ç çš„é—®é¢˜åœ¨äºï¼ŒParseException è¢«æ•è·å¹¶ä¸”ç›´æ¥è¿”å› 0 äº†ã€‚è¿™æ„å‘³ç€ä¸¤ä¸ª date string åªè¦æœ‰ä¸€ä¸ªæ˜¯æ— æ³•è§£æçš„ï¼Œé‚£ä¹ˆæ¯”è¾ƒç»“æœå°±æ˜¯0ï¼Œä¹Ÿå°±æ˜¯ç›¸ç­‰ã€‚åŠ å…¥ a, b, c ä¸‰ä¸ª date stringï¼Œåªæœ‰ b æ˜¯æ— æ³•è§£æçš„ï¼Œé‚£ä¹ˆ a å’Œ b æ¯”è¾ƒç»“æœä¸º 0ï¼Œb å’Œ c æ¯”è¾ƒç»“æœä¹Ÿæ˜¯ 0ï¼Œåˆ™æ ¹æ®ç¬¬ 3 æ¡ contractï¼Œa å’Œ c çš„æ¯”è¾ƒç»“æœä¹Ÿåº”è¯¥æ˜¯ 0ï¼Œå¯æ˜¯ a å’Œ c éƒ½æ˜¯å¯ä»¥æ­£å¸¸è§£æçš„ï¼Œå®ƒä»¬çš„æ¯”è¾ƒç»“æœä¸ä¸€å®šæ˜¯ 0ã€‚æ‰€ä»¥ç¬¬ 3 æ¡ contract ä¼šè¢«è¿åã€‚ è¦æ”¹æ­£ä¸Šé¢çš„ä»£ç ç‰‡æ®µï¼Œå¯ä»¥ç›´æ¥æŠŠå¼‚å¸¸æŠ›å‡ºï¼Œä»¥æœŸæå‰å°†ä¸å¯è§£æçš„ date string é¿å…æ‰ã€‚å¦ä¸€ç§æ–¹å¼æ›´å•°å—¦ç‚¹ï¼Œå°±æ˜¯ä¸¤ä¸ªä¸å¯è§£æçš„ date string è®¤ä¸ºæ˜¯ç›¸ç­‰çš„ï¼Œç„¶åå¯è§£æå’Œä¸å¯è§£æçš„å­—ç¬¦ä¸²çš„æ¯”è¾ƒçº¦å®šå¥½å¤§å°å…³ç³»ï¼Œå¹¶ç¡®ä¿ç¬¦åˆç›¸åæ€§ contractã€‚","categories":[],"tags":[{"name":"Java","slug":"Java","permalink":"https://tao93.top/tags/Java/"}]},{"title":"çŸ©é˜µè¿ç®—åœ¨ Android ä¸­çš„ç®€å•åœºæ™¯","slug":"çŸ©é˜µè¿ç®—åœ¨ Android ä¸­çš„ç®€å•åœºæ™¯","date":"2018-12-04T14:52:16.196Z","updated":"2019-07-05T14:04:27.118Z","comments":true,"path":"2018/12/04/çŸ©é˜µè¿ç®—åœ¨ Android ä¸­çš„ç®€å•åœºæ™¯/","link":"","permalink":"https://tao93.top/2018/12/04/çŸ©é˜µè¿ç®—åœ¨ Android ä¸­çš„ç®€å•åœºæ™¯/","excerpt":"","text":"è®©æˆ‘ä»¬å…ˆä»ä½äº android.graphics åŒ…ä¸­çš„ Bitmap ç±»çš„ä¸€ä¸ªæ–¹æ³•å¼€å§‹è¯´èµ·ï¼Œä¹Ÿå°±æ˜¯ createBitmap(Bitmap source, int x, int y, int width, int height, Matrix m, boolean filter) è¿™æ ·ä¸€ä¸ªæ–¹æ³•ã€‚è¿™ä¸ªæ–¹æ³•ä¸­æœ‰ä¸ªçŸ©é˜µå‚æ•°ï¼Œé€šè¿‡ä¼ å…¥æ­¤çŸ©é˜µå‚æ•°ï¼Œå¯ä»¥å°† source Bitmap ç»è¿‡ä¸€å®šçš„è½¬æ¢å†åˆ›å»ºç›®æ ‡ Bitmapã€‚é‚£ä¹ˆè¿™ä¸ªçŸ©é˜µæ˜¯æ€ä¹ˆèµ·ä½œç”¨çš„å‘¢ï¼Ÿå…ˆçœ‹ä¸€æ®µç¤ºä¾‹ä»£ç ï¼š 123Matrix matrix = new Matrix();matrix.postRotate(90);Bitmap bitmap2 = Bitmap.createBitmap(bitmap1, 0, 0, bitmap1.width(), bitmap1.getHeight(), matrix, true); ä¸Šè¿°ä»£ç åšçš„äº‹æƒ…æ˜¯å°† bitmap1 é¡ºæ—¶é’ˆæ—‹è½¬ 90Â° å¾—åˆ° bitmap2ï¼Œèµ·å…³é”®ä½œç”¨çš„å°±æ˜¯è¿™ä¸ª matrixã€‚ç¬¬ä¸€è¡Œä»£ç ä¼šå¾—åˆ°ä¸€ä¸ª 3Ã—3 çš„å•ä½çŸ©é˜µï¼Œè€Œç¬¬äºŒè¡Œä»£ç ä¹‹åï¼ŒçŸ©é˜µå°†ä¼šå˜æˆä¸‹é¢è¿™æ ·ï¼š \\begin{bmatrix} 0 & -1 & 0 \\\\ 1 & 0 & 0 \\\\ 0 & 0 & 1 \\end{bmatrix} Â· \\begin{bmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{bmatrix} = \\begin{bmatrix} 0 & -1 & 0 \\\\ 1 & 0 & 0 \\\\ 0 & 0 & 1 \\end{bmatrix}æ³¨æ„åœ¨ xy å¹³é¢å†…é¡ºæ—¶é’ˆ rotate 90Â° çš„æ“ä½œå¯¹åº”çš„çŸ©é˜µæ˜¯ \\begin{bmatrix} cos 90Â° & -sin 90Â° & 0 \\\\ sin 90Â° & cos90Â° & 0 \\\\ 0 & 0 & 1 \\end{bmatrix} = \\begin{bmatrix} 0 & -1 & 0 \\\\ 1 & 0 & 0 \\\\ 0 & 0 & 1 \\end{bmatrix}è®°ä¸Šé¢çš„çŸ©é˜µä¸º R90ï¼Œè®°ä¸Šé¢ä»£ç ä¸­çš„ matrix ä¸º Mï¼Œè®°å•ä½çŸ©é˜µä¸º Iï¼Œé‚£ä¹ˆç¬¬ 2 è¡Œçš„æ“ä½œåˆ™æ˜¯ç­‰åŒäºä¸‹é¢çš„è¡¨è¾¾å¼ï¼š M = R90Â·Mä¹Ÿå°±æ˜¯: M = R90Â·Iæ³¨æ„ä¸Šé¢çš„ç‚¹ä¹˜é¡ºåºæ˜¯ R90 åœ¨å‰ï¼ŒI åœ¨åï¼ˆè™½ç„¶è¿™é‡Œ R90Â·I å’Œ IÂ·R90 ç»“æœæ˜¯ä¸€æ ·ï¼Œä½†åˆ«çš„åœºæ™¯æœªå¿…å¦‚æ­¤ï¼‰ã€‚åŸå› æ˜¯ ä»£ç ä¸­æ˜¯ postRotate æ–¹æ³•ï¼Œè¿™é‡Œ post è¡¨ç¤ºæ˜¯æŠŠ rotate æ”¾åœ¨å˜æ¢çš„æœ€åä¸€æ­¥ã€‚è€Œå˜æ¢çŸ©é˜µä½œç”¨ R90Â·M ä½œç”¨åœ¨ç›®æ ‡å‘é‡ V æ—¶ï¼Œå°†ä¼šæ˜¯è¡¨è¾¾å¼ï¼š R90Â·MÂ·Vè¿™æ ·å°±å¯ä»¥ç†è§£ä¸ºæ˜¯å…ˆ MÂ·V ç„¶åè¿™ä¸ªç»“æœå†è¢« R90 ä¹˜ï¼Œæ‰€ä»¥æ˜¯å…ˆåš M æœ¬æ¥çš„å˜æ¢ï¼Œç„¶åå†åš R90 çš„å˜æ¢ï¼Œä¹Ÿå°±æ˜¯ rotate 90Â° åœ¨æœ€åä¸€æ­¥ã€‚è¿™ä¹Ÿå°±æ˜¯ç¬¬ 2 è¡Œä»£ç çš„ postRotate 90Â° ç­‰ä»·äº M = R90Â·M ä¹Ÿå°±æ˜¯ M = R90Â·I çš„åŸå› ã€‚ æ‰€ä»¥ç¬¬ 3 è¡Œä»£ç ä¼ å…¥çš„ matrix å°±æ˜¯ï¼š \\begin{bmatrix} 0 & -1 & 0 \\\\ 1 & 0 & 0 \\\\ 0 & 0 & 1 \\end{bmatrix}ç°åœ¨æˆ‘ä»¬è¿›å…¥å‰é¢è¯´çš„ createBitmap è¿™ä¸ªæ–¹æ³•ä¸­å»çœ‹çœ‹æºç æ˜¯æ€ä¹ˆå®ç°è¿™ä¸ªå˜æ¢çš„ï¼š 1234567891011121314151617public static Bitmap createBitmap(Bitmap source, int x, int y, int width, int height, Matrix m, boolean filter) &#123; ... Rect srcR = new Rect(x, y, x + width, y + height); RectF dstR = new RectF(0, 0, width, height); RectF deviceR = new RectF(); m.mapRect(deviceR, dstR); neww = Math.round(deviceR.width()); newh = Math.round(deviceR.height()); bitmap = createBitmap(neww, newh, transformedConfig, transformed || source.hasAlpha()); Canvas canvas = new Canvas(bitmap); canvas.translate(-deviceR.left, -deviceR.top); canvas.concat(m); canvas.drawBitmap(source, srcR, dstR, paint); ... return bitmap;&#125; ä¸Šé¢ä»£ç ç¬¬ 3 è¡Œ srcR å°†æ˜¯ source Bitmap ä¸­è¦è¢«è½¬æ¢çš„éƒ¨åˆ†ã€‚è€Œ dstR æ˜¯åŒæ ·å®½é«˜ä½†æ˜¯å·¦ä¸Šè§’åœ¨ (0, 0) çš„çŸ©å½¢ã€‚ç¬¬ 6 è¡Œåˆ™æ˜¯å°† dstR å˜æ¢åå¾—åˆ° deviceRï¼Œæ ¹æ®å‰é¢æ‰€çŸ¥ çš„ m çš„å€¼ï¼Œå¯çŸ¥deviceR å°†ä¼šæ˜¯ left, top, right, bottom åˆ†åˆ«æ˜¯ -height, 0, 0, width: å³ deviceR æ˜¯ dstR ç»•åŸç‚¹é¡ºæ—¶é’ˆæ—‹è½¬ 90Â° å¾—åˆ°çš„ã€‚ç´§æ¥ç€ä»£ç  7ã€8 è¡Œå¾—åˆ°è½¬æ¢åçš„ Bitmap çš„å®½é«˜ã€‚ç„¶åç¬¬ 9 è¡Œä»¥æ­¤å®½é«˜åˆ›å»ºäº†æ–°çš„ Bitmapã€‚ç¬¬ 11 è¡ŒåŸºäºæ­¤ Bitmap åˆ›å»ºäº† canvasã€‚ é‡ç‚¹æ¥äº†ï¼Œç¬¬ 12 è¡Œå¯¹æ­¤ canvas è¿›è¡Œå¹³ç§»å˜æ¢ï¼Œå¹³ç§»çš„ç›®çš„æ˜¯è®© deviceR çš„å·¦ä¸Šè§’ç§»åŠ¨åˆ°åŸç‚¹ã€‚ä»è€Œè®©å®ƒä½äº x éè´Ÿä¸” y éè´Ÿçš„è±¡é™ã€‚è€Œç¬¬ 13 è¡Œåˆ™å°† m çŸ©é˜µçš„å˜æ¢ä½œç”¨åœ¨æ­¤ canvas æ˜¯ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç¬¬ 12ã€13 è¡Œçš„å˜æ¢ï¼Œéƒ½æ˜¯ pre çš„å˜æ¢è€Œä¸æ˜¯ post çš„ã€‚æ‰€ä»¥å¯ä»¥çœ‹æˆ 13 è¡Œçš„å˜æ¢å…¶å®æ˜¯æ¯”ç¬¬ 12 è¡Œçš„å¹³ç§»å…ˆæ‰§è¡Œçš„ï¼Œä¹Ÿå°±æ˜¯æ•´ä¸ªå˜æ¢è¿‡ç¨‹å¯ç†è§£ä¸ºå…ˆç»•åŸç‚¹é¡ºæ—¶é’ˆæ—‹è½¬ 90Â°ï¼Œç„¶åå†å°†å·¦ä¸Šè§’å¹³ç§»åˆ°åŸç‚¹ï¼Œè¿™æ ·å°±æˆåŠŸçš„å®Œæˆäº†å°†åŸ Bitmap æ—‹è½¬ 90Â° å¹¶åˆ›å»ºæ–° Bitmap çš„æ“ä½œï¼Œè™½ç„¶è¿™é‡Œé™¤äº† rotateï¼Œå…¶å®è¿˜åˆ©ç”¨äº† translation æ“ä½œã€‚ ç”¨ 3Ã—3 çŸ©é˜µåœ¨ xy å¹³é¢å†…å˜æ¢ï¼Œå¯ä»¥åˆ†ä¸º translate, rotate, scale, skew ä¸€å…± 4 ç§ï¼Œè¡¨ç¤ºè¿™å››ç§æ“ä½œçš„çŸ©é˜µåˆ†åˆ«è®°ä½œï¼š T(a, b),\\ R(\\theta),\\ S(u, v),\\ SKx(\\theta), SKy(\\theta)é‚£ä¹ˆå®ƒä»¬åˆ†åˆ«æ˜¯ï¼š \\begin{bmatrix} 1 & 0 & a \\\\ 0 & 1 & b \\\\ 0 & 0 & 1 \\end{bmatrix} ,\\ \\begin{bmatrix} cos(\\theta) & -sin(\\theta) & 0 \\\\ sin(\\theta) & cos(\\theta) & 0 \\\\ 0 & 0 & 1 \\end{bmatrix} ,\\ \\begin{bmatrix} u & 0 & 0 \\\\ 0 & v & 0 \\\\ 0 & 0 & 1 \\end{bmatrix} ,\\ \\begin{bmatrix} 1 & tan(\\theta) & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{bmatrix} ,\\ \\begin{bmatrix} 1 & 0 & 0 \\\\ tan(\\theta) & 1 & 0 \\\\ 0 & 0 & 1 \\end{bmatrix}åˆ†åˆ«è¡¨ç¤ºçš„å«ä¹‰æ˜¯ï¼š å‘ +x æ–¹å‘å¹³ç§» a ä¸”å‘ +y æ–¹å‘å¹³ç§» bï¼› ä»¥åŸç‚¹ä¸ºä¸­å¿ƒåœ¨ xy å¹³é¢æ—‹è½¬ theta è§’åº¦ï¼› ä»¥åŸç‚¹ä¸º pivotï¼Œx æ–¹å‘å’Œ y æ–¹å‘åˆ†åˆ«ä¼¸ç¼©å€¼ä¸º u å’Œ v çš„æ¯”ä¾‹ï¼› æ¯ä¸ªç‚¹çš„ $x$ åæ ‡å˜ä¸º $x + yÂ·tan(\\theta)$ï¼Œè€Œ $y$ åæ ‡ä¸å˜ï¼Œè§†è§‰è¡¨ç°ä¸ºå›¾å½¢å‘ +y æ–¹å‘å€¾æ–œï¼Œå€¾æ–œè§’åº¦ä¸º $\\theta$; æ¯ä¸ªç‚¹çš„ $y$ åæ ‡å˜ä¸º $xÂ·tan(\\theta) + y$ï¼Œè€Œ $x$ åæ ‡ä¸å˜ï¼Œè§†è§‰è¡¨ç°ä¸ºå›¾å½¢å‘ +x æ–¹å‘å€¾æ–œï¼Œå€¾æ–œè§’åº¦ä¸º $\\theta$. æ³¨æ„, $T(a, 0)$ å’Œ $T(0, b)$ ç»„åˆèµ·æ¥çš„å˜æ¢ï¼Œç­‰ä»·äº $T(a, b)$ï¼Œä¸”å’Œç»„åˆé¡ºåºæ— å…³ï¼Œè¿™ä»çŸ©é˜µä¹˜æ³•ä¹Ÿå¯ä»¥çœ‹å‡ºæ¥ï¼š \\begin{bmatrix} 1 & 0 & a \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{bmatrix}Â· \\begin{bmatrix} 1 & 0 & 0 \\\\ 0 & 1 & b \\\\ 0 & 0 & 1 \\end{bmatrix}= \\begin{bmatrix} 1 & 0 & 0 \\\\ 0 & 1 & b \\\\ 0 & 0 & 1 \\end{bmatrix}Â· \\begin{bmatrix} 1 & 0 & a \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{bmatrix}= \\begin{bmatrix} 1 & 0 & a \\\\ 0 & 1 & b \\\\ 0 & 0 & 1 \\end{bmatrix}åŒæ ·çš„ï¼Œ$S(u, 0)$ å’Œ $S(0, v)$ ç»„åˆèµ·æ¥ç­‰ä»·äº $S(u, v)$ ä¸”å’Œç»„åˆé¡ºåºæ— å…³ã€‚è€Œ Skew æ— æ­¤æ€§è´¨ã€‚äº‹å®ä¸Šï¼š \\begin{bmatrix} 1 & tan(\\alpha) & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{bmatrix}Â· \\begin{bmatrix} 1 & 0 & 0 \\\\ tan(\\beta) & 1 & 0 \\\\ 0 & 0 & 1 \\end{bmatrix}= \\begin{bmatrix} 1+tan(\\alpha)tan(\\beta) & tan(\\alpha) & 0 \\\\ tan(\\beta) & 1 & 0 \\\\ 0 & 0 & 1 \\end{bmatrix}è€Œï¼š \\begin{bmatrix} 1 & 0 & 0 \\\\ tan(\\beta) & 1 & 0 \\\\ 0 & 0 & 1 \\end{bmatrix}Â· \\begin{bmatrix} 1 & tan(\\alpha) & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{bmatrix}= \\begin{bmatrix} 1 & tan(\\alpha) & 0 \\\\ tan(\\beta) & 1+tan(\\alpha)tan(\\beta) & 0 \\\\ 0 & 0 & 1 \\end{bmatrix}æ¥ä¸‹æ¥è¯´è¯´ Android ä¸­å’Œ 3Ã—3 çŸ©é˜µç›¸å…³çš„ä¸€äº›ç±»ï¼Œä¹Ÿå°±æ˜¯ Matrix, Canvas, Camera è¿™ 3 ä¸ªç±»ï¼Œæ³¨æ„æœ€åè¿™ä¸ª Camera ç±»æ˜¯ android.graphics åŒ…ä¸­çš„ï¼Œè€Œä¸æ˜¯ android.hardware ä¸­çš„ã€‚ Matrix å¯¹è±¡è¡¨ç¤ºä¸€ä¸ª 3Ã—3 çŸ©é˜µï¼Œå¸¸ç”¨äºæŒ‡ç¤º x y å¹³é¢å†…çš„å˜æ¢ï¼Œæ„é€ å‡½æ•°åˆ›å»ºçš„éƒ½æ˜¯å•ä½çŸ©é˜µã€‚Matrix æœ‰ä¸€ç³»åˆ— set æ–¹æ³•ï¼Œç”¨äºè®¾ç½®çŸ©é˜µçš„å€¼ï¼Œè¿™äº›æ–¹æ³•å¯¹åº”äºä¸€äº›å¸¸è§çš„å˜æ¢æ“ä½œï¼Œæ¯”å¦‚ setScale(int sx, int sy) æ–¹æ³•ï¼Œå…¶å®å°±æ˜¯æŠŠçŸ©é˜µ(ä¸ç®¡åŸæ¥æ˜¯ä»€ä¹ˆå€¼)å˜æˆä¸‹é¢çš„å€¼ï¼š \\begin{bmatrix} sx & 0 & 0 \\\\ 0 & sy & 0 \\\\ 0 & 0 & 1 \\end{bmatrix}ä¸Šé¢çš„ç¼©æ”¾æ˜¯ä»¥åŸç‚¹ä¸º pivot ç¼©æ”¾çš„ï¼Œæ­¤å¤–ï¼Œè¿˜æœ‰ setScale(float sx, float sy, float px, float py) è¿™æ ·ä»¥ (px, py) ä¸º pivot è¿›è¡Œç¼©æ”¾çš„æ“ä½œï¼Œç­‰ä»·äºæŠŠçŸ©é˜µå˜ä¸ºä¸‹é¢è¿™æ ·ï¼š \\begin{bmatrix} sx & 0 & px(1-sx) \\\\ 0 & sy & py(1-sy) \\\\ 0 & 0 & 1 \\end{bmatrix}æ³¨æ„ä»¥ä¸ŠçŸ©é˜µæ˜¯å¯ä»¥åˆ†è§£çš„ï¼Œåˆ†è§£ä¸ºä¸¤ä¸ªçŸ©é˜µï¼Œä¸”è¿™ä¸¤ä¸ªçŸ©é˜µäº¤æ¢ä½ç½®åçš„ç§¯ä¹Ÿæ˜¯ä¸Šé¢çš„çŸ©é˜µã€‚å…¶ä»–çš„ set æ–¹æ³•ä¸æ­¤ç±»ä¼¼ï¼Œå°±ä¸å¤šè¯´äº†ã€‚ Matrix è¿˜æœ‰ä¸€ç³»åˆ— post æ–¹æ³•å’Œ pre æ–¹æ³•ï¼Œæ¯”å¦‚ postRotate(int degrees) å’Œ preSkew(int kx, int ky) æ–¹æ³•ï¼Œå‰è€…ç›¸å½“äº $M=R(degrees)Â·M$ï¼Œåè€…ç›¸å½“äº $M=MÂ·SK(kx,\\ ky)$. æ³¨æ„è¿™é‡ŒçŸ©é˜µç›¸ä¹˜çš„é¡ºåºå–å†³äºæ˜¯ post è¿˜æ˜¯ pre. å…¶å® Matrix ä¹Ÿå¯ä»¥åœ¨ 3 ç»´ç©ºé—´ä¸­å˜æ¢ï¼Œæ¯”å¦‚ä½¿ç”¨å®ƒçš„ setPolyToPoly æ–¹æ³•ï¼Œå¯ä»¥å¾—åˆ°æ»¡è¶³æŒ‡å®šçš„æ˜ å°„å…³ç³»çš„çŸ©é˜µã€‚è€Œè¿™ç§æ˜ å°„å…³ç³»å¯èƒ½éœ€è¦ 3 ä¸ºç©ºé—´çš„å˜æ¢æ‰èƒ½æ»¡è¶³ã€‚ Canvas ç±»åŒ…å«ä¸€ä¸ªå˜æ¢çŸ©é˜µï¼Œè¿™ä¸ªçŸ©é˜µå¯ä»¥ get ä¹Ÿå¯ä»¥ setï¼Œä¹Ÿå¯ä»¥ç”¨ concact(Matrix mat) æ¥æ”¹å˜ Canvas çš„å˜æ¢çŸ©é˜µçš„å€¼ï¼Œè¿™ä¸ªè¿‡ç¨‹ç­‰ä»·äº $M=MÂ·mat$. å¦å¤–ï¼ŒCanvas çš„ drawBitmap æ–¹æ³•ä¹Ÿå¯ä»¥ä¼ å…¥ Matrix å¯¹è±¡æ¥æ§åˆ¶ bitmap è¢« draw æ—¶éœ€è¦çš„æ–½åŠ çš„å˜æ¢ã€‚Canvas çš„ translate å’Œ rotate ç­‰æ–¹æ³•ï¼Œéƒ½æ˜¯ pre ç±»å‹çš„ï¼Œå¹¶ä¸”è¿™ç§å˜åŒ–ï¼Œå¯ä»¥ç†è§£ä¸ºæ˜¯å¯¹ canvas çš„åæ ‡ç³»è¿›è¡Œå˜åŒ–ã€‚æ— å˜æ¢æ—¶ï¼Œåæ ‡ç³»åŸç‚¹åœ¨å¯è§åŒºåŸŸçš„å·¦ä¸Šè§’ï¼Œè€Œ +x å‘å³ï¼Œ+y å‘ä¸‹ã€‚translate(10, 0) åï¼Œcanvas åŸç‚¹å‘å³ç§»åŠ¨ 10ï¼Œæ­¤åç»˜åˆ¶åœ¨ (0, 0) ä½ç½®çš„ä¸œè¥¿ï¼Œå…¶å®æ˜¯ä½äºå¯è§åŒºåŸŸçš„å·¦ä¸Šè§’å³ä¾§è·ç¦»ä¸º 10 çš„åœ°æ–¹ã€‚ ä»¥ä¸Šè¯´çš„å¯è§åŒºåŸŸï¼Œå…¶å®æ˜¯ Canvas ä¸­çš„ clip æ¦‚å¿µï¼Œè¿™æ˜¯ä¸€ä¸ªæè¿°å¯è§åŒºåŸŸçš„çŸ©å½¢ã€‚ä¸€èˆ¬ Canvas çš„åˆå§‹ clip çš„ ltrb fåˆ†åˆ«ä¸º 0, 0, view width, view height. å½“ Canvas å˜æ¢æ—¶ï¼Œå¯ç†è§£ä¸ºå…¶åæ ‡ç³»å˜æ¢äº†ï¼Œé‚£ä¹ˆè‡ªç„¶ clip ä¹Ÿä¼šè·Ÿç€å˜åŒ–ï¼Œæ¯”å¦‚ translate(10, 0) åï¼Œclip çš„ ltrb å°±å˜ä¸º -10, 0, view width - 10, view height. Canvas å‡ºäºçµæ´»æ€§è€ƒè™‘ï¼Œæœ‰ save å’Œ restore ä¸¤ä¸ªæ–¹æ³•ç”¨äºä¿å­˜å’Œæ¢å¤å˜æ¢çš„çŠ¶æ€ï¼Œå¸¸ç”¨åšæ³•æ˜¯ï¼Œåœ¨æ— å˜æ¢æ—¶ save ä¸€ä¸‹ï¼Œç„¶åå˜æ¢å¹¶åšç»˜åˆ¶ï¼Œæœ€årestoreï¼Œä»¥é¿å…å½±å“å…¶å®ƒç»˜åˆ¶å·¥ä½œã€‚å‡ºäº†translateã€rotateã€Skewã€Scale è¿™äº› 2 ç»´å˜æ¢ï¼ŒCanvas è¿˜æœ‰ä¸€ç³»åˆ— clip æ–¹æ³•ï¼Œè¿™äº›æ–¹æ³•å°† Canvas è¿›ä¸€æ­¥å‰ªè£ï¼Œå¹¶æ ¹æ®å‰ªè£åå¯è§åŒºåŸŸæ˜¯å¦ä¸ºç©ºè¿”å›å¸ƒå°”å€¼ã€‚å‰ªè£æ“ä½œä¹Ÿæ˜¯å¯ä»¥ save å’Œ restore çš„ï¼Œä½†æ˜¯æ³¨æ„å‰ªè£æ“ä½œå¹¶ä¸å˜æ¢åæ ‡ç³»ã€‚ Camera å¯¹è±¡ä¸“é—¨ç”¨äºè®¡ç®—å˜æ¢ï¼Œä¸”åŒ…å« 3 ç»´ç©ºé—´ä¸­çš„å˜æ¢(ç›¸å Matrix å¯¹è±¡å…¶å®åªæ˜¯ xy å¹³é¢å†…çš„å˜æ¢)ï¼Œå®ƒçš„å˜æ¢è®¡ç®—ç»“æœæ˜¯ä¸€ä¸ªçŸ©é˜µï¼Œå¯é€šè¿‡ getMatrix æ–¹æ³•å¾—åˆ°ï¼Œä¸€èˆ¬ä¼šå°†æ­¤çŸ©é˜µç”¨ä½œå®ƒç”¨ï¼Œå¯ä»¥å°† Camera ç†è§£ä¸ºä¸€ä¸ªå˜æ¢è®¡ç®—å™¨ã€‚å‡ºäºçµæ´»æ€§çš„è€ƒè™‘ï¼ŒCamera å¯¹è±¡ä¸­æœ‰ save å’Œ restore æ“ä½œï¼Œè¿™å°±åƒæ˜¯ git ä¸­çš„ stash å’Œ pop stash æ“ä½œä¸€æ ·ï¼Œå¯ä»¥æŠŠå½“å‰çš„å˜æ¢ä¿å­˜ï¼Œå¹¶åœ¨åé¢æŸä¸ªæ—¶å€™æ¢å¤å‡ºæ¥ï¼Œæ¢å¤ä¹‹å‰çš„å€¼å°†ä¼šä¸¢å¤±ã€‚ä¸åŒçš„æ˜¯ï¼Œgit stash å working tree å°†æ˜¯ clean çš„ï¼Œå³å·²ä¿®æ”¹çš„å†…å®¹éƒ½æ¸…ç©ºäº†ï¼Œè€Œ Camera å¯¹è±¡ save åï¼Œå®ƒçš„çŸ©é˜µè¿˜æ˜¯ save ä¹‹å‰çš„ï¼Œå¹¶ä¸ä¼šå˜æˆå•ä½çŸ©é˜µã€‚ éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒCamera çš„åæ ‡ç³»ï¼Œ+x æ˜¯å‘å³çš„ï¼Œ+y æ˜¯å‘ä¸Šçš„ï¼Œè€Œ +z æ˜¯å‘å±å¹•é‡Œé¢çš„ã€‚æ‰€ä»¥æ¯”å¦‚ Camera çš„ rotateZ(int degrees) æ–¹æ³•å’Œ Matrix çš„ [pre|post]Rotate(int degree) çš„æ—‹è½¬æ–¹å‘æ˜¯åè¿‡æ¥çš„ã€‚å‰è€…ç­‰ä»·äºé€†æ—¶é’ˆæ–¹å‘è½¬ï¼Œåè€…åˆ™æ˜¯é¡ºæ—¶é’ˆæ–¹å‘è½¬ã€‚ä¸‹é¢çš„ä¾‹å­å¯ä»¥è¯´æ˜è¿™ä¸€ç‚¹ï¼š 12345678Matrix mat1 = new Matrix();Camera camera = new Camera();camera.rotateZ(-90);camera.getMatrix(mat1);Matrix mat2 = new Matrix();mat2.preRotate(90); ä¸Šé¢ä»£ç æ‰§è¡Œå mat1 å’Œ mat2 éƒ½æ˜¯ï¼š \\begin{bmatrix} 0 & -1 & 0 \\\\ 1 & 0 & 0 \\\\ 0 & 0 & 1 \\end{bmatrix}å¯¹äº Camera å¯¹è±¡ï¼Œ è°ƒç”¨å®ƒçš„ translate ç­‰æ–¹æ³•ï¼Œä¼šä½¿å¾—å®ƒçš„ matrix å˜ä¸º Camera çš„åæ ‡ç³»ä¸­å¯¹åº”æ­¤å˜æ¢çš„å€¼ï¼Œè€Œè¿™æ ·çš„çŸ©é˜µï¼Œåœ¨åº”ç”¨åœ¨ Canvas ä¸Šè¿›è¡Œç»˜åˆ¶æ—¶ï¼Œåˆæ˜¯ä½œç”¨åœ¨ +y å‘ä¸‹çš„åæ ‡ç³»ä¸­ã€‚æ‰€ä»¥æ¯”å¦‚ Camera translate(10, -20, 0) åå¾—åˆ°çš„çŸ©é˜µæ˜¯ï¼š \\begin{bmatrix} 1 & 0 & 10 \\\\ 0 & 1 & 20 \\\\ 0 & 0 & 1 \\end{bmatrix}éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå½“ Camera åœ¨ z æ–¹å‘è¿›è¡Œ translate æ“ä½œæ—¶ï¼Œå˜æ¢å¯¹è±¡åœ¨å±å¹•ä¸Šçš„æŠ•å½±å¤§å°å‘ç”Ÿå˜åŒ–ï¼Œæ‰€ä»¥ï¼Œå®é™…å˜æ¢æ•ˆæœæ˜¯ä¸€ä¸ªç¼©æ”¾å˜æ¢ï¼Œæ‰€ä»¥ Camera getMatrix çš„ç»“æœï¼Œä¹Ÿæ˜¯ä¸€ä¸ªäºŒç»´ç¼©æ”¾å˜æ¢çš„çŸ©é˜µã€‚Camera çš„ location ä¹Ÿå°±æ˜¯ 3D æŠ•å½±ä¸­çš„ camera ä½ç½®ï¼ˆè§‚å¯Ÿè€…ä½ç½®ï¼‰ï¼Œæ­¤ä½ç½®é»˜è®¤æ˜¯ (0, 0, -8)ï¼Œæ³¨æ„è¿™ä¸ª -8 å®é™…ç›¸å½“äº -576 ä¸ªåƒç´ ã€‚å½“ z æ–¹å‘ translate è·ç¦»ä¸ºæ­£æ—¶ï¼Œç›¸å½“äºè¿œç¦»è§‚å¯Ÿè€…ï¼Œæœ€ç»ˆå°±æ˜¯ç¼©å°çš„å˜æ¢ï¼Œåæ­£æ˜¯æ”¾å¤§çš„å˜æ¢ã€‚","categories":[],"tags":[{"name":"Android","slug":"Android","permalink":"https://tao93.top/tags/Android/"}]},{"title":"å¾®ä¿¡ Android ç‰ˆæ˜¯å¦‚ä½•è®¡æ­¥çš„","slug":"å¾®ä¿¡ Android ç‰ˆæ˜¯å¦‚ä½•è®¡æ­¥çš„","date":"2018-11-24T04:54:22.998Z","updated":"2019-07-05T14:04:04.030Z","comments":true,"path":"2018/11/23/å¾®ä¿¡ Android ç‰ˆæ˜¯å¦‚ä½•è®¡æ­¥çš„/","link":"","permalink":"https://tao93.top/2018/11/23/å¾®ä¿¡ Android ç‰ˆæ˜¯å¦‚ä½•è®¡æ­¥çš„/","excerpt":"","text":"å¾ˆæ—©ä»¥å‰ï¼Œæˆ‘ä½¿ç”¨ä¸€éƒ¨ iPhone 5S æ‰‹æœºï¼Œè¿™æ˜¯ç¬¬ä¸€æ¬¾å¸¦æœ‰è®¡æ­¥åŠŸèƒ½çš„ iPhone æœºå‹ï¼Œè‹¹æœç§°ä¹‹ä¸ºæ­è½½è¿åŠ¨åå¤„ç†å™¨ã€‚å¦‚æœæˆ‘æ²¡è®°é”™ï¼ŒiOS çš„è¿åŠ¨æ•°æ®ï¼Œæ—¢å¯ä»¥è¢«ç¬¬ä¸‰æ–¹ app è¯»å–ï¼Œä¹Ÿå¯ä»¥è¢«å†™å…¥ã€‚è¯»å–å¥½è¯´ï¼Œå†™å…¥æ˜¯å› ä¸ºç”¨æˆ·å¯èƒ½ä½¿ç”¨æ‰‹ç¯ä¹‹ç±»çš„ä¸œè¥¿æ¥è®°å½•æ•°æ®ï¼Œé‚£ä¹ˆè¿™äº›æ•°æ®å¯èƒ½æ¯” iOS ç³»ç»Ÿä¸­çš„æ•°æ®æ›´å—ç”¨æˆ·é‡è§†ï¼Œæ‰€ä»¥å°±å¯ä»¥æŠŠ iOS ç³»ç»Ÿä¸­çš„æ•°æ®æ›¿æ¢ä¸ºæ‰‹ç¯äº§ç”Ÿçš„æ•°æ®ï¼Œæ‰€ä»¥éœ€è¦å…è®¸å†™å…¥ã€‚ä¸è¿‡ç›®å‰è€Œè¨€ï¼ŒAndroid ç³»ç»Ÿä¸­ï¼Œç¬¬ä¸‰æ–¹åº”ç”¨ä¼¼ä¹æ— æ³•å†™å…¥ç³»ç»Ÿçš„è¿åŠ¨æ•°æ®ï¼Œè€Œåªèƒ½è¯»å–ã€‚ å›åˆ°æ­£é¢˜ï¼Œä¼—æ‰€å‘¨çŸ¥ï¼Œå¾®ä¿¡æœ‰ä¸ªå¾®ä¿¡è¿åŠ¨åŠŸèƒ½ã€‚Android ç‰ˆå¾®ä¿¡æ˜¯æ€ä¹ˆè®¡æ­¥çš„å‘¢ï¼Ÿæˆ‘æœ€å…ˆæ˜¯åœ¨å¾®ä¿¡çš„æƒé™é¡µå‘ç°å¾®ä¿¡å£°æ˜äº† Body Sensors æƒé™ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š è¿™ä¸ªæƒé™å¾ˆæœ‰è¿·æƒ‘æ€§ï¼Œè®©äººä»¥ä¸ºæœ‰è¿™ä¸ªå°±å¯ä»¥è¯» Android ç³»ç»Ÿäº§ç”Ÿçš„è®¡æ­¥æ•°æ®äº†ã€‚äº‹å®ä¸Šï¼ŒæŠŠè¿™ä¸ªæƒé™å…³äº†ï¼Œç„¶åæ™ƒåŠ¨æ‰‹æœº 20 æ¬¡ï¼Œå†è¿›å…¥å¾®ä¿¡è¿åŠ¨ï¼Œæ­¥æ•°å¾ˆå‡†ç¡®çš„å¢åŠ äº† 20 æ¬¡å·¦å³ï¼Œæ‰€ä»¥è¿™ä¸ªæƒé™å¹¶ä¸å½±å“è¯»å–è®¡æ­¥æ•°æ®ã€‚ é‚£è¿™ä¸ªæƒé™å¯ä»¥å¹²å˜›å‘¢ï¼ŸBody Sensors æƒé™è¢«åˆ—ä¸º dangerous permissionï¼Œæ‰€å±çš„ permission group ä»…æœ‰è¿™ä¸€ä¸ªæƒé™ã€‚ä¸è¿‡å¾ˆé—æ†¾ï¼Œæˆ‘åœ¨ç½‘ä¸ŠæŸ¥äº†æŒºä¹…ï¼Œæ²¡æœ‰æŸ¥åˆ°è·å¾—è¿™ä¸ªæƒé™åå¯ä»¥ç”¨æ¥å†™ä»€ä¹ˆä»£ç åšä»€ä¹ˆäº‹æƒ…ã€‚å€˜è‹¥æƒ³è¦äº†è§£æ­¤æƒé™çš„æ ¹åº•ï¼Œä¼°è®¡éœ€è¦åœ¨ AOSP ä¸­æ‰¾ç­”æ¡ˆäº†ã€‚å¯æƒœæˆ‘ç”µè„‘ä¸Šæ¬¡å‡çº§å¤±è´¥åï¼Œç›®å‰æˆ‘ç”µè„‘ä¸­æ²¡æœ‰å®Œæ•´çš„ AOSPã€‚ å°±ç›®å‰æˆ‘åœ¨ç½‘ä¸Šäº†è§£åˆ°çš„ä¿¡æ¯è€Œè¨€ï¼Œæ­¤æƒé™ä¼¼ä¹æ²¡ä»€ä¹ˆç”¨ï¼Œå¾ˆå¤šå¸–å­éƒ½åœ¨è¯¢é—® Google Play Services ä¸ºä½•è¦ä½¿ç”¨æ­¤æƒé™ä»¥åŠæ˜¯å¦å¯ä»¥å…³é—­è¯¥æƒé™ã€‚æˆ‘æ‰‹ä¸­çš„ Pixel XL ä¹Ÿä»…æœ‰ Google Play Services å’Œå¾®ä¿¡å£°æ˜äº†æ­¤æƒé™ï¼š æ ¹æ®ç½‘ä¸Šçš„å¸–å­ï¼Œåœ¨ Android 7 æ—¶ä»£çš„æŸä¸ªæ—¶å€™ï¼ŒGmail æœ‰ä¸ª bugï¼Œå³å…³é—­ Google Play Services çš„ Body Sensors æƒé™åï¼ŒGmail ç–¯ç‹‚å¼¹æ¡†æ˜¾ç¤ºã€ŒThis app wonâ€™t work properly unless you allow Google Play Servicesâ€™ request to access the foloowing: Body Sensorsã€ï¼Œå°½ç®¡ Gmail ä»èƒ½æ­£å¸¸å·¥ä½œã€‚å› ä¸ºæ­¤å¼¹æ¡†å¤ªè¿‡æ€ªå¼‚ï¼Œéšåè°·æ­Œä¿®å¤äº†æ­¤é—®é¢˜ï¼Œè¿™è¯´æ˜å³ä½¿æ˜¯ Google è‡ªå·±çš„åº”ç”¨ï¼Œä¹Ÿæ²¡æœ‰ä¸¥æ ¼å®¡æŸ¥è‡ªå·±æ˜¯å¦å£°æ˜äº†ä¸å¿…è¦çš„æƒé™ã€‚ å½“ç„¶æŠŠ Google Play Services çš„ Body Sensors æƒé™å…³é—­åï¼Œæ‰“å¼€ Google Fit åº”ç”¨æ—¶ï¼Œå¼¹å‡ºå’Œä¸Šé¢ç±»ä¼¼çš„æ¶ˆæ¯ï¼Œå¹¶ä¸” Google Fit ä¸å†æ˜¾ç¤ºæˆ‘çš„æ­¥æ•°ï¼Œä¹ä¸€çœ‹ï¼Œè¿™ä¼¼ä¹è¯´å¾—é€šã€‚ä½†æ˜¯ï¼Œæ­¤æ—¶å¾®ä¿¡ä»ç„¶å¯ä»¥æ­£å¸¸è®¡æ­¥ã€‚è¿™è¯´æ˜ä½†å°±è®¡æ­¥è¿™ä¸€åŠŸèƒ½çœ‹ï¼ŒBody Sensors å¹¶éå¿…è¦çš„ã€‚ äº‹å®ä¸Šæˆ‘çš„è®¡æ­¥ Demo åº”ç”¨å¦‚ä¸Šè¿°å¾®ä¿¡ä¸€æ ·ï¼Œä¹Ÿè¿˜å¯ä»¥è®¡æ­¥ã€‚è®¡æ­¥ Demo ä¸­çš„ä»£ç éå¸¸ç®€å•ï¼ŒGoogle è‡ªå·±ä¹Ÿæœ‰ä¸ªå±•ç¤ºæ­¤åŠŸèƒ½çš„ç®€å•é¡¹ç›® android-BatchStepSensorã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼ŒGoogle çš„ç®€å•é¡¹ç›®ä¸­ manifest å£°æ˜äº†ä¸¤é¡¹ use-featureï¼Œä½†å…¶å®è¿™ä¹Ÿä¸æ˜¯å¿…è¦çš„ã€‚ç¬¬ä¸‰æ–¹åº”ç”¨æ— éœ€å£°æ˜ä»»ä½•æƒé™ï¼Œæ— éœ€å£°æ˜ä»»ä½• use-featureï¼Œåªéœ€æ³¨å†Œä¸€ä¸ª android.hardware.SensorEventListener æ¥å£ï¼Œå³å¯åœ¨æ­¤æ¥å£çš„ onSensorChanged æ–¹æ³•ä¸­æºæºä¸æ–­çš„æ”¶åˆ°æ­¥æ•°æ›´æ–°ï¼š 1234567891011121314@Overridepublic void onSensorChanged(SensorEvent event) &#123; switch (event.sensor.getType()) &#123; case Sensor.TYPE_STEP_DETECTOR: stepDetector ++; tvDetector.setText(stepDetector + \"\"); break; case Sensor.TYPE_STEP_COUNTER: // event.values[0] is step count since last reboot of Android device stepCounter = (int) event.values[0]; tvCounter.setText(stepCounter + \"\"); break; &#125;&#125; è¿™æ ·ç¬¬ä¸‰æ–¹åº”ç”¨å°±å¯ä»¥è®¡æ­¥äº†ï¼Œå³ä½¿ç¬¬ä¸‰æ–¹åº”ç”¨è¿›ç¨‹ç»ˆæ­¢ï¼Œä¹Ÿå¯ä»¥åœ¨åº”ç”¨å†æ¬¡è¿è¡Œæ—¶ï¼Œåœ¨ onSensorChanged æ–¹æ³•ä¸­å¾—çŸ¥æ–°çš„æ­¥æ•°ã€‚ å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œç³»ç»Ÿè¿”å›çš„æ­¥æ•°å§‹ç»ˆæ˜¯ä¸Šæ¬¡é‡å¯è®¾å¤‡åçš„æ€»æ­¥æ•°ã€‚é‚£ä¹ˆç¬¬ä¸‰æ–¹åº”ç”¨ä½¿ç”¨è¿™ç§æ–¹å¼è®¡æ­¥æ—¶ï¼Œä¼šå­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œå³åº”ç”¨è¿›ç¨‹è¢«æ€åï¼Œå¦‚æœç”¨æˆ·å…ˆè¿åŠ¨ï¼Œç„¶åé‡å¯è®¾å¤‡ï¼Œç„¶åæ‰æ‰“å¼€ç¬¬ä¸‰æ–¹åº”ç”¨ï¼Œé‚£ä¹ˆç¬¬ä¸‰æ–¹åº”ç”¨ä¼šä¸¢å¤±ä»åº”ç”¨è¢«æ€åˆ°è®¾å¤‡é‡å¯ä¹‹é—´çš„æ­¥æ•°ï¼Œè€ŒåªçŸ¥é“è®¾å¤‡é‡å¯åæ–°å¢äº†å¤šå°‘æ­¥æ•°ã€‚ ç»è¿‡éªŒè¯ï¼Œæˆ‘çš„ demoã€å¾®ä¿¡è¿˜æœ‰ Google Fit å‡å­˜åœ¨æ­¤é—®é¢˜ã€‚è¿™è¯´æ˜å¾®ä¿¡å’Œ Google Fit (æˆ–è€…å®ƒä¾èµ–çš„ Google Play Services) éƒ½æ˜¯é€šè¿‡æ³¨å†Œ SensorEventListener æ¥å£æ¥è·çŸ¥æ­¥æ•°çš„ã€‚è¿™ä¹Ÿè¯´æ˜äº†å¾®ä¿¡å£°æ˜ Body Sensors æƒé™æ˜¯å†—ä½™çš„ã€‚ é‚£ä¹ˆ Body Sensors æƒé™åˆ°åº•å¯ä»¥ç”¨æ¥åšä»€ä¹ˆï¼Ÿè¿™æ˜¯ä¸€ä¸ªå¾…å¡«çš„å‘ã€‚ å¯¹äº†ï¼Œç½‘ä¸Šè¿˜æœ‰ç§æ–¹å¼ï¼Œé€šè¿‡ç›‘å¬æ‰‹æœºåŠ é€Ÿåº¦æ„Ÿåº”å™¨çš„äº‹ä»¶æ¥è‡ªå·±è®¡æ­¥ï¼Œè‡³äºå‡†ç¡®æ€§ï¼Œé‚£å°±å—è‡ªå·±çš„ç®—æ³•çš„ç§‘å­¦æ€§å’Œå¤æ‚æ€§çš„é™åˆ¶äº†ã€‚æ–¹æ³•ä¹Ÿæ˜¯æ³¨å†Œ SensorEventListenerï¼Œä¸è¿‡æ³¨å†Œçš„ type æ˜¯ android.hardware.Sensor.TYPE_ACCELEROMETER è€Œéå‰é¢çš„ TYPE_STEP_COUNTERã€‚æ›´å¤šç»†èŠ‚è§æ­¤å¸–å­ã€‚","categories":[],"tags":[{"name":"Android","slug":"Android","permalink":"https://tao93.top/tags/Android/"}]},{"title":"ä¸ä¸€æ ·çš„ RelativeLayout measure è¿‡ç¨‹","slug":"ä¸ä¸€æ ·çš„ RelativeLayout measure è¿‡ç¨‹","date":"2018-11-02T02:59:59.975Z","updated":"2019-07-05T14:03:32.140Z","comments":true,"path":"2018/11/01/ä¸ä¸€æ ·çš„ RelativeLayout measure è¿‡ç¨‹/","link":"","permalink":"https://tao93.top/2018/11/01/ä¸ä¸€æ ·çš„ RelativeLayout measure è¿‡ç¨‹/","excerpt":"","text":"ç›´æ¥ç”¨ä¸€ä¸ªç®€å•çš„ä¾‹å­å±•ç¤º RelativeLayout çš„ä¸ä¸€æ ·ä¹‹å¤„ï¼š å›¾ä¸­ï¼Œå·¦è¾¹æ˜¯ä¸€ä¸ªç®€å•çš„ Android layout ä¾‹å­ï¼Œä¾‹å­ä¸­åœ¨å¤–ä¾§æ˜¯ä¸€ä¸ªæœ€å¤§çš„ horizontal çš„ LinearLayoutï¼Œå®ƒæœ‰ 3 ä¸ª childï¼Œåˆ†åˆ«æ˜¯å·¦éƒ¨ã€åˆ†å‰²çº¿å’Œå³éƒ¨ã€‚å·¦éƒ¨å’Œå³éƒ¨éå¸¸ç›¸ä¼¼ï¼Œéƒ½æ˜¯å¤–é¢ä¸€ä¸ª ViewGroup å†…åµŒä¸€ä¸ª TextViewï¼Œä¸” ViewGroup çš„é«˜åº¦éƒ½æ˜¯ wrapContent è€Œå†…åµŒçš„ TextView çš„é«˜åº¦éƒ½æ˜¯ matchParent. å› ä¸º TextView èƒŒæ™¯éƒ½æ˜¯çº¢è‰²ï¼Œæ‰€ä»¥ä» preview å¯ä»¥æ¸…æ™°çœ‹åˆ°ï¼Œå·¦éƒ¨çš„ TextView ç­‰æ•ˆäº wrapContentï¼Œè€Œå³éƒ¨çš„ TextView åˆ™ç­‰æ•ˆäº matchParentï¼Œè¿™å°±æ˜¯ RelativeLayout çš„ä¸ä¸€æ ·ã€‚ç®€è€Œè¨€ä¹‹å°±æ˜¯ï¼ŒRelativeLayout ä¸­å†…åµŒçš„ child tree çš„æ ¹èŠ‚ç‚¹ size å¦‚æœæ˜¯ matchParentï¼Œé‚£ä¹ˆæ­¤ child tree æµ‹é‡å¾—åˆ°çš„ size å°†ä¼šæ˜¯æœ€å¤§åŒ–çš„ï¼Œå¯è¾¾åˆ° RelativeLayout size çš„ä¸Šé™ï¼Œè€Œå…¶ä½™å¸¸è§ ViewGroup æ²¡æœ‰æ­¤ç‰¹ç‚¹ï¼Œæ¯”å¦‚ LinearLayout, FrameLayout, ConstraintLayout ç­‰ã€‚ ç©¶å…¶åŸå› ï¼Œå¯ä»¥ä» RelativeLayout ä¸­çš„ onMeasure æ–¹æ³•æ‰¾ã€‚ 1234567891011@Overrideprotected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) &#123; for (int i = 0; i &lt; count; i++) &#123; final View child = views[i]; if (child.getVisibility() != GONE) &#123; final LayoutParams params = (LayoutParams) child.getLayoutParams(); applyVerticalSizeRules(params, myHeight, child.getBaseline()); measureChild(child, params, myWidth, myHeight); ...&#125; ä¸Šé¢æ˜¯ RelativeLayout#onMeasure çš„ç‰‡æ®µï¼Œå¯çŸ¥å¯¹æ‰€æœ‰ child è°ƒç”¨äº† measureChild æ–¹æ³•ï¼Œè€Œè¿™æ˜¯ä¸ª RelativeLayout çš„ private æ–¹æ³•ï¼š 1234567891011121314151617181920212223/** * Measure a child. The child should have left, top, right and bottom information * stored in its LayoutParams. If any of these values is VALUE_NOT_SET it means * that the view can extend up to the corresponding edge. * * @param child Child to measure * @param params LayoutParams associated with child * @param myWidth Width of the the RelativeLayout * @param myHeight Height of the RelativeLayout */private void measureChild(View child, LayoutParams params, int myWidth, int myHeight) &#123; int childWidthMeasureSpec = getChildMeasureSpec(params.mLeft, params.mRight, params.width, params.leftMargin, params.rightMargin, mPaddingLeft, mPaddingRight, myWidth); int childHeightMeasureSpec = getChildMeasureSpec(params.mTop, params.mBottom, params.height, params.topMargin, params.bottomMargin, mPaddingTop, mPaddingBottom, myHeight); child.measure(childWidthMeasureSpec, childHeightMeasureSpec);&#125; ä»ä¸Šè¿°æ–¹æ³•çœ‹ï¼Œå…ˆè·å–åˆ° child measureSpecï¼Œç„¶åä¾æ¬¡ä¸ºå‚æ•°æ¥ measure æ¯ä¸ª childã€‚å†è¿›å…¥åˆ° RelativeLayout#getChildMeasureSpec è¿™ä¸ªæ–¹æ³•ä¸­çœ‹çœ‹ä¸‹é¢çš„é€»è¾‘ï¼š 123456789101112131415161718192021222324252627282930313233343536if (childStart != VALUE_NOT_SET &amp;&amp; childEnd != VALUE_NOT_SET) &#123; // Constraints fixed both edges, so child must be an exact size. childSpecMode = isUnspecified ? MeasureSpec.UNSPECIFIED : MeasureSpec.EXACTLY; childSpecSize = Math.max(0, maxAvailable);&#125; else &#123; if (childSize &gt;= 0) &#123; // Child wanted an exact size. Give as much as possible. childSpecMode = MeasureSpec.EXACTLY; if (maxAvailable &gt;= 0) &#123; // We have a maximum size in this dimension. childSpecSize = Math.min(maxAvailable, childSize); &#125; else &#123; // We can grow in this dimension. childSpecSize = childSize; &#125; &#125; else if (childSize == LayoutParams.MATCH_PARENT) &#123; // Child wanted to be as big as possible. Give all available // space. childSpecMode = isUnspecified ? MeasureSpec.UNSPECIFIED : MeasureSpec.EXACTLY; childSpecSize = Math.max(0, maxAvailable); &#125; else if (childSize == LayoutParams.WRAP_CONTENT) &#123; // Child wants to wrap content. Use AT_MOST to communicate // available space if we know our max size. if (maxAvailable &gt;= 0) &#123; // We have a maximum size in this dimension. childSpecMode = MeasureSpec.AT_MOST; childSpecSize = maxAvailable; &#125; else &#123; // We can grow in this dimension. Child can be as big as it // wants. childSpecMode = MeasureSpec.UNSPECIFIED; childSpecSize = 0; &#125; &#125;&#125; ä»ä¸Šé¢å¯ä»¥çœ‹åˆ°ï¼ŒchileSpecMode èµ‹å€¼ä¸º MeasureSpec.AT_MOST çš„åœ°æ–¹åªæœ‰ 27 è¡Œä¸€ä¸ªåœ°æ–¹ï¼Œä¹Ÿå°±æ˜¯åªè¦ child å£°æ˜ä¸º match_parentï¼Œé‚£ä¹ˆ child çš„ specMode ä¸å‡ºæ„å¤–å°±ä¼šæ˜¯ EXACTLYã€‚è€Œ EXACTLY æ„å‘³ç€æ­¤ child ä¸ºæ ¹èŠ‚ç‚¹çš„ view tree çš„æµ‹é‡ç»“æœå°†ä¼šæ˜¯æ­¤ child çš„ specSizeï¼Œè€Œè¿™ä¸ª specSize æ˜¾ç„¶å°±æ˜¯ RelativeLayout èƒ½è¾¾åˆ°çš„æœ€å¤§ size (å¯èƒ½éœ€è¦å‡å» paddingï¼ŒRelativeLayout å…¶å®ƒ child å æ®çš„ç©ºé—´ç­‰)ã€‚ é¡ºä¾¿å†çœ‹çœ‹ LinearLayout ç­‰ç­‰ä¸ºå•¥ä¸æ˜¯è¿™æ ·çš„ï¼Œäº‹å®ä¸Š LinearLayout ç­‰ä½¿ç”¨çš„æ˜¯ ViewGroup è¿™ä¸ªæŠ½è±¡åŸºç±»ä¸­çš„ getChildMeasureSpec æ–¹æ³•ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546public static int getChildMeasureSpec(int spec, int padding, int childDimension) &#123; int specMode = MeasureSpec.getMode(spec); int specSize = MeasureSpec.getSize(spec); int size = Math.max(0, specSize - padding); int resultSize = 0; int resultMode = 0; switch (specMode) &#123; // Parent has imposed an exact size on us case MeasureSpec.EXACTLY: if (childDimension &gt;= 0) &#123; resultSize = childDimension; resultMode = MeasureSpec.EXACTLY; &#125; else if (childDimension == LayoutParams.MATCH_PARENT) &#123; // Child wants to be our size. So be it. resultSize = size; resultMode = MeasureSpec.EXACTLY; &#125; else if (childDimension == LayoutParams.WRAP_CONTENT) &#123; // Child wants to determine its own size. It can't be // bigger than us. resultSize = size; resultMode = MeasureSpec.AT_MOST; &#125; break; // Parent has imposed a maximum size on us case MeasureSpec.AT_MOST: if (childDimension &gt;= 0) &#123; // Child wants a specific size... so be it resultSize = childDimension; resultMode = MeasureSpec.EXACTLY; &#125; else if (childDimension == LayoutParams.MATCH_PARENT) &#123; // Child wants to be our size, but our size is not fixed. // Constrain child to not be bigger than us. resultSize = size; resultMode = MeasureSpec.AT_MOST; &#125; else if (childDimension == LayoutParams.WRAP_CONTENT) &#123; // Child wants to determine its own size. It can't be // bigger than us. resultSize = size; resultMode = MeasureSpec.AT_MOST; &#125; break; ... //noinspection ResourceType return MeasureSpec.makeMeasureSpec(resultSize, resultMode);&#125; ä»ä¸Šè¿°ä»£ç å¯ä»¥çœ‹åˆ°ï¼Œå¦‚æœ child å£°æ˜ä¸º matchParent ä½†æ˜¯ RelativeLayout çš„ specMode æ˜¯ AT_MOST çš„è¯ï¼Œé‚£ä¹ˆ child çš„ specMode å¦‚ç¬¬ 35 è¡Œæ‰€ç¤ºå°†ä¼šæ˜¯ AT_MOSTï¼Œè¿™å°±æ˜¯å’Œ RelativeLayout çš„ä¸åŒä¹‹å¤„ã€‚ æ€»ç»“ä¸€ä¸‹ï¼Œå³ä½¿ RelativeLayout çš„ specMode æ˜¯ AT_MOSTï¼Œåªè¦å®ƒçš„ child å£°æ˜ matchParentï¼Œé‚£ä¹ˆ child çš„ SpecMode ä¸€èˆ¬ä¼šæ˜¯ EXACTLYï¼Œæ­¤ child ä¸ºæ ¹èŠ‚ç‚¹çš„ viewTree çš„æµ‹é‡ç»“æœå°±æ˜¯æœ€å¤§åŒ–çš„ã€‚","categories":[],"tags":[{"name":"Android","slug":"Android","permalink":"https://tao93.top/tags/Android/"}]},{"title":"ä¸€é”®è®¾ç½® Android http proxy çš„å°è¯•","slug":"ä¸€é”®è®¾ç½® Android http proxy çš„å°è¯•","date":"2018-11-01T03:04:32.507Z","updated":"2018-11-01T03:04:32.507Z","comments":true,"path":"2018/10/31/ä¸€é”®è®¾ç½® Android http proxy çš„å°è¯•/","link":"","permalink":"https://tao93.top/2018/10/31/ä¸€é”®è®¾ç½® Android http proxy çš„å°è¯•/","excerpt":"","text":"è‡ªæ‰“æ¥åˆ°æ­å·åï¼Œè°ƒè¯• Android app æ—¶ç”¨ Charles åšä»£ç†çš„åœºæ™¯æˆäº†éå¸¸å¸¸è§çš„æ“ä½œï¼Œè€Œè®©äººçƒ¦æ¼çš„æ˜¯ï¼Œæ¯æ¬¡éƒ½éœ€è¦è¿›å…¥æ‰‹æœºçš„ WiFi -&gt; ç‚¹å‡»å½“å‰ WiFi -&gt; ç‚¹å‡»ç¼–è¾‘ -&gt; ç‚¹å‡» Advanced options -&gt; proxy é€‰æ‹© None æˆ–è€… Manual -&gt; ä¸Šä¸€æ­¥å¦‚æœé€‰äº† Manual, åˆ™éœ€è¦è¾“å…¥ IP åœ°å€å’Œç«¯å£å· -&gt; ä¿å­˜ã€‚ è¿™æ ·ä¸€ä¸ªå…­ä¸ƒæ­¥çš„æ­¥éª¤ï¼ŒçœŸçš„å¾ˆè®©äººçƒ¦ï¼Œè€Œå¦‚æœç”µè„‘çš„å±€åŸŸç½‘ IP åœ°å€ä¸å›ºå®šçš„è¯ï¼Œå°±æ›´åŠ è®©äººä¸çˆ½äº†ï¼Œæ„å‘³ç€æ¯æ¬¡ç”µè„‘é‡æ–°è”ç½‘åï¼Œæ‰‹æœºéƒ½éœ€è¦é‡æ–°è®¾ç½®ä»£ç†çš„ IPã€‚å°±ç®—ç”µè„‘ IP å›ºå®šï¼Œå½“æ‰‹æœºéœ€è¦ä½¿ç”¨ Charles ä»£ç†æˆ–è€…å…³é—­ä»£ç†ï¼Œéƒ½æ¯”è¾ƒéº»çƒ¦ã€‚æ‰€ä»¥å¾ˆä¹…å‰æˆ‘å°±æƒ³æœ‰æ²¡æœ‰æ–¹æ³•å¯ä»¥ä¸€é”®è®¾ç½®ä»£ç†ã€‚ æˆ‘çš„æ„æƒ³æ˜¯ï¼Œå¦‚æœç”µè„‘ IP åœ°å€ä¸å›ºå®šï¼Œé‚£ä¹ˆä¸€é”®è®¾ç½®éœ€è¦åœ¨ç”µè„‘ä¸Šæ“ä½œï¼Œä¸ç„¶æ— æ³•è·çŸ¥ç”µè„‘çš„ IPï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ç”µè„‘è¿è¡Œä¸ª socket serverï¼Œç„¶åæ‰‹æœºè¿æ¥ï¼Œç„¶åç”µè„‘æŠŠ IP å‘ç»™æ‰‹æœºã€‚å¦‚æœç”µè„‘ IP åœ°å€å›ºå®šï¼Œæœ€ç†æƒ³çš„åˆ™æ˜¯æ‰‹æœºä¸Šä¸€é”®è®¾ç½®ï¼Œè¿™æ ·å°±ä¸éœ€è¦ adb è¿æ¥äº†ã€‚ ç»è¿‡ä¸€ç•ª google å’Œæƒ¨ç—›çš„å°è¯•ï¼Œæˆ‘å¾—çŸ¥äº†ä¸¤ç§å¹¶ä¸å®Œç¾çš„æ–¹æ³•ã€‚ æ–¹æ³•ä¸€ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253/** * è®¾ç½®ä»£ç†ä¿¡æ¯ exclListæ˜¯æ·»åŠ ä¸ç”¨ä»£ç†çš„ç½‘å€ç”¨çš„ * */ public static void setHttpProxySetting(Context context, String host, int port) throws ClassNotFoundException, NoSuchMethodException, InvocationTargetException, IllegalAccessException, NoSuchFieldException &#123; WifiManager wifiManager =(WifiManager)context.getSystemService(Context.WIFI_SERVICE); WifiConfiguration config = getCurrentWifiConfiguration(wifiManager); ProxyInfo mInfo = ProxyInfo.buildDirectProxy(host,port); if (config != null)&#123; Class clazz = Class.forName(\"android.net.wifi.WifiConfiguration\"); Class parmars = Class.forName(\"android.net.ProxyInfo\"); Method method = clazz.getMethod(\"setHttpProxy\",parmars); method.invoke(config,mInfo); Object mIpConfiguration = getDeclaredFieldObject(config,\"mIpConfiguration\"); setEnumField(mIpConfiguration, \"STATIC\", \"proxySettings\"); setDeclardFildObject(config,\"mIpConfiguration\", mIpConfiguration); // save the settings wifiManager.updateNetwork(config); wifiManager.disconnect(); wifiManager.reconnect(); &#125; &#125; /** * å–æ¶ˆä»£ç†è®¾ç½® * */ public static void unSetHttpProxy(Context context) throws ClassNotFoundException, InvocationTargetException, IllegalAccessException, NoSuchFieldException, NoSuchMethodException &#123; WifiManager wifiManager = (WifiManager) context.getSystemService(Context.WIFI_SERVICE); WifiConfiguration configuration = getCurrentWifiConfiguration(wifiManager); ProxyInfo mInfo = ProxyInfo.buildDirectProxy(null, 0); if (configuration != null)&#123; if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.O) &#123; configuration.setHttpProxy(mInfo); &#125; else &#123; Class clazz = Class.forName(\"android.net.wifi.WifiConfiguration\"); Class parmars = Class.forName(\"android.net.ProxyInfo\"); Method method = clazz.getMethod(\"setHttpProxy\",parmars); method.invoke(configuration,mInfo); Object mIpConfiguration = getDeclaredFieldObject(configuration,\"mIpConfiguration\"); setEnumField(mIpConfiguration, \"NONE\", \"proxySettings\"); setDeclardFildObject(configuration,\"mIpConfiguration\",mIpConfiguration); &#125; wifiManager.updateNetwork(configuration); wifiManager.disconnect(); wifiManager.reconnect(); &#125; &#125; ä¸Šé¢çš„æ–¹æ³•ç›´æ¥è·å–åˆ°å½“å‰è¿æ¥çš„ WiFi configurationï¼Œç„¶åæŠŠå®ƒçš„ http proxy ç±»å‹ (æšä¸¾å˜é‡ï¼Œä¸»è¦æ˜¯ NONE å’Œ STATIC ä¸¤ä¸ªå€¼)ï¼Œå’Œå€¼ (å³ IP å’Œ port) ç”¨åå°„çš„æ–¹æ³•è®¾ç½®è¿›å»ï¼Œç„¶åæ›´æ–° WiFi configurationï¼Œå¹¶æ–­å¼€ WiFi å¹¶é‡æ–°è¿æ¥ WiFiã€‚ä»¥ä¸Šè®¾ç½®ä»£ç†å’Œå…³é—­ä»£ç†çš„åŠ¨ä½œï¼Œå…¨éƒ¨ç”±ä¸Šé¢çš„ä»£ç ä¸€é”®å®Œæˆï¼Œç›´æ¥åœ¨æ‰‹æœºä¸Šè¿è¡Œå³å¯ï¼Œå¹¶ä¸”ä»£ç è¿è¡Œç»“æœå’Œæ‰‹æœº Settings ä¸­çš„ UI ç»“æœæ˜¯ä¸€è‡´çš„ï¼Œæ„Ÿè§‰ç›¸å½“å®Œç¾ã€‚ ç„¶è€Œæ–¹æ³•ä¸€ä¸æ”¯æŒ API 23 ä»¥ä¸Šçš„ Android ç³»ç»Ÿï¼Œè€Œæ‰€ç”¨ API 21 æµ‹è¯•æ˜¯å¯ä»¥å®Œç¾è¿è¡Œçš„ï¼Œåœ¨å¦‚ä»Š API 28 éƒ½å‘å¸ƒäº†çš„æ—¶å€™ï¼Œä¸æ”¯æŒ API 23 ä»¥ä¸Šå¯ä»¥è¯´è®©å®ç”¨æ€§å¤§æ‰“æŠ˜æ‰£ã€‚ä¸è¿‡è¿™æ˜¯å¯ä»¥ç†è§£çš„ï¼Œæ¯•ç«Ÿå¤„äºå®‰å…¨è€ƒè™‘ï¼Œä¸èƒ½è®©ç”¨æˆ·çš„æ‰‹æœºéšä¾¿è¢«ç¬¬ä¸‰æ–¹ app é»˜é»˜ä¿®æ”¹äº†ä»£ç†ï¼Œè¿™å¤ªå±é™©äº†ã€‚ æ–¹æ³•äºŒï¼š 1adb shell settings put global http_proxy &lt;ip&gt;:&lt;port&gt; æ‰§è¡Œä»¥ä¸Šå‘½ä»¤åï¼ŒSettings ä¸­çš„ UI å¹¶æœªæ›´æ”¹ï¼Œä½†æ˜¯ä»£ç†å·²ç»ç”Ÿæ•ˆã€‚è¿™ä¸€æ–¹æ³•å®é™…æ˜¯æ–°å¢äº† Settings Provider ä¸­çš„ key valueï¼Œæœ‰ä¸¤ç§æ–¹å¼å¯ä»¥æŸ¥çœ‹åˆ°è¿™ä¸€æ–°å¢ key value: 123adb shell settings get global http_proxyadb shell settings get global global_http_proxy_hostadb shell settings get global global_http_proxy_port 123String httpProxy = android.provider.Settings.Global.getString(contentResolver, android.provider.Settings.Global.HTTP_PROXY);String httpProxyHost = android.provider.Settings.Global.getString(contentResolver, android.provider.Settings.Global.GLOBAL_HTTP_PROXY_HOST);String httpProxyPort = android.provider.Settings.Global.getString(contentResolver, android.provider.Settings.Global.GLOBAL_HTTP_PROXY_PORT); Android ä¸è¿è¡Œç¬¬ä¸‰æ–¹åº”ç”¨æ–°å¢è¿™æ ·çš„å±æ€§å€¼ï¼Œè€Œåªæœ‰ read çš„æƒé™ï¼Œæ‰€ä»¥éœ€è¦ adb æ¥æ–°å¢è¿™äº›å±æ€§å€¼ï¼Œé™¤äº†è¿™ä¸ªç¼ºç‚¹ï¼Œè¿˜æœ‰æ›´è‡´å‘½çš„ç¼ºé™·ã€‚æ–¹æ³•äºŒçš„ reset proxy çš„æ–¹æ³•æ˜¯ï¼š 123456adb shell settings delete global http_proxyadb shell settings delete global global_http_proxy_hostadb shell settings delete global global_http_proxy_port# æ˜¯çš„ï¼Œç›®å‰æˆ‘å·²çŸ¥çš„æ–¹æ³•ï¼Œåªæœ‰é‡å¯æ‰èƒ½è®©ä¸Šè¿° delete ç”Ÿæ•ˆï¼Œå½“ç„¶æ‰‹åŠ¨é‡å¯éƒ½å¯ä»¥ã€‚adb reboot è¦ reset proxyï¼Œåˆ é™¤ key value å’Œé‡å¯ (ç›®å‰æˆ‘åªçŸ¥é“é‡å¯å¯ä»¥) ç¼ºä¸€ä¸å¯ï¼Œå¦åˆ™è®¾å¤‡åªèƒ½é€šè¿‡ proxy ä½¿ç”¨ httpã€‚ä¹Ÿå°±æ˜¯è¿åˆ«çš„ wifi æˆ–è€…ä½¿ç”¨æ•°æ®æµé‡éƒ½ä¸èƒ½ä½¿ç”¨ httpï¼è¦æƒ³ä¸é‡å¯ï¼Œé™¤éåœ¨å°† key value è®¾ç½®ä¸ºå¦ä¸€ä¸ªæœ‰æ•ˆçš„ proxy é…ç½®ï¼Œè¿™ä¸ªç¼ºé™·å¯ä»¥è¯´éå¸¸è‡´å‘½äº†ã€‚","categories":[],"tags":[{"name":"Android","slug":"Android","permalink":"https://tao93.top/tags/Android/"}]},{"title":"ShadowSocks for Gradle & Shell","slug":"æ³¨æ„ä¸‹é¢çš„ç«¯å£å·ä¸ä¸€å®šæ˜¯ 1086","date":"2018-10-18T07:11:58.403Z","updated":"2019-07-05T14:04:20.267Z","comments":true,"path":"2018/10/18/æ³¨æ„ä¸‹é¢çš„ç«¯å£å·ä¸ä¸€å®šæ˜¯ 1086/","link":"","permalink":"https://tao93.top/2018/10/18/æ³¨æ„ä¸‹é¢çš„ç«¯å£å·ä¸ä¸€å®šæ˜¯ 1086/","excerpt":"","text":"ShadowSocks æ˜¯ä¸ªå¾ˆå¥½çš„å·¥å…·ï¼Œå®ƒè‡ªå¸¦ PAC æ¨¡å¼å’Œå…¨å±€æ¨¡å¼ã€‚ ä¸è¿‡è¿™ä¸ªå…¨å±€æ¨¡å¼å¹¶ä¸èƒ½å®Œå…¨è®©æ•´å°ç”µè„‘çš„æ‰€æœ‰ç½‘ç»œè®¿é—®å…¨éƒ¨é€šè¿‡ä»£ç†è¿›è¡Œï¼Œæ¯”å¦‚ç»ˆç«¯å‘½ä»¤å°±ä¸å¯ä»¥ã€‚æˆ‘æ‰“å¼€å…¨å±€ä»£ç†åï¼Œç„¶ååœ¨ç»ˆç«¯æ‰§è¡Œ curl ip.cn å‘½ä»¤ï¼Œç»“æœæ˜¾ç¤ºæ£€æŸ¥åˆ°çš„ IP åœ°å€ä¾ç„¶æ˜¯æœ¬æœºçœŸå®çš„å…¬ç½‘ IP: 12âœ ~ curl ip.cnå½“å‰ IPï¼š122.225.224.218 æ¥è‡ªï¼šæµ™æ±Ÿçœæ­å·å¸‚ ç”µä¿¡ è¦è®© shell ä¹Ÿä½¿ç”¨ä»£ç†ï¼Œå¯ä»¥æ‰§è¡Œä¸€ä¸‹å‘½ä»¤æ¥è®¾ç½®ä»£ç†ï¼š 12# æ³¨æ„ä¸‹é¢çš„ç«¯å£å·ä¸ä¸€å®šæ˜¯ 1086export ALL_PROXY=socks5://127.0.0.1:1086 ä¸Šé¢æˆ‘ä½¿ç”¨çš„ç«¯å£å·æ˜¯ 1086ï¼Œè¿™æ˜¯å› ä¸ºæˆ‘çš„ ShadowSocks å®¢æˆ·ç«¯çš„åå¥½è®¾ç½®ä¸­å¦‚ä¸‹æ‰€ç¤ºçš„è®¾ç½®é¡¹æ˜¯ 1086: ä½†æ˜¯æ¯æ¬¡éƒ½æ‰§è¡Œä¸Šé¢çš„ export å‘½ä»¤å¾ˆéº»çƒ¦ï¼Œé‚£ä¹ˆå¯ä»¥åœ¨ shell çš„é…ç½®æ–‡ä»¶ä¸­è®¾ç½® aliasï¼š 12345# enable proxyalias proxy=\"export ALL_PROXY=socks5://127.0.0.1:1086\"# disable proxyalias unproxy=\"unset ALL_PROXY\" å‰ä¸¤å¤©æˆ‘å‘ç°åœ¨å®¶çš„æ—¶å€™ï¼ŒAndroid Studio æ— æ³•è®¿é—® Google çš„ maven ä»“åº“ï¼Œå³ä½¿æˆ‘å¼€å…¨å±€ä»£ç†ä¹Ÿä¸è¡Œï¼Œå³ä½¿æˆ‘åœ¨ terminal ä¸­æŒ‰å‰é¢æ–¹æ³•è®¾ç½® proxy å¹¶ä¸”ä½¿ç”¨ gradle å‘½ä»¤æ¥æ„å»ºä¹Ÿä¸è¡Œã€‚ ä¸ºæ­¤ï¼Œæˆ‘æ‰¾åˆ°äº†å‘ gradle è®¾ç½® proxy çš„æ–¹æ³•ï¼Œé‚£å°±æ˜¯åœ¨é¡¹ç›®çš„ local.properties æ–‡ä»¶ï¼ˆä¹‹æ‰€ä»¥é€‰è¿™ä¸ªæ–‡ä»¶æ˜¯å› ä¸ºè¿™ä¸ªæ–‡ä»¶ä¸€èˆ¬æ˜¯ä¸çº³å…¥ git ç®¡ç†çš„ï¼Œæ‰€ä»¥æˆ‘å¯ä»¥éšä¾¿è‡ªå®šä¹‰åœ°ä¿®æ”¹ï¼‰åŠ å…¥ä¸‹é¢çš„è®¾ç½®ï¼Œå³å¯è®© gradle ä½¿ç”¨ä»£ç†ï¼š 1org.gradle.jvmargs=-Xmx4536m -DsocksProxyHost=127.0.0.1 -DsocksProxyPort=1086 ä¸Šé¢çš„ç«¯å£å·å’Œå‰é¢çš„æ–¹æ³•ä¸­æ˜¯ä¸€è‡´çš„ã€‚","categories":[],"tags":[{"name":"ShadowSocks","slug":"ShadowSocks","permalink":"https://tao93.top/tags/ShadowSocks/"}]},{"title":"Don't let Your App Drain your Users' Battery","slug":"Don't let Your App Drain your Users' Battery","date":"2018-10-10T08:52:40.506Z","updated":"2019-07-05T14:01:39.879Z","comments":true,"path":"2018/10/10/Don't let Your App Drain your Users' Battery/","link":"","permalink":"https://tao93.top/2018/10/10/Don't let Your App Drain your Users' Battery/","excerpt":"","text":"What drives battery Life? Hardware (Screen etc.) Operating System Apps &amp; Services User Interaction Efforts to improve battery Job Scheduler (Since API 21) Doze &amp; App Standby(Since API 23) Doze on-the-go (Since API 24) Background Limits (Since API 26) Adaptive Battery, Background Restrictions etc. (Since API 28) Among the above only Job Scheduler could be directly leveraged by app developers in the code. Job Scheduler (Since API 21)Job Scheduler is suitable when we want to do something in a specified circumstance, such as: Batterry is not Low With specified Netwoek Status Is Charging Storage is not Low Device is Idle Without Job Scheduler, we may need to keep a service running to monitor specified system broadcast and then do what we want, which is not optimized for battery comparing to Job Scheduler. Here is a simple example of Job Scheduler: 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566public class MyJobService extends JobService &#123; @Override public boolean onStartJob(final JobParameters params) &#123; new AsyncTask&lt;Void, Void, Void&gt;() &#123; @Override protected Void doInBackground(Void... voids) &#123; // stuffs that consumes a lot of time like making a backup to the cloud return null; &#125; @Override protected void onPostExecute(Void aVoid) &#123; // tell scheduler our job is done jobFinished(params, false); &#125; &#125;.execute(); // return true to tell scheduler our job is not finished. return true; &#125; @Override public boolean onStopJob(JobParameters params) &#123; return false; &#125;&#125;public class MainActivity extends Activity &#123; private static int sJobId = 0; private JobScheduler mJobScheduler; @Override protected void onCreate(Bundle savedInstanceState) &#123; super.onCreate(savedInstanceState); setContentView(R.layout.activity_main); mJobScheduler = (JobScheduler)getSystemService(Context.JOB_SCHEDULER_SERVICE); findViewById(R.id.schedule_btn).setOnClickListener(new View.OnClickListener() &#123; @Override public void onClick(View v) &#123; scheduleAJob(); &#125; &#125;); &#125; public void scheduleAJob() &#123; for (JobInfo info : mJobScheduler.getAllPendingJobs()) &#123; if (info.getId() == sJobId) &#123; // the last scheduled job is not finished yet return; &#125; &#125; // build the jobInfo that requires charging, idle and network that won't charge. JobInfo jobInfo = new JobInfo.Builder(++ sJobId, new ComponentName(this, MyJobService.class)) .setRequiresCharging(true) .setRequiresDeviceIdle(true) .setRequiredNetworkType(JobInfo.NETWORK_TYPE_UNMETERED) .build(); mJobScheduler.schedule(jobInfo); &#125;&#125; Doze (Since API 23)Unplugged and stationary for a period of time, a device would be in doze mode, which restricts all apps regardless whether they targets api 23. However, the OS periodically exits Doze for a brief time to let apps complete their deferred jobs. The bried time slot is called Maintenance window. Below is a figure showing the mode changing: In doze mode, the following are restricted: Network access is suspended WakeLock is ignored Standard AlarmManager alarms (setExact() and setWindow()) are deferred to the next maintenance window No Wi-Fi scaning No Sync Adapters No JobScheduler jobs Stuffs not restricted by Doze: FCM high priority msg Alarms set with setAndAllowWhileIdle() and setExactAndAllowWhileIdle() Testing Doze: 123456789# if your device is connected with a cable, use the following to disable chargingadb shell dumpsys battery unplug# Force the system into Doze modeadb shell dumpsys deviceidle force-idle# exit idle mode &amp; reactivate the deviceadb shell dumpsys deviceidle unforceadb shell dumpsys battery reset # this also recovers charging App Standby (Since API 23)An app is idle if the followings are satisfies: No user touching for a certain period of time No processes in the foreground (either as an activity or foreground service) No notifications showing on the lock screen or in the notification center. Not charging Testing App Standby: 1234567891011# if your device is connected with a cable, use the following to disable chargingadb shell dumpsys battery unplug# check whether your app is in standby mode. A 'Idle=false' output means not in standby modeadb shell am get-inactive &lt;packageName&gt;# Force the app into App Standby modeadb shell am set-inactive &lt;packageName&gt; true# exit Standby mode for your appadb shell am set-inactive &lt;packageName&gt; false Doze on-the-go (Since API 24)A lighter Doze mode which activates when the phone is moving in our pockets or hands. Doze on-the-go allows WakeLock, Wifi Scaning and GPS etc, thatâ€™s why itâ€™s lighter than former Doze mode introduced in API 23. Ignore Doze configuration: Background Limits (Since API 26)Background Limits affects apps that targets API 26 or higher and includes Background Service Limitations and Broadcast Limitations. Background Service LimitationsFor an app that targets API 26 or higher, itâ€™s in background if: No visible Activity No foreground Service Not InputMethod Service, Wallpaper service etc. After several minutes of being in background, background services are stopped by the OS. Replacing background services with Scheduler Jobs is fine in many cases. Broadcast Limitations (Introduced in API 25 and strengthened in API 26)For an app that targets API 26 or higher, it: canâ€™t register receivers for implicit broadcasts in Manifest file can register receivers for explicit broadcasts in Manifest file can register receivers for any broadcasts runtimely Broadcasts that require a signature permission are exempted from this restriction. In some cases, registering system broadcasts could be replaced by Scheduler Jobs, such as if we want to do something when the device is charging. Adaptive Battery (Since API 29)A new feature based on Machine Learning. Limit battery for apps that are not used often. Apps should be able to run quickly when they are needed. Donâ€™t bother users to manage manually. Apps are arranged into 4 standby buckets: Active, Working set, Frequent and Rare. Limits are increased from Active to Rare: An app is in Active if it: has launched an activity is running a foreground service has a sync adapter associated with a content provider used by a foreground app has a notification clicked by the user An app is in Working set if it runs often but isnâ€™t active. An app is in Frequent if it is used regularly, but not necessarily every day. An app is in Rare if it is not often used. Find out what bucket the app is currently in programmatically: 1UsageStatsManager.getAppStandbyBucket() Test Standby Buckets: 123456# assgin your app into a specified bucketadb shell am set-standby-bucket &lt;packagename&gt; active|working_set|frequent|rare# check bucket assignments for one app or all apps# the output '10 20 30 40' mean Active, Working set, Frequent, Rare respectivelyadb shell am get-standby-bucket [&lt;packagename&gt;] Battery SaverNew battery saver in API 29: No red status bar and has animation Location service is off when screen is off Battery level threshold is adjustable Apps are encouraged to switch to dark theme when battery saver is on. Check whether battery saver is on programmatically: 1((PowerManager)getSystemService(Context.POWER_SERVICE)).isPowerSaveMode() Test battery saver: 12345# pretend to be in low battery statusadb shell settings put global low_power 1# reset all configurationsadb shell dumpsys battery reset Background Restrictions (Since API 29)Two criterias: Apps targeting pre-Oreo and using background services Excessive WakeLocks (&gt; 1hr in background) Background restrictions are decided by the users: When Background Restrictions is enabled for an app, fllowings are restricted: Background jobs, alarms, services and network accessing Location related updates Foreground services Except GUI operation, Background restrictions could alse be finished via adb: 12345# enable background restrictionsadb shell appops set &lt;package_name&gt; RUN_ANY_IN_BACKGROUND ignore# disable background restrictionsadb shell appops set &lt;package_name&gt; RUN_ANY_IN_BACKGROUND allow","categories":[],"tags":[{"name":"Android","slug":"Android","permalink":"https://tao93.top/tags/Android/"}]},{"title":"é€šè¿‡ wifi è¿æ¥ adb","slug":"é€šè¿‡ wifi è¿æ¥ adb","date":"2018-09-26T07:47:46.693Z","updated":"2018-09-26T07:47:46.694Z","comments":true,"path":"2018/09/26/é€šè¿‡ wifi è¿æ¥ adb/","link":"","permalink":"https://tao93.top/2018/09/26/é€šè¿‡ wifi è¿æ¥ adb/","excerpt":"","text":"Android è°ƒè¯•æœ‰ä¸ªè®©äººä¸å¼€å¿ƒçš„åœ°æ–¹ï¼Œé‚£å°±æ˜¯å¦‚æœç”¨çœŸæœºè°ƒè¯•ï¼Œéœ€è¦ç”¨æ•°æ®çº¿è¿æ¥åˆ° Android è®¾å¤‡ï¼Œè€Œå¯¹äº type C æ¥å£çš„ MacBookï¼Œå¦‚æœæ²¡æœ‰åŒç«¯ type C æ•°æ®çº¿ï¼Œé‚£ä¹ˆè¿˜å¾—ç”¨è½¬æ¥å™¨æ‰è¡Œã€‚ç›¸æ¯”è¾ƒçœŸæœºè°ƒè¯•ï¼Œå…¶å®è¿˜å¯ä»¥ç”¨æ¨¡æ‹Ÿå™¨ï¼Œä¸è¿‡æ¨¡æ‹Ÿå™¨åªèƒ½æ”¯æŒ x86 ç±»å‹çš„ native åº“ï¼Œå¹¶ä¸”ä¹Ÿè¿˜ä¼šæœ‰ä¸€äº›å…¶ä»–å±€é™æ€§ã€‚ å…¶å®ï¼ŒçœŸæœºä¹Ÿæ˜¯å¯ä»¥ç”¨å±€åŸŸç½‘æ— çº¿è¿æ¥çš„ï¼Œåªéœ€è¦ç”µè„‘å’Œ Android è®¾å¤‡åœ¨åŒä¸€ä¸ªå±€åŸŸç½‘å†…ã€‚å¤§è‡´æ­¥éª¤å°±æ˜¯ä¸‹é¢å‡ æ¡å‘½ä»¤ï¼š 12345678910# å…ˆç”¨æ•°æ®çº¿è¿æ¥ï¼Œç¡®ä¿ adb devices å¯ä»¥çœ‹åˆ°è®¾å¤‡# è®© adb server é‡æ–°ä»¥ tcp æ¨¡å¼å¯åŠ¨ï¼Œç«¯å£æŒ‡å®šä¸º 5555adb tcpip 5555# ç”µè„‘å’Œæ‰‹æœºä¹‹é—´å»ºç«‹æ— çº¿è¿æ¥adb connect &lt;IP address of your Computer&gt;# æ‹”æ‰æ•°æ®çº¿ï¼Œæ­¤æ—¶å†æ£€æŸ¥ä¸€éæ˜¯å¦æ— çº¿è¿æ¥æˆåŠŸadb devices æ¯æ¬¡éƒ½æƒ³ä¸Šé¢è¿™æ ·æ‰§è¡Œä¸¤ä¸‰æ¡å‘½ä»¤æ˜¾ç„¶å¤ªç¹æ‚ï¼Œå°¤å…¶æ˜¯å…¶ä¸­è¿˜æœ‰ä¸€æ­¥è¦æ›¿æ¢ä¸ºç”µè„‘çš„å½“å‰å†…ç½‘ IPï¼Œæ‰€ä»¥åº”è¯¥å†™ä¸€ä¸ªè„šæœ¬æ¥æŠŠä¸Šé¢çš„ä¸œè¥¿ä¸€é”®æå®šï¼š 1234567891011121314151617181920212223#!/usr/bin/env bash# å…ˆæ–­å¼€ä¸€ä¸‹adb disconnectadb tcpip 5555# sleep ä¸¤ç§’ï¼Œä¸ç„¶çš„è¯å› ä¸ºåˆšæ‰§è¡Œ adb tcpip 5555 é‚£ä¹ˆåç»­çš„å‘½ä»¤ä¼šæ‰¾ä¸åˆ° devicessleep 2# æ£€æŸ¥æ˜¯å¦å®‰è£…äº†é»‘åŸŸadb shell pm list packages | grep 'me\\.piebridge\\.brevent'has_brevent=$?if [ $has_brevent -eq 0 ]; then # é‡æ–°å¯åŠ¨é»‘é˜ˆ adb -d shell sh /data/data/me.piebridge.brevent/brevent.shfi# è·å– android è®¾å¤‡çš„ IP åœ°å€android_ip=`adb shell \"ifconfig\" | grep 'inet.*cast' | awk '&#123;print $2&#125;' | awk -F':' '&#123;print $2&#125;'`echo 'Android device IP: ' $android_ipadb connect $android_ip ä¸Šé¢çš„è„šæœ¬ä¸­ï¼Œä¼šæ£€æŸ¥æ˜¯å¦å®‰è£…äº†é»‘é˜ˆï¼Œå¦‚æœå®‰è£…äº†ï¼Œå°±ä¼šé‡æ–°å¯åŠ¨é»‘é˜ˆã€‚é»‘é˜ˆæ˜¯ä¸€æ¬¾ç®¡ç† Android åº”ç”¨è¿è¡ŒçŠ¶æ€çš„åº”ç”¨ï¼Œç”¨æ¥é™åˆ¶åº”ç”¨å”¤é†’å’Œå¸¸é©»åå°ã€‚Android 8.0 ä»¥ä¸Šçš„ç³»ç»Ÿï¼Œåªè¦ USB è°ƒè¯•é€‰é¡¹å‘ç”Ÿå˜æ›´ï¼Œé»‘é˜ˆå°±ä¼šåœæ­¢èµ·ä½œç”¨ï¼Œæ‰€ä»¥æ­¤å¤„éœ€è¦é‡æ–°è®©å®ƒè¿è¡Œèµ·æ¥ã€‚å¦å¤–ä¸Šé¢çš„è„šæœ¬ä¸­è¿˜é€šè¿‡ ifconfig å‘½ä»¤æ¥è·å–åˆ°ç”µè„‘çš„å†…ç½‘ IPï¼Œç”¨äºæ‰§è¡Œ adb connect å‘½ä»¤ã€‚","categories":[],"tags":[{"name":"Android","slug":"Android","permalink":"https://tao93.top/tags/Android/"},{"name":"adb","slug":"adb","permalink":"https://tao93.top/tags/adb/"}]},{"title":"è®°ä¸€æ¬¡æ··æ·†é—®é¢˜å¯¼è‡´çš„ bug","slug":"è®°ä¸€æ¬¡æ··æ·†é—®é¢˜å¯¼è‡´çš„ bug","date":"2018-09-26T07:47:46.691Z","updated":"2019-07-05T14:04:42.596Z","comments":true,"path":"2018/09/26/è®°ä¸€æ¬¡æ··æ·†é—®é¢˜å¯¼è‡´çš„ bug/","link":"","permalink":"https://tao93.top/2018/09/26/è®°ä¸€æ¬¡æ··æ·†é—®é¢˜å¯¼è‡´çš„ bug/","excerpt":"","text":"æœ€è¿‘æŠŠ Card.IO æ”¹é€ æˆä¸€ä¸ª aar ä¾èµ–æä¾›ç»™å…¬å¸çš„é¡¹ç›®ä½¿ç”¨ã€‚è¿™ä¸ª aar ä¸­ä½¿ç”¨äº†å‡ ä¸ª so åº“ã€‚åªä¸è¿‡æ²¡æœ‰æä¾› armeabi ç±»å‹çš„ so åº“ï¼Œè€Œåªæœ‰ armeabi-v7a å’Œ armeabi-v8a ä¹‹ç±»çš„ so åº“ã€‚æ‰€ä»¥åˆæ¬¡æä¾›ç»™å…¬å¸é¡¹ç›®ä½¿ç”¨æ—¶ï¼Œå‡ºç°äº†æ‰¾ä¸åˆ° so çš„é”™è¯¯ï¼Œä¹Ÿå°±æ˜¯ UnsatisfiedLinkError é”™è¯¯ã€‚ä¹Ÿå°±æ˜¯ä¸‹é¢è¿™æ ·çš„æç¤ºï¼š åé¢æˆ‘æƒ³å°½åŠæ³•æä¾›äº† armeabi ç±»å‹çš„ so åº“ï¼Œè¿™ä¸ªé—®é¢˜å°±ç®—å‘Šä¸€æ®µè½äº†ï¼Œç„¶åè¿™è¿˜ä¸æ˜¯ç»“æŸã€‚ä»Šå¤©ï¼Œæµ‹è¯•åˆå‘äº†ä¸€æ®µå´©æºƒæ—¥å¿—ï¼Œä¹Ÿå°±æ˜¯ä¸‹é¢è¿™æ ·çš„æ—¥å¿—ï¼š å› ä¸ºä¹‹å‰å‡ºç°è¿‡æ‰¾ä¸åˆ° so åº“çš„é—®é¢˜ï¼Œæ‰€ä»¥ä¹ä¸€çœ‹ä¸Šé¢çš„æ—¥å¿—ï¼Œæˆ‘ä»¬éƒ½ä»¥ä¸ºåˆæ˜¯æ‰¾ä¸åˆ° so åº“ (ä¸ºæˆ‘ä»¬çš„èœè¡¨ç¤ºç¾æ„§ ğŸ¤©)ã€‚ç„¶åç»è¿‡ä¸Šç½‘æŸ¥æ‰¾ï¼Œå¹¶å’Œ native çš„ä»£ç å¯¹æ¯”ï¼Œæˆ‘æ‰æ„è¯†åˆ°ï¼Œä¸Šé¢çš„æ—¥å¿—å…¶å®æ˜¯ so åº“æ˜¯æ‰¾åˆ°äº†çš„ï¼Œåªä¸è¿‡æ˜¯åŠ è½½ so åº“æ—¶ï¼Œè°ƒç”¨ JNI_onLoad è¿™ä¸ª native æ–¹æ³•æ—¶å‡ºé”™äº†ã€‚æ­¤å¤–ï¼Œå‘æµ‹è¯•è¦äº† debug åŒ…ï¼Œå‘ç°æ²¡æœ‰é—®é¢˜ï¼Œæ‰€ä»¥åˆæ­¥æ–­å®šæ˜¯æ··æ·†çš„é—®é¢˜ï¼Œç„¶åå°±æ˜¯æ’æŸ¥äº†ã€‚ æˆ‘æŠŠæµ‹è¯•æä¾›ç»™æˆ‘çš„ release åŒ…åç¼–è¯‘ï¼Œç„¶åå’Œ JNI_onLoad æ–¹æ³•ä¸­çš„ native ä»£ç å¯¹æ¯”ï¼Œç»ˆäºæ‰¾åˆ°åŸå› äº†ï¼šrelease åŒ…ä¸­ï¼Œæˆ‘æä¾›çš„åº“çš„æŸä¸ªæ–¹æ³•è¢«æ··æ·†æ‰äº†ï¼Œä½†æ˜¯è¿™ä¸ªæ–¹æ³•æ˜¯éœ€è¦è¢« JNI_onLoad æ–¹æ³•è°ƒç”¨çš„ã€‚æ‰€ä»¥é—®é¢˜å°±æ˜¯ï¼šä¸€ä¸ªéœ€è¦è¢« so åº“è°ƒç”¨çš„ Java æ–¹æ³•è¢«æ··æ·†äº†ï¼å…¶å®ï¼Œå¾ˆå¤šæ—¶å€™æˆ‘ä»¬çš„é¡¹ç›®å¼•å…¥ä¸€äº›è‘—åçš„ç¬¬ä¸‰æ–¹åŒ… (æ¯”å¦‚ Knife ä¹‹ç±»çš„) æ—¶ï¼Œéƒ½ä¼šåœ¨æˆ‘ä»¬çš„é¡¹ç›®çš„ Proguard é…ç½®æ–‡ä»¶ä¸­å£°æ˜ä¸è¦æ··æ·†è¿™äº›ä¸‰æ–¹åŒ…çš„ä»£ç ï¼Œä¸ºçš„å°±æ˜¯é¿å…ä¸Šé¢è¿™ä¸ªé—®é¢˜ã€‚è¯´ä¸€å¥æ˜¾å¾—æœ‰ç‚¹åºŸè¯çš„è¯ï¼šç¬¬ä¸‰æ–¹åŒ…å‘å¸ƒæ··æ·†åŒ…æ—¶ï¼Œä»–ä»¬çš„ Proguard é…ç½®æ–‡ä»¶åªèƒ½åœ¨ä»–ä»¬çš„ aar åŒ…æ„å»ºæ—¶ç”Ÿæ•ˆï¼Œè€Œåœ¨ä»–ä»¬çš„ aar æ„å»ºåˆ°æˆ‘ä»¬çš„é¡¹ç›®ä¸­æ—¶ï¼Œä»–ä»¬çš„ Proguard æ—©å·²é­é•¿è«åŠä¸èµ·ä½œç”¨äº†ã€‚ å›åˆ°æˆ‘é‡åˆ°çš„è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬æœ¬åœ°è‡ªæµ‹æ—¶ï¼Œå¾ˆå°‘ä¼šè¿›è¡Œæ··æ·†ï¼Œæœ¬åœ°çš„ release é»˜è®¤éƒ½æ˜¯æœªæ··æ·†çš„ (minifyEnabled æ˜¯ false)ï¼Œæ‰€ä»¥è‡ªæµ‹çš„æ—¶å€™æ ¹æœ¬æ²¡æœ‰æ³¨æ„åˆ°è¿™ä¸ªé—®é¢˜ã€‚è¿™æ¬¡è¿™ä¸ª bug çš„è§£å†³åŠæ³•ä¹‹ä¸€æ˜¯ï¼Œåœ¨æœ€ç»ˆä½¿ç”¨æˆ‘çš„ aar çš„é¡¹ç›®ä¸­ï¼Œæ˜¾ç¤ºå£°æ˜ä¸è¦æ··æ·†æˆ‘è¿™ä¸ª aar ä¸­çš„æŸäº›ä»£ç ï¼Œè¿™å°±å’Œä¸Šä¸€æ®µè¯´çš„å£°æ˜ä¸æ··æ·†ç¬¬ä¸‰æ–¹åŒ…çš„ä»£ç æ˜¯ä¸€æ ·çš„ã€‚Butï¼Œè¿˜æœ‰ä¸€ç§æ›´å¥½çš„æ–¹æ³•ï¼Œé‚£å°±æ˜¯ä½¿ç”¨ com.android.support.support-annotations æ”¯æŒåº“ä¸­çš„ @Keep æ³¨è§£ï¼Œæ­¤æ³¨è§£å¯ä»¥æ ‡è®°å“ªäº›æ–¹æ³•æˆ–è€…ç±»åœ¨æœ€ç»ˆæ„å»º apk æ—¶ä¸ä¼šè¢«æ··æ·†æ‰ (å½“ç„¶åœ¨å‰é¢çš„ aar æ„å»ºç­‰è¿‡ç¨‹è‡ªç„¶ä¹Ÿä¸ä¼šæ··æ·†)ã€‚ æ€»ç»“ä¸€ä¸‹ï¼Œå½“å‰é¡¹ç›®çš„ Proguard é…ç½®æ–‡ä»¶åªèƒ½åœ¨å½“å‰é¡¹ç›®æ„å»ºè¾“å‡ºäº§ç‰©æ—¶èµ·ä½œç”¨ï¼Œè€Œæ— æ³•ç¡®ä¿è¾“å‡ºçš„äº§ç‰©äº¤ç»™å…¶ä»–é¡¹ç›®é›†æˆæ—¶ä¸è¢«æ··æ·†ã€‚è‹¥è¦ç¡®ä¿åè€…ï¼Œé‚£å°±å¯ä»¥ç”¨ support-annotations æ”¯æŒåº“ä¸­çš„æ³¨è§£äº†ã€‚","categories":[],"tags":[{"name":"Android","slug":"Android","permalink":"https://tao93.top/tags/Android/"}]},{"title":"è®°ä¸€ä¸ªç®€å•çš„é€’å½’é—®é¢˜ä¸è§£æ³•","slug":"è®°ä¸€ä¸ªç®€å•çš„é€’å½’é—®é¢˜ä¸è§£æ³•","date":"2018-09-26T07:47:46.682Z","updated":"2019-07-05T14:04:38.082Z","comments":true,"path":"2018/09/26/è®°ä¸€ä¸ªç®€å•çš„é€’å½’é—®é¢˜ä¸è§£æ³•/","link":"","permalink":"https://tao93.top/2018/09/26/è®°ä¸€ä¸ªç®€å•çš„é€’å½’é—®é¢˜ä¸è§£æ³•/","excerpt":"","text":"é€’å½’é—®é¢˜å°±åƒæ˜¯ä¿„ç½—æ–¯å¥—å¨ƒä¸€æ ·ç²¾å¦™ï¼Œå¤§çš„å¥—å°çš„ï¼Œä¸€å±‚ä¸€å±‚å¥—åœ¨ä¸€èµ·ã€‚ å‰äº›æ—¥å­ï¼Œä¸€ä¸ªæœ‹å‹è¯´çœ‹åˆ°ä¸€ä¸ªç®—æ³•é¢˜ç›®ï¼Œç„¶åé—®æˆ‘æœ‰æ€è·¯å—ï¼Ÿé—®é¢˜å°±æ˜¯ä¸‹é¢è¿™æ ·çš„ï¼š è¿™ä¸ªé—®é¢˜å¾ˆæ˜æ˜¾æ˜¯ä¸ªé€’å½’é—®é¢˜ã€‚æˆ‘å½“æ—¶å°±å¤¸ä¸‹æµ·å£è¯´ï¼Œ10åˆ†é’Ÿç»™ä½ å†™ä¸ª Python è„šæœ¬ã€‚è™½ç„¶å®é™…ä¸Šç”¨äº†æ¥è¿‘ 30 åˆ†é’Ÿã€‚ã€‚ã€‚ è¨€å½’æ­£ä¼ ï¼Œè¿™ä¸ªé—®é¢˜çš„é€’å½’å…³ç³»åŒ…å«ä¸¤ç§ï¼ŒåµŒå¥—å…³ç³»å’Œå¹¶åˆ—å…³ç³»ã€‚æ¯”å¦‚ 2[a]3[c] æœ€å¤–å±‚æ˜¯å¹¶åˆ—å…³ç³»ï¼Œå³ 2[a] å’Œ 3[c] æ˜¯ä¸¤ä¸ªäº’ç›¸å¹¶åˆ—çš„å­é—®é¢˜ï¼Œä»–ä»¬çš„è§£ç­”ä¸²èµ·æ¥å°±æ˜¯ 2[a]3[c] çš„è§£ç­”ã€‚è€Œ 2[2[a]] æœ€å¤–å±‚åˆ™æ˜¯ä¸€ä¸ªåµŒå¥—å…³ç³»ï¼Œå³è¦æ±‚ 2[2[a]] çš„è§£ç­”éœ€è¦å…ˆæ±‚å­é—®é¢˜ 2[a] çš„è§£ç­” (è¿™ä¸ªè§£ç­”æ˜¾ç¤ºå°±æ˜¯ aa)ï¼Œæ‰€ä»¥é—®é¢˜åŒ–è§£ä¸º 2[aa]ã€‚ æ‰€ä»¥æ€è·¯å°±æ˜¯ï¼Œå¯¹äºä¸€ä¸ªé—®é¢˜ Xï¼Œå…ˆæŒ‰å¹¶åˆ—å…³ç³»åˆ’åˆ†ä¸ºè‹¥å¹²ä¸ªå­é—®é¢˜ X1, X2, â€¦, Xnï¼›å¦‚æœ n å¤§äº 1ï¼Œé‚£ä¹ˆå„ä¸ªå­é—®é¢˜çš„ç­”æ¡ˆä¸²èµ·æ¥å°±æ˜¯ç­”æ¡ˆäº†ï¼›å¦‚æœ n ç­‰äº 1ï¼Œé‚£ä¹ˆè¯´æ˜ X æœ€å¤–å±‚å¹¶ä¸æ˜¯å¹¶åˆ—å…³ç³»è€Œæ˜¯åµŒå¥—å…³ç³»æˆ–è€…æ ¹æœ¬å°±æ˜¯å•ä¸ªå­—æ¯ï¼Œå¦‚æœ X æ˜¯å•ä¸ªå­—æ¯ï¼Œé‚£ä¹ˆç­”æ¡ˆå°±æ˜¯å®ƒæœ¬èº«ï¼Œåä¹‹ï¼Œé‚£ä¹ˆ X ä¸€å®šæ˜¯ s[Y] çš„å½¢å¼ï¼Œç­”æ¡ˆå°±æ˜¯ s ä¸ª Y çš„ç­”æ¡ˆä¸²èµ·æ¥ã€‚ 12345678910111213141516171819202122232425262728293031323334353637def p_loc(input, left): count = 1 i = left while count &gt; 0: i += 1 if input[i] == ']': count -= 1 elif input[i] == '[': count += 1 return idef do(input): if '[' not in input: return input first = input.find('[') i = p_loc(input, first) if i &lt; len(input) -1: parts = [] while i &lt; len(input) -1: parts.append(input[:i+1]) input = input[i+1:] first = input.find('[') i = p_loc(input, first) parts.append(input[:i+1]) res = '' for part in parts: res += do(part) return res else: right = p_loc(input, first) sub_res = do(input[first+1:right]) return int(input[:first]) * sub_res print(do('2[a]3[c]'))print(do('2[2[a]]'))print(do('2[2[a]]3[c]'))","categories":[],"tags":[{"name":"Algorithm","slug":"Algorithm","permalink":"https://tao93.top/tags/Algorithm/"}]},{"title":"æ—¥å¸¸ä¿® Bug","slug":"æ—¥å¸¸ä¿® Bug","date":"2018-09-26T07:47:46.680Z","updated":"2019-07-05T14:04:13.348Z","comments":true,"path":"2018/09/26/æ—¥å¸¸ä¿® Bug/","link":"","permalink":"https://tao93.top/2018/09/26/æ—¥å¸¸ä¿® Bug/","excerpt":"","text":"å‰å‡ å¤©æœ‰äººæŠ¥å‘Šå·´è¥¿ç‰ˆæœ¬ä¹˜å®¢ç«¯æ‰«æé“¶è¡Œå¡çš„ç•Œé¢æœ‰ bugï¼Œå³å±å¹•å³ä¾§æœ‰ä¸€æ¡ç™½çº¿ï¼Œä¹Ÿå°±æ˜¯ä¸‹å›¾æ‰€ç¤ºã€‚ é‰´äºæŠ¥å‘Šäººæ²¡æå…·ä½“çš„ç‰ˆæœ¬å·ï¼Œä¹Ÿæ²¡ææ€ä¹ˆå‡ºç°çš„ï¼Œä¹Ÿæ²¡ææ˜¯ä»€ä¹ˆæœºå‹å‡ºç°çš„ï¼Œæˆ‘å°±å’ŒæŠ¥å‘Šäººè¯´æ²Ÿé€šäº†ä¸€ç•ªã€‚æŠ¥å‘Šäººè¯´åº”è¯¥æ˜¯å°ç±³ 6 å‡ºç°è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘é‚å€Ÿäº†ä¸€éƒ¨å°ç±³ 6ï¼Œç„¶åè¿è¡Œ demo å¹¶æ²¡æœ‰å¤ç°ã€‚ç°åœ¨å°±æœ‰ä¸¤ç§å¯èƒ½ï¼Œç¬¬ä¸€æ˜¯åªæœ‰æŠ¥å‘Šäººé‚£å°å°ç±³ 6 æœ‰é—®é¢˜ï¼Œç¬¬äºŒæ˜¯ demo æ²¡é—®é¢˜ä½†æ˜¯é›†æˆåˆ°å·´è¥¿ç‰ˆæœ¬åå°±æœ‰é—®é¢˜äº†ã€‚ç»è¿‡è‰°è‹¦äº¤æ¶‰ï¼Œç»ˆäºä»å¯¹æ–¹é‚£é‡Œè¦åˆ°äº†ä¸€ä¸ªå®‰è£…åŒ…åï¼Œæˆ‘æ‰‹é‡Œæ‰‹æœºå¤ç°äº†æ­¤é—®é¢˜ï¼Œäº‹å®å¾ˆå¿«å°±æ¸…æ¥šäº†ï¼šdemo æ²¡é—®é¢˜ä½†æ˜¯é›†æˆåæœ‰é—®é¢˜ï¼Œä¹Ÿå°±æ˜¯å’Œæœºå‹å‹æ ¹æ²¡å…³ç³»ã€‚ å…ˆç›´æ¥ç»™å‡ºæœ€åä¿®å¤çš„æ–¹æ³•ï¼Œä¿®å¤æ–¹æ³•æ˜¯åœ¨æˆ‘çš„æ‰«å¡åº“çš„ activity ä¸­ï¼Œè°ƒç”¨ä»¥ä¸‹ä¸€è¡Œå°± OK äº†ï¼š 12// ç»™ PhoneWindow è®¾ç½®ä¸€ä¸ªèƒŒæ™¯ getWindow().setBackgroundDrawable(new ColorDrawable(Color.TRANSPARENT)); å—¯ï¼Œä¿®å¤æ–¹æ³•å¾ˆç®€å•ï¼Œä½†æ˜¯ä¸ºä»€ä¹ˆè¿™æ ·åšå°± work äº†å‘¢ï¼Ÿæ¥ä¸‹æ¥å°±æ˜¯è°ƒè¯•çš„è¿‡ç¨‹äº†. é¦–å…ˆè·å–ä¸€ä¸‹è¿™ä¸ªç•Œé¢çš„ layout ä¿¡æ¯ï¼Œå°è¯•çœ‹çœ‹å³ä¾§ç™½è‰²ç»†çº¿æ˜¯ä¸æ˜¯é¢å¤–å¡è¿›å»çš„è§†å›¾ï¼Œç»“æœå¹¶ä¸æ˜¯ã€‚ç„¶åæˆ‘å†çœ‹æ˜¯å¦æ˜¯è®¾ç½®äº†ä»€ä¹ˆ padding å¯¼è‡´äº†è¿™ä¸ªé—®é¢˜ã€‚äº‹å®ä¸Šï¼Œæ­£å¼è¿™æ ·çš„ï¼Œå¯æƒœæˆ‘å¯èƒ½æ˜¯çäº†çœ¼ï¼Œå±…ç„¶æ²¡æœ‰çœ‹åˆ°ä¸‹é¢çš„çº¿ç´¢ï¼Œå³ DecorView çš„å³ä¾§ padding æ˜¯ 2ï¼š æˆ‘åªçœ‹åˆ°äº†ä¸‹é¢çš„ LinearLayout çš„å®½åº¦æ˜¯1438ï¼Œæ¯”æˆ‘çš„æ‰‹æœºå±å¹•å®½åº¦1440å°‘äº†2ä¸ªåƒç´ ï¼Œæ˜¾ç„¶å°±æ˜¯å³ä¾§çš„ç™½çº¿äº†ã€‚ æ‰€ä»¥æˆ‘æ€ä¹ˆåŠå‘¢ï¼Œæˆ‘å¼€å§‹è°ƒè¯• measure å’Œ layout çš„è¿‡ç¨‹ã€‚å› ä¸º DecorView çš„å®½åº¦æ˜¯ 1440 æ²¡é”™ï¼Œå¯æ˜¯å®ƒçš„ Child LinearLayout å®½åº¦åªæœ‰ 1438ï¼Œæ‰€ä»¥æˆ‘å…ˆæ¡ä»¶æ–­ç‚¹åœ¨ LinearLayout ç±»ä¸­çš„ onMeasure æ–¹æ³•ã€‚æ–­ç‚¹çš„æ¡ä»¶æˆ‘æœ¬æ¥æƒ³å†™ getParent() instance DecorViewï¼Œç»“æœå‘ç°æ— æ³•åº”ç”¨ DecorViewï¼Œäºæ˜¯æˆ‘å°±æ”¹æˆäº† getParent() != null &amp;&amp; getParent().getParent() == nullï¼Œå…¶å®è¿™æ˜¯ä¸å¯¹çš„ï¼ŒDecorView åŒæ ·æœ‰ Parentï¼Œä¹Ÿå°±æ˜¯ ViewRootImpl å¯¹è±¡ï¼Œæˆ‘æŠŠè¿™ä¸ªç»™å¿˜äº†ã€‚æ‰€ä»¥æ–­ç‚¹æ¡ä»¶å°±æˆäº†ä¸‹é¢è¿™æ ·è‡ƒè‚¿çš„äº†ï¼š 123getParent() != null &amp;&amp; getParent().getParent() != null &amp;&amp; getParent().getParent().getParent() == null // å½“ç„¶å…¶å®è¿˜æœ‰æ›´ç®€æ´çš„æ–¹å¼ï¼Œæ¯”å¦‚ä¸‹é¢è¿™æ · getClass().getName.endswith(\"DecorView\") ç„¶åå‘ç°ä¸ç®¡æ˜¯ measure è¿˜æ˜¯ layout çš„è¿‡ç¨‹ï¼ŒLinearLayout å®½åº¦å§‹ç»ˆå°±æ˜¯ 1438ï¼ŒDecorView å°±åªç»™å®ƒç•™äº†è¿™ä¸ªå¤§ç©ºé—´ã€‚ç„¶åæˆ‘å¼€å§‹è°ƒè¯•åˆ° DecorView çš„æµ‹é‡è¿‡ç¨‹ä¸­ï¼Œæœ€åå‘ç°åœ¨ ViewGroup (è¿™é‡Œä»…ä»…æ˜¯ç”±äº DecorView æ˜¯ç»§æ‰¿è‡ª ViewGroup çš„) çš„ measureChildWithMargins æ–¹æ³•ä¸­ï¼Œæ‰¾åˆ°äº†å…³é”®çº¿ç´¢ï¼š ä¹Ÿå°±æ˜¯ä¸Šé¢çš„ mPaddingRight çš„å€¼å±…ç„¶æ˜¯ 2 è€Œä¸æ˜¯ 0ï¼Œè¿™æ„å‘³ç€ DecorView çš„å³ä¾§ padding æ˜¯2ï¼Œè¿™æ ·å°±èƒ½è§£é‡Šé€šä¸ºå•¥ DecorView çš„ child å®½åº¦å°äº† 2 äº†ã€‚è¿™æ˜¯æˆ‘èµ¶ç´§å›å»çœ‹ layout ä¿¡æ¯ï¼Œç„¶åå°±å‘ç°äº†æˆ‘æœ¬æ¥æ—©å°±è¯¥å‘ç°çš„çº¿ç´¢äº†ã€‚ OKï¼Œæ¥ä¸‹æ¥æ˜¯è¦çŸ¥é“ï¼Œè°æŠŠ DecorView çš„å³ä¾§ padding åŠ äº† 2 çš„ã€‚æˆ‘å¯¹ View ç±»çš„ mPaddingRight å±æ€§åŠ äº†ä¸‹å›¾æ‰€ç¤ºçš„æ–­ç‚¹ï¼š æœç„¶ï¼Œä¸ä¸€ä¼šå„¿ï¼Œæˆ‘å°±æœ‰äº†æ”¶è·ï¼Œå¾—åˆ°äº†ä¸‹é¢çš„å †æ ˆï¼š ä¸Šé¢å †æ ˆæ¸…æ™°äº†å±•ç¤ºäº†å³ä¾§ padding æ˜¯æ€ä¹ˆè¢«è®¾ç½®ä¸º 2 çš„ï¼Œæ¦‚æ‹¬æ¥è¯´ï¼Œå°±æ˜¯ PhoneWindow åœ¨å‡†å¤‡ DecorView æ—¶ï¼Œæ£€æŸ¥åˆ°æœ‰ä¸€ä¸ª Drawableï¼Œç„¶ååœ¨è®¾ç½®è¿™ä¸ª Drawable æ—¶ï¼Œå»è®¾ç½®äº† paddingã€‚é‚£ä¹ˆä¸ºä»€ä¹ˆè®¾ç½® Drawable éœ€è¦è®¾ç½® padding å‘¢ï¼Ÿçœ‹ä¸‹å›¾å°±æ˜ç™½äº†ï¼š åŸæ¥ï¼Œè¿™æ˜¯ä¸ªè‡ªå¸¦ padding çš„ NinePatchDrawableã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘å°±æŸ¥æ‰¾äº†ä¸€ä¸‹ï¼Œå‘ç°è¿™ä¸ª drawable å°±æ˜¯ PhoneWindow ä¸­çš„ mBackgroundsource å±æ€§è§£æè€Œæ¥ã€‚è¿™ä¸ªå±æ€§æ˜¯ä»åº”ç”¨ä¸»é¢˜ä¸­æŒ‡å®šçš„ã€‚ç°åœ¨å›åˆ°å‰é¢æˆ‘æå‰è´´å‡ºçš„è§£å†³æ–¹æ³•ä¹‹ä¸€ï¼š 1getWindow().setBackgroundDrawable(new ColorDrawable(Color.TRANSPARENT)) ä¸Šé¢çš„ä»£ç è°ƒç”¨ PhoneWindow çš„ setBackgroundDrawable æ–¹æ³•ï¼Œè¿™ä¸ªè°ƒç”¨é™¤äº†è®¾ç½® bg drawable å¤–ï¼Œè¿˜ç›´æ¥è®© mBackgroundsource å˜ä¸º 0ï¼Œæ‰€ä»¥åé¢å°±è½®ä¸åˆ°é‚£ä¸ª NinePatchDrawable äº†ã€‚ å…¶å®ï¼Œä¸Šé¢çš„è§£å†³æ–¹æ³•è¿˜æ˜¯æœ‰ç‚¹çªå…€ï¼Œå¦ä¸€ç§æ–¹æ³•æ˜¯ï¼Œåœ¨æ‰«å¡çš„åº“ä¸­è®¾ç½®ä¸€ä¸ªä¸»é¢˜ï¼Œè¿™æ ·çš„è¯ï¼Œå°±ä¸ä¼šåº”ç”¨å·´è¥¿ç‰ˆæœ¬ä¹˜å®¢ç«¯é¡¹ç›®ä¸­å£°æ˜çš„ä¸»é¢˜äº†ï¼Œè‡ªç„¶ä¹Ÿå°±ä¸ä¼šæŠŠé‚£ä¸ª NinePatchDrawable è®¾ç½®è¿›æ¥ã€‚ å†è¯´ç‚¹åˆ«çš„ã€‚è¿™ä¸ªæ‰«å¡çš„åº“ï¼Œè¢«é›†æˆåˆ°å¦ä¸€ä¸ªåº“ä¸­ï¼Œç„¶åå¦ä¸€ä¸ªåº“å†é›†æˆåˆ°å·´è¥¿ç‰ˆæœ¬ä¸­ã€‚ä¸­é—´è¿™ä¸ªåº“ï¼Œæˆ‘æ˜¯æ²¡æœ‰æ¶‰è¶³çš„ã€‚æ‰€ä»¥ä¸ºä¹ˆéªŒè¯æˆ‘æœ‰æ²¡æœ‰ä¿®å¤æˆåŠŸï¼Œæˆ‘åªèƒ½åœ¨æœ€ç»ˆçš„é¡¹ç›®ä¸­å†å¼•ç”¨ä¸€ä¸‹æˆ‘çš„åº“ç»è¿‡æ”¹åŠ¨åçš„ç‰ˆæœ¬ï¼Œå½“ç„¶ç‰ˆæœ¬å·ä¹Ÿè¦å¢åŠ ä¸€ä¸‹ã€‚è¿™æ ·çš„è¯ï¼Œå°±å¯ä»¥æ–°çš„è¦†ç›–æ—§çš„ï¼ŒæŠŠä¸­é—´é‚£ä¸ªåº“å¯¹æ‰«å¡åº“çš„å¼•ç”¨ç»™è¦†ç›–çš„ã€‚å”‰ï¼ŒçœŸæ˜¯æŠ˜è…¾ã€‚","categories":[],"tags":[{"name":"Android","slug":"Android","permalink":"https://tao93.top/tags/Android/"}]},{"title":"æé«˜å¼€å‘æ•ˆç‡çš„å„ç§å·¥å…·","slug":"æé«˜å¼€å‘æ•ˆç‡çš„å„ç§å·¥å…·","date":"2018-09-26T07:47:46.677Z","updated":"2019-07-05T14:04:08.836Z","comments":true,"path":"2018/09/26/æé«˜å¼€å‘æ•ˆç‡çš„å„ç§å·¥å…·/","link":"","permalink":"https://tao93.top/2018/09/26/æé«˜å¼€å‘æ•ˆç‡çš„å„ç§å·¥å…·/","excerpt":"","text":"ä¿—è¯è¯´ï¼Œå·¥æ¬²å–„å…¶äº‹å¿…å…ˆåˆ©å…¶å™¨ã€‚å¥½ç”¨çš„å¼€å‘å·¥å…·ï¼Œè™½ç„¶ä¸ä¼šç›´æ¥æ”¹å–„æˆ‘ä»¬å†™çš„ä»£ç ï¼Œä½†æ˜¯å¯¹äºæ•ˆç‡çš„æé«˜å’Œæé«˜èˆ’é€‚åº¦è¿˜æ˜¯å¾ˆæœ‰å¸®åŠ©çš„ã€‚æœ¬æ–‡æ„åœ¨æä¾›ä¸€äº›ä¸æ˜¯éå¸¸æ™®éä½¿ç”¨ï¼Œä½†æ˜¯å¯¹äºæ•ˆç‡æå‡å¯èƒ½éå¸¸æœ‰ç”¨çš„å·¥å…·ã€‚è¯ä¸å¤šè¯´ï¼Œå¼€å§‹æ­£æ–‡ï¼ å‰ªè´´æ¿å·¥å…· â€”â€” Clipyå‰ªè´´æ¿å·¥å…·å®åœ¨å¤ªå®ç”¨äº†ï¼Œä¸è¿‡ä¼¼ä¹å¤§éƒ¨åˆ†ç¨‹åºå‘˜éƒ½æ²¡æœ‰ç”¨ä¸Šå‰ªè´´æ¿å·¥å…·ã€‚è€Œ Clipy æ˜¯ä¸€æ¬¾å¾ˆåˆé€‚çš„å‰ªè´´æ¿å·¥å…·ï¼Œä»¥è‡³äºæˆ‘æƒ³èµ·å®ƒæ—¶ï¼Œç›´æ¥å°†å®ƒæ’åˆ°æœ€å‰é¢ï¼Œå¹¶ä¸”åºå·ç¼–ä¸º 0ã€‚Clipy æ˜¯ä¸€ä¸ªå¼€æºçš„å‰ªè´´æ¿å·¥å…·ï¼Œç®€æ´ä¸é—¹å¿ƒï¼Œå¤åˆ¶çš„å›¾ç‰‡å’Œæ–‡æœ¬éƒ½å¯ä»¥ç®¡ç†ï¼Œç”¨èµ·æ¥å¾ˆçˆ½ã€‚ oh-my-zshè¿™æ˜¯ä¸ªç»ˆç«¯åŠ å¼ºå·¥å…·ï¼ŒmacOS å’Œ Linux éƒ½å¯ç”¨ï¼ŒæŠŠé»˜è®¤ shell ä» bash æ”¹ä¸º zshï¼Œç„¶åå†åŠ å¼ºä¸€ä¸‹ã€‚æˆ‘åªç”¨çš„ oh-my-zsh çš„ 3 ä¸ª featuresï¼Œä½†è¿™ 3 ä¸ªéƒ½æ˜¯å¾ˆæœ‰å¸å¼•åŠ›çš„ã€‚ ç¬¬ä¸€ã€è‡ªå¸¦è¯†åˆ« git é¡¹ç›®ç›®å½•çš„åŠŸèƒ½ï¼Œç›´æ¥æ˜¾ç¤ºåˆ†æ”¯åã€æœ‰æ— æœªæäº¤çš„æœ¬åœ°ä¿®æ”¹ï¼› ç¬¬äºŒã€cd æ—¶ï¼Œç›´æ¥ä¸åœçš„æŒ‰ tabï¼ŒæŒ‡å¯¼é€‰ä¸­äº†ä½ æƒ³è¦çš„ç›®å½•ï¼Œç„¶åå›è½¦ï¼Œå°±å¯ä»¥è¿›å…¥æƒ³è¿›å…¥çš„ç›®æ ‡ï¼Œå‡å°‘è¾“å…¥ç›®å½•åå‰å‡ ä¸ªå­—æ¯çš„åŠ³ç´¯ã€‚ ç¬¬ä¸‰ã€è¿™æ˜¯ä¸ª killer featureï¼Œåœ¨ç»ˆç«¯è¾“å…¥ä»»ä½•å‡ ä¸ªå­—ç¬¦ï¼ŒæŒ‰å‘ä¸Šçš„ç®­å¤´ï¼Œå°±å¯åˆ—å‡ºä»¥è¿™äº›å­—ç¬¦å¼€å¤´çš„æ‰€æœ‰å†å²å‘½ä»¤ï¼Œè¿™æ ·å¾ˆå¤šéœ€é‡å¤ä½¿ç”¨çš„å‘½ä»¤ã€å¾ˆä¹…å¿½ç„¶æƒ³èµ·éœ€è¦å†æ¬¡ä½¿ç”¨çš„å‘½ä»¤çš„ä½¿ç”¨æ–¹ä¾¿äº†éå¸¸å¤šï¼Œæ¯”å¦‚å¿½ç„¶æƒ³èµ· 10 å¤©å‰ï¼Œä½¿ç”¨ sed å‘½ä»¤æäº†ä¸ªäº‹æƒ…ï¼Œä½†æ˜¯ sed å‘½ä»¤ä½ æ‡‚çš„ï¼Œå‹æ ¹è®°ä¸ä½ç”¨æ³•ï¼Œæ€ä¹ˆåŠï¼Ÿç›´æ¥ç»ˆç«¯è¾“å…¥ sed ç„¶åæŒ‰å‘ä¸Šç®­å¤´ï¼Œç«‹é©¬è°ƒå‡º sed å¼€å¤´çš„å†å²å‘½ä»¤ã€‚ local Maven ä»“åº“è‡ªæ‰“è°·æ­Œä¸€æ‰‹å°† Android çš„æ„å»ºå·¥å…·åˆ‡æ¢åˆ° Gradle åï¼Œè¿œç¨‹ä¾èµ–å˜ä¸ºç”¨ç”± Gradle é…ç½®ä» Maven ä»“åº“è·å–ä¾èµ–ã€‚è€Œé™¤äº† Jcenterã€mavenCentralã€Google è¿™æ ·æœ€å¸¸è§ 3 ä¸ªå…¬å¼€ Maven ä»“åº“å¤–ï¼Œç°åœ¨å¾ˆå¤šå…¬å¸å†…éƒ¨ä¼šå¼€å‘ä¸€äº› SDK æˆ–è€…å·¥å…·åŒ…ä¹‹ç±»çš„ï¼Œç„¶åä½œä¸ºä¾èµ–æ”¾åœ¨å…¬å¸å†…éƒ¨çš„ç§æœ‰ Maven ä»“åº“ä¸­ï¼Œæä¾›ç»™å…¬å¸å†…éƒ¨ä½¿ç”¨ã€‚ é—®é¢˜æ¥äº†ï¼Œå¯¹äºæ™®é€šçš„å¼€å‘è€…æ¥è¯´ï¼Œæœ‰æ—¶å€™éœ€è¦ä¿®æ”¹æŸä¸ªä¾èµ–çš„æºä»£ç å¹¶åŠ ä»¥éªŒè¯ï¼Œä½†æ˜¯åˆä¸æƒ³æŠŠä¿®æ”¹åçš„ä»£ç é©¬ä¸Šå°±æ„å»ºä¸€ä¸ªæ–°ç‰ˆæœ¬çš„ä¾èµ–ä¼ è¾“åˆ°å…¬å¸çš„ Maven ä»“åº“ã€‚æ¯•ç«Ÿï¼Œå¤©æ™“å¾—è‡ªå·±è¦æ”¹å¤šå°‘æ¬¡ï¼Œå¦‚æœä¸€ç›´å¾€å…¬å¸ Maven ä»“åº“æ¨ï¼Œè¢«åˆ«äººçœ‹åˆ°äº†å¥½åƒä¼šæ„Ÿè§‰è‡ªå·±å¾ˆèœçš„æ ·å­ ?ã€‚è¿™æ—¶å€™ï¼Œå¦‚æœæœ‰ä¸€ä¸ªæœ¬åœ°çš„ Maven ä»“åº“ï¼Œé‚£å…ˆä¼ åˆ°æœ¬åœ° Maven ä»“åº“ï¼Œç„¶åå†ä»æœ¬åœ°ä»“åº“è·å–ä¾èµ–ï¼Œå°±å¯ä»¥é¿å…è¿™ä¸ªé—®é¢˜äº†ï¼Œç‰¹åˆ«æ˜¯å¯¹äºä¸€äº›æ–‡ä»¶æ¯”è¾ƒå¤§çš„ä¾èµ–ï¼Œè¿™æ ·é€Ÿåº¦ä¹Ÿä¼šæ›´å¿«ã€‚ è¿™é‡Œè¯´çš„ local Maven ä»“åº“ï¼Œä¸æ˜¯ Gradle ä¸­ä½¿ç”¨ mavenLocal() æ¥å£°æ˜çš„é‚£ä¸ªä»“åº“ (é€šå¸¸ä½äº ~/.m2/repository) ä¸­ï¼Œè€Œæ˜¯æŒ‡è‡ªå·±åœ¨ä¸ªäººç”µè„‘ä¸Šæ­å»ºä¸€ä¸ª Maven ä»“åº“ï¼Œå°±å’Œè¿œç¨‹ä»“åº“ä¸€æ ·ï¼Œåªä¸è¿‡åŸŸåä½¿ç”¨ localhost æ¥è®¿é—®å³å¯ã€‚ æ–¹æ³•å…¶å®æ¯”è¾ƒç®€å•ï¼Œæ¯”å¦‚ä½¿ç”¨ Nexus OSS Maven çš„è¯ï¼Œåœ¨ macOS ç³»ç»Ÿä¸Šç®€ç›´ä¸è¦å¤ªå®¹æ˜“ï¼Œç›´æ¥ brew install nexusï¼Œç„¶åå† nexus start å°± OKäº†ï¼Œæ­¤æ—¶åœ¨æµè§ˆå™¨ä¸Šé¢æ‰“å¼€ http://localhost:8081/nexus å°±å¯ä»¥å¼€å§‹ç™»å½•äº†ï¼Œåˆå§‹ç”¨æˆ·åå’Œå¯†ç åˆ†åˆ«æ˜¯ admin å’Œ admin123ï¼Œç™»å½•ä¹‹åï¼Œé‡Œé¢å·²ç»æœ‰äº†ä¸€äº› repository äº†ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š æˆ‘å¸¸ç”¨çš„å°±æ˜¯ä¸Šé¢ Snapshots è¿™ä¸ª repositoryï¼Œä¸“é—¨ç”¨æ¥æ‰˜ç®¡ SNAPSHOT ç±»å‹çš„ä¾èµ–ï¼Œå…³äº SNAPSHOT ç±»å‹çš„ä¾èµ–ï¼Œæˆ‘ä¼šå†™ä¸€ç¯‡æ›´å…¨é¢è¯¦ç»†çš„æ–‡ç« æ¥è®²æ€ä¹ˆä½¿ç”¨ã€‚ OKï¼Œç°åœ¨å°±å¯ä»¥åœ¨å‘æœ¬åœ°çš„ Maven ä»“åº“ä¼ ä¾èµ–åŒ…å¹¶æ‹‰å–ä½¿ç”¨äº†ã€‚å…¶å®ï¼Œå±€åŸŸç½‘å†…å…¶ä»–åŒäº‹ä¹Ÿæ˜¯å¯ä»¥è®¿é—®è¿™ä¸ª Maven ä»“åº“çš„ï¼Œæ¯”å¦‚ http://localhost:8081/nexus/content/repositories/snapshots/ è¿™ä¸ªä»“åº“ï¼Œåˆ«çš„åŒäº‹è¦è®¿é—®æˆ‘è¿™ä¸ª snapshot ä»“åº“çš„è¯ï¼Œåªéœ€è¦ä»–æŠŠ localhost æ¢æˆæˆ‘çš„ç§æœ‰ IP åœ°å€å³å¯ã€‚ Pythonä¸ºä»€ä¹ˆæŠŠ Python åˆ—å‡ºæ¥å‘¢ï¼Ÿå› ä¸ºå…¶å® Python å…¥é—¨æ˜¯éå¸¸ç®€å•çš„ï¼Œå†åŠ ä¸Šè¿™å¹´å¤´ï¼Œä¸äº†è§£ä¸€ä¸‹ Python éƒ½ä¸å¥½æ„æ€è¯´è‡ªå·±æ˜¯ç¨‹åºå‘˜ã€‚è€Œå…¥é—¨åï¼Œå¯ä»¥å¸®æˆ‘ä»¬åšç‚¹äº‹æƒ…ï¼Œæ¯”å¦‚ä¸‹å›¾ä¸­ï¼Œè¡¨è¾¾å¼è®¡ç®—ï¼Œè¿›åˆ¶è½¬æ¢: å…¶å® Python å¯ä»¥åšçš„äº‹å¾ˆå¤šï¼Œé€šè¿‡å¼•å…¥ Python è‡ªå¸¦çš„åŒ…æˆ–è€…ç¬¬ä¸‰æ–¹åº“çš„åŒ…ï¼ŒPython å‡ ä¹æ— æ‰€ä¸èƒ½ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå»å¹´å¾®ä¿¡è·³ä¸€è·³å°æ¸¸æˆåˆšå‡ºæ¥æ—¶ï¼Œæˆ‘çœ‹è¿™ä¸ªæ¸¸æˆéå¸¸ç®€å•ï¼Œæˆ‘å°±æƒ³ï¼Œèƒ½ä¸èƒ½ç”¨ Python åšä¸ªè‡ªåŠ¨åŒ–è„šæœ¬æ¥è·³å‘¢ï¼Ÿå½“ç„¶å¯ä»¥ï¼å…¶å®åŸç†ä¹Ÿå¾ˆç®€å•ï¼Œå¯¹äºæ¯ä¸€è·³ï¼Œå¯ä»¥åˆ†ä¸ºè‹¥å¹²æ­¥ï¼šæˆªå›¾ã€åˆ†æå›¾ç‰‡å¾—å‡ºéœ€è¦è·³è·ƒçš„è·ç¦»ã€æ ¹æ®è·ç¦»æ¥æ¨¡æ‹Ÿä¸€ä¸ªé•¿æŒ‰äº‹ä»¶ã€‚è¿™æ ·çš„ä¸‰ä¸ªæ­¥éª¤å¯¹äº Android è®¾å¤‡æ˜¯å¾ˆå®¹æ˜“å®ç°çš„ã€‚æ‰€ä»¥æ€è·¯å°±æ˜¯ï¼Œä½¿ç”¨ Python è°ƒç”¨ adb å·¥å…·æ¥æˆªå›¾ã€pull æˆªå›¾åˆ°ç”µè„‘ä¸­ï¼›ç„¶åä½¿ç”¨ Python çš„ç…§ç‰‡å¤„ç†åº“æ¥åˆ†æç…§ç‰‡çš„åƒç´ ï¼Œæ‰¾åˆ°è·³çš„é‚£ä¸ªä¸œè¥¿çš„ä½ç½®å’Œä¸‹ä¸€ä¸ªæ–¹å—çš„ä½ç½®ï¼Œè¿™æ ·å°±çŸ¥é“éœ€è¦è·³è·ƒçš„è·ç¦»äº†ï¼›è°ƒç”¨ adb æ¨¡æ‹Ÿä¸€ä¸ªé•¿æŒ‰å±å¹•çš„äº‹ä»¶ï¼Œé•¿æŒ‰çš„æ—¶é—´å’Œéœ€è¦è·³è·ƒçš„è·ç¦»æˆæ­£æ¯”ï¼Œè‡³äºè¿™ä¸ªæ¯”å€¼ç³»æ•°ï¼Œæ‘¸ç´¢å‡ æ¬¡æµ‹è¯•ä¸€ä¸‹å°±å¯ä»¥äº†ã€‚è¯¦è§æˆ‘çš„åšå®¢ Python ä¹Ÿèƒ½ç©è·³ä¸€è·³å°æ¸¸æˆã€‚ æˆ‘æ”¹è¿›è¿‡çš„ JD-GUIæ¬ä¸çŸ¥è€»çš„æ¨èä¸€ä¸‹æˆ‘æ›´æ”¹è¿‡çš„ JD-GUIã€‚JD-GUI æœ¬æ¥æ˜¯ä¸€ä¸ªå¼€æºé¡¹ç›®ï¼Œä½†æ˜¯å·²ç»3å¹´æ²¡æœ‰ç»´æŠ¤äº†ã€‚ä¸¤å¹´å‰ï¼Œå½“æ—¶å› ä¸ºå·¥ä½œéœ€è¦ï¼Œæˆ‘è¦é¢‘ç¹çš„è§£å‹ apkï¼ŒæŠŠ dex æ–‡ä»¶è½¬æˆ jarï¼Œç„¶åå†ç”¨ JD-GUI åç¼–è¯‘æŸ¥çœ‹ä»£ç æ³¨å…¥æ•ˆæœï¼Œæ‰€ä»¥æˆ‘å°±æƒ³ï¼Œè¿™ä¹ˆä¸‰ä¸ªæ­¥éª¤èƒ½ä¸èƒ½ä¸€æ­¥æå®šã€‚äºæ˜¯ç»è¿‡ä¸€ä¸ªå‘¨æœ«çš„åŠªåŠ›ï¼Œæˆ‘å°æ”¹äº†ä¸€ä¸‹ JD-GUIï¼Œä½¿å…¶æ”¯æŒç›´æ¥æ‹–å…¥ apk æ–‡ä»¶ï¼Œç„¶åè‡ªåŠ¨è§£å‹ï¼Œè‡ªåŠ¨è°ƒç”¨ apktool æ¥å°† dex è½¬æˆ jar æ–‡ä»¶ï¼Œç„¶åå†äº¤ç»™åŸ JD-GUI åç¼–è¯‘ã€‚PSï¼šæˆ‘éå¸¸è´´å¿ƒçš„æä¾›äº† macOSã€Windowsã€Linux ä¸‰ä¸ªå¹³å°çš„ binary åŒ…ã€‚ the Unarchiver for macOSmacOS è‡ªå¸¦çš„è§£å‹å·¥å…·æ¯”è¾ƒå¼±é¸¡ï¼Œæ¯”å¦‚ jar æ–‡ä»¶æ— æ³•è§£å‹ï¼Œä¸€äº›åˆ«çš„å‹ç¼©åŒ…è§£å‹æ—¶ä¹Ÿä¼šå‡ºå¹ºè›¾å­ã€‚è€Œè¿™æ¬¾ the Unarchiver for macOS ä½“ç§¯ä¸å¤§ï¼Œç®€æ´å´å¯ä»¥åº”ä»˜å‡ ä¹æ‰€æœ‰çš„è§£å‹åœºæ™¯ï¼Œè¿˜èƒ½æä¾›é€‰æ‹© charset çš„æœºä¼šï¼Œä»è€Œè§£å‹æŸäº›å‹ç¼©åŒ…æ—¶é¿å…æ–‡ä»¶åä¹±ç ã€‚ USTC Mirroråœ¨æ­¤æ¨èä¸€ä¸‹ä¸­å›½ç§‘å¤§å¼€æºé•œåƒï¼Œè¿™ä»½é•œåƒå¯ä»¥ä½¿å¾—åœ¨å›½å†…è®¿é—®å¾ˆå¤šå¼€æºè½¯ä»¶çš„é€Ÿåº¦é£èµ·æ¥ã€‚ æ¯”å¦‚ç»™ pip è®¾ç½®ä»£ç†ï¼Œå¯ä»¥è®© pip ä¸‹è½½ Python æ‰©å±•åŒ…çš„é€Ÿåº¦å¿«å¾—é£èµ·ã€‚ å†æ¯”å¦‚ä½¿ç”¨ä¸­å›½ç§‘å¤§çš„ AOSP é•œåƒï¼Œè·å– AOSP é¡¹ç›®çš„æºç  (å‡ å GB å¤§å°) çš„é€Ÿåº¦å°†è¦åŠ å¿«å¾ˆå¤šï¼Œå¦‚æœä¸ä½¿ç”¨ä»£ç†ï¼Œé‚£ä¹ˆä» Google å®˜æ–¹åŒæ­¥ AOSP ä»£ç ï¼Œå…¶éš¾åº¦ä½ æ‡‚çš„ã€‚ å†å†æ¯”å¦‚ï¼Œéå¸¸æµè¡Œçš„ Homebrewï¼Œæ˜¯ macOS å¹³å°ä¸Šä½¿ç”¨å‘½ä»¤è¡Œç®¡ç†è½¯ä»¶åŒ…åŠå®ƒä»¬çš„ä¾èµ–å…³ç³»çš„å·¥å…·ï¼Œå¥½æ¯”æ˜¯ Linux çš„åŒ…ç®¡ç†ç³»ç»Ÿã€‚æ­¤å¤– Homebrew ä½¿ç”¨ cask tap ç”šè‡³è¿˜å¯ä»¥å®‰è£… Sublime textï¼ŒChrome ç­‰è®¸å¤šçš„ GUI è½¯ä»¶ï¼Œå¹¶è‡ªåŠ¨å»ºç«‹è½¯é“¾æ¥é“¾æ¥åˆ° GUI çš„è½¯ä»¶çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œæ¯”å¦‚ Sublime textï¼Œä½¿ç”¨ Homebrew å®‰è£…åï¼Œå°±å¯ä»¥åœ¨å‘½ä»¤è¡Œä½¿ç”¨ subl å³å¯æ‰“å¼€ Sublime text äº†ã€‚æ‰¯è¿œäº†ï¼ŒHomebrew åŒæ ·å­˜åœ¨åœ¨å›½å†…ä¸‹è½½è½¯ä»¶é€Ÿåº¦æ…¢çš„é—®é¢˜ï¼Œè€ŒåŒæ ·ï¼Œä¸­å›½ç§‘å¤§é•œåƒæä¾›äº† Homebrew é•œåƒï¼Œèƒ½è®©ç»å¤§éƒ¨åˆ†åŒ…çš„ä¸‹è½½é€Ÿåº¦å¿«èµ·æ¥ã€‚ æœ€åï¼Œå…ˆå¯¹ USTC Mirror çš„ç»´æŠ¤è€…è¡¨ç¤ºæ„Ÿè°¢ã€‚ç„¶åï¼Œæˆ‘æƒ³è¯´è¿™ä¸ªé•œåƒçš„å†…å®¹éå¸¸å¤šï¼Œç»å¤§éƒ¨åˆ†æˆ‘ä¹Ÿä¸äº†è§£ï¼Œä¹Ÿå°±æ˜¯è¿˜æœ‰å¾ˆå¤šå¯ä»¥æ·±å…¥æ¢ç´¢çš„ä¸œè¥¿ã€‚","categories":[],"tags":[{"name":"Android","slug":"Android","permalink":"https://tao93.top/tags/Android/"}]},{"title":"å¸¸ç”¨çš„ Bash å‘½ä»¤æ€»ç»“","slug":"å¸¸ç”¨çš„ Bash å‘½ä»¤æ€»ç»“","date":"2018-09-26T07:47:46.676Z","updated":"2018-09-26T07:47:46.677Z","comments":true,"path":"2018/09/26/å¸¸ç”¨çš„ Bash å‘½ä»¤æ€»ç»“/","link":"","permalink":"https://tao93.top/2018/09/26/å¸¸ç”¨çš„ Bash å‘½ä»¤æ€»ç»“/","excerpt":"","text":"è¿™ç¯‡è®°å½•æ˜¯æˆ‘çœ‹ The Linux Command Line åä¸ºäº†æ€»ç»“è€Œå†™çš„ï¼Œç›®çš„æ˜¯ä¾¿äºè‡ªå·±éšæ—¶æŸ¥é˜…ã€‚The Linux Command Line æ˜¯æˆ‘ç›¸å½“å–œæ¬¢çš„ä¸€æœ¬ç”µå­ä¹¦ï¼Œå®ƒæ˜¯ä¸€æœ¬å€¼å¾—ä¸€é¡µä¸€é¡µçœ‹ä¸‹å»çš„ä¹¦ã€‚ cp 12345678# ä»…å¤åˆ¶ç›®æ ‡ç›®å½•ä¸å­˜åœ¨æˆ–è€…å­˜åœ¨ä½†æ˜¯æ›´æ—§çš„çš„é¡¹ã€‚ cp -u # å¦‚æœ file2 å·²ç»å­˜åœ¨, file2 çš„å†…å®¹ä¼šè¢« file1 çš„å†…å®¹é‡å†™ã€‚å¦‚æœ file2 ä¸å­˜åœ¨ï¼Œåˆ™ä¼šåˆ›å»ºå®ƒã€‚ cp file1 file2 # å¦‚æœç›®å½• dir2 ä¸å­˜åœ¨ï¼Œåˆ›å»ºç›®å½• dir2ï¼Œæ“ä½œå®Œæˆåï¼Œç›®å½• dir2 ä¸­çš„å†…å®¹å’Œ dir1 ä¸­çš„ä¸€æ ·ã€‚å¦‚æœç›®å½• dir2 å­˜åœ¨ï¼Œåˆ™ç›®å½• dir1 å’Œå…¶ä¸­çš„å†…å®¹å°†ä¼šè¢«å¤åˆ¶åˆ° dir2 ä¸­ã€‚ cp -r dir1 dir2 mv 12345# ä»…ç§»åŠ¨ç›®æ ‡ç›®å½•ä¸å­˜åœ¨æˆ–è€…å­˜åœ¨ä½†æ˜¯æ›´æ—§çš„çš„é¡¹ã€‚ mv -u # å¦‚æœç›®å½• dir2 ä¸å­˜åœ¨ï¼Œåˆ›å»ºç›®å½• dir2ï¼Œå¹¶ä¸”ç§»åŠ¨ç›®å½• dir1 çš„å†…å®¹åˆ°ç›®å½• dir2 ä¸­ï¼ŒåŒæ—¶åˆ é™¤ç›®å½• dir1ã€‚å¦‚æœç›®å½• dir2 å­˜åœ¨ï¼Œç§»åŠ¨ç›®å½• dir1( å®ƒçš„å†…å®¹)åˆ°ç›®å½• dir2 ä¸­ã€‚ mv dir1 dir2 rm 1# è­¦æƒ•ä¸å°å¿ƒå†™å‡º rm * .html è¿™æ ·çš„å‘½ä»¤ï¼Œè¿™ä¼šåˆ é™¤å½“å‰ç›®å½•çš„æ‰€æœ‰æ–‡ä»¶ã€‚ å‘½ä»¤çš„4ä¸­å½¢å¼ executable file, å¯ä»¥æ˜¯äºŒè¿›åˆ¶çš„ï¼Œä¹Ÿå¯ä»¥æ˜¯æ–‡æœ¬å½¢å¼çš„è„šæœ¬ï¼› builtins, å³ /bin ä¸‹é¢çš„ [, echo, kill, pwd, test å’Œ /usr/bin ä¸‹é¢çš„ alias, bg, cd, command, false, fc, fg, getopts, hash, jobs, printf, read, true, type, ulimit, umask, unalias, wait, whichï¼› shell å‡½æ•° alias å®šä¹‰çš„åˆ«å type typeæ˜¯ä¸€ä¸ªæå…¶æœ‰ç”¨çš„å‘½ä»¤ï¼Œèƒ½ç«‹é©¬æ‰¾åˆ°å½“å‰ç¯å¢ƒèƒ½ç”¨çš„å‘½ä»¤æ˜¯æºè‡ªå“ªé‡Œï¼Œæ˜¯ä»€ä¹ˆç±»å‹çš„ã€‚ç¤ºä¾‹ï¼š âœ ~ type Python3Python3 is /Users/didi/.bin/Python3âœ ~ ls -l /Users/didi/.bin/Python3lrwxr-xr-x 1 didi staff 22 4 25 10:06 /Users/didi/.bin/Python3 -&gt; /usr/local/bin/python3âœ ~ type [[ is a shell builtinâœ ~ type lsls is an alias for ls -G where whereå‘½ä»¤çš„æœ‰ç”¨ä¹‹å¤„æ˜¯å®ƒå¯ä»¥åˆ—å‡ºæ‰€æœ‰å‡ºç°çš„åœ°æ–¹ï¼Œæ¯”å¦‚ç”µè„‘é‡Œé¢æœ‰ä¸¤ä¸ª git å¯æ‰§è¡Œæ–‡ä»¶ï¼Œé‚£ä¹ˆ where git å¯ä»¥æŠŠå®ƒä»¬ç»Ÿç»Ÿåˆ—å‡ºæ¥ã€‚ man æ‰‹å†Œçš„ç« èŠ‚å«ä¹‰ ç”¨æˆ·å‘½ä»¤ ç¨‹åºæ¥å£å†…æ ¸ç³»ç»Ÿè°ƒç”¨ åº“å‡½æ•°ç¨‹åºæ¥å£ ç‰¹æ®Šæ–‡ä»¶ï¼Œæ¯”å¦‚è¯´è®¾å¤‡ç»“ç‚¹å’Œé©±åŠ¨ç¨‹åº æ–‡ä»¶æ ¼å¼ æ¸¸æˆå¨±ä¹ï¼Œå¦‚å±å¹•ä¿æŠ¤ç¨‹åº å…¶ä»–æ–¹é¢ ç³»ç»Ÿç®¡ç†å‘˜å‘½ä»¤ &gt; file_name å·§å¦™çš„ä½¿ç”¨é‡å®šå‘ï¼Œå¯ä»¥å°†æ–‡æœ¬æ–‡ä»¶çš„å†…å®¹æ¸…ç©ºï¼Œä¹Ÿå¯ä»¥æ–°å»ºä¸€ä¸ªç©ºæ–‡ä»¶ã€‚ é‡å®šå‘çš„å¸¸è§ç”¨æ³• 1234567891011# è¦†ç›–å‹é‡å®šå‘ stdoutï¼Œå¯ä»¥çœç•¥é‚£ä¸ª 1 ls ~ 1&gt; out.txt # è¿½åŠ æ€§é‡å®šå‘ stdoutï¼Œå¯ä»¥çœç•¥é‚£ä¸ª 1 ls ~ 1&gt;&gt; out.txt # è¦†ç›–å‹é‡å®šå‘ stderr ls ~ 2&gt; out.txt # è¿½åŠ æ€§é‡å®šå‘ stdout ls ~ 2&gt;&gt; out.txt /dev/null éšæ„æ”¾ä¸œè¥¿è¿›å»çš„åƒåœ¾ç®± èŠ±æ‹¬å·å±•å¼€ echo Front-{A..D}â€“Back å°†ä¼šè¾“å‡ºå››é¡¹å†…å®¹ï¼Œå³ {A..D} è¡¨ç¤ºä» A åˆ° D ä¸€å…±å››ä¸ªæƒ…å†µã€‚ å°†å‘½ä»¤æ‰§è¡Œç»“æœå±•å¼€ 12# åªéœ€è¦æŠŠå‘½ä»¤æ”¾åœ¨ $() é‡Œé¢å³å¯ï¼Œæ—§ç‰ˆ shell ä¹Ÿä½¿ç”¨æŠŠå‘½ä»¤æ”¾åœ¨ `` ä¸­é—´çš„æ–¹å¼ echo $(ls) å¼•å· 1234# åŒå¼•å·ä¸­ï¼Œå‚æ•°å±•å¼€ï¼Œç®—æœ¯è¡¨è¾¾å¼å±•å¼€ï¼Œå’Œå‘½ä»¤æ›¿æ¢ä»ç„¶æœ‰æ•ˆï¼Œæ¯”å¦‚ echo \"$USER $((2+2)) $(cal)\" # å•å¼•å·ä¸­ï¼Œæ‰€æœ‰å±•å¼€éƒ½æ— æ•ˆ å‘½ä»¤è¡Œç§»åŠ¨å…‰æ ‡ ctrl a # ç§»åŠ¨åˆ°è¡Œé¦– ctrl e # ç§»åŠ¨åˆ°è¡Œæœ« alt &lt;- # å·¦ç§»ä¸€ä¸ª word alt -&gt; # å³ç§»ä¸€ä¸ª word ctrl u # å‰ªåˆ‡æ•´è¡Œå†…å®¹ ctrl k # å‰ªåˆ‡å…‰æ ‡åé¢çš„å†…å®¹ ctrl y # ç²˜è´´ ç®¡ç†è¿›ç¨‹ 123456789101112131415161718192021222324# åˆ—å‡ºç»ˆç«¯ç›¸å…³è¿›ç¨‹ps # åˆ—å‡ºæ‰€æœ‰è¿›ç¨‹ps x # åˆ—å‡ºæ‰€æœ‰è¿›ç¨‹çš„è¯¦ç»†ä¿¡æ¯ps aux # æ˜¾ç¤ºä»ç»ˆç«¯å¯åŠ¨çš„åå°è¿›ç¨‹jobs # è®©æŒ‡å®šåºå·çš„ä»ç»ˆç«¯å¯åŠ¨çš„è¿›ç¨‹è¿”å›åˆ°å‰å°fg %JOB_SPEC # è®©æŒ‡å®šåºå·çš„ä»ç»ˆç«¯å¯åŠ¨çš„è¿›ç¨‹è¿”å›åˆ°åå°bg %JOB_SPEC # ç»™è¿›ç¨‹å‘é€ä¿¡å·ï¼Œæœ€å¸¸è§çš„ä¿¡å·æ˜¯ï¼škill -SIG_NUM PID 1 HUP æŒ‚èµ· 2 INT ä¸­æ–­ï¼Œå’Œ ctrl c çš„ä½œç”¨ä¸€æ · 9 KILL æ€æ­»ï¼Œè¿™ä¸ªä¿¡å·å¹¶ä¸ä¼šå‘ç»™è¿›ç¨‹å·æ˜¯ PID çš„è¿›ç¨‹ï¼Œè€Œæ˜¯ç«‹å³å¼ºåˆ¶åœæ­¢æ­¤è¿›ç¨‹ï¼Œè¢«æ€è¿›ç¨‹å°±æ²¡æœ‰æœºä¼šä¿å­˜æ•°æ® 15 TERM kill å‘½ä»¤çš„é»˜è®¤ä¿¡å·ï¼Œç»ˆæ­¢è¿›ç¨‹ï¼Œè¢«ä¸­æ­¢çš„è¿›ç¨‹æœ‰æœºä¼šä¿å­˜æ•°æ®","categories":[],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://tao93.top/tags/Linux/"},{"name":"Bash","slug":"Bash","permalink":"https://tao93.top/tags/Bash/"}]},{"title":"åšå®¢ç³»ç»Ÿè¿ç§»è®°å½•","slug":"åšå®¢ç³»ç»Ÿè¿ç§»è®°å½•","date":"2018-09-26T07:47:46.674Z","updated":"2019-07-05T14:03:52.028Z","comments":true,"path":"2018/09/26/åšå®¢ç³»ç»Ÿè¿ç§»è®°å½•/","link":"","permalink":"https://tao93.top/2018/09/26/åšå®¢ç³»ç»Ÿè¿ç§»è®°å½•/","excerpt":"","text":"æ­¤å‰æˆ‘ç”¨çš„æ˜¯ Z-blog ç³»ç»Ÿï¼Œè¿™ä¸ªç³»ç»Ÿä¸Šæ‰‹ç®€å•ï¼Œä¸è¿‡ä»…æ”¯æŒåœ¨ç½‘é¡µåœ¨çº¿ç¼–å†™æ–‡ç« ã€‚è¿™ç§æ–¹å¼å¼Šç«¯æ˜¯æ¯”è¾ƒæ­»æ¿ï¼Œå¦‚æœå°†æ¥éœ€è¦æŠŠæ–‡ç« ç§»åŠ¨åˆ°åˆ«çš„åœ°æ–¹ä¼šå¾ˆéº»çƒ¦ï¼Œè€Œå¦‚æœæ˜¯ç”¨ MarkDown æ¥å†™æ–‡ç« å°±ä¸ä¼šæœ‰è¿™ä¸ªéº»çƒ¦äº†ã€‚æœ¬æ–‡å°±è¯¦ç»†è®°å½•è¿™æ¬¡åšå®¢ç³»ç»Ÿè¿ç§»çš„ç»†èŠ‚ï¼ŒåŒ…å« Linux ç³»ç»Ÿé…ç½®ã€Nginx çš„é…ç½®ã€hexo çš„é…ç½®å’Œ deploy è„šæœ¬ç­‰å†…å®¹ã€‚ é¦–å…ˆæ˜¯ï¼Œè¿™æ¬¡åˆæŠŠ VPS çš„ Server ç¡¬ç›˜é‡ç½®äº†ï¼Œæ¯æ¬¡é‡ç½®åéƒ½éœ€è¦é‡æ–°è®¾ç½®é…ç½®ä¸€é Linux ç³»ç»Ÿï¼ˆæˆ‘çš„ VPS æ˜¯ Ubuntu 16.04ï¼‰ï¼Œæ‰€ä»¥è¿™æ¬¡è®°å½•ä¸€ä¸‹é…ç½®çš„è¿‡ç¨‹ï¼Œä¹Ÿå°±æ˜¯å„ç§é…ç½®å‘½ä»¤ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586adduser liutao # add user, with root userusermod -aG sudo liutao # add sudo permission, with root usersu - liutao # switch to user liutao# update repository infosudo apt-get updatesudo apt-get upgrade# configure shadowsockssudo apt install python-pipsudo pip install shadowsockssudo mkdir /etc/shadowsocks# create config filesudo vim /etc/shadowsocks/ss.json&#123; \"server\":\"0.0.0.0\", \"server_port\":22222, \"local_port\":1080, \"password\":\"your pass word\", \"timeout\":1000, \"method\":\"aes-256-cfb\"&#125;# add service configuration info,.sudo vim /etc/systemd/system/shadowsocks.service[Unit]Description=Shadowsocks ServerAfter=network.target[Service]ExecStart=/usr/local/bin/ssserver -c /etc/shadowsocks/ss.jsonRestart=on-abort[Install]WantedBy=multi-user.target# start shadowsocks servicesudo systemctl start shadowsocks# start shadowsocks on startupsudo systemctl enable shadowsocks# install linuxbrewsh -c \"$(curl -fsSL https://raw.githubusercontent.com/Linuxbrew/install/master/install.sh)\"# install zshsudo apt-get install zsh# install oh my zsh, this dependends on zshsh -c \"$(curl -fsSL https://raw.githubusercontent.com/robbyrussell/oh-my-zsh/master/tools/install.sh)\"vim .zshrc# install Nginx, MySQL, Phpwget http://soft.vpser.net/lnmp/lnmp1.5-full.tar.gzgunzip lnmp1.5-full.tar.gztar xf lnmp1.5-full.tarcd lnmp1.5-fullsudo ./install.sh lnmp# install word-presswget https://wordpress.org/latest.zipunzip latest.zip -d wordpress# set root to be/home/liutao/wordpresssudo vim /usr/local/nginx/conf/nginx.confsudo nginx -s reload# ç„¶åæœ¬åœ°æµè§ˆå™¨æ‰“å¼€ https://tao93.top/ å¼€å§‹è®¾ç½® WordPress# create database named wordpressmysql -u root -p&gt; create database wordpress# ç„¶ååœ¨æµè§ˆå™¨ä¸­å¡«å…¥åˆšåˆšçš„ database åå­—ï¼ŒåŠå…¶ä»–ä¿¡æ¯# åœ¨ server ä¸­çš„ WordPress æ ¹ç›®å½•ä¸­åˆ›å»º wp-config.php å¹¶å¡«å…¥æµè§ˆå™¨é¡µé¢æ˜¾ç¤ºçš„å†…å®¹# æ‰¾åˆ° nginx ä½¿ç”¨çš„ config æ–‡ä»¶sudo nginx -t# ä¸ºäº†è§£å†³ä¸€äº›æƒé™é—®é¢˜ï¼Œwww æ˜¯ nginx é…ç½®æ–‡ä»¶ä¸­å£°æ˜çš„ web server çš„ user name# è¿™æ ·å°±æŠŠ group æ”¹ä¸ºäº† wwwï¼Œå¹¶ä¸” group ç”¨æˆ·éƒ½æœ‰ write çš„æƒé™sudo chgrp -R www &lt;root_dir_of_wordpress&gt;sudo chmod -R g+w &lt;root_dir_of_wordpress&gt;# å¦å¤–è¿˜åœ¨ &lt;root_dir_of_wordpress&gt; ä¸­çš„ wp-config.php æ–‡ä»¶ä¸­æ’å…¥äº† define('FS_METHOD','direct'); è¿™æ ·ä¸€è¡Œï¼Œä¸çŸ¥é“æ˜¯ä¸æ˜¯å¿…è¦çš„ ä»¥ä¸Šå°±æ˜¯æœ€ç»ˆé…ç½®åˆ° WordPress çš„è¿‡ç¨‹ã€‚ä¹‹æ‰€ä»¥é…ç½® WordPressï¼Œæ˜¯å› ä¸ºæˆ‘æŸ¥åˆ° WordPress å¯ä»¥ä½¿ç”¨ Markdownï¼Œå¦å¤– WordPress è‡ªå¸¦è¯„è®ºåŠŸèƒ½ï¼Œæ’ä»¶å’Œä¸»é¢˜ä¹Ÿéå¸¸ä¸°å¯Œï¼Œæ‰€ä»¥å°±å…ˆä½¿ç”¨ WordPressã€‚ç»“æœå‘ç° WordPress çš„ Markdown è¿˜éœ€è¦å®‰è£…æ’ä»¶æ‰èƒ½æ”¯æŒï¼Œå¦å¤–æ”¯æŒä¹Ÿä¸æ˜¯å¾ˆå¥½ï¼Œæ¯”å¦‚ä»£ç å—ä¼šæŠŠæ¯”è¾ƒé•¿çš„è¡Œè½¬è¡Œæ˜¾ç¤ºï¼ˆå³ä¸æ˜¯å¯ä»¥å·¦å³æ»‘åŠ¨ï¼‰ï¼Œä»£ç è¡Œå·ä¸é«˜äº®éƒ½æ²¡è¦ã€‚ æ‰€ä»¥ï¼Œæˆ‘è¿˜æ˜¯ç—›ä¸‹å†³å¿ƒï¼Œæ¢å›åˆ° hexoã€‚hexo æ¯”è¾ƒç®€å•ï¼Œæœ¬åœ°å®‰è£… hexo åï¼Œåœ¨ç©ºç›®å½•ä¸­æ‰§è¡Œ hexo init å³å¯ç”Ÿæˆä¸€å †ç›¸å…³æ–‡ä»¶ï¼Œå…¶ä¸­çš„ public ç”¨æ¥å­˜æ”¾ä»å½“å‰ theme å’Œ markdown æ–‡ä»¶ç”Ÿæˆçš„ static web æ–‡ä»¶ï¼›è€Œ source ç›®å½•ç”¨æ¥å­˜æ”¾ markdown æ–‡ä»¶ã€‚ç®€å•ä½¿ç”¨æ­¥éª¤ï¼š 123456# in hexo root directoryhexo g # generate static web fileshexo server # start local web server, then browse http://localhost:4000 to preview web pages# copy files in public to server's directory, therefore updated pages can be browsed at https://tao93.top/ ä»¥ä¸Šå°±æ˜¯ç®€å•çš„ç”¨æ³•ï¼Œä¸è¿‡å®é™…ä¸Šæˆ‘åšäº†ä¸€äº›é¢å¤–å·¥ä½œã€‚ä¾‹å¦‚ä¸ºäº†é¿å… markdown æ–‡ä»¶æ„å¤–ä¸¢å¤±ï¼Œæˆ‘ä»¬éœ€è¦æŠŠå®ƒä»¬å¤‡ä»½åˆ° server ä¸Šï¼Œserver å’Œ local åŒæ—¶ä¸¢å¤±çš„å¯èƒ½æ€§æå°ã€‚å¦å¤–ï¼Œmarkdown ä¸­æ’å…¥å›¾ç‰‡æ—¶ï¼Œå¯ä»¥å…ˆæŠŠå›¾ç‰‡æ”¾åœ¨æœ¬åœ°ï¼Œç„¶å markdown ä¸­æŒ‡å‘å›¾ç‰‡çš„æœ¬åœ°è·¯å¾„ï¼Œè¿™æ ·ç”Ÿæˆçš„ web æ–‡ä»¶ä¼šæŠŠå›¾ç‰‡æ‹·è´åˆ° public ç›®å½•ä¸­æŸå¤„ï¼Œç„¶å html æ–‡ä»¶å¼•ç”¨ public ç›®å½•ä¸­çš„ imageï¼Œè¿™æ—¶çš„å¼•ç”¨å…¶å®å°±æ˜¯ä¸€ä¸ª url äº†ã€‚ä½†æ˜¯æˆ‘ä¸æ˜¯è¿™æ ·åšçš„ï¼Œæˆ‘æ˜¯å…ˆæŠŠè¦æ’å…¥çš„å›¾ç‰‡æ‹·è´åˆ° Server çš„ public ç›®å½•æŸå¤„ï¼Œè¿™æ ·å°±ä¼šå¾—åˆ°ä¸€ä¸ªæŒ‡å‘æ¬¡å›¾ç‰‡çš„ urlï¼Œç„¶åå† markdown ä¸­ç›´æ¥ä½¿ç”¨è¿™ä¸ª urlã€‚è¿™æ ·çš„è¯ï¼Œåªè¦ server çš„å›¾ç‰‡åº“ä¿æŒç¨³å®šï¼Œmarkdown æ–‡ä»¶å°±ä¸ç”¨å’Œæœ¬åœ°å›¾ç‰‡åº“ç»‘å®šåœ¨ä¸€èµ·ã€‚åŒæ ·çš„ï¼Œserver çš„å›¾ç‰‡åº“ä¹Ÿéœ€è¦å¤‡ä»½åˆ° localï¼Œä»¥ç¡®ä¿å®‰å…¨ã€‚ä¸‹é¢å°±å¼€å§‹ä»‹ç»ä»¥ä¸Šä¸¤ç‚¹ã€‚ é¦–å…ˆæ˜¯æœ¬åœ° source ç›®å½•éœ€è¦å¤‡ä»½åˆ° server ä¸Šï¼Œæˆ‘çš„æ–¹å¼æ˜¯æœ¬åœ° source ç›®å½•ä½¿ç”¨ git æ¥è¿½è¸ªï¼Œç„¶å server ä¸Šç®€å†ä¸€ä¸ª bare repository source.gitï¼Œè¿™æ ·æœ¬åœ°çš„æ¯æ¬¡ commit éƒ½ push åˆ° server ä¸Šçš„ source.gitï¼Œå°±å¯ä»¥ä½œä¸ºå¤‡ä»½äº†ã€‚ç›¸åº”çš„æœ¬åœ°çš„ public ç›®å½•ä¹Ÿè¦ push åˆ° server ä¸Šçš„ public.git è¿™æ ·ä¸€ä¸ª bare repositoryï¼Œç„¶ååœ¨ server ä¸Šçš„ public ä¸­ï¼Œä» public.git è¿™ä¸ª remote git pull ä¸€ä¸‹ï¼Œè¿™æ · server ä¸­çš„ public å°±æœ‰äº†æœ€æ–°çš„ web æ–‡ä»¶ã€‚ æ¥ä¸‹æ¥æ˜¯å›¾ç‰‡ä¸Šä¼ åˆ° server ä¸­ï¼Œä¸ºäº†æ–¹ä¾¿ï¼Œæˆ‘å†™äº†ä¸€ä¸ª Python è„šæœ¬ï¼Œç”¨æ¥æŠŠæœ¬åœ°å›¾ç‰‡ä¸Šä¼ åˆ° serverï¼Œæˆ–è€…æŠŠå‰ªè´´æ¿çš„å›¾ç‰‡ (ä¾¿äºå¤åˆ¶å›¾ç‰‡çš„æƒ…æ™¯) ä¸Šä¼ åˆ° serverï¼Œç„¶åå°†å¯¹åº”çš„ url ç²˜è´´åˆ°å‰ªè´´æ¿ï¼Œè¿™æ ·çš„è¯ï¼Œåªéœ€è¦æ‰§è¡Œè¿™ä¸ª Python è„šæœ¬ï¼Œå°±å¯ä»¥ä¸Šä¼ æœ¬åœ°å›¾ç‰‡æˆ–è€…å‰ªè´´æ¿ä¸Šçš„å›¾ç‰‡ï¼Œå¹¶æŠŠå¾—åˆ°çš„ url å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼Œç„¶åå°±å¯ä»¥ç›´æ¥ç²˜è´´åˆ° markdown ä¸­ã€‚ä»¥ä¸‹æ˜¯è¿™ä¸ª upload_pic.py è„šæœ¬ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364from PIL import ImageGrab, Imageimport sysimport datetimeimport osnow = datetime.datetime.now()# store image files in date format directory path in serverdate_path = now.strftime('%Y/%m/%d')# use timestamp as image file name in serverf_name = str(int(now.timestamp()))if len(sys.argv) == 1: # get picture in clipboard im = ImageGrab.grabclipboard() # check whether it's a picture if isinstance(im, Image.Image): # file name in server f_name = str(int(datetime.datetime.now().timestamp())) + '.png' # save in local im.save(f_name) # the url of the image url = 'http://tao93.top/images/' + date_path + '/' + f_name # copy the url to clipboard os.system(\"echo '%s' | pbcopy\" % url) print('url has been copied') print('copying...') dest_path = '/home/liutao/hexo_blog/public/images/' + date_path # mkdir in server and copy the image os.system(\"ssh liutao@tao93.top 'mkdir -p \" + dest_path + \"'\") os.system('scp ' + f_name + ' liutao@tao93.top:' + dest_path) print('copy finished') # remove local image file os.remove(f_name) else: print('clipboard content is not a image!')elif len(sys.argv) == 2: if os.path.isfile(sys.argv[1]): # file name in server f_name = str(int(datetime.datetime.now().timestamp())) dot_loc = sys.argv[1].rfind('.') if dot_loc &gt;= 0: f_name += sys.argv[1][dot_loc:] # append the file extension url = 'http://tao93.top/images/' + date_path + '/' + f_name os.system(\"echo '%s' | pbcopy\" % url) print('url has been copied') print('copying...') dest_path = '/home/liutao/hexo_blog/public/images/' + date_path os.system(\"ssh liutao@tao93.top 'mkdir -p \" + dest_path + \"'\") os.system('scp ' + sys.argv[1] + ' liutao@tao93.top:' + dest_path + '/' + f_name) print('copy finished') else: print(sys.argv[1] + ' is not a file!')else: print('too much arguments') ä¸ºäº†ç®€åŒ–æ­¥éª¤ï¼Œæˆ‘å†™äº†ä¸€ä¸ª deploy.sh è„šæœ¬æ”¾åœ¨æœ¬åœ° hexo blog æ ¹ç›®å½•ä¸­ï¼Œè¿™æ ·åªéœ€è¦åœ¨ source ç›®å½•ä¸­ç¼–è¾‘ markdown æ–‡ä»¶ï¼Œç„¶å commitï¼Œå†è°ƒç”¨ deploy.sh è„šæœ¬å³å¯ã€‚æ­¤è„šæœ¬æŠŠå…¶ä»–è¦åšçš„äº‹æƒ…éƒ½åšäº†ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142#!/bin/bash# into source cd source# make sure it's commited in source directorystatus=$(git status -s)if [ -z \"$status\" ]; then # git push in source git pushelse echo 'not commited in source directory!' exit 1fi# back into parent directorycd ..# generate static web fileshexo g# git push in local public directorycd publicgit add .git commit -m 'update web files'git pushcd ..# git pull in server's public directoryssh liutao@tao93.top 'cd /home/liutao/hexo_blog/public; git pull'# git commit in server's images directoryssh liutao@tao93.top 'cd /home/liutao/hexo_blog/public/images; git add .; git commit -m \"add images\"'# git pull in local's images directorycd imagesgit pullcd ..echo '========='echo 'Finished!'echo '=========' è¿™æ ·ä¸Šé¢çš„è„šæœ¬å°±æŠŠç”Ÿæˆ web æ–‡ä»¶ï¼Œæ‹·è´ public ä¸­çš„ web æ–‡ä»¶æ‹·è´åˆ° serverï¼ŒæŠŠ server ä¸­çš„ image ç›®å½•ä¸­çš„ä¿¡æ¯æ›´æ–°åˆ° local çš„ images ç›®å½•è¿™æ ·å‡ ä¸ªäº‹æƒ…ã€‚ é™„ï¼š å¦‚æœè¦æœ¬åœ° git repo æ²¡æœ‰ commitï¼Œremote repo æœ‰ commitï¼Œç°åœ¨éœ€è¦æœ¬åœ°çš„ master åˆ†æ”¯ track remote çš„ master åˆ†æ”¯ï¼š 12345678# å…ˆæ·»åŠ  originï¼Œè®¾ç½®å¥½ urlgit remote add origin liutao@tao93.top:/home/liutao/hexo_blog/public/images/.git# ç„¶å fetch ä¸€ä¸‹ è¿œç¨‹çš„çŠ¶æ€git fetch# æ­¤æ—¶å¦‚æœ git pull --set-upstream-to æ˜¯ä¸è¡Œçš„ï¼Œä¼šè¯´æœ¬åœ° master åˆ†æ”¯ä¸å­˜åœ¨ï¼Œè€Œéœ€è¦ä¸‹é¢è¿™æ ·æ‰è¡Œgit checkout master","categories":[],"tags":[{"name":"Other","slug":"Other","permalink":"https://tao93.top/tags/Other/"}]},{"title":"ä¿®è½¦å°èƒ½æ‰‹ä¸Šçº¿","slug":"ä¿®è½¦å°èƒ½æ‰‹ä¸Šçº¿","date":"2018-09-26T07:47:46.673Z","updated":"2019-07-05T14:03:47.278Z","comments":true,"path":"2018/09/26/ä¿®è½¦å°èƒ½æ‰‹ä¸Šçº¿/","link":"","permalink":"https://tao93.top/2018/09/26/ä¿®è½¦å°èƒ½æ‰‹ä¸Šçº¿/","excerpt":"","text":"ä¿®è½¦æŠ€æœ¯ä¹Ÿæ˜¯æŠ€æœ¯ï¼Œæ‰€ä»¥å…³äºä¿®è½¦çš„åšå®¢ä¹Ÿæ˜¯æŠ€æœ¯åšå®¢å•¦ ğŸ˜ äº‹æƒ…è¦ä»ä¸¤ä¸ªæœˆå‰è¯´èµ·ï¼Œå½“æ—¶åœ¨äº¬ä¸œä¹°äº†ä¸€è¾†ç²‰è‰²çš„æ¯”å¾·æ–‡ç”µåŠ¨è½¦ç»™å¥³æœ‹å‹ä¸Šä¸‹ç­ç”¨ã€‚è¿™è¾†ç”µåŠ¨è½¦æ¯”è¾ƒä¾¿å®œï¼Œå½“æ—¶æˆ‘ä»¬ä¹Ÿä¸æ€ä¹ˆæ³¨æ„é¢„é˜²ç”µåŠ¨è½¦è¢«é›¨æ·‹ï¼Œå› ä¸ºæ½œæ„è¯†è§‰å¾—ç»å¸¸çœ‹åˆ°åˆ«äººçš„ç”µåŠ¨è½¦è¢«é›¨æ·‹ï¼Œæ‰€ä»¥åº”è¯¥æ²¡äº‹ã€‚äº‹æƒ…åå°±ååœ¨è¿™è¾†ç”µåŠ¨è½¦é˜²æ°´æ€§çœŸä¸å¥½ï¼Œæ‰€ä»¥å‡ åœºå¤§é›¨ä¹‹åï¼Œè¿˜æ²¡åˆ°ä¸€ä¸ªæœˆï¼Œç”µåŠ¨è½¦å°±åäº†ï¼Œæ‹§è½¦æŠŠä¸Šçš„æ—‹é’®è½¦å­æ²¡ååº”ï¼Œä¹Ÿå°±æ˜¯ç”µæœºä¸è½¬äº†ã€‚ æœ¬ç€åº”è¯¥æœ‰ä¸“ä¸šäººå‘˜ (åé¢äº‹å®è¯æ˜ä¿®è½¦çš„çœŸä¸æ˜¯ä¸ªå¥½ä¸œè¥¿) ä¿®ç†çš„æ€åº¦ï¼Œå¤§çƒ­å¤©æˆ‘è´¹å°½åŠ›æ°”æŠŠç”µåŠ¨è½¦æ¨åˆ°äº†ä¿®è½¦é“ºã€‚ç­‰äº†åŠå¤©ä¿®è½¦çš„æ‰å§—å§—æ¥è¿Ÿçš„è¿‡æ¥äº†ã€‚ç„¶åä¿®è½¦çš„æ‰“å¼€ç”µåŠ¨è½¦åç›–ç§äº†ç§ï¼Œè¯´æ˜¯æ§åˆ¶å™¨åäº†ï¼Œéœ€è¦æ›´æ¢ï¼Œä»–åº—é‡Œçš„æ§åˆ¶å™¨ 80 å—é’±ä¸€ä¸ªã€‚è¿™æ—¶å€™æˆ‘å’Œå¥³æœ‹å‹å°±å’Œå‚å®¶è”ç³»ï¼Œå‚å®¶ç§°è¦ä¹ˆç»™æˆ‘ä»¬50å—é’±ï¼Œè¦ä¹ˆæˆ‘ä»¬æŠŠæ—§æ§åˆ¶å™¨å¯„å›å»ç„¶åä»–ä»¬å¯„ä¸€ä¸ªæ–°çš„å›æ¥ã€‚æˆ‘ä»¬å¿ƒæƒ³ï¼Œå¿«é€’å¯„æ§åˆ¶å™¨ä¸€æ¥ä¸€å›è¦å¥½å¤šå¤©ï¼Œè¿™äº›å¤©æˆ‘ä»¬çš„è½¦å­å°±è¦è¿™ä¹ˆæ™¾åœ¨ç¦»å®¶å‡ å…¬é‡Œçš„åœ°æ–¹ï¼Œè¿™æ€ä¹ˆèƒ½å¿ï¼æ‰€ä»¥æˆ‘ä»¬å’Œå‚å®¶æ’•é€¼ï¼Œæœ€ç»ˆå‚å®¶ç­”åº”ç»™æˆ‘ä»¬ 80 å—ï¼Œäºæ˜¯æˆ‘ä»¬å°±åœ¨åº—é‡Œæ¢äº†ä¸ªæ§åˆ¶å™¨ã€‚å‘çˆ¹çš„ä¿®è½¦çš„ï¼Œå¸®æˆ‘ä»¬æ¢æ§åˆ¶å™¨æ—¶æ…¢æ…¢è…¾è…¾ï¼Œä¸­é€”è¿˜åœä¸‹æ¥å¸®ä¸¤ä¸ªå¥³çš„é…é’¥åŒ™ï¼å½“æ—¶çœŸçš„æ˜¯å¾ˆæ°”æ„¤ï¼Œæ¢ä¸ªæ§åˆ¶å™¨æ¢äº†æ¥è¿‘ä¸¤å°æ—¶ï¼ŒæœŸé—´ä¿®è½¦çš„è¿˜ä¸åœç”¨ä¸€ç§å‚²æ…¢çš„æ€åº¦æ•°è½æˆ‘ä»¬ä¸åº”è¯¥å†ç½‘ä¸Šå›¾ä¾¿å®œä¹°äº†ä¸ªè´¨é‡å·®çš„ç”µåŠ¨è½¦ï¼Œä»–åº—é‡Œå–çš„è½¦æ€ä¹ˆæ€ä¹ˆå¥½æ€ä¹ˆæ€ä¹ˆåœ°ã€‚è€Œå½“å¥³æœ‹å‹å¯¹ä¿®è½¦çš„è¯´ï¼šâ€ä½ çš„æ„æ€æ˜¯è¿™ä¸ªç”µåŠ¨è½¦å„æ–¹é¢è´¨é‡å¾ˆå·®å—ï¼Ÿâ€ ä¿®è½¦çš„åˆå¼€å§‹å«ç³Šå…¶è¾ã€‚ æ¢å®Œä¹‹åï¼Œæœ¬æ¥æƒ³è¿™äº‹å°±ç®—ç»“æŸäº†ï¼Œè¯¥å»æ‰¾å‚å®¶è¦ 80 å—é’±äº†ã€‚è°çŸ¥é“ï¼Œäº‹æƒ…æ‰åˆšåˆšå¼€å§‹ã€‚å½“å¤©ï¼Œå¥³æœ‹å‹å°±è¯´è½¦å­æœ‰é—®é¢˜ï¼Œå¥¹æŠŠè½¦å­ä»åœ°ä¸‹è½¦åº“æ¨å‡ºæ¥æ—¶ï¼Œä¸Šä¸€ä¸ªå¾ˆé™¡çš„å¡æ—¶ï¼Œè½¦å­åŠ¨åŠ›ä¸è¶³ä¸Šä¸å»ï¼Œä¸Šåˆ°ä¸€èˆ¬å°±çŒ›åœ°å¾€å›é€€ï¼æœ€åè¿˜æ˜¯ä¸€ä¸ªç”·ç”Ÿå¥½å¿ƒæŠŠå¥¹æ¨ä¸Šæ¥äº†ã€‚ç„¶åéš”äº†ä¸¤å¤©ï¼Œå¥³æœ‹å‹åˆå»ä¿®è½¦é“ºé‚£é‡Œï¼Œè¯¢é—®ä¸ºä»€ä¹ˆåŠ¨åŠ›ä¸è¡Œäº†ã€‚ä¿®è½¦çš„éª‘ç€ç”µåŠ¨è½¦èµ°äº†ä¸€åœˆï¼Œç»™äº†è¿™ä¹ˆå¥è¯ã€Œç”µæœºåäº†ã€ã€‚æœ¬æ¥æˆ‘å¯¹ä¿®è½¦çš„å°±æ²¡å¥½å°è±¡ï¼Œæ‰€ä»¥å¬åˆ°è¿™é‡Œæˆ‘æ˜¯ä¸ä¿¡çš„ï¼Œæ§åˆ¶å™¨åäº†æˆ‘ä¿¡ï¼Œç”µæœºä¹ŸåŒæ—¶åè¿™ä¹Ÿå¤ªæ‰¯æ·¡äº†ã€‚æ‰€ä»¥æˆ‘æ¨æ–­æ˜¯æ§åˆ¶å™¨çš„é€‚é…æ€§ (æˆ–è€…è¯´å’Œç”µåŠ¨è½¦çš„å…¼å®¹æ€§) æ¯”è¾ƒå·®ï¼Œæ‰€ä»¥æ‰ä¼šåŠ¨åŠ›ä¸è¶³ã€‚ä¸å°±æˆ‘è¿˜å‘ç°åˆ«çš„é—®é¢˜ï¼Œå½“æ‹§ç€è½¦æŠŠæ—‹é’®å†æåˆ¹è½¦é—¸æ—¶ï¼Œç”µæœºå±…ç„¶è¿˜åœ¨å‘åŠ›ï¼Œè¿™ä¸ªæœ€åŸºæœ¬çš„å®‰å…¨æœºåˆ¶éƒ½æ²¡äº†ã€‚æ­¤å¤–ï¼Œæ™ºèƒ½æ§åˆ¶å™¨åœ¨å¯åŠ¨æ—¶å™ªéŸ³æ¯”è¾ƒå¤§ã€‚ æŠ±ç€å¯¹æ§åˆ¶å™¨é€‚é…æ€§çš„è´¨ç–‘ï¼Œæˆ‘æ‰¾åˆ°äº†æ­å·ä¸€å®¶æ¯”å¾·æ–‡è½¦åº—ï¼Œä»è½¦åº—é‚£é‡Œæˆ‘ç®—ææ¸…æ¥šäº†ç¼˜ç”±ã€‚åŸæ¥ï¼Œä¿®è½¦çš„ç»™æˆ‘æ¢çš„æ˜¯æ‰€è°“æ™ºèƒ½æ§åˆ¶å™¨ï¼Œä¹Ÿå°±æ˜¯åŸºæœ¬å•¥ç”µåŠ¨è½¦éƒ½èƒ½ç”¨ï¼Œä½†æ˜¯å¹¶ä¸èƒ½å¯¹æ¯ç§ç”µåŠ¨è½¦éƒ½æœ‰æœ€å¥½çš„é€‚é…æ€§ï¼Œè‡ªç„¶ä¹Ÿè¿œä¸å¦‚åŸè£…æ§åˆ¶å™¨ã€‚è€ŒåŸè£…æ§åˆ¶å™¨åªèƒ½å‚å®¶å¯„è¿‡æ¥ï¼Œè¿™ä¸ªæ¯”å¾·æ–‡è½¦åº—ä¹Ÿæ²¡æœ‰ã€‚å¦å¤–ï¼Œä»å‚å®¶æ‹¿åˆ°åŸè£…æ§åˆ¶å™¨åï¼Œæ¥è¿™ä¸ªåº—é‡Œå®‰è£…çš„è¯ï¼Œä»–ä»¬éœ€è¦æ”¶ ä¸‰å››åå—é’±ã€‚ ä¹‹åæˆ‘å°±åƒå‚å®¶è”ç³»ï¼Œè¡¨ç¤ºä¸è¦ 80 å—é’±äº†ï¼Œæˆ‘æŠŠåäº†çš„åŸè£…æ§åˆ¶å™¨å¯„å›å»ï¼Œå‚å®¶ç»™æˆ‘å¯„ä¸€ä¸ªæ–°çš„æ§åˆ¶å™¨ã€‚ä¸å¾—ä¸åæ§½ï¼Œå‚å®¶åŠ¨ä½œéå¸¸æ…¢ï¼Œæ€»å…±ä¸¤ä¸‰ä¸ªæ˜ŸæœŸæˆ‘æ‰æ‹¿åˆ°æ–°çš„åŸè£…æ§åˆ¶å™¨ã€‚æˆ‘æ‰ä¸åƒè·‘åˆ°æ¯”å¾·æ–‡è½¦åº—å‡ºå‡ åå—é’±è®©ä»–ä»¬å¸®æˆ‘å®‰è£…ï¼Œæ‰€ä»¥æ¥ä¸‹æ¥ï¼Œæˆ‘ç›´æ¥è‡ªå·±åŠ¨æ‰‹å®‰è£…ï¼Œå…¶å®å®‰è£…å¾ˆç®€å•ï¼Œå°±æ˜¯æŠŠé‚£äº›å€Ÿå£å¯¹åº”æ’ä¸Šå°±å¥½äº†ã€‚å®‰è£…å¥½åï¼Œæˆ‘è¯•ç€éª‘äº†éª‘ï¼Œæ²¡äº†å™ªéŸ³ï¼Œå¯åŠ¨æ›´å¿«ï¼Œåé¢ä¸¤å¤©å¥³æœ‹å‹ä¹Ÿè¡¨ç¤ºä¸Šå¡æ—¶ä¸ä¼šåŠ¨åŠ›ä¸è¶³äº†ã€‚ åˆ°æ­¤å¥½åƒå·²ç»ç»“æŸäº†ã€‚ä¸è¿‡å¦‚æœå°±è¿™æ ·ç»“æŸäº†ï¼Œæˆ‘è¿˜èƒ½ç§°ä½œä¿®è½¦å°èƒ½æ‰‹ä¹ˆï¼ æ‰ä¸¤ä¸‰å¤©ï¼Œå°±å‡ºç°æ‹§æ—‹é’®åè½¦è½® (ç”µæœº) ä¸è½¬çš„é—®é¢˜ï¼Œä½†æ˜¯åˆä¼šå¿½ç„¶å¥½äº†ã€‚åˆä¸€æ¬¡å¥³æœ‹å‹å»ä¸Šç­éª‘åˆ°åŠè·¯ï¼Œå¿½ç„¶è½¦è½®ä¸è½¬äº†ï¼ŒæŠŠå¥¹å“ä¸€è·³ï¼Œåé¢çš„æ—¥å­å¥¹å°±å†ä¹Ÿä¸æ•¢éª‘äº†ï¼Œå¥¹è¯´è¿˜æ˜¯è¦å»ä¿®è½¦åº—ä¿®ä¸€ä¸‹æ‰è¡Œã€‚è¿™æ ·è¿‡äº†ä¸€ä¸ªå¤šæ˜ŸæœŸï¼Œåˆ°äº†ä»Šå¤©è¿™ä¸ªå‘¨å…­ã€‚æˆ‘ç»ˆäºæœ‰æ—¶é—´å»å¤„ç†ä¸€ä¸‹è¿™ä»¶äº‹äº†ã€‚ æˆ‘æœ‰ä¸¤ä¸ªé€‰æ‹©ï¼Œä¸€ä¸ªæ˜¯å¼„åˆ°ä¿®è½¦åº—å»ï¼Œå¦ä¸€ä¸ªæ˜¯è‡ªå·±åŠ¨æ‰‹ï¼Œæˆ‘é€‰æ‹©äº†åè€…ï¼ŒåŸå› æ˜¯é—´æ­‡æ€§çš„å‡ºé—®é¢˜ï¼Œè¯´æ˜æ— æ³•ç¨³å®šå¤ç°ï¼Œå†‰ä¹‰å¼„åˆ°ä¿®è½¦åº—ï¼Œä¿®è½¦çš„æåŠå¤©è¯´æ²¡æ¯›ç—…ï¼Œé‚£ä¸å°±å°´å°¬äº†å˜›ã€‚ä»Šå¤©æˆ‘è¿˜ç‰¹æ„éª‘ç€ç”µåŠ¨è½¦ç»•å°åŒºä¸€åœˆï¼Œé—®é¢˜ä¾ç„¶æ²¡å¤ç°ï¼Œè¿™å°±å¾ˆéº»çƒ¦äº†ã€‚ä¸è¿‡ï¼Œæˆ‘æ—©å°±æ€€ç–‘ï¼Œè¿™ç§é—´æ­‡æ€§çš„ç”µæœºä¸è½¬åº”è¯¥æ˜¯æ¥è§¦ä¸è‰¯çš„é—®é¢˜ã€‚æ‰€ä»¥ä»Šå¤©æˆ‘æ‰“ç®—è¯•è¯•ç”¨æ’é™¤æ³•æ¥çœ‹èƒ½å¦éªŒè¯æˆ‘çš„çŒœæµ‹ã€‚æˆ‘æ‰“å¼€åç›–ï¼š å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œé“¶ç™½è‰²é“ç›’å­å°±æ˜¯æ–°çš„åŸè£…æ§åˆ¶å™¨ï¼Œç®­å¤´æ‰€æŒ‡çš„å°±æ˜¯å®ƒè¿æ¥åˆ°ç”µåŠ¨è½¦çš„ä¸€äº›æ¥å£ã€‚éƒ½æ˜¯é‚£ç§å¸¦å€’é’©ã€ç›´æ¥æ’ä¸Šå°±å¯ä»¥çš„æ¥å£ã€‚ ä¿®è½¦ä¹Ÿè¦è®²å®‰å…¨ï¼Œæ¯•ç«Ÿç”µæ± çš„ç”µå‹æœ‰å‡ åä¼ï¼Œå¯èƒ½ä¼šè§¦ç”µï¼Œæ‰€ä»¥æˆ‘æ˜¯è¿™æ ·æ¥åˆ¤æ–­æ¥å£æ˜¯å¦æœ‰é—®é¢˜çš„ï¼šæ–­å¼€ç”µæ± å’Œç”µåŠ¨è½¦çš„è¿æ¥ï¼Œæ‹”å¼€ä¸€ä¸ªæ¥å£ï¼Œè¿æ¥ä¸Šç”µæ± ï¼Œæœ€åè½¬åŠ¨æ—‹é’®çœ‹ç”µæœºæ˜¯å¦æ—‹è½¬ï¼Œæ˜¯çš„è¯è¯´æ˜è¿™ä¸ªæ¥å£å‹æ ¹ä¸å½±å“ç”µæœºæ˜¯å¦è½¬åŠ¨ï¼Œå¦çš„è¯è¯´æ˜è¿™ä¸ªæ¥å£å…³é”®æ¥å£ä¹‹ä¸€ï¼Œä¼šå½±å“ç”µæœºçš„æ—‹è½¬ã€‚ ç”¨ä¸Šé¢çš„æ–¹æ³•æŒ¨ä¸ªæ¥å£å°è¯•ï¼Œæˆ‘æ‰¾åˆ°3ä¸ªå…³é”®æ¥å£ã€‚å¦‚æœé—®é¢˜çœŸçš„æ˜¯æ¥è§¦ä¸è‰¯çš„è¯ï¼Œå¾ˆå¯èƒ½å°±æ˜¯è¿™ 3 ä¸ªæ¥å£ä¹‹ä¸€æ¥è§¦ä¸è‰¯ï¼Œæ‰€ä»¥æ¥ä¸‹æ¥æˆ‘æŠŠè¿™ 3 ä¸ªæ¥å£è¿›è¡Œä¸‹ä¸€è½®æµ‹è¯•ã€‚æµ‹è¯•æ–¹æ³•æ˜¯ï¼ŒæŠŠæ¥å£å¾€å¤–æ‹”ä¸€ç‚¹ (ä½†æ˜¯ä¾ç„¶åœ¨å€’é’©é”å®šèŒƒå›´å†…)ï¼Œè¿™æ ·å°±å¯ä»¥æ¨¡æ‹Ÿç°å®ä¸­æ¥å£æ¾åŠ¨çš„æƒ…å†µäº†ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå·¦è¾¹æ˜¯æ¥å£æ’å¾ˆç´§ï¼Œå›¾ä¸­ç®­å¤´æŒ‡çš„å°±æ˜¯å€’é’©ï¼›å³è¾¹æ˜¯æ¥å£å¾€å¤–æ‹”ä¸€ç‚¹ç‚¹ï¼Œå¯ä»¥çœ‹åˆ°å€’é’©å’Œä¸€ä¸ªå‡¸èµ·ç‰©ä¹‹é—´å·²ç»æ²¡æœ‰é—´éš™äº†ã€‚ é€šè¿‡æ¨¡æ‹Ÿæ¥å£æ¾åŠ¨çš„æƒ…å†µï¼Œç„¶åæµ‹è¯•æ˜¯å¦ä¼šå¯¼è‡´ç”µæœºä¸è½¬ï¼Œå¾ˆå¿«æˆ‘å°±æ‰¾åˆ°äº†ä¸€ä¸ªæ¥å£ï¼Œè¿™ä¸ªæ¥å£å¾€å¤–æ‹”ä¸€ç‚¹ç‚¹ï¼Œç”µæœºå°±æ— æ³•è½¬ï¼Œå¾€é‡Œæ’ç´§ä¸€ç‚¹ï¼Œç”µæœºå°±èƒ½è½¬åŠ¨äº†ã€‚ å‘ç°äº†é—®é¢˜æ‰€åœ¨ï¼Œæ¥ä¸‹æ¥å°±å¾ˆå¥½åŠäº†ï¼Œç”¨ä¸œè¥¿æŠŠè¿™ä¸ªæ¥å£å›ºå®šç´§å°±å¥½äº†ï¼Œè®©å®ƒä¸€ç›´ä¿æŒæ’ç´§çš„çŠ¶æ€ã€‚æœ€å¥½çš„ææ–™åº”è¯¥ç»†é“ä¸ï¼Œç”¨ç»†é“ä¸æ‰ç´§ç„¶åç”¨é’³å­æ‹§ç´§å°±å¥½ã€‚å¯æ˜¯æˆ‘æ˜ç™½ç»†é“ä¸ï¼Œæ‰€ä»¥æˆ‘ç”¨ç»³å­æŠŠå®ƒç»‘ç´§æ¥ï¼Œä¹Ÿå°±æ˜¯ä¸‹é¢å›¾ä¸­è¿™æ ·ï¼š ä¸ºä»€ä¹ˆæˆ‘å‰é¢è¯´ç»†é“ä¸æ›´å¥½å‘¢ï¼Œå› ä¸ºç»†é“ä¸æ‹§ç´§åä¸ä¼šé€†è½¬å˜æ¾ï¼Œä½†æ˜¯ç»³å­æ˜¯ä¼šçš„ã€‚ç”¨ç»³å­å¸®ç¡¬çš„ä¸œè¥¿ï¼Œæ€»æ˜¯ä¼šæœ‰é‚£ä¹ˆå†™æ¾åŠ¨ï¼Œæ— æ³•å½»åº•ç»‘ç´§ã€‚æ‰€ä»¥åœ¨ç»‘å®Œåï¼Œæˆ‘è¿˜ç”¨ä¸€æ ¹ç‰™ç­¾æŒ‘è¿‡ç»³å­ï¼Œç„¶åè½¬ä¸¤åœˆï¼Œè¿™æ ·ç»³å­å°±ä¼šè¢«ç»·å¾—å¾ˆç´§äº†ï¼Œå°±æ˜¯ä¸‹é¢è¿™æ ·çš„ï¼š ä¸Šå›¾ä¸­ç‰™ç­¾é¡ºæ—¶é’ˆæ—‹è½¬è¶Šå¤šï¼Œç»³å­å°±ç»·å¾—è¶Šç´§ã€‚ OKï¼Œå¤§åŠŸå‘Šæˆï¼","categories":[],"tags":[{"name":"Other","slug":"Other","permalink":"https://tao93.top/tags/Other/"}]},{"title":"ä»é˜¿é‡Œäº‘æœåŠ¡å™¨åˆ°ä¸ªäººåšå®¢","slug":"ä»é˜¿é‡Œäº‘æœåŠ¡å™¨åˆ°ä¸ªäººåšå®¢","date":"2018-09-26T07:47:46.671Z","updated":"2019-07-05T14:03:42.652Z","comments":true,"path":"2018/09/26/ä»é˜¿é‡Œäº‘æœåŠ¡å™¨åˆ°ä¸ªäººåšå®¢/","link":"","permalink":"https://tao93.top/2018/09/26/ä»é˜¿é‡Œäº‘æœåŠ¡å™¨åˆ°ä¸ªäººåšå®¢/","excerpt":"","text":"å‰è¨€ï¼š(å‹æƒ…æç¤ºï¼Œæƒ³çœ‹æ­¥éª¤çš„è¯ï¼Œä¸‹é¢çš„å‰è¨€å¯ä»¥è·³è¿‡ä¸çœ‹) ä¸ºä»€ä¹ˆæˆ‘ç°åœ¨è¦ä¹°é˜¿é‡Œäº‘çš„ VPS (Virtual Private Server) æåšå®¢ç³»ç»Ÿå‘¢ï¼Ÿæˆ‘ä¹Ÿè¯´ä¸ä¸Šä¸ºä»€ä¹ˆï¼Œä¸è¿‡å¯ä»¥è®²ä¸€ä¸‹äº‹æƒ…çš„ç»è¿‡ã€‚ 2016å¹´åˆšå¼€å§‹å·¥ä½œé‚£ä¼šå„¿ï¼Œä»ç‹è¯‘é”‹é‚£é‡ŒçŸ¥é“äº†ç§Ÿ VPSã€æ­å»ºæŸ socksã€nginx é©±åŠ¨ hexo åšå®¢è¿™æ ·ä¸€å¥—ä¸œè¥¿ã€‚å½“æ—¶è§‰å¾—å¾ˆæ–°é²œï¼Œç«‹é©¬ä¹Ÿä¹°äº†æ¬ç“¦å·¥çš„ VPSï¼Œç„¶åä¸€åŒçæï¼Œç®—æ˜¯ææˆäº†ä¸€ä¸ª hexo é™æ€åšå®¢ç³»ç»Ÿäº†ï¼Œä¸è¿‡æœ‰ç‚¹å°´å°¬çš„å°æ’æ›²ï¼Œæˆ‘æŠŠ hexo å®‰è£…åœ¨äº† VPS ä¸Šé¢ ï¼Œç„¶åæŠŠ Markdown æ–‡ä»¶æ¨åˆ° VPS ä¸Šé¢ï¼Œç„¶åå† VPS å†ç”¨ hexo ç”Ÿæˆé™æ€é¡µé¢çš„æ–‡ä»¶ã€‚ã€‚ã€‚ å®é™…ä¸Šæ›´åˆé€‚çš„æ˜¯æŠŠ hexo å®‰è£…åœ¨æœ¬åœ°ï¼Œç„¶åæœ¬åœ°ç”Ÿæˆçš„é¡µé¢æ–‡ä»¶æ¨åˆ° nginx çš„ web root ç›®å½•ä¸­å»ã€‚ åæ¥å˜›ï¼Œæ¬ç“¦å·¥ï¼ŒVultrï¼ŒLinode é˜¿é‡Œäº‘æˆ‘éƒ½è¯•äº†ä¸ªéï¼Œå‘ç°é™¤äº†é˜¿é‡Œäº‘æ„å¤–ï¼Œè™½ç„¶éƒ½ä¸è´µï¼Œä½†æ˜¯ç½‘é€Ÿç¨³å®šæ€§çœŸçš„å¾ˆæ‰æ€¥ï¼Œæœ‰æ—¶å€™åœ¨ç»ˆç«¯ ssh åˆ°æœåŠ¡å™¨ä¸Šé¢æ—¶ï¼Œè¾“å…¥å‘½ä»¤çœŸçš„æ˜¯ä¸€å¡ä¸€å¡çš„ï¼Œè¿™æ ·çš„ç½‘é€Ÿå¸¦æ¥çš„ç§‘å­¦ä¸Šç½‘ä½“éªŒåªèƒ½ç”¨ã€Œèƒ½ç”¨ã€ä¸¤ä¸ªå­—æ¥å½¢å®¹ã€‚ç›´è§‰å‘Šè¯‰æˆ‘ï¼Œå¯èƒ½éƒ¨ç½²åœ¨é¦™æ¸¯çš„ VPS ç½‘é€Ÿä¼šæ¯”è¾ƒå¿«ï¼Œå› ä¸ºé¦™æ¸¯ç¦»å¤§é™†è¿‘ã€‚æˆ‘å°±å¼€å§‹æ‰¾é¦™æ¸¯çš„ VPS äº†ï¼Œä¸€ç•ªæ‰¾å‘€æ‰¾ï¼Œä¸­é—´ä¹Ÿäº¤äº†äº›å­¦è´¹ï¼Œæœ€åæ‰¾åˆ°äº†ä¸€ä¸ªå«æ«å¶ä¸»æœºçš„ï¼Œé€Ÿåº¦æŒºä¸é”™ï¼Œè½»æ¾è¾¾åˆ° 500 KB/Sï¼Œå°±æ˜¯è´µäº†ç‚¹ï¼Œæˆ‘å°±å’ŒæŸåŒäº‹ä¸€èµ·å¹³æ‘Šè´¹ç”¨äº†ã€‚è¿™ä¸ªæ«å¶ä¸»æœºæˆ‘ä¸€å£æ°”ä¹°äº†ä¸€å¹´çš„ï¼Œä¸è¿‡ä¸­é—´ä¾ç„¶å› ä¸ºæŸäº›åŸå› è€Œå‡ºç°ç½‘é€Ÿä¸ç¨³å®šçš„æƒ…å†µã€‚ç­‰åˆ°æ«å¶ä¸»æœºè¿‡æœŸåï¼Œå› ä¸ºç©·ï¼Œæˆ‘å¿½ç„¶æƒ³è¯•è¯•è€æ—©å°±å¬åˆ«äººæ¨èçš„ä¸€ä¸ªå«äº‘æ¢¯çš„ VPNã€‚è¿™ä¸ªäº‘æ¢¯æˆ‘æ›¾ç»ä½¿ç”¨è¿‡ï¼Œä½†æ˜¯çš„é€Ÿåº¦ç¡®å®è¿˜ä¸é”™ï¼Œå“ªæƒ³åˆ°æˆ‘ä¸€å£æ°”ä¹°äº†ä¸€å¹´çš„ VPN åï¼Œå‘ç°ç”¨ä¸äº†ï¼Œæ•´ä¸ªäº‘æ¢¯å›¢é˜Ÿéƒ½è·‘è·¯äº†ï¼ï¼ï¼å°±ç•™ä¸‹ä¸ªç½‘ç«™è¿˜åœ¨è¿è¡Œï¼Œä¸æ–­çš„å¸é’±ï¼ŒçœŸä»–ä»¬å‘ï¼åƒäº†å¤§äºçš„æˆ‘ï¼Œå¼€å§‹è¹­å¤§å­¦åŒå­¦çš„ VPS çš„æŸ socks æœåŠ¡ï¼ŒæŒºé•¿æ—¶é—´éƒ½æ²¡å†ä¹°è¿‡ VPSäº†ï¼ŒæœŸé—´ï¼Œæˆ‘æŠŠé™æ€åšå®¢æ”¾åˆ°äº† github.io é¡µé¢ã€‚ç„¶è€Œï¼Œè‡ªå§‹è‡³ç»ˆï¼Œæˆ‘å…¶å®æ²¡å†™å‡ ç¯‡åšå®¢ï¼ŒçœŸä¸ºè‡ªå·±çš„æ‡’æƒ°æ„Ÿåˆ°æƒ­æ„§ã€‚ ç›´åˆ°æœ€è¿‘ï¼Œå†æ¬¡çœ‹åˆ°ç‚ç¥å’Œç‹è¯‘é”‹çš„åšå®¢ã€æ˜é‡‘æå¾—é£ç”Ÿæ°´èµ·ï¼Œæ„Ÿå¹è‡ªå·±æ²¡æœ‰èƒ½æ‹¿çš„å‡ºæ‰‹çš„ä¸œè¥¿ï¼Œæ‰€ä»¥å°±ä¹°é˜¿é‡Œäº‘ VPS â†’ æ³¨å†ŒåŸŸå â†’ æ­åšå®¢ç³»ç»Ÿäº†ï¼ŒæœŸå¾…è‡ªå·±èƒ½å¤šå†™ä¸€äº›æœ‰ä»·å€¼çš„ä¸œè¥¿ï¼ŒåŠ æ²¹ï¼ æ­£æ–‡ï¼šç§Ÿé˜¿é‡Œäº‘ VPSåœ¨é˜¿é‡Œäº‘å®˜ç½‘ï¼Œè¿™ä¸ªå«åšã€Œäº‘æœåŠ¡å™¨ ECSã€ï¼Œè¿™ä¸ªå…¶å®å¾ˆç®€å•äº†ï¼ŒèŠ±å‡ ç™¾å—é’±å°±èƒ½ç§Ÿä¸€å¹´ï¼Œæˆ‘æ˜¯ 290 å‡ å—é’±ç§Ÿçš„ 1GB å†…å­˜ã€1Mbps å¸¦å®½ã€40GB é SSD çš„é¦™æ¸¯ VPSã€‚å…¶å®ï¼Œå¯¹æˆ‘ä»¬è€Œè¨€æœ€æ•æ„Ÿçš„æ€§èƒ½æŒ‡æ ‡å°±æ˜¯å†…å­˜å’Œå¸¦å®½äº†ï¼Œç¡¬ç›˜ä¸€èˆ¬æ˜¯ä¸ä¼šç”¨å…‰çš„ï¼ŒCPU æ€§èƒ½ä¹Ÿæ²¡å¤šå¤§å½±å“ã€‚è¿™é‡Œè§£é‡Šä¸€ä¸‹ï¼Œä¸ºä»€ä¹ˆé€‰é˜¿é‡Œäº‘ã€‚æœ‰é‰´äºå‰é¢è¯•ç”¨äº†ä¸€å¤§æ³¢ VPS æœåŠ¡ï¼Œæˆ‘å‘ç°åªæœ‰é˜¿é‡Œäº‘ç®—æ˜¯æœ€ç¨³å®šçš„ï¼Œè™½ç„¶å¸¦å®½åªæœ‰ 1Mbps (æŒ‡ä»æˆ‘ä»¬ä¸ªäººç”µè„‘è®¿é—® VPS çš„ç½‘é€Ÿï¼Œè€Œåœ¨ VPS ä¸Šé¢å®‰è½¯ä»¶æ—¶ï¼Œä¸‹è½½è½¯ä»¶åŒ…çš„é€Ÿåº¦å…¶å®æ˜¯å¾ˆå¿«çš„ï¼Œå› ä¸ºç”¨çš„æ˜¯é˜¿é‡Œäº‘çš„é•œåƒï¼Œæ‰€ä»¥ç›¸å½“äºå†…ç½‘ä¼ è¾“æ•°æ®)ï¼Œä½†æ˜¯èƒœåœ¨ç¨³ï¼Œç»ˆç«¯è¾“å…¥å‘½ä»¤åŸºæœ¬ä¸ä¼šæœ‰ä»»ä½•å»¶è¿Ÿã€‚ ç§Ÿå®Œ VPSï¼Œssh è¿æ¥åˆ°å®ƒï¼Œç„¶åå°±æ˜¯æ­å»ºæŸ socks æœåŠ¡äº†ï¼Œç½‘ä¸Šèµ„æ–™éå¸¸å¤šã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œé˜¿é‡Œäº‘æœåŠ¡å™¨éœ€è¦é…ç½®å®‰å…¨ç»„è§„åˆ™çš„ï¼Œä¸ç„¶æ— æ³•æä¾›æœåŠ¡ã€‚å‡è®¾æŸ socks ä½¿ç”¨ 23333 å·ç«¯å£æ¥æä¾›æœåŠ¡ï¼Œé‚£ä¹ˆéœ€è¦ä¸‹å›¾é‚£æ ·é…ç½®ä¸€æ¡å…¥æ–¹å‘çš„è§„åˆ™ï¼š å…¥æ–¹å‘è¡¨ç¤ºæ•°æ®æµå‘ VPS çš„ï¼Œåè®®ç±»å‹é€‰ TCPï¼Œå¯¹ç»å¤§éƒ¨åˆ†æœåŠ¡æ¥è¯´ï¼Œéƒ½æ˜¯ TCP åè®®ï¼Œç«¯å£èŒƒå›´å°±æ˜¯ VPS ä¸Šé¢æä¾›çš„æœåŠ¡æ‰€ä½¿ç”¨çš„ç«¯å£äº†ã€‚å¦‚æœæ²¡æœ‰è¿™ä¸ªé…ç½®ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¸ªäººç”µè„‘å°†æ— æ³•å‘ 23333 å·ç«¯å£å‘èµ·è¯·æ±‚ã€‚å¦å¤–å‡ºæ–¹å‘é»˜è®¤å…¨å¼€äº†ï¼Œæ‰€ä»¥ä¸éœ€é…ç½®ã€‚ æ³¨å†ŒåŸŸåæˆ‘æŒ‘äº†ä¸ªå¾ˆä¾¿å®œçš„ï¼Œ36å—é’± 3 å¹´ï¼ŒåŸŸåå°±æ˜¯ tao93.topï¼Œä¹Ÿç®—æ˜¯å’Œæˆ‘çš„åå­—å’Œå‡ºç”Ÿå¹´ä»½æœ‰äº›å…³è”å§ã€‚ åŸŸåç»‘å®š IPè¿™ä¸ªè¿˜æ˜¯è¦æä¸€ä¸‹çš„ã€‚åœ¨é˜¿é‡Œäº‘æ³¨å†Œçš„åŸŸåï¼Œéœ€è¦å®åè®¤è¯ (ä¸Šä¼ å•é¢èº«ä»½è¯ç…§ç‰‡) æ‰è¡Œï¼Œä¸€å¼€å§‹æˆ‘ä¸çŸ¥é“ï¼Œå‚»ä¹ä¹çš„æ€»ç­‰ï¼Œä¸€è¾¹ç­‰ï¼Œä¸€è¾¹ ping å’Œ nslook æˆ‘çš„åŸŸåï¼Œå¥½åœ¨å®åè®¤è¯å¾ˆå¿«ï¼ŒåŸºæœ¬ä¸Šæäº¤è®¤è¯åï¼Œ1å°æ—¶å†…å°±æœ‰äººå¤„ç†ã€‚æˆ‘è®¤è¯æ—¶æœ‰ç‚¹æç¬‘ï¼Œæˆ‘ä¼ äº†ä¸€å¼  jpeg åç¼€çš„å›¾ç‰‡ï¼Œç„¶åå®¡æ ¸è€…å›å¤è¯´ï¼Œéœ€è¦ jpg æˆ– bmp åç¼€çš„å›¾ç‰‡ã€‚æˆ‘æœ‰ç‚¹åƒé²¸ï¼Œç„¶åæŠŠåŒä¸€å¼ å›¾ç‰‡åç¼€æ”¹æˆäº† jpgï¼Œä¸Šä¼ ï¼Œç„¶åè®¤è¯å°±æˆåŠŸäº†ã€‚ã€‚ã€‚è®¤è¯ç»“æŸåï¼Œå°±å¯ä»¥è®¾ç½®è§£æè§„åˆ™äº†ï¼š åªéœ€è¦ä¸Šé¢çº¢æ¡†ä¸­çš„ä¸€æ¡è§„åˆ™å°±å¯ä»¥æŠŠ tao93.top è§£æäº†ï¼Œmail çš„é‚£æ¡è§„åˆ™ï¼Œæˆ‘ç°åœ¨è¿˜ç”¨ä¸ä¸Šã€‚æ·»åŠ è§„åˆ™çš„æ—¶å€™ï¼Œå¦‚æœæ‹¿ä¸å‡†ï¼Œå¯ä»¥åœ¨ä¸‹å›¾ä¸­åªåœ¨è®°å½•å€¼å¡«å…¬ç½‘ IP åœ°å€å³å¯ï¼š æˆ‘å½“æ—¶ä¹Ÿæ˜¯æœ‰ç‚¹å‚»ï¼Œè§‰å¾—é¦™æ¸¯çš„ VPS ç®—æ˜¯å¢ƒå¤–ï¼Œå°±åœ¨è§£æçº¿è·¯é€‰äº†å¢ƒå¤–ï¼Œç„¶åå‚»ç­‰äº†å¥½ä¹…ï¼Œåé¢æ¢æˆé»˜è®¤åï¼ŒåŸºæœ¬å‡ åˆ†é’Ÿå°±å¯ä»¥è§£æäº†ã€‚ æ­åšå®¢ç³»ç»Ÿå…ˆè¯´ä¸‹ä¸ºä»€ä¹ˆæˆ‘æ²¡ç”¨ hexo é™æ€åšå®¢ï¼Œå› ä¸ºé™æ€åšå®¢æ— æ³•è¯„è®ºï¼Œæˆ‘è§‰å¾—è¯„è®ºè¿˜æ˜¯æŒºæœ‰å¿…è¦çš„ï¼Œè™½ç„¶å¯ä»¥åµŒå…¥ç¬¬ä¸‰æ–¹è¯„è®ºæœåŠ¡ï¼Œä½†æ˜¯è¿™ç§éœ€è¦è¯„è®ºè€…ç”¨ç¤¾äº¤è´¦å·ç™»å½•ï¼Œéº»çƒ¦ï¼Œå¦å¤–è¯„è®ºçš„æ•°æ®å…¨åœ¨åˆ«äººæ‰‹é‡Œï¼Œæˆ‘è§‰å¾—ä¸å¥½ã€‚æ‰€ä»¥æˆ‘å°±è¦è‡ªå·±æ­ä¸€ä¸ªæœ‰åå°çš„åšå®¢äº†ã€‚ç‚ç¥ä½¿ç”¨çš„ zblog æ˜¯ä¸€ä¸ªï¼Œå›½äº§çš„ï¼Œçœ‹èµ·æ¥ä¸é‚£ä¹ˆåä¸½ï¼›WordPress æ˜¯å¦ä¸€ä¸ªã€‚æˆ‘ä¸¤ä¸ªéƒ½è£…äº†ï¼Œå…ˆè£…äº† zblogï¼Œè§‰å¾—æœ‰ç‚¹ç‚¹ç®€å•ç²—ç³™ï¼Œç„¶åå°±åˆ çš„ä¸€å¹²äºŒå‡€ï¼Œè£…äº† WordPressï¼Œç„¶åå‘ç° WordPress å¤æ‚çš„è®©æˆ‘æœ‰ç‚¹è¿·å¤±ï¼Œæˆ‘å°±æƒ³ç®€å•çš„å†™å†™ä¸œè¥¿ï¼Œä¸æƒ³è¦é‚£ä¹ˆå¤šä¸œè¥¿ã€‚ç„¶åæˆ‘å°±åœ¨ä¿ç•™ WordPress çš„åŸºç¡€ä¸Šï¼Œåˆè£…äº† zblogã€‚ zblog æœ‰ä¸ª php ç‰ˆæœ¬ï¼Œå’Œ WordPress çš„æŠ€æœ¯ç»„åˆä¸€æ¨¡ä¸€æ ·ï¼Œå°±æ˜¯ php + æ•°æ®åº“ + nginx ç­‰ web serverï¼Œå…¶ä¸­ zblog çš„æ•°æ®åº“è¿˜å¯ä»¥ç”¨ sqliteï¼Œè™½ç„¶æˆ‘æ²¡æˆåŠŸè¿‡ã€‚æˆ‘ç¬¬ä¸€æ¬¡è£… zblog æ—¶ï¼Œæ‰‹åŠ¨å®‰è£…äº† MySQLï¼Œphpï¼Œnginxï¼Œç„¶åæ‘¸ç´¢ç€å„ç§é…ç½®ï¼Œæäº†è›®ä¹…æ‰æå®šçš„ã€‚è€Œ WordPress çš„å®‰è£…å°±å¾ˆç®€å•äº†ï¼Œç½‘ä¸Šæœ‰ LNMP (Linux Nginx MySQL PHP) ç»„åˆåŒ…ï¼Œç­‰äºä¸€é”®å°±èƒ½è£…å¥½ç¯å¢ƒï¼Œå‰©ä¸‹çš„å°±æ˜¯æä¸ª WordPressï¼Œå¹¶ä¸”æ›¿æ¢æ‰ LNMP åŸæœ‰çš„ web root ç›®å½•ï¼Œå°±å¥½äº†ã€‚ æ‰€ä»¥ï¼Œæ— è®º WordPress è¿˜æ˜¯ zblogï¼Œæœ€ç®€å•çš„æ–¹å¼æ˜¯ï¼Œå…ˆè£… LNMP ç¯å¢ƒï¼Œç„¶åå°±å¿«äº†ã€‚éœ€è¦è®°ä½ä¸€ç‚¹çš„æ˜¯ï¼ŒLNMP ç¯å¢ƒä¼šæ–°å»ºä¸€ä¸ª www:www ç”¨æˆ·(ç»„) æ¥ç”¨äºé©±åŠ¨ web æœåŠ¡ã€‚åŠ¡å¿…éœ€è¦è®©æ­¤ www ç”¨æˆ·å¯¹äº web root æœ‰ rwx æƒé™ã€‚æ¯”å¦‚ LNMP é»˜è®¤çš„ web root æ˜¯ /home/wwwroot/defaultï¼Œé‚£ä¹ˆä¸€å¥ sudo chown -R www:www /home/wwwroot/default å³å¯ã€‚ ç›´æ¥å®‰è£… z_blog çš„è¿‡ç¨‹æ­¤è¿‡ç¨‹é…ç½®æ¯”è¾ƒéº»çƒ¦ï¼Œæ‰€ä»¥åªæ˜¯è®°å½•ä¸€ä¸‹ï¼Œä¸å»ºè®®ä½¿ç”¨æ­¤æ–¹å¼ã€‚ è£… nginxï¼Œè®¾ç½®å¼€æœºè‡ªå¯ï¼Œè¿è¡Œèµ·æ¥ï¼Œç„¶ååˆ«æ€¥ç€è¿›æµè§ˆå™¨éªŒè¯ï¼Œå…ˆåˆ°é˜¿é‡Œäº‘ç½‘ç«™å¢åŠ ä¸€ä¸‹ 80 å·ç«¯å£çš„å®‰å…¨è§„åˆ™ï¼Œç„¶åéªŒè¯ nginx æ˜¯å¦å¯ç”¨ã€‚ å»ºè®®æ›´æ”¹ä¸€ä¸‹ nginx é…ç½®æ–‡ä»¶ä¸­çš„ rootï¼Œå³æ›´æ”¹ web root çš„ä½ç½®ï¼Œæ¯”å¦‚æ”¹ä¸ºè‡ªå·± home ä¸­çš„æŸä¸ªç›®å½•ï¼Œè¿™æ ·çš„è¯ chown web root æ—¶ä¸ä¼šæœ‰çƒ¦äººçš„è­¦å‘Šã€‚ æ³¨æ„ï¼Œnginx éœ€è¦é‡æ–°åŠ è½½é…ç½®æ–‡ä»¶ï¼Œæ‰èƒ½è®©é…ç½®æ–‡ä»¶çš„ä¿®æ”¹ç”Ÿæ•ˆï¼Œæ–¹æ³•æ˜¯ sudo nginx -s reload å³å¯ã€‚ å®‰è£… Mysqlï¼Œè®°å¾—åˆ«å¿˜è®°äº† root å¯†ç ã€‚ å®‰è£… Phpï¼Œç„¶åå°±æ˜¯åœ¨ Php.ini é…ç½®æ–‡ä»¶ä¸­ï¼ŒæŠŠå„ç§ extension=php_mysql.dll ä¹‹ç±»çš„è¯­å¥è§£é™¤æ³¨é‡Šï¼Œæ„æ€æ˜¯ php éœ€è¦å’Œ MySQL æ•°æ®åº“è¿æ¥ã€‚ä½†æ˜¯è¿™æ ·çš„é…ç½®è¿˜ä¸å¤Ÿï¼Œè¿˜éœ€è¦ sudo apt-get install php7.0-mysql è¿™æ—¶å€™ï¼Œå¯ä»¥ä¸‹è½½ zblog çš„å‹ç¼©åŒ…ï¼Œè§£å‹åˆ° web root ä¸­ï¼Œç„¶åæµè§ˆå™¨æ‰“å¼€ https://tao93.topï¼Œå°±å¯ä»¥å¼€å§‹å®‰è£… zblog äº†ï¼Œå®‰è£…å¥½åå°±æ˜¯å„ç§ GUI é…ç½®æ–¹å¼äº†ã€‚å†æ¬¡å¼ºè°ƒä¸€ä¸‹ï¼Œéœ€è¦ nginx å¯¹åº”çš„ Linux ç”¨æˆ·å¯¹äº web root ç›®å½•é€’å½’çš„æœ‰ rwx æƒé™ã€‚æˆ‘ç¬¬ä¸€æ¬¡è£… zblog å°±æ˜¯æ²¡è®¾ç½®æƒé™ï¼Œç„¶ååœ¨åå°é¦–é¡µä¸­ï¼Œã€Œæ¸…ç©ºç¼“å­˜å¹¶é‡æ–°ç¼–è¯‘æ¨¡æ¿ã€ä¸€ç›´è½¬åœˆåœˆã€‚ é…ç½®ä¸»é¢˜ï¼Œæ ·å¼è‡ªå®šä¹‰ï¼Œç„¶åå¼€å§‹å†™åšå®¢ã€‚ç•¥","categories":[],"tags":[{"name":"VPS","slug":"VPS","permalink":"https://tao93.top/tags/VPS/"}]},{"title":"ä» Android ä¸­ Message çš„ obj æ— æ³•è·¨è¿›ç¨‹ä¼ é€è‡ªå®šä¹‰ Parcelable è¯´èµ·","slug":"ä» Android ä¸­ Message çš„ obj æ— æ³•è·¨è¿›ç¨‹ä¼ é€è‡ªå®šä¹‰ Parcelable è¯´èµ·","date":"2018-09-26T07:47:46.669Z","updated":"2019-07-05T14:03:37.447Z","comments":true,"path":"2018/09/26/ä» Android ä¸­ Message çš„ obj æ— æ³•è·¨è¿›ç¨‹ä¼ é€è‡ªå®šä¹‰ Parcelable è¯´èµ·/","link":"","permalink":"https://tao93.top/2018/09/26/ä» Android ä¸­ Message çš„ obj æ— æ³•è·¨è¿›ç¨‹ä¼ é€è‡ªå®šä¹‰ Parcelable è¯´èµ·/","excerpt":"","text":"ä»Šå¤©æ¸©ä¹ ã€ŠAndroid å¼€å‘è‰ºæœ¯æ¢ç´¢ã€‹ä¸€ä¹¦æ—¶ï¼Œçœ‹åˆ°ç±»ä¼¼ä¸‹é¢è¿™ä¹ˆä¸€å¥è¯ï¼šã€Œä½¿ç”¨ Messenger å°† Message å¯¹è±¡è·¨è¿›ç¨‹ä¼ è¾“æ—¶ï¼Œobj å±æ€§æ— æ³•ä¼ è¾“è‡ªå®šä¹‰çš„ Parcelableï¼Œè€Œåªèƒ½ä¼ è¾“ framework å·²æœ‰çš„ Parcelableï¼Œæ¯”å¦‚ Bitmap ç­‰ã€ã€‚ç„¶åä¹Ÿç¿»äº†æºç æ³¨é‡Šï¼Œæ³¨é‡Šä¹Ÿæ˜¯è¿™ä¹ˆè¯´çš„ï¼šFroyo ä¹‹åï¼Œæ‰èƒ½ç”¨ obj ä¼ è¾“ framework çš„ Parcelableï¼Œä¸” obj ä¸èƒ½ä¸º nullã€‚ä¸‹é¢æ˜¯æ³¨é‡Šï¼š 1234567891011/** * An arbitrary object to send to the recipient. When using * &#123;@link Messenger&#125; to send the message across processes this can only * be non-null if it contains a Parcelable of a framework class (not one * implemented by the application). For other data transfer use * &#123;@link #setData&#125;. * * &lt;p&gt;Note that Parcelable objects here are not supported prior to * the &#123;@link android.os.Build.VERSION_CODES#FROYO&#125; release. */public Object obj; å½“ç„¶ï¼ŒMessage è¿˜æœ‰ setData(Bundle b) æ–¹æ³•å¯ç”¨ï¼Œè€Œè¿™ä¸ªæ–¹æ³•ä¸­æ˜¯å¯ä»¥æ”¾å…¥è‡ªå®šä¹‰çš„ Parcelableï¼Œä¸è¿‡æ­¤å¤„éœ€è¦åŸ‹ä¸‹ä¼ç¬”ã€‚ ä¸‹é¢æˆ‘ä»¬ç»§ç»­è¯´ obj ä¸ºä»€ä¹ˆä¸èƒ½ä¼ è‡ªå®šä¹‰ Parcelableã€‚ç†è®ºä¸Šè¯´ï¼Œåªæœ‰èƒ½åŠ è½½åˆ°è‡ªå®šä¹‰ç±»ï¼Œé‚£ä¹ˆå°±åº”è¯¥èƒ½ååºåˆ—åŒ–å‡ºè‡ªå®šä¹‰ç±»çš„å¯¹è±¡ã€‚å¸¦ç€è¿™ä¸ªæƒ³æ³•ï¼Œæˆ‘æµè§ˆäº† Message çš„ writeToParcel å’Œ readFromParcel ä¸¤ä¸ªæ–¹æ³•ã€‚å‘ç°äº†ç„æœºå°±æ˜¯ä¸‹é¢çš„ readFromParcel æ–¹æ³•ï¼š 123456789101112private void readFromParcel(Parcel source) &#123; what = source.readInt(); arg1 = source.readInt(); arg2 = source.readInt(); if (source.readInt() != 0) &#123; obj = source.readParcelable(getClass().getClassLoader()); &#125; when = source.readLong(); data = source.readBundle(); replyTo = Messenger.readMessengerOrNullFromParcel(source); sendingUid = source.readInt();&#125; ä¸Šé¢ä»£ç ä½¿ç”¨ getClass().getClassLoader æ¥ååºåˆ—åŒ– obj æ‰€è¦å¼•ç”¨çš„å¯¹è±¡ï¼Œå¦‚æœè¿™ä¸ª ClassLoader æ— æ³•æ‰¾åˆ°è‡ªå®šä¹‰ç±»ï¼Œé‚£ä¹ˆé—®é¢˜è‚¯å®šå°±æ˜¯å‡ºåœ¨è¿™é‡Œäº†ã€‚ ä¸‹é¢æˆ‘å°±å¼€å§‹ä¸€æ­¥ä¸€æ­¥éªŒè¯ã€‚é¦–å…ˆå»ºç«‹ä¸€ä¸ªé¡¹ç›®ï¼Œé¡¹ç›®ä¸­æ·»åŠ ä¸€ä¸ªè‡ªå®šä¹‰çš„ Parcelable ç±»ï¼š 1234567891011121314public class Book implements Parcelable &#123; private int mId; private String mName; private Book(Parcel in) &#123; mId = in.readInt(); mName = in.readString(); &#125; public Book(int id, String name) &#123; mId = id; mName = name; &#125;&#125; ç„¶åé¡¹ç›®ä¸­å¼€å¯ä¸¤ä¸ªè¿›ç¨‹ï¼Œåˆ†åˆ«ç§°ä¸º client è¿›ç¨‹å’Œ server è¿›ç¨‹å¥½äº†ã€‚ç„¶å client è¿›ç¨‹çš„ activity ä¸­ç»‘å®š server è¿›ç¨‹ä¸­çš„ serverï¼Œç»‘å®šåï¼Œclient è¿›ç¨‹ä½¿ç”¨ Messenger å‘ server è¿›ç¨‹å‘é€ä¸€ä¸ª Message å¯¹è±¡ï¼Œæ­¤ Message å¯¹è±¡çš„ obj å¼•ç”¨ä¸€ä¸ª Book å¯¹è±¡ï¼š 123456789101112private ServiceConnection mMsgConnection = new ServiceConnection() &#123; @Override public void onServiceConnected(ComponentName name, IBinder service) &#123; mMessenger = new Messenger(service); try &#123; Book book = new Book(1, \"name\"); mMessenger.send(Message.obtain(null, 101, book)); &#125; catch (RemoteException e) &#123; e.printStackTrace(); &#125; &#125;&#125; ç„¶åï¼Œæˆ‘åœ¨ Message ç±»çš„ readFromParcel æ–¹æ³•ä¸­æ‰“ä¸Šæ–­ç‚¹ï¼Œå½“ä»£ç æ‰§è¡Œåˆ°æ–­ç‚¹å¤„æ—¶ï¼Œå…ˆéªŒè¯ getClass().getClassLoader() æ— æ³•åŠ è½½åˆ°è‡ªå®šä¹‰çš„ Book ç±»ï¼š ç„¶åéªŒè¯ä¸»çº¿ç¨‹çš„ Thread.getContextClassLoader å¯ä»¥åŠ è½½åˆ° Book ç±»ï¼š æœ€åéªŒè¯ä½¿ç”¨å¯ä»¥åŠ è½½åˆ° Book ç±»çš„ ClassLoader çš„è¯ï¼Œæ˜¯å¯ä»¥æˆåŠŸååºåˆ—åŒ–å¾—åˆ° Book å¯¹è±¡çš„ï¼š æ’ä¸€å¥ï¼Œè¿™ä¸ª readFromParcel ä¸æ˜¯è¿è¡Œåœ¨ä¸»çº¿ç¨‹ï¼Œè€Œæ˜¯è¿è¡Œåœ¨ server è¿›ç¨‹çš„ Binder çº¿ç¨‹æ± ä¸­çš„ã€‚çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹çš„ getContextClassLoader() ç»“æœæ˜¯ nullã€‚ OKï¼Œä¸Šé¢çš„æµ‹è¯•å‡†ç¡®çš„éªŒè¯äº†æˆ‘çš„æƒ³æ³•ï¼Œç°åœ¨å›åˆ°å‰é¢è¯´çš„ Message çš„ setData(Bundle b) æ–¹æ³•çš„ä¼ç¬”ã€‚æ˜¾ç„¶è¿™é‡Œçš„ Bundle å¦‚æœè¦è·¨è¿›ç¨‹ä¼ è¾“è‡ªå®šä¹‰ Parcelableï¼Œæˆ‘ä»¬ä¹Ÿéœ€è¦ç¡®å®š Bundle åœ¨ååºåˆ—åŒ–æ—¶ä¸ä¼šé‡è¹ˆ Message.obj çš„è¦†è¾™ã€‚å®é™…ä¸Šï¼ŒBundle è‡ªå·±åšä¸åˆ°è¿™ç‚¹ï¼Œè¿˜éœ€è¦æˆ‘ä»¬å¸®å®ƒä¸€æŠŠå¿™ï¼Œé‚£å°±æ˜¯åœ¨ server è¿›ç¨‹ä¸­ï¼Œä» Message æ‹¿åˆ° Bundle åå†ç»™ Bundle è®¾ç½®ä¸€ä¸ª ClassLoader å³å¯ï¼š 1234567891011private static class MessengerHandler extends Handler &#123; @Override public void handleMessage(Message msg) &#123; switch (msg.what) &#123; case 101: Bundle b = msg.getData(); b.setClassLoader(Thread.currentThread().getContextClassLoader()); Book book = b.getParcelable(\"book\"); &#125; &#125;&#125; æ³¨æ„ï¼Œä¸Šé¢de handleMessage æ–¹æ³•æ˜¯åœ¨ä¸»çº¿ç¨‹ï¼Œæ‰€ä»¥æˆ‘ç›´æ¥ä½¿ç”¨ Thread.currentThread().getContextClassLoader() å°±å¯ä»¥ã€‚ åˆ°æ­¤ï¼Œæˆ‘å¾—å‡ºä¸€ä¸ªç»“è®ºï¼Œé‚£å°±æ˜¯æˆ‘çš„å¯¹äº Java çš„ ClassLoader ä¸€æ— æ‰€çŸ¥ï¼Œæƒ­æ„§æƒ­æ„§ï¼Œè¿˜æœ‰å¾ˆé•¿çš„è·¯è¦èµ°ã€‚æ‰€ä»¥ï¼Œåç»­æˆ‘ä¼šåŠ å¼ºè¿™æ–¹é¢çš„å­¦ä¹ ï¼Œç„¶åå¯èƒ½ä¼šç»§ç»­åŠ é•¿è¿™ç¯‡æ–‡ç« ï¼Œæ¯•ç«Ÿè¿™ç¯‡çš„æ ‡é¢˜æ˜¯ã€Œä» XXX è¯´èµ·ã€ã€‚","categories":[],"tags":[{"name":"Android","slug":"Android","permalink":"https://tao93.top/tags/Android/"}]},{"title":"The Linux Command Line digest","slug":"The Linux Command Line digest","date":"2018-09-26T07:47:46.656Z","updated":"2018-09-26T07:47:46.669Z","comments":true,"path":"2018/09/26/The Linux Command Line digest/","link":"","permalink":"https://tao93.top/2018/09/26/The Linux Command Line digest/","excerpt":"","text":"æœ¬æ–‡æ˜¯é˜…è¯» The Linux Command Line åå†™æˆçš„æ‘˜è¦ï¼Œç”¨äºè‡ªå·±éœ€è¦ç”¨åˆ°æ—¶å›å¿†å’Œå‚è€ƒã€‚ Learning The Shell","categories":[],"tags":[{"name":"Shell","slug":"Shell","permalink":"https://tao93.top/tags/Shell/"},{"name":"Linux","slug":"Linux","permalink":"https://tao93.top/tags/Linux/"}]},{"title":"targetSdkVersion æ‚è°ˆ","slug":"targetSdkVersion æ‚","date":"2018-09-26T07:47:46.655Z","updated":"2019-07-05T14:03:06.654Z","comments":true,"path":"2018/09/26/targetSdkVersion æ‚/","link":"","permalink":"https://tao93.top/2018/09/26/targetSdkVersion æ‚/","excerpt":"","text":"å¾ˆä¹…æ²¡æœ‰å†™æ–°çš„åšå®¢äº†ï¼ŒåŸå› æ˜¯è¿™ä¸€ä¸ªå¤šæœˆä»¥æ¥éƒ½æ²¡æƒ³åˆ°ä»€ä¹ˆåˆé€‚çš„ä¸»é¢˜ï¼Œä»Šå¤©å°±æ¥æ‚è°ˆä¸€ä¸‹ targetSdkVersion ç›¸å…³çš„ä¸œè¥¿å§ã€‚ åœ¨æˆ‘å·¥ä½œçš„ç¬¬ä¸€å¹´é‡Œï¼Œå…¶å®æˆ‘å¹¶ä¸çŸ¥é“ targetSdkVersion æœ‰ä»€ä¹ˆå«ä¹‰ï¼ŒæŸ¥èµ„æ–™ï¼Œçœ‹åˆ°çš„æ˜¯ç±»ä¼¼äºã€Œä»£è¡¨åº”ç”¨é’ˆå¯¹æŸä¸ª api level å®Œæˆé€‚é…äº†ã€è¿™æ ·çš„æè¿°ï¼Œè¿™æ ·çš„æè¿°å…¶å®è®©æˆ‘æ‘¸ä¸ç€å¤´è„‘ã€‚åæ¥ï¼Œæˆ‘æŠŠä¸€ä¸ªå°åº”ç”¨é¡¹ç›®çš„ targetSdkVersion å‡é«˜åˆ° api 27ï¼Œè¿™ä¸ªè¿‡ç¨‹æ‰è®©æˆ‘å¯¹ targetSdkVersion ç†è§£æ¯”è¾ƒåˆ°ä½äº†ã€‚è€Œè¿™æ—¶å€™ï¼Œæˆ‘å‘ç° targetSdkVersion çš„çš„ç¡®ç¡®å¦‚æˆ‘å…ˆå‰æŸ¥åˆ°çš„èµ„æ–™æ‰€è¨€ï¼Œè¡¨ç¤ºé’ˆå¯¹æŸä¸ª api level å®Œæˆé€‚é…äº†ï¼Œè¿™ä¸ªä¿¡æ¯æ˜¯ä¼šä¼ é€’ç»™ android ç³»ç»Ÿçš„ï¼Œandroid ç³»ç»Ÿä¾æ®è¿™ä¸€ä¿¡æ¯æ¥å¯¹åº”ç”¨åšåŒºåˆ«å¯¹å¾…ã€‚ é¦–å…ˆï¼Œéœ€è¦æ˜ç¡® Android ç³»ç»Ÿåœ¨å¤§ç‰ˆæœ¬æ›´æ–°æ—¶ï¼Œæ€»ä¼šåŠ å…¥ä¸€äº›æ–°çš„ featureï¼Œè€Œè¿™äº›æ–° feature å¯èƒ½ä¼šè®©è€çš„åº”ç”¨æ— æ³•å®Œç¾å…¼å®¹ã€‚å…¸å‹çš„ä¾‹å­æ˜¯ api 23 æ–°å¢çš„è¿è¡Œæ—¶åŠ¨æ€ç”³è¯·æƒé™æœºåˆ¶ã€‚åœ¨ api 23 ä»¥ä¸Šçš„ android ç³»ç»Ÿä¸­ï¼Œç³»ç»ŸæœŸå¾…ä»£ç å…ˆç”³è¯·æƒé™ (æˆ–è€…æ£€æŸ¥æƒé™æ˜¯å·²æœ‰çš„) åæ‰è¿è¡Œéœ€è¦æƒé™çš„ä»£ç  (ä¾‹å¦‚æ‹ç…§)ã€‚ä½†æ˜¯è€åº”ç”¨çš„ä»£ç ï¼Œåˆ™æ˜¯åªéœ€è¦åœ¨ manifest æ–‡ä»¶ä¸­ç”³è¯·æ‹ç…§æƒé™ï¼Œå°±å¯ä»¥ç›´æ¥æ‰§è¡Œæ‹ç…§çš„ä»£ç ã€‚æ‰€ä»¥ï¼ŒtargetSdkVersion çš„ä½œç”¨å°±æ˜¯ï¼Œå¦‚æœ targetSdkVersion å¤§äºç­‰äº 23ï¼Œé‚£ä¹ˆä»£ç å¿…é¡»æŒ‰æ–°æœºåˆ¶æ¥ (å³å…ˆç”³è¯·æƒé™ï¼Œç„¶åæ‰èƒ½æ‰§è¡Œéœ€è¦æƒé™çš„ä»£ç )ï¼Œå¦åˆ™ï¼Œandroid ç³»ç»Ÿå°±è®¤ä¸ºè¿™æ˜¯ä¸ªæ²¡æœ‰é’ˆå¯¹ api 23 è¿›è¡Œé€‚é…çš„è€åº”ç”¨ (æ¯”å¦‚å¯èƒ½æ˜¯ä¸€ä¸ª 2012 å¹´å°±åœæ­¢æ›´æ–°çš„åº”ç”¨ï¼‰ã€‚å¯¹è¿™ç§è€åº”ç”¨ï¼Œandroid ç³»ç»Ÿéœ€è¦å…¼å®¹ï¼Œå…¼å®¹çš„æ–¹å¼å°±æ˜¯ï¼Œè¿™ç§åº”ç”¨ä¸€ç»å®‰è£…ï¼Œå°±è‡ªåŠ¨è·å¾—äº†æ‰€æœ‰ manifest ä¸­ç”³æ˜çš„æƒé™ï¼Œè¿™æ ·å®ƒå°±èƒ½åœ¨æ–°ç³»ç»Ÿä¸­æ­£å¸¸è¿è¡Œã€‚ åœ¨æ–°ç³»ç»Ÿ (api 23 åŠä»¥ä¸Š) ä¸­ï¼Œå¯¹äºä¸Šè¿°çš„è€åº”ç”¨ï¼Œå®‰è£…æ—¶ä¼šåˆ—å‡ºæ‰€æœ‰æƒé™ï¼Œå‘Šè¯‰ç”¨æˆ·è¿™ä¸ªåº”ç”¨ä¸€ç»å®‰è£…å°±æœ‰äº†ä¸‹é¢çš„æƒé™ (å¦‚åŒè€ç³»ç»Ÿå®‰è£…æ‰€æœ‰åº”ç”¨æ—¶ä¸€æ ·)ã€‚è¿™å°±æ˜¯ç³»ç»Ÿçš„å…¼å®¹æœºåˆ¶ã€‚æ–°ç³»ç»Ÿä¸­å®‰è£…çš„è¿™æ ·çš„è€åº”ç”¨åï¼Œæˆ‘ä»¬åœ¨åº”ç”¨è¯¦æƒ…ä¸­å¯ä»¥çœ‹åˆ°å®ƒè‡ªåŠ¨æœ‰äº†æ‰€æœ‰æƒé™ï¼Œå¯æ˜¯æ–°ç³»ç»Ÿæ˜¯å¯ä»¥æ‰‹åŠ¨å…³é—­æŸä¸ªåº”ç”¨çš„æƒé™çš„ï¼Œå¦‚æœæˆ‘ä»¬å…³é—­è¿™ä¸ªè€åº”ç”¨çš„æŸä¸ªæƒé™ï¼Œä¼šæ€ä¹ˆæ ·å‘¢ï¼Ÿå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š ç³»ç»Ÿä¼šæç¤ºç”¨æˆ·ï¼Œå…³æ‰æƒé™çš„è¯åº”ç”¨å¯èƒ½æ— æ³•æ­£å¸¸è¿è½¬ã€‚è¿™æ˜¯å¯¹çš„ï¼Œå› ä¸ºå‡è®¾è€åº”ç”¨ä¸­æœ‰ç›´æ¥æ‰§è¡Œæ‹ç…§é€»è¾‘çš„ä»£ç ï¼Œæ‹ç…§æƒé™ç°åœ¨è¢«ç”¨æˆ·æ‰‹åŠ¨å…³é—­ï¼Œé‚£ä¹ˆæ‰§è¡Œåˆ°è¿™æ ·çš„ä»£ç æ—¶å°±ä¼šå´©æºƒ (without permission)ï¼ é—®é¢˜æ˜¯ï¼Œè®¸å¤šåº”ç”¨æ˜æ˜ä¸€ç›´åœ¨æ›´æ–°ï¼Œä½†æ˜¯ä¸ºäº†å°½é‡è·å–åˆ°å„ç§æƒé™ï¼Œä¼šæ•…æ„å°† targetSdkVersion åœç•™åœ¨ 22 åŠä»¥ä¸‹ï¼Œè¿™æ ·ç”¨æˆ·ä¸€ç»å®‰è£…ï¼Œè¿™æ ·çš„åº”ç”¨å°±è‡ªåŠ¨æœ‰äº†å®ƒæƒ³è¦çš„ä»»ä½•æƒé™ï¼Œä¾‹å¦‚ Android ç‰ˆæ‰‹æœº QQ ç°åœ¨çš„ targetSdkVersion ä¾ç„¶æ˜¯ 17ï¼š å¯¹äºè¿™æ ·çš„æ¯”è¾ƒæ— èµ–çš„åº”ç”¨ï¼Œå…¶å®å¯ä»¥æ”¾å¿ƒæŠŠä¸æƒ³æˆäºˆçš„æƒé™å…³é—­æ‰ï¼Œå®ƒæ˜¯ä¸ä¼šå´©æºƒçš„ï¼Œå› ä¸ºå…¶ä»£ç ä¸­å…¶å®å·²ç»åšäº†æƒé™æ£€æŸ¥ï¼Œæ¯•ç«Ÿå®ƒä¸€ç›´åœ¨æ›´æ–°å’Œç»´æŠ¤ã€‚å¦å¤–ï¼Œå¯¹äºè¿™ç§ç°è±¡ï¼ŒGoogle ä¹Ÿæœ‰æªæ–½ï¼Œä»Šå¹´è°·æ­Œå£°æ˜äº†å¯¹åœ¨ Google Play æ›´æ–°çš„åº”ç”¨å’Œä¸Šæ¶çš„æ–°åº”ç”¨éƒ½åœ¨ä»Šå¹´å¿…é¡»å°† targetSdkVersion å‡è‡³ 27 (æ­¥å­æœ‰ç‚¹å¤§)ã€‚è™½ç„¶ Google Play å¯¹å›½å†…è¿˜æœ‰ç‚¹é­é•¿è«åŠï¼Œä¸è¿‡è¿™ä¸€å€¡å¯¼åº”è¯¥è¿˜æ˜¯ä¼šè®©è®¸å¤šå¤§å‚çš„åº”ç”¨æ›´å¿«çš„æé«˜ targetSdkVersionã€‚ å¦å¤–ï¼Œå‡å¦‚ç”¨æˆ·æœ¬æ¥å®‰è£…äº† targetSdkVersion ä¸º 22 çš„è€åº”ç”¨ï¼Œä¸”è€åº”ç”¨æœ‰æ‰€æœ‰æƒ³è¦çš„æƒé™ï¼Œæ­¤æ—¶å¦‚æœæ›´æ–°åˆ° targetSdkVersion ä¸º 23 çš„æ–°ç‰ˆæœ¬åº”ç”¨ï¼Œé‚£ä¹ˆæ–°åº”ç”¨å°†ã€Œç»§æ‰¿ã€æ‰€æœ‰çš„æƒé™ã€‚åè¿‡æ¥ï¼Œæ–°ç‰ˆæœ¬çš„åº”ç”¨çš„ targetSdkVersion æ˜¯ä¸èƒ½æ¯”å·²å®‰è£…çš„è€ç‰ˆæœ¬åº”ç”¨è¿˜æ›´ä½çš„ï¼Œå› ä¸ºè¿™ä¸å…‰å…¼å®¹èµ·æ¥å¾ˆéº»çƒ¦ï¼Œè€Œä¸”äºæƒ…äºç†éƒ½ä¸åº”è¯¥ã€‚ åŠ¨æ€ç”³è¯·æƒé™å¤§æ¦‚ç®—æ˜¯æœ€å…¸å‹çš„ä¸€ä¸ªæ— æ³•å®Œç¾å…¼å®¹çš„ feature äº†ï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æœ‰ api 26 å¼•å…¥çš„ adaptive icon è¿™ä¸ª featureã€‚adaptive icon ä½¿å¾—åº”ç”¨å¯ä»¥æ ¹æ® launcher çš„åå¥½ï¼Œæ˜¾ç¤ºåœ†å½¢ã€åœ†è§’æ–¹å½¢ã€æ­£æ–¹å½¢ç­‰å„ç§å½¢çŠ¶çš„å›¾æ ‡ã€‚è®¸å¤šè€åº”ç”¨æ˜¯ç›´æ¥è‡ªå·±è£å‰ªä¸€ä¸ªåœ†è§’æ–¹å½¢çš„å›¾æ ‡ï¼Œè¿™æ˜¾ç„¶æ— æ³•å®Œç¾æ»¡è¶³ adaptive iconï¼Œæ‰€ä»¥æ˜¯ä¸å®Œç¾å…¼å®¹ã€‚targetSdkVersion ä¸º 26 åŠä»¥ä¸Šçš„åº”ç”¨ï¼Œåº”è¯¥ä¸”éœ€è¦å°† launcher icon åˆ†ä¸º foreground å’Œ background ä¸¤å±‚ï¼Œforeground æ˜¯å›¾æ ‡ä¸­å¿ƒçš„è‹¥å¹²å…ƒç´ ï¼Œæ¯”å¦‚é»‘é˜ˆ çš„ launcher icon çš„ foreground æ˜¯ä¸‹é¢è¿™æ ·ä¸€å¼ å›¾ç‰‡ï¼š è¿™ä¸ªå›¾ç‰‡ç»å¤§éƒ¨åˆ†éƒ½æ˜¯é€æ˜çš„ï¼Œåªæœ‰é‚£ 3 æ¡å¼§çº¿æ˜¯ç°ç™½è‰²çš„ã€‚è¿™æ ·ä¸€ä¸ª foreground ä½œä¸ºé»‘é˜ˆåº”ç”¨å›¾æ ‡çš„ä¸­å¿ƒå…ƒç´ ã€‚è€Œ background åˆ™æ˜¯ #FF353535 è¿™æ ·ä¸€ä¸ªçº¯è‰²ã€‚äº‹å®ä¸Šï¼Œé»‘é˜ˆçš„åœ¨æ–°ç³»ç»Ÿçš„å›¾æ ‡æ˜¯å¦‚ä¸‹æ‰€ç¤ºçš„ xml æ–‡ä»¶ï¼š 123456&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;adaptive-icon xmlns:android=\"http://schemas.android.com/apk/res/android\"&gt; &lt;background android:drawable=\"@color/ic_brevent_background\" /&gt; &lt;foreground android:drawable=\"@mipmap/ic_brevent_foreground\" /&gt;&lt;/adaptive-icon&gt; è¿™æ ·ä¸€ä¸ªæ–‡ä»¶å£°æ˜äº† foreground å’Œ backgroundã€‚å½“æ—¶é»‘é˜ˆä¹Ÿæ˜¯å¯èƒ½åœ¨ api 25 åŠä»¥ä¸‹çš„ android ç³»ç»Ÿè¿è¡Œçš„ï¼Œè¿™æ ·çš„ç³»ç»Ÿæ²¡æœ‰ adaptive icon è¿™ä¸ª featureï¼Œæ‰€ä»¥ï¼Œå½“åº”ç”¨çš„ minSdkVersion ä¸åˆ° 26 æ—¶ï¼Œåº”ç”¨ä¸­è¿˜éœ€è¦ä¸ºè€ç³»ç»Ÿå‡†å¤‡å›¾æ ‡èµ„æºã€‚å…¶å®åšæ³•å°±æ˜¯ä¸Šè¿° xml æ–‡ä»¶å‘½åä¸º ic_launcher.xml ä¹‹ç±»çš„åå­—ï¼Œç½®äº drawable-anydpi-v26 è¿™æ ·çš„èµ„æºç›®å½•ä¸­ï¼Œè€Œå…¶ä»–ç”¨äºè€ç³»ç»Ÿçš„å›¾æ ‡èµ„æº ic_launcher.png æ–‡ä»¶ç½®äº drawable-xdpi ç­‰èµ„æºç›®å½•ä¸­ï¼Œå³å¯ã€‚","categories":[],"tags":[{"name":"Android","slug":"Android","permalink":"https://tao93.top/tags/Android/"}]},{"title":"Python ä¹Ÿèƒ½ç©è·³ä¸€è·³å°æ¸¸æˆ","slug":"Python ä¹Ÿèƒ½ç©è·³ä¸€è·³å°æ¸¸æˆ","date":"2018-09-26T07:47:46.654Z","updated":"2019-07-05T14:03:01.649Z","comments":true,"path":"2018/09/26/Python ä¹Ÿèƒ½ç©è·³ä¸€è·³å°æ¸¸æˆ/","link":"","permalink":"https://tao93.top/2018/09/26/Python ä¹Ÿèƒ½ç©è·³ä¸€è·³å°æ¸¸æˆ/","excerpt":"","text":"2017å¹´12æœˆå¾®ä¿¡å‘å¸ƒçš„è·³ä¸€è·³å°æ¸¸æˆï¼Œç®€å•å´åˆè€ƒéªŒäººï¼Œå€Ÿç€è…¾è®¯ä¸€è´¯çš„å¥½å‹æ’åæœºåˆ¶å¯¹ç”¨æˆ·çš„åˆºæ¿€ï¼Œå‡ ä¹æ˜¯ç¬é—´å°±ç«èµ·æ¥äº†ã€‚æ‰‹æ®‹çš„æˆ‘ï¼Œç©è¿™ä¸ªæ¸¸æˆæœ€å¤šä¹Ÿåªæœ‰å‡ ååˆ†ã€‚çœ‹ç€è¿™æ¬¾å°æ¸¸æˆï¼Œæå…¶ç®€å•çš„æ“ä½œ (é•¿æŒ‰å°±å¤Ÿäº†)ã€æå…¶ç®€å•çš„èƒŒæ™¯ (å‡ ä¹æ˜¯çº¯è‰²ï¼Œæ²¡æœ‰ä»»ä½•èƒŒæ™¯è£…é¥°ç‰©)ã€æå…¶ç®€å•çš„å…ƒç´  (é•¿æ–¹ä½“ã€åœ†æŸ±ä½“ç­‰)ï¼Œè®©æˆ‘è§‰å¾—åº”è¯¥å¯ä»¥ç”¨ä¸€ä¸ªè„šæœ¬æ¥è‡ªåŠ¨åŒ–ç©è¿™ä¸ªæ¸¸æˆï¼Œè¯´å¹²å°±å¹²ã€‚ å¯¹äº Android è®¾å¤‡ï¼Œéœ€è¦è§£å†³çš„é—®é¢˜å…¶å®åªæœ‰ï¼šæ¨¡æ‹Ÿé•¿æŒ‰äº‹ä»¶ã€æˆªå›¾å¹¶è·å–å›¾ç‰‡ã€åˆ†æå›¾ç‰‡åƒç´ ï¼Œåˆ†æå¾—åˆ°æ¯ä¸€æ­¥éœ€è¦è·³åŠ¨çš„è·ç¦»ã€‚ä¸‹é¢ä¸€æ ·ä¸€æ ·æ¥çœ‹ã€‚ æ¨¡æ‹Ÿé•¿æŒ‰äº‹ä»¶ï¼Œæˆ‘é¦–å…ˆæƒ³åˆ°äº† adbï¼ŒæŸ¥äº†ä¸€ä¸‹ï¼Œæ‰¾åˆ°äº† adb shell input swipe x y time è¿™æ ·ä¸€æ¡å‘½ä»¤ï¼Œswipe æœ¬æ¥æ˜¯ç”¨æ¥åšæ»‘åŠ¨æ“ä½œçš„ï¼Œä½†æ˜¯è¿™é‡Œåªéœ€è¦é•¿æŒ‰ï¼Œæ‰€ä»¥åªæä¾›äº†ä¸€å¯¹åæ ‡ï¼Œæœ€åä¸€ä¸ªå‚æ•° time è¡¨ç¤ºé•¿æŒ‰çš„æ—¶é—´ï¼ŒOKã€‚ æˆªå›¾å¹¶è·å–å›¾ç‰‡ã€‚è·å–å›¾ç‰‡å¥½åŠï¼Œadb pull ä¸€ä¸‹å°±å¥½äº†ã€‚æˆªå›¾çš„è¯ï¼Œæˆ‘ä¹Ÿæ˜¯æƒ³åˆ°äº† adbï¼ŒæŸ¥äº†ä¸€ä¸‹ï¼Œæ‰¾åˆ°äº† adb shell /system/bin/screencap -p /sdcard/screenshot.png è¿™æ ·çš„å‘½ä»¤ï¼Œç”¨äºæˆªå›¾å¹¶æ”¾åˆ° sdcard ä¸­çš„æŸä¸ªä½ç½®ã€‚ åˆ†æå›¾ç‰‡åƒç´ è¿™ä¸€æ­¥ï¼Œå°±ä»…ä»…å‰©ä¸‹ç®—æ³•çš„é—®é¢˜å•¦ï¼Œæ¯•ç«Ÿå‰é¢å·²ç»æ‹¿åˆ°äº†æˆªå›¾äº†ã€‚æˆ‘æ˜¯ç”¨ Python çš„ PIL å›¾ç‰‡å¤„ç†åº“æ¥åšçš„ã€‚æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€å¼ è·³ä¸€è·³çš„æˆªå›¾ï¼š é¦–å…ˆå¯ä»¥æ˜ç¡®ä¸€ä¸ªé—®é¢˜ï¼Œå…¶å®æˆ‘ä»¬ä¸éœ€è¦æ±‚ä¸¤ä¸ªè½ç‚¹ä¹‹é—´çš„è·ç¦»ï¼Œè€Œåªè¦æ±‚ä¸Šå›¾ä¸­ä¸¤æ¡çº¢è‰²ç«–çº¿ä¹‹é—´çš„è·ç¦»å°±å¥½äº†ï¼ŒåŸå› æ˜¯ä¸ç®¡å¾€å·¦ä¸Šè·³ï¼Œè¿˜æ˜¯å¾€æœ‰ä¸Šè·³ï¼Œè¿™ä¸¤ç§è·³æ³•å·¦å³å¯¹ç§°ï¼Œæ‰€ä»¥æ¯ä¸€æ¬¡è·³åŠ¨çš„è·ç¦»ï¼Œå…¶å®æ­£æ¯”äºä¸¤ä¸ªåº•åº§çš„ä¸­å¿ƒçš„ x åæ ‡çš„è·ç¦»ï¼Œä¹Ÿå°±æ˜¯ä¸Šå›¾ä¸¤æ¡ç«–ç›´çº¢çº¿çš„è·ç¦»ã€‚ å‡è®¾ç¬¬ä¸€æ¡çº¢è‰²ç«–çº¿ä¸ºè·³ä¹‹å‰ä½ç½®ï¼Œç¬¬äºŒæ¡ç«–çº¿ä¸ºä¸‹ä¸€ä¸ªåº•åº§ä¸­å¿ƒçº¿ã€‚ç¬¬ä¸€æ¡ç«–çº¿çš„ x åæ ‡ï¼Œå¯ä»¥é€šè¿‡ä»ä¸Šåˆ°ä¸‹ä»å·¦åˆ°å³æ‰«æå›¾ç‰‡æ¯ä¸€ä¸ªåƒç´ ï¼Œç›´åˆ°æ‰¾åˆ°äº†é¢œè‰²å’Œè·³åŠ¨çš„æ£‹å­é¢œè‰²ç›¸åŒçš„é¢œè‰² (ä¸€ç§æ¯”è¾ƒæ·±çš„ç´«è‰²)ã€‚ç„¶åå°±å¯ä»¥æ‰¾åˆ°ç¬¬ä¸€æ¡çº¢çº¿çš„ x åæ ‡äº†ã€‚ç¬¬äºŒæ¡ç«–çº¿ï¼Œå¯ä»¥åœ¨é¦–æ¬¡æ‰«æåˆ°å’ŒèƒŒæ™¯é¢œè‰²ä¸ä¸€è‡´çš„é¢œè‰²æ—¶ï¼Œæ­¤æ—¶åº”è¯¥å°±æ˜¯ä¸‹ä¸€ä¸ªåº•åº§çš„æœ€é ä¸Šçš„åƒç´ ï¼Œå¹¶ä¸”ç”±äºåº•åº§è¦ä¹ˆæ˜¯åœ†æŸ±å½¢è¦ä¹ˆæ˜¯é•¿æ–¹ä½“ï¼Œæ‰€ä»¥è¿™ä¸ªåƒç´ ä¹Ÿå°±æ˜¯å·¦å³æ–¹å‘ä¸Šæ˜¯å±…ä¸­çš„ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬è¦æ‰¾çš„ç¬¬ 2 æ¡ç«–çº¿çš„ä½ç½®ã€‚ æœ€åé€šè¿‡æµ‹è¯•å’Œè°ƒæ ¡ï¼Œå¯ä»¥æ‰¾åˆ°é•¿æŒ‰çš„æ—¶é•¿å’Œä¸¤æ¡çº¢è‰²ç«–çº¿è·ç¦»çš„æ¯”å€¼ã€‚ åˆ°æ­¤ä¸ºæ­¢ï¼Œæ€è·¯éƒ½ç†æ¸…äº†ï¼Œæ¥ä¸‹æ¥å°±æ˜¯å†™ä»£ç åŠ ç»†èŠ‚ä¼˜åŒ–äº†ã€‚ä»£ç ä¸­æœ€å¤–å±‚æ˜¯ä¸ªå¾ªç¯ï¼Œå¾ªç¯çš„æ¯ä¸€æ­¥éƒ½æ˜¯è¿™æ ·å‡ æ­¥ï¼šæˆªå›¾ã€åˆ†æå›¾ç‰‡ç¡®å®šé•¿æŒ‰çš„æ—¶é•¿ã€æ¨¡æ‹Ÿé•¿æŒ‰ã€ç­‰å¾…å‡ ç§’ç­‰è·³è·ƒå®Œæˆä»¥å…ä¸‹ä¸€æ¬¡å¾ªç¯è¿‡æ—©å¼€å§‹æˆªå–åˆ°ä¸­é—´æ€çš„å›¾ç‰‡ã€‚ ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªæŒ‰ç…§ 1080P å±å¹•å†™çš„è„šæœ¬ï¼Œè¿˜æ˜¯æˆ‘å»å¹´å†™çš„ï¼Œä¹Ÿä¸çŸ¥é“æ˜¯å¦è¿˜é€‚ç”¨äºç°åœ¨çš„è·³ä¸€è·³ï¼Œæˆ‘ç°åœ¨ä¹Ÿä¸æƒ³ç©è·³ä¸€è·³äº†ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106from PIL import Imageimport osimport timeimport randomdef is_ball_color(r, g, b): # åˆ¤æ–­æ˜¯å¦æ˜¯æ£‹å­é¡¶éƒ¨å°çƒçš„é¢œè‰² if r &lt; 50 or r &gt; 70: return False if g &lt; 50 or g &gt; 70: return False if b &lt; 50 or b &gt; 70: return False return Truedef is_base_color(r, g, b): # åˆ¤æ–­æ˜¯å¦æ˜¯æ£‹å­åº•åº§çš„é¢œè‰² if r &lt; 50 or r &gt; 70: return False if g &lt; 50 or g &gt; 70: return False if b &lt; 90 or b &gt; 100: return False return Truedef is_similar_color(c1, c2): # åˆ¤æ–­æ˜¯å¦æ˜¯ç›¸è¿‘çš„é¢œè‰² if abs(c1[0] - c2[0]) &gt; 20: return False if abs(c1[1] - c2[1]) &gt; 20: return False if abs(c1[2] - c2[2]) &gt; 20: return False return Truewhile True: os.system('adb shell /system/bin/screencap -p /sdcard/screenshot.png') os.system('adb pull /sdcard/screenshot.png .') img = Image.open('screenshot.png') w = img.size[0] h = img.size[1] if w == 0 or h == 0: print('w, h:', w, h) break # print img.getpixel((310, 933)) # print img.getpixel((311, 933)) # é¦–å…ˆæ˜¯æ‰«ææ¥æ‰¾æ£‹å­ base_x = base_y = 0 for y in range(400, h): # y åæ ‡ä» 400 å¼€å§‹ï¼Œé¿å…æ‰«æåˆ°å›¾ç‰‡é¡¶éƒ¨çš„æŒ‰é’® x = 0 for x in range(0, w): px = img.getpixel((x, y)) if is_ball_color(px[0], px[1], px[2]): px = img.getpixel((x, y + 192)) if is_base_color(px[0], px[1], px[2]): break if x &lt; w - 1: base_x = x base_y = y break base_y += 192 if base_x == 0: print('base_x == 0') break print('base:', base_x, base_y) bg_px = img.getpixel((0, 400)) # ç„¶åæ˜¯æ‰«ææ¥æ‰¾ä¸‹ä¸€ä¸ªåº•åº§çš„ä½ç½® dest_x = dest_y = 0 for y in range(400, h): x = 0 for x in range(0, w): if x % 50 == 0 and x &gt; 0: px = img.getpixel((x - 50, y)) if is_similar_color(bg_px[0 : 3], px[0 : 3]): bg_px = px px = img.getpixel((x, y)) if abs(px[0] - bg_px[0]) &gt; 20 or abs(px[1] - bg_px[1]) &gt; 20 or abs(px[2] - bg_px[2]) &gt; 20: if abs(x - base_x) &gt; 100: y += 10 left = right = x while not is_similar_color(bg_px[0 : 3], img.getpixel((left, y))[0 : 3]): left -= 1 while not is_similar_color(bg_px[0 : 3], img.getpixel((right, y))[0 : 3]): right -= 1 break if x &lt; w - 1: dest_x = (left + right) / 2 dest_y = y break distance = abs(dest_x - base_x) print('dest:', dest_x, dest_y) x = (int)(random.random() * 200 + 600) y = (int)(random.random() * 200 + 600) # t æ˜¯é•¿æŒ‰çš„æ—¶é—´ t = distance * 600 / 383 loc = ' ' + str(x) + ' ' + str(y) + ' ' os.system('adb shell input swipe ' + loc + loc + str(t)) os.system('rm screenshot.png') time.sleep(3)","categories":[],"tags":[{"name":"Python","slug":"Python","permalink":"https://tao93.top/tags/Python/"}]},{"title":"MySQL æ•°æ®åº“æ”¯æŒ emoji è¡¨æƒ…å­—ç¬¦","slug":"MySQL æ•°æ®åº“æ”¯æŒ emoji è¡¨æƒ…å­—ç¬¦","date":"2018-09-26T07:47:46.652Z","updated":"2018-09-26T07:47:46.653Z","comments":true,"path":"2018/09/26/MySQL æ•°æ®åº“æ”¯æŒ emoji è¡¨æƒ…å­—ç¬¦/","link":"","permalink":"https://tao93.top/2018/09/26/MySQL æ•°æ®åº“æ”¯æŒ emoji è¡¨æƒ…å­—ç¬¦/","excerpt":"","text":"å…´å†²å†²çš„æ•´ä¸ªåšå®¢ï¼Œæ­»çš®èµ–è„¸çš„å«å‡ ä¸ªåŒå­¦æ¥è¯„è®ºï¼Œç»“æœè¯„è®ºä¸­è¾“å…¥çš„ emoji è¡¨æƒ…æœ€åä¼šå˜æˆé—®å·ï¼Œè¯•æƒ³åˆ«äººè¯„è®ºã€Œå†™çš„çœŸæ£’ ğŸ˜„ã€ç»“æœå˜æˆäº†ã€Œå†™çš„çœŸæ£’ ï¼Ÿã€ï¼Œè¿™æ˜¯ä½•å…¶çš„å°´å°¬ã€‚ ç»§ç»­å›åˆ°è¿™ä¸ªé—®é¢˜æœ¬èº«ã€‚æˆ‘ç™»å½•åˆ°æ•°æ®åº“ä¸€æŸ¥ï¼Œå‘ç°æ•°æ®åº“ä¸­å­˜çš„è¯„è®ºæ–‡æœ¬å°±æ˜¯ä¸ªé—®å·ï¼Œè¿™è¯´æ˜ emoji è¡¨æƒ…å­˜åˆ°æ•°æ®åº“çš„è¿‡ç¨‹å‡ºé—®é¢˜äº†ã€‚èµ¶ç´§ä¸€æŸ¥ï¼Œå‘ç°ç½‘ä¸Šè¿˜æ˜¯å¾ˆå®¹æ˜“æ‰¾åˆ°äº†è§£å†³æ–¹æ³•ã€‚é—®é¢˜çš„åŸå› æ˜¯ MySQL å­˜å‚¨æ–‡æœ¬æ—¶é»˜è®¤çš„ UTF-8 ä»…æ”¯æŒ 3 ä¸ªå­—èŠ‚ç¼–ç ï¼Œè€Œ emoji æ˜¯ 4 å­—èŠ‚ç¼–ç çš„ï¼Œæ‰€ä»¥å­˜å‚¨è¿‡ç¨‹å‡ºé—®é¢˜äº†ã€‚æ‰€ä»¥éœ€è¦å°† charset è®¾ç½®ä¸º UTF-8 çš„è¶…é›† UTF-8mb4ï¼Œè™½ç„¶æˆ‘ä¹Ÿä¸çŸ¥é“è¿™ä¸ª UTF-8mb4 æ˜¯ä½•æ–¹ç¥åœ£ã€‚ é¦–å…ˆï¼Œéœ€è¦åœ¨é…ç½®æ–‡ä»¶ my.cnf (åœ¨æˆ‘çš„æœºå™¨ä¸Šè¿™ä¸ªæ–‡ä»¶è·¯å¾„æ˜¯ /etc/my.cnf) ä¸­æ·»åŠ ä¸€ä¸‹å†…å®¹ï¼š 1234567891011[client]default-character-set=utf8mb4[mysqld]character-set-client-handshake = FALSEcharacter-set-server = utf8mb4collation-server = utf8mb4_unicode_ciinit_connect=â€™SET NAMES utf8mb4'[mysql]default-character-set=utf8mb4 ç„¶åï¼Œéœ€è¦ä¿®æ”¹å·²æœ‰åº“ã€è¡¨ã€å­—æ®µçš„ charsetã€‚ 12345678# ä¿®æ”¹åº“çš„ ALTER DATABASE &lt;database_name&gt; CHARACTER SET = utf8mb4 COLLATE = utf8mb4_unicode_ci; # ä¿®æ”¹è¡¨çš„ ALTER TABLE &lt;table_name&gt; CONVERT TO CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci; # ä¿®æ”¹å­—æ®µçš„ ALTER TABLE &lt;table_name&gt; CHANGE &lt;column_name&gt; &lt;column_name&gt; &lt;original_column_type&gt; CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci; æœ€åé‡æ–°å¯åŠ¨ MySQL æœåŠ¡ï¼š 1sudo /etc/init.d/mysql stop sudo /etc/init.d/mysql start å¦å¤–ï¼Œmysqldump æ—¶ï¼Œä¹Ÿéœ€è¦è¿›è¡Œé¢å¤–æŒ‡å®š char setï¼š 1mysqldump -default-character-set-utf8mb4 -u &lt;db_user_name&gt; -p --databases &lt;db_name&gt; --lock-all-tables &gt; &lt;file_name&gt;","categories":[],"tags":[{"name":"MySQL","slug":"MySQL","permalink":"https://tao93.top/tags/MySQL/"}]},{"title":"macOS ç³»ç»Ÿç¼–è¯‘ Android 8.1.0 æºç å…¨è¿‡ç¨‹","slug":"macOS ç³»ç»Ÿç¼–è¯‘ Android 8.1.0 æºç å…¨è¿‡ç¨‹","date":"2018-09-26T07:47:46.651Z","updated":"2019-07-05T14:02:49.537Z","comments":true,"path":"2018/09/26/macOS ç³»ç»Ÿç¼–è¯‘ Android 8.1.0 æºç å…¨è¿‡ç¨‹/","link":"","permalink":"https://tao93.top/2018/09/26/macOS ç³»ç»Ÿç¼–è¯‘ Android 8.1.0 æºç å…¨è¿‡ç¨‹/","excerpt":"","text":"è¿™ç¯‡æ–‡ç« è¯¦ç»†è®°å½•æˆ‘åœ¨ macOS 10.13 ä¸Šä½¿ç”¨ AOSP ä»£ç ç¼–è¯‘æœ€æ–° Android 8.1.0 çš„ userdebug ç³»ç»Ÿï¼Œå¹¶å®‰è£…åˆ° Pixel XL æ‰‹æœºä¸Šï¼Œæœ€åç”¨ AOSP ä»£ç æˆåŠŸè°ƒè¯• userdebug ç³»ç»Ÿ (ä»è€Œå¯ä»¥å‡†ç¡®å°†ç”µè„‘ä¸Šçš„æºç å’Œè®¾å¤‡ç³»ç»Ÿä»£ç è¡Œå·å¯¹åº”) çš„å…¨è¿‡ç¨‹ã€‚å…¨æ–‡åŒ…æ‹¬ AOSP çš„è·å–ã€ç¼–è¯‘ Android ç³»ç»Ÿã€ä½¿ç”¨ Intellij IDEA æ‰“å¼€éƒ¨åˆ†æºç ã€ä½¿ç”¨ Intellij IDEA è¿›è¡Œè°ƒè¯•è¿™æ ·å‡ éƒ¨åˆ†ã€‚ ç¯å¢ƒï¼šmacOS 10.13, 250GB SSD, 16GB RAM, XCode 9.2, JDK 1.8.0_151 ä¸€ã€AOSP ä»£ç çš„è·å–å›  Android çš„ç¼–è¯‘éœ€è¦ case-sensitive çš„ç£ç›˜ç³»ç»Ÿï¼Œè€Œ macOS çš„ç£ç›˜ç³»ç»Ÿä¸æ»¡è¶³æ­¤æ¡ä»¶ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å»ºç«‹ä¸€ä¸ª case-sensitive çš„é•œåƒæ–‡ä»¶ï¼Œç„¶åæŒ‚è½½æ­¤é•œåƒæ–‡ä»¶ï¼Œæœ€åå†æŒ‚è½½çš„ç›®å½•ä¸­è·å–æºç å’Œç¼–è¯‘æºç ã€‚å»ºç«‹é•œåƒæ–‡ä»¶çš„æ“ä½œï¼š 123456789101112# åˆ›å»ºç©ºé—´ä¸Šé™ä¸º 150GB çš„ç¨€ç–é•œåƒæ–‡ä»¶ï¼Œåˆ›å»ºåé•œåƒæ–‡ä»¶å…¶å®æ˜¯ ~/android.dmg.sparseimage # åˆ›å»ºåå¹¶æœªçœŸæ­£å æ®è¿™ä¹ˆå¤šç£ç›˜ç©ºé—´ï¼Œè€Œæ˜¯éšç€é•œåƒä¸­é˜²æ­¢çš„æ•°æ®è¶Šæ¥è¶Šå¤šï¼Œè¯¥é•œåƒæ–‡ä»¶æ‰åŸæ¥è¶Šå¤§ hdiutil create -type SPARSE -fs 'Case-sensitive Journaled HFS+' -size 150g ~/android.dmg # ç„¶åå°±å¯ä»¥å°†é•œåƒæ–‡ä»¶æŒ‚è½½åˆ° /Volumes ä¸­ï¼Œæ¯”å¦‚æˆ‘æŒ‚è½½åˆ° /Volumes/android hdiutil attach ~/android.dmg.sparseimage -mountpoint /Volumes/android # è§£é™¤æŒ‚è½½åˆ™æ˜¯ä¸‹é¢è¿™æ · hdiutil detach /Volumes/android # é•œåƒæ–‡ä»¶çš„ç©ºé—´ä¸Šé™æ˜¯å¯ä»¥æ›´æ”¹çš„ï¼Œæ¯”å¦‚ä¸‹é¢æ›´æ”¹ä¸º 160GB hdiutil resize -size 160G ~/android.dmg.sparseimage æç¤ºä¸€ä¸‹ï¼Œhdiutil å‘½ä»¤çš„æŸäº›æ“ä½œéœ€è¦ç”µè„‘æ’ç€ç”µæºï¼Œå¦åˆ™ä¼šæŠ¥é”™ï¼Œä¸è¿‡è¿™ä¸ªæŠ¥é”™åœ¨ Google æœç´¢ä¸€ä¸‹å°±èƒ½æ‰¾åˆ°ç­”æ¡ˆäº†ã€‚ AOSP é¡¹ç›®å› ä¸ºåŒ…å«å¤ªå¤šäº†å­é¡¹ç›®ï¼Œæ‰€ä»¥æ¯ä¸ªå­é¡¹ç›®ä½¿ç”¨ Git æ¥ç®¡ç†ï¼Œè€Œæ•´ä¸ª AOSP åˆ™ä½¿ç”¨ repo å·¥å…·æ¥ç®¡ç†ï¼Œrepo å…¶å®å°±æ˜¯ä¸€ä¸ª shell è„šæœ¬ï¼Œå†…éƒ¨è°ƒç”¨ Gitã€‚å®˜æ–‡æä¾›çš„è·å– AOSP ä»£ç çš„æ–¹å¼å› ä¸ºæŸäº›åŸå› è€Œæ¯”è¾ƒéš¾åšåˆ°ï¼Œæ‰€ä»¥æˆ‘ä» USTC Mirror æ¥è·å–æºç ã€‚æ­¥éª¤å¦‚ä¸‹ï¼š 123456789101112131415# é¦–å…ˆè·å–ä¸€ä¸‹ repo å·¥å…· mkdir ~/bin export PATH=~/bin:$PATH curl https://storage.googleapis.com/git-repo-downloads/repo &gt; ~/bin/repo # å…ˆæŒ‚è½½ï¼Œç„¶åè¿›å…¥æŒ‚è½½åçš„ç›®å½•ï¼Œåˆ›å»ºä¸€ä¸ªç›®å½•ï¼Œæˆ‘è¿™æ˜¯åˆ›å»ºäº† android-8.1.0_r20 cd /Volumes/android mkdir android-8.1.0_r20 &amp;&amp; cd android-8.1.0_r20 # ç„¶åä½¿ç”¨ repo init æ¥åˆå§‹åŒ– AOSP ç›®å½•ï¼Œå› ä¸º android-8.1.0_r20 æ˜¯å¯ä»¥å®‰è£…åœ¨ Pixel XL ä¸Šé¢çš„æœ€æ–°ç‰ˆæœ¬ï¼Œæ‰€ä»¥æˆ‘é€‰æ‹©å®ƒæ¥ä½œä¸ºåˆ†æ”¯ # å‚è§ https://source.android.google.cn/setup/build-numbers?hl=zh-cn#source-code-tags-and-builds æ¥æŸ¥è¯¢å“ªäº›åˆ†æ”¯æ”¯æŒå“ªäº›è®¾å¤‡ã€‚ # USTC Mirror ä½œä¸ºåŒæ­¥ä»£ç çš„é•œåƒ repo init -u git://mirrors.ustc.edu.cn/aosp/platform/manifest -b android-8.1.0_r20 # æ¥ä¸‹æ¥æ˜¯éœ€è¦æ¼«é•¿æ—¶é—´çš„ä¸€æ­¥ï¼Œå³ä»æœåŠ¡å™¨åŒæ­¥æ‰€æœ‰ä»£ç åŠæ–‡ä»¶åˆ°æœ¬åœ°ã€‚ repo sync å¦‚æœ repo init å¤±è´¥ï¼Œå¯ä»¥å‚è€ƒä¸€ä¸‹ USTC Mirror çš„æ–¹æ³• ä¸­çš„åˆå§‹åŒ–ä»“åº“é‚£ä¸€æ­¥ã€‚åŒæ­¥è¿‡ç¨‹æ˜¯å¯èƒ½æ„å¤–ä¸­æ–­çš„ï¼Œæ­¤æ—¶å¯ä»¥ç›´æ¥ç»§ç»­æ‰§è¡Œ repo sync æ¥ç»§ç»­åŒæ­¥ã€‚ä¸è¿‡ï¼Œè¿™ä¸ªè¡¥åˆ€æ˜¯å¯ä»¥è‡ªåŠ¨åŒ–æ‰§è¡Œçš„ï¼Œé‚£å°±æ˜¯ä¸‹é¢çš„ shell è„šæœ¬ï¼š 123456#!/bin/bash repo sync while [ $? -e 1 ]; do repo sync doneecho success é™¤äº†åŒæ­¥çš„æ–¹å¼ï¼Œå…¶å®è¿˜æœ‰å¦ä¸€æ¡è·¯å¯ä»¥èµ°ï¼Œé‚£å°±æ˜¯å…ˆä» USTC Mirror AOSP Monthly æˆ–è€… TUNA Mirror AOSP Monthly ä¸‹è½½ aosp-latest.tar æ–‡ä»¶ï¼Œç„¶åè§£å‹åˆ°æ”¾ç½®æºç çš„ç›®å½•ï¼Œç„¶åå† repo initï¼Œç„¶åå† repo syncï¼Œè¿™æ ·çš„è¯ï¼Œrepo sync å°±ä¼šå¿«å¾ˆå¤šï¼Œå¯èƒ½ä¸€ä¸ªå°æ—¶å°±å¯ä»¥äº†å§ã€‚ äºŒã€ç¼–è¯‘ Android ç³»ç»ŸæˆåŠŸå¾—åˆ°æºç åï¼Œå°±å¯ä»¥ç¼–è¯‘ Android ç³»ç»Ÿé•œåƒäº†ã€‚åœ¨ macOS ä¸Šï¼Œå¦‚æœä½ ä¸æ˜¯ macOS æˆ– iOS å¼€å‘è€…çš„è¯ï¼Œå…«æˆæˆ‘ä»¬éœ€è¦å…ˆå®‰è£… XCodeã€‚ Gentle remindï¼šåŠ å…¥ä½ ä¹Ÿæ˜¯ 250GB SSD ç”¨æˆ·ï¼Œè€ƒè™‘åˆ°ç¼–è¯‘è¿‡ç¨‹ä¸­ï¼Œæºç ç›®å½•å æ®çš„ç©ºé—´ä¼šè¶Šæ¥è¶Šåºå¤§ï¼Œé‚£ä¹ˆæˆ‘å»ºè®®æš‚æ—¶å°†æºç æ ¹ç›®å½•ä¸­çš„ .repo éšè—ç›®å½•å‰ªåˆ‡åˆ°ç§»åŠ¨ç¡¬ç›˜ã€‚ä½†æ˜¯å…‰è¿™æ ·è¿˜ä¸å¤Ÿï¼Œä½ è¿˜éœ€è¦å…ˆè§£é™¤æŒ‚è½½ï¼Œç„¶åå†æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤æ¥æ”¶ç¼©ç¨€ç–é•œåƒæ–‡ä»¶æ‰€å æ®çš„ç©ºé—´å¤§å°ï¼š 123# å› ä¸ºç¨€ç–é•œåƒæ–‡ä»¶åˆ é™¤å†…å®¹æ—¶ï¼Œå¹¶ä¸ä¼šå‡å°å æ®çš„ç©ºé—´å¤§å°ï¼Œæ‰€ä»¥ç¨€ç–é•œåƒæ–‡ä»¶ä¼šè¶Šæ¥è¶Šå¤§ï¼Œè§£å†³åŠæ³•å°±æ˜¯ä¸‹é¢è¿™æ ·æ”¶ç¼©ä¸€ä¸‹ # æ”¶ç¼©æ˜¯æŠŠç¨€ç–é•œåƒä¸­æ²¡æœ‰ä½¿ç”¨çš„ç©ºé—´å»é™¤æ‰ï¼Œä»è€Œè®©å®ƒä¸é‚£ä¹ˆç¨€ç–ï¼Œå°±å¥½åƒæŠŠæµ·ç»µé‡Œçš„æ°´æŒ¤æ‰ä¸€æ · hdiutil compact android.dmg.sparseimage ä¸‹é¢å¼€å§‹ç¼–è¯‘çš„ä¸€äº›æ­¥éª¤ï¼š 12# å…ˆè¿›å…¥ AOSP æ ¹ç›®å½•ï¼Œç„¶åå°è¯•æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ï¼Œä¹Ÿå°±æ˜¯æ¸…ç†ä¸Šæ¬¡æ„å»ºçš„äº§ç‰© make clobber å¦‚æœä¸Šé¢çš„å‘½ä»¤æŠ¥é”™ï¼Œæç¤º MacOSX SDK ç¼ºå°‘ï¼Œé‚£ä¹ˆå¯ä»¥ https://github.com/phracker/MacOSX-SDKs/releases ä¸‹è½½å¯¹åº”ç‰ˆæœ¬çš„å‹ç¼©åŒ…ï¼Œè§£å‹åˆ° /Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs è¿™ä¸ªè·¯å¾„ä¸­ã€‚å¦‚æœæç¤ºä»€ä¹ˆ rt.jar æ‰¾ä¸åˆ°ï¼Œé‚£ä¹ˆä¹…å°† ANDROID_JAVA_HOME è®¾ç½®ä¸º JDK çš„æ ¹ç›®å½•ã€‚ ç›´åˆ° make clobber ä¸æŠ¥é”™äº†ï¼Œå¼€å§‹ä¸‹é¢çš„æ­¥éª¤ï¼š 12345678# å¼•å…¥ä¸€ä¸ªç¯å¢ƒè®¾ç½®çš„è„šæœ¬ source build/envsetup.sh # é€‰æ‹©ç¼–è¯‘ç›®æ ‡ï¼Œæˆ‘é€‰æ‹©çš„æ˜¯ aosp_marlin-userdebugï¼Œmarlin è¡¨ç¤º Pixel XLï¼Œuserdebug çš„å«ä¹‰è¡¨ç¤ºè°ƒè¯•ç‰ˆæœ¬çš„ Android ç³»ç»Ÿ lunch # ç„¶åå°±æ˜¯å¼€å§‹ç¼–è¯‘äº†ï¼Œ-j åé¢è¡¨ç¤ºå¤šå°‘ä¸ªçº¿ç¨‹å¹¶è¡Œç¼–è¯‘ã€‚æ ¹æ®ç”µè„‘ CPU ç¡¬ä»¶æ¥é€‰ï¼Œä¸€èˆ¬ 4 æ ¸å¿ƒ 8 çº¿ç¨‹çš„ CPU å°±é€‰ -j8 make -j8 å®Œæ•´ç¼–è¯‘ä¸€éæ˜¯éœ€è¦è€—è´¹è‹¥å¹²å°æ—¶æ—¶é—´çš„ï¼Œæ‰€ä»¥è€å¿ƒç­‰å¾…ï¼Œæˆ‘çš„ç”µè„‘æ˜¯ MacBook Pro 15 å¯¸ 2016ç‰ˆ 2.6GHz CPUï¼Œç¼–è¯‘å¤§çº¦éœ€è¦ä¸‰å››ä¸ªå°æ—¶ã€‚ å¦‚æœä¸Šé¢ç¼–è¯‘æ—¶å‡ºç°ç±»ä¼¼ä¸‹é¢çš„é”™è¯¯ï¼š ninja: build stopped: subcommand failed. ninja failed with: exit status 1 é‚£ä¹ˆå‚è€ƒ https://groups.google.com/forum/#!topic/android-building/D1-c5lZ9Oco ç»™å‡ºçš„æ–¹æ³•ï¼Œéœ€è¦æ›´æ”¹ external/bison è¿™ä¸ªé¡¹ç›®çš„ä»£ç äº†ã€‚æ­¤æ—¶å¦‚æœå‰é¢æˆ‘ä»¬æŠŠ .repo éšè—ç›®å½•å‰ªè´´èµ°äº†ï¼Œé‚£ä¹ˆç°åœ¨å°±éœ€è¦æŠŠå®ƒçš„ä¸€éƒ¨åˆ†æ‹·è´å›æ¥ï¼Œå³ external/bison è¿™ä¸ªé¡¹ç›®æ‰€éœ€çš„ Git track æ–‡ä»¶ï¼Œé€šè¿‡æŸ¥çœ‹ external/bison/.git ä¸­çš„ç¬¦å·é“¾æ¥ï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“å“ªäº›æ–‡ä»¶éœ€è¦æ‹·è´å›æ¥ã€‚ çº¢æ¡†ä¸­å°±æ˜¯éœ€è¦æ‹·è´å›æ¥çš„ç›®å½•ã€‚ç„¶åæˆ‘ä»¬æ‰§è¡Œä¸‹é¢çš„æ›´æ”¹ï¼š 1234567891011121314# å…ˆè¿›å…¥è¿™ä¸ª bison é¡¹ç›®çš„ç›®å½• cd external/bison # ä½œå‡ºæ›´æ”¹ git cherry-pick c0c852bd6fe462b148475476d9124fd740eba160 # æ„å»ºä¸€ä¸‹ bison é¡¹ç›® mm # å›åˆ° AOSP æ ¹ç›®å½•ï¼Œç„¶åå°†åˆšåˆšæ„å»ºå¾—åˆ°çš„ bison æ›¿ä»£å¦ä¸€ä¸ªåœ°æ–¹çš„ cd ../.. &amp;&amp; cp out/host/darwin-x86/bin/bison prebuilts/misc/darwin-x86/bison/ # ç„¶åç»§ç»­å†ç¼–è¯‘ make -j8 å»ºè®®ï¼šå¦‚æœä½ ä¹Ÿæ˜¯ 250 GB SSD ç”¨æˆ·ï¼Œé‚£ä¹ˆæ¯æ¬¡ç¼–è¯‘å¤±è´¥åï¼Œå¯ä»¥å…ˆ make clobber æ¸…é™¤æ„å»ºäº§ç‰©ï¼Œå†è§£é™¤æŒ‚è½½ï¼Œç„¶å compat ä¸€ä¸‹ç¨€ç–é•œåƒæ–‡ä»¶ï¼Œè¿™æ ·å¯ä»¥å°½å¯èƒ½çš„é¿å…æœ€åç¼–è¯‘æ—¶ç©ºé—´ä¸å¤Ÿç”¨ã€‚ ä¸‰ã€çƒ§å½•åˆ° Pixel XL è®¾å¤‡ä¸­å…ˆè¿›å…¥å¼€å‘è€…æ¨¡å¼ï¼Œç„¶åæ‰“å¼€ OEM é”ã€‚è¿æ¥åˆ°ç”µè„‘ï¼Œä½¿ç”¨ adb reboot bootloader å‘½ä»¤è®©æ‰‹æœºè¿›å…¥åˆ° BootLoader æ¨¡å¼ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥é‡‡ç”¨æŒ‰è®¾å¤‡çš„ç‰©ç†æŒ‰é”®çš„æ–¹å¼è¿›å…¥ BootLoader æ¨¡å¼ã€‚å¦‚æœæ­¤æ—¶å±å¹•ä¸‹åƒä¸‹é¢è¿™æ ·ï¼Œå°±ä¸éœ€è¦è§£é”ï¼Œåä¹‹éœ€è¦ä½¿ç”¨ fastboot flashing unlock æ¥è§£å¼€ BootLoader é”ã€‚ç³Ÿäº†ï¼Œä»Šå¤©å‡ºé—¨æ²¡å¸¦æ‰‹æœºï¼Œæ— æ³•æˆªå›¾äº†ï¼Œåæ­£å°±æ˜¯å±å¹•ä¸‹éƒ¨å‡ºç° unlocked å­—æ ·ï¼Œç„¶åè¿˜æœ‰ä¸€æŠŠè§£å¼€çš„å°é”çš„å›¾æ ‡ï¼Œå°±æ˜¯å·²è§£é”ï¼Œå¦åˆ™æ˜¯æœªè§£é”ã€‚åªæœ‰è§£é”åæ‰èƒ½åˆ·æœºã€‚å¯¹äº†ï¼Œæ¸©é¦¨æç¤ºä¸€ä¸‹ï¼Œè§£é”åæ¯æ¬¡å¼€æœºéƒ½ä¼šæç¤ºã€ŒYour device software canâ€™t be checked for corruption. Please lock the bootloader. PRESS POWER TO PAUSE BOOTã€ï¼Œä¸ç”¨ç†å®ƒå°±å¥½äº†ã€‚ ç°åœ¨æˆ‘ä»¬è¦å» Driver Binaries ä¸‹è½½é€‚ç”¨äº Pixel XL çš„é©±åŠ¨æ–‡ä»¶ã€‚è¿™ä¸ªé¡µé¢å¾ˆé•¿ï¼Œè¦åœ¨å…¶ä¸­æ‰¾åˆ°æˆ‘ä»¬éœ€è¦çš„é©±åŠ¨æ–‡ä»¶ï¼Œéœ€è¦ä¸€ä¸ªç»†åˆ†ç‰ˆæœ¬å·ï¼Œåœ¨ ä»£å·ã€æ ‡ç­¾å’Œç‰ˆæœ¬å·è¿™ä¸ªé¡µé¢ï¼Œå¯ä»¥æ‰¾åˆ°æˆ‘ä¹‹å‰ä½¿ç”¨çš„ android-8.1.0_r20 åˆ†æ”¯å¯¹åº”çš„ç»†åˆ†åˆ†æ”¯æ˜¯ OPM2.171019.029ï¼Œä½¿ç”¨è¿™ä¸ªç»†åˆ†åˆ†æ”¯ï¼Œå°±å¯ä»¥åœ¨ Driver Binaries ä¸‹è½½åˆ°ç”¨äº Pixel XL çš„å‡†ç¡®çš„é©±åŠ¨æ–‡ä»¶äº†ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œä¸€å…±æ˜¯ä¸¤ä¸ªæ–‡ä»¶ï¼Œä¸‹è½½ä¹‹åè§£å‹ï¼Œå‘ç°æ˜¯ä¸¤ä¸ª shell è„šæœ¬ï¼Œåå­—åˆ†åˆ«æ˜¯ extract-qcom-marlin.sh å’Œ extract-google_devices-marlin.shã€‚ ç°åœ¨ï¼Œå°†ä¸Šä¸€æ­¥å¾—åˆ°çš„ä¸¤ä¸ª shell è„šæœ¬éƒ½å¤åˆ¶åˆ° AOSP æºç æ ¹ç›®å½•ï¼Œç„¶ååˆ†åˆ«æ‰§è¡Œä»¥ä¸‹ã€‚æ¥ä¸‹æ¥ï¼Œéœ€è¦ä»¥ä¸‹æ­¥éª¤æ¥ç¼–è¯‘å¾—åˆ°ä¸€äº›é¢å¤–çš„æ–‡ä»¶ï¼Œå…¶å®æˆ‘ä¹Ÿä¸çŸ¥é“æ˜¯ä»€ä¹ˆæ–‡ä»¶ã€‚æ¥ä¸‹æ¥çš„æ­¥éª¤ï¼š 12345source build/envsetup.sh # ä¸‹é¢è¿™ä¸€æ­¥æˆ‘ä¾æ—§æ˜¯é€‰ marlin-userdebug lunchmake -j8 åˆ«æ‹…å¿ƒä¸Šé¢è¿™ä¸ª make å¾ˆå¿«å°±ä¼šå®Œæˆï¼Œå› ä¸ºä¹‹å‰å·²ç»å®Œæ•´ç¼–è¯‘è¿‡äº†ã€‚æ¥ä¸‹æ¥è¦å¼€å§‹åˆ·æœºçš„æœ€åæ­¥éª¤äº†ï¼š 12345# å› ä¸ºåé¢çš„ flashall éœ€è¦ä¸‹é¢è¿™æ ·ä¸€ä¸ªç¯å¢ƒå˜é‡ï¼Œæ‰€ä»¥å…ˆè®¾ç½®ä¸€ä¸‹ export ANDROID_PRODUCT_OUT=&lt;AOSP_ROOT_DIR&gt;/out/target/product/marlin # è¿›å…¥ä¸Šé¢è¿™ä¸ª marlin ç›®å½•ï¼Œæ‰‹æœºä¿æŒ BootLoader æ¨¡å¼å¹¶è¿æ¥åˆ°ç”µè„‘ï¼Œç„¶åå¼€å§‹åˆ·æœºfastboot -w flashall å››ã€è°ƒè¯• Android ä»£ç user-debug çš„ç³»ç»Ÿå®‰è£…åˆ°æ‰‹æœºä¸­åï¼Œå¯ä»¥å‘ç°å’Œå‘è¡Œç‰ˆè¿˜æ˜¯æœ‰äº›ä¸åŒçš„ï¼Œæ¯”å¦‚æ²¡æœ‰ Google æ¡†æ¶ï¼Œæ²¡æœ‰ Google Photosï¼Œç”šè‡³è¿æ—¶é’Ÿåº”ç”¨éƒ½å’Œå‘è¡Œç‰ˆçš„åŸç”Ÿ Android ä¸ä¸€æ ·ã€‚å¦‚æœéœ€è¦è°ƒè¯•ä»£ç ï¼Œæ¯”å¦‚æˆ‘ä»¬è°ƒè¯•åˆ° com.android.internal.policy.PhoneWindow è¿™ä¸ªç±»çš„ä»£ç ï¼Œé‚£ä¹ˆæ˜¾ç„¶ï¼Œéœ€è¦ä½¿ç”¨ä¸€ä¸ª IDE æ¥æ‰“å¼€æˆ‘ä¸‹è½½çš„ AOSP æºç ï¼Œå› ä¸ºè¿™ä»½æºç å†æ˜¯å®‰è£…åˆ°æ‰‹æœºä¸­çš„æºç ï¼Œè€Œä¸èƒ½ä½¿ç”¨ Android SDK ä¸­çš„ sources/android-27 ä¸­çš„æºç æ¥è°ƒè¯•ã€‚ä½¿ç”¨ Intellij IDEA (ä¸‹é¢ç”¨ IDEA ç®€ç§°) æ¥æ‰“å¼€æºç ï¼Œå°†ä¼šæ¯” Android Studio å¥½ä¸€äº›ï¼Œå› ä¸ºå‰è€…æ›´å®¹æ˜“æ§åˆ¶ JDK çš„å¼•å…¥ã€‚ é¦–å…ˆï¼Œå¯¹äºæˆ‘ä»¬çš„ä¸ªäººç”µè„‘æ¥è¯´ï¼Œç›´æ¥æ‰“å¼€æ•´ä¸ª AOSP é¡¹ç›®çš„æºç æ˜¾å¾—æœ‰äº›è€ƒéªŒäººï¼ŒåŒæ—¶ä¹Ÿè€ƒéªŒæœºã€‚å› ä¸º AOSP ç›®å½•å¤ªåºå¤§äº†ï¼ŒIDEA å»ºç«‹ç´¢å¼•å°†ä¼šéœ€è¦éå¸¸ä¹‹ä¹…ï¼Œä¸€æ—¦æ–‡ä»¶æœ‰äº†æ›´æ”¹ï¼Œé‡æ–°ç´¢å¼•åˆè¦å¾ˆä¹…ï¼Œæ­¤å¤–ï¼Œå…‰æ˜¯ç´¢å¼•æ–‡ä»¶éƒ½ä¼šå¾ˆå¤§ã€‚æ‰€ä»¥æƒå®œä¹‹è®¡æ˜¯ï¼ŒåªæŠŠæœ€å¸¸ç”¨çš„ä¸€éƒ¨åˆ† AOSP ä»£ç  (ä¹Ÿå°±æ˜¯ä¸€éƒ¨åˆ†å­é¡¹ç›®) ä½¿ç”¨ IDEA æ‰“å¼€ã€‚æˆ‘é€‰æ‹©äº† framework ç›®å½•ä¸‹çš„æ‰€æœ‰å­é¡¹ç›®å’Œ libcoreã€repo è¿™ä¸¤ä¸ªå­é¡¹ç›®ã€‚framework æ˜¯å› ä¸ºé‡Œé¢çš„ä»£ç å¸¸ç”¨åˆ°ï¼Œlibcore æ˜¯å› ä¸ºé‡Œé¢æœ‰ Java çš„åº“ä»£ç ï¼Œè€Œ repo æ˜¯å› ä¸º repo è¢«å¼•ç”¨äº†ï¼Œæ‰€ä»¥ä¹ŸåŠ è¿›æ¥äº†ã€‚ æ­¤å¤–ï¼Œå› ä¸º AOSP æºç æ”¾ç½®åœ¨ case-sensitive çš„é•œåƒæ–‡ä»¶ä¸­ï¼Œè€Œå¦‚æœ IDEA æ‰“å¼€ä½äºé•œåƒæ–‡ä»¶ä¸­çš„æºç çš„è¯ï¼Œå°†éœ€è¦ä¸º IDEA é…ç½®ä¸º case-sensitiveï¼Œå¯æ˜¯ IDEA å¯èƒ½è¿˜éœ€è¦æ‰“å¼€å…¶ä»–çš„æ™®é€šé¡¹ç›®ï¼Œå³ä½äº macOS çš„ case-insensitive æ–‡ä»¶ç³»ç»Ÿä¸­çš„é¡¹ç›®ã€‚è¿™æ ·ä¸¤è€…å°±ä¼šå†²çªï¼Œé¢‘ç¹æŠ¥é”™ã€‚æ‰€ä»¥æˆ‘çš„æ–¹æ³•æ˜¯ï¼ŒæŠŠä¸Šä¸€æ®µæåˆ°çš„éƒ¨åˆ†å­é¡¹ç›®æ‹·è´åˆ°å¤–é¢ï¼Œä¹Ÿå°±æ˜¯æ‹·è´åˆ° macOS æ–‡ä»¶ç³»ç»Ÿï¼Œç„¶åå†ç”¨ IDEA æ‰“å¼€ã€‚ æ¥ä¸‹æ¥æ˜¯å…·ä½“çš„æ­¥éª¤äº†ï¼Œ é¦–å…ˆéœ€è¦ç”Ÿæˆç”¨äº IDEA çš„ android.imp å’Œ android.ipr æ–‡ä»¶: 12# åœ¨ AOSP æ ¹ç›®å½•æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ make idegen &amp;&amp; development/tools/idegen/idegen.sh ç„¶åå°±æ˜¯æ‹·è´å­é¡¹ç›®å‡ºæ¥ 1234567# è¿™ä¸ª aosp_part å°±æ˜¯ç”¨æ¥ä¿å­˜éƒ¨åˆ†å­é¡¹ç›®çš„ç›®å½•äº† mkdir aosp_part &amp;&amp; cd aosp_part # æ‹·è´ framework ç›®å½•å’Œ libcore ç›®å½•å‡ºæ¥ cp -R /Volumes/android/android-8.1.0_r20/framework . cp -R /Volumes/android/android-8.1.0_r20/libcore . cp -R /Volumes/android/android-8.1.0_r20/repo . ä¸ºé¿å…ä¸å°å¿ƒæ”¹åŠ¨ä¸Šé¢é¡¹ç›®ä¸­çš„æ–‡ä»¶ï¼Œæˆ‘ä»¬éœ€è¦ Git æ¥è¿½è¸ªå®ƒä»¬ï¼Œè€Œæ‰€æœ‰å­é¡¹ç›®çš„ git æ–‡ä»¶å…¶å®éƒ½åœ¨ .repo è¿™ä¸ªéšè—ç›®å½•ä¸­ã€‚æ‰€ä»¥ï¼š 12345678910111213# æ¥ä¸‹æ¥éœ€è¦æŠŠä¸Šé¢å­é¡¹ç›®å¯¹åº”çš„ .git ç›®å½•æ‹·è´è¿‡æ¥ # å…ˆå»ºä¸€ä¸ª .repo ç›®å½•ï¼Œå¹¶å»ºå¥½ç›¸å…³ç›®å½• mkdir -p .repo/project-objects/platform &amp;&amp; mkdir -p .repo/projects # ç„¶åå¼€å§‹æ‹·è´ .git ç›®å½• cp -R /Volumes/android/android-8.1.0_r20/.repo/project-objects/platform/frameworks .repo/project-objects/platform cp -R /Volumes/android/android-8.1.0_r20/.repo/project-objects/platform/libcore.git .repo/project-objects/platform cp -R /Volumes/android/android-8.1.0_r20/.repo/project-objects/platform/repo.git .repo/project-objects/platform cp -R /Volumes/android/android-8.1.0_r20/.repo/projects/frameworks .repo/projects/ cp -R /Volumes/android/android-8.1.0_r20/.repo/projects/libcore.git .repo/projects/ cp -R /Volumes/android/android-8.1.0_r20/.repo/projects/repo.git .repo/projects/ # æœ€åï¼ŒæŠŠå‰é¢ç”Ÿæˆçš„ä¸¤ä¸ªæ–‡ä»¶æ‹·è´è¿‡æ¥ cp /Volumes/android/android-8.1.0_r20/android.iml /Volumes/android/android-8.1.0_r20/android.ipr . ç„¶åï¼Œå°±å¯ä»¥ä½¿ç”¨ IDEA ä»¥æ‰“å¼€é¡¹ç›®çš„å½¢å¼æ‰“å¼€æ­¤ aosp_part ç›®å½•äº†ã€‚æ‰“å¼€åï¼Œå› ä¸º libcore ä¸­å°±å·²ç»æœ‰äº† JDK åº“ä»£ç ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦è®© aosp_part é¡¹ç›®ä¸ä½¿ç”¨ç”µè„‘ä¸­çš„ JDKã€‚æ–¹æ³•æ˜¯åœ¨ IDEA æ‰“å¼€çš„ aosp_part é¡¹ç›®ï¼ŒFile â†’ Project Structure â†’ SDKsï¼Œç„¶åå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š ç‚¹å‡»åŠ å·ï¼Œæ–°å»ºä¸€ä¸ª JDK å¹¶å°†æ–°çš„ JDK å‘½åä¸º aosp_jdk_1.8ï¼Œæ–°å»ºçš„ JDK ä¸€å¼€å§‹ä¼šå’Œå·²æœ‰çš„é‚£ä¸ª JDK 1.8 ä¸€æ¨¡ä¸€æ ·ï¼ŒåŒ…å«äº†åº“ä»£ç ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æŠŠ aosp_jdk_1.8 çš„ ClassPath tab ä¸­çš„æ‰€æœ‰ .jar æ–‡ä»¶ç§»é™¤ï¼Œè¿™æ · aosp_jdk_1.8 æˆäº†ä¸€ä¸ªç©ºçš„ JDKï¼Œå°†è¢«ç”¨äº aosp_part é¡¹ç›®ï¼Œè€Œå…¶ä»–çš„ IDEA é¡¹ç›®å¯ä»¥ä¾æ—§ä½¿ç”¨ JDK 1.8ï¼Œäº’ä¸å½±å“ã€‚ åœ¨ä¸Šé¢çš„çª—å£ä¸­ï¼Œåœ¨å·¦ä¾§åˆ‡æ¢åˆ° Modules tabï¼Œç„¶åå¦‚ä¸‹å›¾ï¼Œåˆ‡æ¢åˆ° dependencies tabï¼š åœ¨ä¸Šé¢è¿™ä¸ªç•Œé¢ä¼šæœ‰éå¸¸å¤šçš„ .jar ï¼ŒæŠŠå®ƒä»¬å…¨éƒ¨ç§»é™¤ï¼Œç„¶åå†æ·»åŠ å‰é¢é‚£ä¸ª aosp_jdk_1.8ï¼Œç°åœ¨å°±å·²ç»ç”¨ IDEA æ‰“å¼€äº†éƒ¨åˆ† android æºç äº†ï¼š æ¥ä¸‹æ¥æ˜¯æœ€åä¸€æ­¥äº†ï¼Œåœ¨ IDEA ä¸­è°ƒè¯•ä»£ç ã€‚ åœ¨ IDEA ä¸­ï¼ŒRun â†’ Edit Configuration â†’ + â†’ Remoteï¼Œç„¶åç¼–è¾‘ä¸€ä¸‹ nameï¼Œç„¶åæŠŠ Settings ä¸‹é¢çš„ port ç¼–è¾‘ä¸º 8700ï¼Œæœ€åä¿å­˜ã€‚ åœ¨ Android SDK æºç ç›®å½•ä¸­çš„ tools ç›®å½•ä¸­çš„ monitor å¯æ‰§è¡Œæ–‡ä»¶ã€‚å¦‚æœè¿™ä¸ªç¨‹åºæ‰“ä¸å¼€ï¼Œåˆ«æ‹…å¿ƒï¼Œå…ˆæ£€æŸ¥ä¸€ä¸‹ JDK ç‰ˆæœ¬æ˜¯ä¸æ˜¯é«˜äºæˆ–ç­‰äº 1.8.0_152ï¼Œå¦‚æœæ˜¯ï¼Œé‚£ä¹ˆåªéœ€è¦å›é€€åˆ° 1.8.0_151 å³å¯ã€‚è´´å¿ƒçš„æˆ‘æä¾›ä¸€ä»½ JDK 1.8.0_151 çš„ä¸‹è½½åœ°å€ï¼Œåœ¨è¿™é‡Œæ‰¾åˆ° 1.8.0_151 ç‰ˆæœ¬å³å¯ä»¥ã€‚ æ‰“å¼€ monitor åï¼Œé¼ æ ‡é€‰ä¸­éœ€è¦è°ƒè¯•çš„è¿›ç¨‹ï¼š å› ä¸ºä»Šå¤©æ²¡å¸¦æ‰‹æœºï¼Œæ‰€ä»¥ä¸Šå›¾ä¸­æ˜¯ä¸ª vivo çš„æµ‹è¯•æœºã€‚ ç„¶ååœ¨ IDEA ç‚¹å‡»è°ƒè¯•æŒ‰é’® (å›¾æ ‡æ˜¯ä¸€ä¸ªç»¿è‰²çš„å°è™«å­)ï¼Œæ­¤æ—¶å¦‚æœå¼¹å‡º Debug tool window å¹¶æç¤º connected to target VMï¼Œåˆ™è¯´æ˜å¯ä»¥åŠ æ–­ç‚¹è°ƒè¯•äº†ã€‚ EOF","categories":[],"tags":[{"name":"Android","slug":"Android","permalink":"https://tao93.top/tags/Android/"},{"name":"AOSP","slug":"AOSP","permalink":"https://tao93.top/tags/AOSP/"}]},{"title":"macOS çŠ¶æ€æ æ˜¾ç¤ºç½‘é€Ÿå°å·¥å…·","slug":"macOS çŠ¶æ€æ æ˜¾ç¤ºç½‘é€Ÿå°å·¥å…·","date":"2018-09-26T07:47:46.649Z","updated":"2019-07-05T14:02:43.754Z","comments":true,"path":"2018/09/26/macOS çŠ¶æ€æ æ˜¾ç¤ºç½‘é€Ÿå°å·¥å…·/","link":"","permalink":"https://tao93.top/2018/09/26/macOS çŠ¶æ€æ æ˜¾ç¤ºç½‘é€Ÿå°å·¥å…·/","excerpt":"","text":"æ—©å…ˆæˆ‘æ˜¯ç”¨ç›—ç‰ˆçš„ iStat Menus è½¯ä»¶ä¸­çš„ã€ŒçŠ¶æ€æ æ˜¾ç¤ºç½‘é€Ÿã€åŠŸèƒ½çš„ï¼Œåæ¥ä¸å†ç”¨ç›—ç‰ˆè½¯ä»¶äº†ï¼Œå¯æ˜¯å¶å°”è¿˜æ˜¯æœ‰æŸ¥çœ‹ç½‘é€Ÿçš„éœ€æ±‚ï¼Œæ‰€ä»¥æˆ‘å°±æŸ¥æ‰¾ macOS ç›‘æµ‹ç½‘é€Ÿçš„æ–¹æ³•ï¼Œæœ€åæ‰¾åˆ°äº† nettop è¿™ä¸ªå‘½ä»¤ã€‚ nettop å‘½ä»¤çš„å‚æ•°æˆ‘å°±ä¸è§£é‡Šäº†ï¼Œåæ­£ç”¨å®ƒå°±å¯ä»¥çœ‹åˆ°å½“å‰æ—¶åˆ»å„ä¸ªè¿›ç¨‹ download å’Œ upload çš„å­—èŠ‚æ•°ï¼Œæ‰€ä»¥å®šæ—¶æ‰§è¡Œæ­¤å‘½ä»¤ï¼Œç„¶åå¯å¾—æ—¶é—´åŒºé—´å†…çš„ä¸Šä¼ å’Œä¸‹è½½å­—èŠ‚æ•°ï¼Œç„¶åå†é™¤ä»¥æ—¶é—´é—´éš”ï¼Œå°±å¾—åˆ°äº†ç½‘é€Ÿã€‚æˆ‘å®šæ—¶æ‰§è¡Œçš„å‘½ä»¤å¦‚ä¸‹æ‰€ç¤ºï¼š 1nettop -x -t wifi -t wired -k rx_dupe,rx_ooo,re-tx,rtt_avg,rcvsize,tx_win,tc_class,tc_mgt,cc_algo,P,C,R,W -P -l 1 æ‰§è¡Œä¸Šé¢çš„å‘½ä»¤ï¼Œå°±å¯åˆ—å‡ºè‹¥å¹²è¿›ç¨‹å’Œä»–ä»¬çš„ä¸Šä¼ ä¸‹è½½å­—èŠ‚æ•°ï¼Œä¸‹é¢æ˜¯ç¤ºä¾‹ï¼š 1234567891011121314151617time interface state bytes_in bytes_out17:36:43.266151 apsd.100 7413 1624617:36:43.266164 sentineld.109 6666 695417:36:43.266166 biometrickitd.253 113264 1980217:36:43.266169 eoshostd.266 0 017:36:43.266171 SystemUIServer.380 0 334417:36:43.266172 rapportd.405 393 36617:36:43.266174 Mail.419 81706 3618317:36:43.266194 SogouServices.487 329 92117:36:43.266198 mDNSResponder.602 20108134 392598717:36:43.266200 Teams.6104 33061 1997517:36:43.266214 Microsoft Teams.6142 23322 2208517:36:43.266220 QQ.33101 522914 8204017:36:43.266222 WeChat.37612 53670 6449217:36:43.266224 Google Chrome.37878 1633955 4264817:36:43.266226 ss-local.38600 52499 7455517:36:43.266228 netbiosd.40075 1008522 151841 ä»¥ä¸Šå°±æ˜¯æœ€åŸºæœ¬çš„ä¸œè¥¿äº†ã€‚å› ä¸ºæˆ‘å¹¶ä¸æ‡‚ swift ç¼–ç¨‹ï¼Œæ‰€ä»¥æˆ‘å…ˆå†™äº†ä¸€ä¸ª python è„šæœ¬ï¼Œæ¥å®šæ—¶æ‰§è¡Œä¸Šé¢çš„å‘½ä»¤ï¼Œç„¶åè§£æå‘½ä»¤çš„è¾“å‡ºå¹¶è®¡ç®—ç½‘é€Ÿï¼Œè„šæœ¬å¦‚ä¸‹ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950import osimport timeimport subprocessdef get_time_stamp(t): h = int(t[0:2]) m = int(t[3:5]) s = int(t[6:8]) miu_s = int(t[9:]) return ((h * 60 + m) * 60 + s) * 1000000 + miu_slast_result = &#123;&#125;cur_result = &#123;&#125;while True: print('---------') # sample, output speed res = subprocess.run('nettop -x -t wifi -t wired -k rx_dupe,rx_ooo,re-tx,rtt_avg,rcvsize,tx_win,tc_class,tc_mgt,cc_algo,P,C,R,W -P -l 1'.split(), stdout=subprocess.PIPE) # assign sample result to last result output = res.stdout.decode() cur_result = &#123;&#125; for line in output.split('\\n'): if line == '' or line.startswith('time'): continue data = line.split() data_len = len(data) t, p, i, o = data[0], ''.join(data[1: data_len - 2]), int(data[data_len - 2]), int(data[data_len - 1]) idx = p.rfind('.') p = p[:idx] t = get_time_stamp(t) cur_result[p] = (t, i, o) if len(last_result) &gt; 0: speed = &#123;&#125; for last_p, last_d in last_result.items(): for cur_p, cur_d in cur_result.items(): if last_p == cur_p: up_speed = cur_d[2] - last_d[2] down_speed = cur_d[1] - last_d[1] if cur_p in speed: speed[cur_p] = (speed[cur_p][0], speed[cur_p][1] + up_speed, speed[cur_p][2] + down_speed) else: speed[cur_p] = (cur_p, up_speed, down_speed) speed = list(speed.values()) speed.sort(key=lambda x: x[1] + x[2], reverse=True) for i in speed: print(i[0]) last_result = cur_result time.sleep(1) ç„¶åä»Šå¤©ç»ˆäºç£•ç£•ç»Šç»Šçš„ç”¨ XCode å†™äº†ä¸€ä¸ªæ¯”è¾ƒç®€é™‹çš„ã€ŒçŠ¶æ€æ æ˜¾ç¤ºå®æ—¶ç½‘é€Ÿã€çš„ macOS å°å·¥å…·ï¼Œå¹¶æ”¾åœ¨äº† github ä¸Šé¢ï¼Œè¿è¡Œæ•ˆæœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š","categories":[],"tags":[{"name":"macOS","slug":"macOS","permalink":"https://tao93.top/tags/macOS/"},{"name":"swift","slug":"swift","permalink":"https://tao93.top/tags/swift/"}]},{"title":"macOS ç¼–è¯‘ Android 9 æºç ","slug":"macOS ä¸‹ç¼–è¯‘ Android 9 æºç ","date":"2018-09-26T07:47:46.647Z","updated":"2019-07-05T14:02:37.866Z","comments":true,"path":"2018/09/26/macOS ä¸‹ç¼–è¯‘ Android 9 æºç /","link":"","permalink":"https://tao93.top/2018/09/26/macOS ä¸‹ç¼–è¯‘ Android 9 æºç /","excerpt":"","text":"ç¯å¢ƒï¼šmacOS High Sierra 10.13.6 with 16GB RAM XCode 9.4.1 Oracle JDK 1.8.0_181 å¤§çº¦ 1 ä¸ªæœˆä¹‹å‰ï¼ŒGoogle æ¨å‡ºäº† Android Pie æ­£å¼ç‰ˆï¼Œæˆ‘ä¹Ÿç”¨ Pixel XL è®¾å¤‡ç¬¬ä¸€æ—¶é—´æ›´æ–°åˆ°äº† Pieï¼Œç»“æœå‘ç°å’Œ Oreo ç›¸æ¯”å˜åŒ–ä¸å¤§ã€‚æ­¤å¤–ï¼Œæˆ‘ä¹Ÿæƒ³åˆ° Google åº”è¯¥æ—©å°±åœ¨ AOSP åˆ›å»ºäº† Android Pie çš„ä»£ç åˆ†æ”¯ï¼Œæ­£å¥½æˆ‘åˆ°åˆšåˆ° Microstrategy æ¥ä¸Šç­ï¼Œæ¢äº†æ–°çš„ MacBookï¼Œæ˜¯æ—¶å€™å†æ¬¡ç”¨ MacBook ç¼–è¯‘ä¸€æ¬¡ AOSP æºç äº†ã€‚ é¦–å…ˆæˆ‘æŸ¥çœ‹äº†æ‰‹ä¸Šçš„ 2017 æ¬¾ MacBook 15å¯¸ï¼Œå‘ç°è¿™å±…ç„¶æ˜¯ 500GB ç£ç›˜çš„ï¼Œè¿™ä»¤æˆ‘ååˆ†æƒŠå–œï¼Œè¿™æ„å‘³ç€è¿™å°æœºå™¨ç¼–è¯‘ Android æºç æ—¶ç£ç›˜ç©ºé—´å°†ä¼šç»°ç»°æœ‰ä½™ã€‚ è·å–æºä»£ç å¯ä»å›½å†…é•œåƒå…ˆä¸‹è½½åˆ°ä¸€ä¸ªå‹ç¼©åŒ…ï¼ŒUSTC Mirror å’Œ Tuna éƒ½å¯é€‰æ‹©ï¼Œä»¥ä¸‹ä»¥ Tuna ä¸ºä¾‹ã€‚ é¦–å…ˆä» è¿™é‡Œ ä¸‹è½½ aosp-latest.tar æ–‡ä»¶å’Œå¯¹åº”çš„ MD5 æ–‡ä»¶ã€‚è¿™ä¸ª tar æ–‡ä»¶ä¸­æ˜¯è¿‘æœŸçš„æ•´ä¸ª AOSP é¡¹ç›®çš„å‹ç¼©åŒ…ã€‚ä¸‹è½½å¯ä»¥ä½¿ç”¨ wget åŠ  -c å‘½ä»¤ï¼Œè¿™æ ·å³ä½¿ä¸‹è½½æ„å¤–å¤±è´¥ï¼Œä¹Ÿå¯ä»¥æ¥ä¸Šä¸­æ–­çš„åœ°æ–¹ç»§ç»­ä¸‹è½½ã€‚ 12# download aosp-latest.tar file, with -c optionwget -c https://mirrors.tuna.tsinghua.edu.cn/aosp-monthly/aosp-latest.tar ä¸‹è½½å®Œæˆåï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤è·å– md5 å€¼ï¼Œæ£€æŸ¥å’Œä¸‹è½½åˆ°çš„ aosp-latest.tar.md5 æ–‡ä»¶ä¸­çš„å€¼æ˜¯å¦ä¸€è‡´ï¼š 12# get it's md5 value then check the valuemd5 aosp-latest.tar å¦ä¸€ä¸ªä»¤äººæƒŠå–œçš„äº‹ï¼Œæœ€è¿‘çš„ aosp ä½“ç§¯å±…ç„¶å‡å°äº†ï¼Œä¹‹å‰å‡ ä¸ªæœˆ aosp ä½“ç§¯é‚£æ˜¯ä¸€è·¯è¹­è¹­è¹­å¾€ä¸Šæ¶¨ï¼Œæ¶¨åˆ°äº† 40 å¤š GBï¼š æ¥ä¸‹æ¥ï¼ŒæŒ‰ç…§ä¹‹å‰æˆ‘çš„ post macOS ç³»ç»Ÿç¼–è¯‘ Android 8.1.0 æºç å…¨è¿‡ç¨‹ ä¸­çš„æè¿°ï¼Œå»ºç«‹ sparse image å¹¶æŒ‚è½½ï¼Œç„¶åå°† aosp-latest.tar è§£å‹åˆ° sparse image ä¸­ã€‚æˆ‘åœ¨ sparse image ä¸­å»ºç«‹äº†ä¸€ä¸ª aosp ç›®å½•ï¼Œç„¶åæŠŠ aosp-latest.tar è§£å‹åˆ°äº† aosp ç›®å½•ä¸­ï¼Œæ­¤æ—¶ aosp ç›®å½•ä¸­ä»…æœ‰ä¸€ä¸ª .repo ç›®å½•ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬æ¥æŠŠæœ€æ–°çš„ Android Pie åˆ†æ”¯çš„ä»£ç  checkoutã€‚ å¦å¤–ï¼Œè¦å…ˆçŸ¥é“æˆ‘ä»¬éœ€è¦å“ªä¸ªåˆ†æ”¯ï¼Œåœ¨ è¿™é‡Œ å¯ä»¥çœ‹åˆ°æ‰€æœ‰ä»£ç åˆ†æ”¯ä¸ä»£å·ã€‚åœ¨è¿™ä¸ªç½‘é¡µå¦‚æœæ˜¾ç¤ºä¸ºä¸­æ–‡ï¼Œå°±æ‹‰åˆ°æœ€åº•éƒ¨åœ¨å·¦ä¸‹è§’æŠŠè¯­è¨€æ¢æˆè‹±æ–‡ï¼Œå› ä¸ºè‹±æ–‡æ‰æœ‰æœ€æ–°çš„ Android Pie ç›¸å…³ä¿¡æ¯ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæ ¹æ®è‡ªå·±æƒ³è¦ç”¨äºä»€ä¹ˆè®¾å¤‡æ¥é€‰æ‹©åˆ†æ”¯ï¼Œæ¯”å¦‚å¦‚æœæ˜¯ Pixel 2 è®¾å¤‡é‚£ä¹ˆæœ€æ–°çš„åˆ†æ”¯å°±æ˜¯ android-9.0.0_r6ï¼Œè€Œä¸èƒ½ä½¿ android-9.0.0_r7 å’Œ android-9.0.0_r8ï¼Œæˆ‘å½“æ—¶ç”¨çš„æ˜¯ android-9.0.0_r2 123456789# prepare repomkdir ~/bincurl https://storage.googleapis.com/git-repo-downloads/repo &gt; ~/bin/repoexport PATH=$&#123;PATH&#125;:$&#123;HOME&#125;/bincd aosp# init with specific branch android-9.0.0_r2, use other branch as you wantrepo init repo init -u https://aosp.tuna.tsinghua.edu.cn/platform/manifest -b android-9.0.0_r2 æ¥ä¸‹æ¥å°±å¯ä»¥ repo sync äº†ï¼Œå¯ä»¥ç›´æ¥æ‰§è¡Œæ­¤å‘½ä»¤ï¼Œä¹Ÿå¯ä»¥åƒæˆ‘ä¹‹å‰ post ä¸€æ ·å†™ä¸€ä¸ª sync è„šæœ¬æ¥æ‰§è¡Œã€‚ æœ‰äºæˆ‘ä»¬ä¸‹è½½äº†æœ€æ–°çš„ aosp-latest.tarï¼Œæ‰€ä»¥ sync çš„è¿‡ç¨‹è¿˜æ˜¯æ¯”è¾ƒå¿«çš„ï¼Œæˆ‘å½“æ—¶åº”è¯¥ 30 æ¥åˆ†é’Ÿå°± sync å®Œæˆäº†ã€‚ ç¼–è¯‘ä»¥å¾€ç¼–è¯‘ Android æºç æ—¶ï¼Œæ€»æ˜¯ä¼šå‡ºç°å„ç§å„æ ·çš„é”™è¯¯ï¼Œä½†æ˜¯è¿™æ¬¡ Android Pie çš„æºç ç¼–è¯‘å¼‚å¸¸é¡ºåˆ©ï¼Œæ²¡æœ‰ä»»ä½•é”™è¯¯ï¼Œä¸çŸ¥é“æ˜¯ä¸æ˜¯ Google åšäº†æ”¹è¿›å’Œä¼˜åŒ–ã€‚ é¦–å…ˆä¸‹è½½ XCode å®‰è£…ï¼Œç„¶åè¿›å…¥ aosp æ ¹ç›®å½•ï¼Œå°±å¯ä»¥ç¼–è¯‘äº†ï¼š 1234567891011# clear build generated filesmake clobber# import a build scriptsource build/envsetup.sh# select build target lunch# start buildmake -j8 éå¸¸é¡ºåˆ©ï¼Œä¸Šæ¬¡æˆ‘é€‰æ‹© aosp_marlin-userdebug ç”¨äº† 3 ä¸ªåŠå°æ—¶å°±æˆåŠŸç¼–è¯‘äº†ï¼Œç®€ç›´ä»¤äººæ„ŸåŠ¨ã€‚ç›¸æ¯”èµ·æ¥ï¼Œä¹‹å‰çš„ Android æºç ç¼–è¯‘ä¼šå‡ºç°å„ç§å„æ ·çš„é”™è¯¯ï¼Œè®©äººéå¸¸æŠ“ç‹‚ã€‚ å› ä¸ºæˆ‘æ‰‹é‡Œçš„ Pixel XL å·²ç»å®‰è£…äº† factory Android systemï¼Œé‡Œé¢æœ‰æˆ‘å¾ˆå¤šèµ„æ–™å’Œæ•°æ®äº†ï¼Œå¦å¤– userdebug ç±»å‹çš„ Android æ˜¯æ²¡æœ‰ Google æœåŠ¡çš„ï¼Œå¹¶ä¸”è¿ Google Photosã€Cameraã€Gmail ç­‰åº”ç”¨å…¨éƒ½æ²¡æœ‰ï¼Œæ‰€ä»¥æˆ‘å°±æ²¡å†æŠŠç¼–è¯‘å‡ºæ¥çš„ userdebug ç±»å‹ç³»ç»Ÿå®‰è£…åˆ°æ‰‹æœºä¸­ã€‚äºæ˜¯ï¼Œæˆ‘ä»Šå¤©é€‰æ‹© aosp_x86_64-eng é‡æ–°ç¼–è¯‘äº†ä¸€éï¼Œè¿™ä¸ª aosp_x86_64-eng é€‚ç”¨äºåœ¨ x86 ç”µè„‘ä¸Šè¿è¡Œæ¨¡æ‹Ÿå™¨ (æ²¡æœ‰æ‰‹æœºå°±åªå¥½ç°åœ¨ç”µè„‘ä¸Šç”¨æ¨¡æ‹Ÿå™¨è¯•è¯•äº†)ã€‚è¿™ä¸€æ¬¡ç”¨äº† 4 ä¸ªå¤šå°æ—¶å®Œæˆç¼–è¯‘ï¼ŒåŒæ ·éå¸¸é¡ºåˆ©ï¼š ç¼–è¯‘å®Œæˆåï¼Œç›´æ¥è¿è¡Œ emulator å‘½ä»¤å³å¯è¿è¡Œæ¨¡æ‹Ÿå™¨ã€‚éœ€è¦æ³¨æ„ï¼Œè¿™ä¸ª emulator å‘½ä»¤æ˜¯è¿è¡Œ lunch å‘½ä»¤è€Œæ·»åŠ çš„ï¼Œä¹Ÿå°±æ˜¯å¦‚æœé€€å‡ºäº†ç”µè„‘çš„ terminalï¼Œç„¶åå†è¿›å…¥ aosp æ ¹ç›®å½•ï¼Œéœ€è¦é‡æ–°è¿è¡Œ source build/envsetup.sh å’Œ lunch ç„¶åæ‰èƒ½è¿è¡Œ emulatorã€‚ä»¥ä¸‹æ˜¯æ¨¡æ‹Ÿå™¨è¿è¡Œçš„æˆªå›¾ï¼š ä¸Šé¢ 3 å¼ æˆªå›¾ä¸­ï¼Œå·¦è¾¹ä¸¤å¼ æˆªå›¾å¯ä»¥çœ‹åˆ°ç³»ç»Ÿæ˜¯å¾ˆç®€é™‹çš„ï¼ŒGoogle çš„è®¸å¤šåº”ç”¨éƒ½æ²¡æœ‰ï¼Œè¿ Google service ä¹Ÿæ²¡æœ‰ã€‚æœ€æœ‰ä¸€å¼ æˆªå›¾ï¼Œæ˜¾ç¤ºäº† Android ç‰ˆæœ¬å·æ˜¯ 9ï¼Œå¦å¤–æœ€åº•éƒ¨çš„ Build Number æ˜¾ç¤ºäº†è¿™æ˜¯ aosp_x86_64-eng ç±»å‹çš„æ„å»ºï¼ŒPPR1.180610.010 æ˜¯ Build ä»£å·ï¼Œåœ¨ è¿™é‡Œ å¯ä»¥çœ‹åˆ°ï¼Œè€Œ 20180907.105244 åˆ™æ˜¯æ„å»ºæ—¶é—´ã€‚","categories":[],"tags":[{"name":"Android","slug":"Android","permalink":"https://tao93.top/tags/Android/"},{"name":"macOS","slug":"macOS","permalink":"https://tao93.top/tags/macOS/"},{"name":"AOSP","slug":"AOSP","permalink":"https://tao93.top/tags/AOSP/"}]},{"title":"Linux æ‰§è¡Œè¿œç¨‹è„šæœ¬","slug":"Linux æ‰§è¡Œè¿œç¨‹è„šæœ¬","date":"2018-09-26T07:47:46.636Z","updated":"2018-09-26T07:47:46.646Z","comments":true,"path":"2018/09/26/Linux æ‰§è¡Œè¿œç¨‹è„šæœ¬/","link":"","permalink":"https://tao93.top/2018/09/26/Linux æ‰§è¡Œè¿œç¨‹è„šæœ¬/","excerpt":"","text":"æœ€è¿‘å·¥ä½œä¸Šéœ€è¦å†™ä¸€å¥—è·¨æœåŠ¡å™¨åˆ†éš”æ•°æ®å’Œè½¬ç§»æ•°æ®çš„è„šæœ¬ã€‚ç»è¿‡å®è·µï¼Œå‘ç°å•çº¯æ‰§è¡Œåœ¨æœ¬åœ°æ‰§è¡Œå‘½ä»¤æ¥æ“æ§è¿œç¨‹æœåŠ¡å™¨çš„æ•°æ®ä¸ç°å®ã€‚æ‰€ä»¥éœ€è¦æŠŠè„šæœ¬æ”¾åœ¨è¿œç¨‹æœåŠ¡å™¨ï¼Œç„¶åæœ¬åœ°è®©æœåŠ¡å™¨è‡ªå·±å»æ‰§è¡Œè„šæœ¬ã€‚æ­¤å¤–ï¼Œéœ€è¦ä½¿ç”¨ expect å·¥å…·æ¥è‡ªåŠ¨è¾“å…¥è¿œç¨‹æœåŠ¡å™¨ç™»å½•å¯†ç ã€‚ å…ˆæä¸€äº› expect çš„ç”¨æ³•ï¼Œå³å¯ä»¥å†™æˆ expect è„šæœ¬å½¢å¼ (å³è„šæœ¬ä»¥ #!/usr/bin/expect å¼€å¤´)ï¼Œä¹Ÿå¯ä»¥å†™æˆ expect -c â€˜&lt;several_cmd&gt;â€™ çš„å•æ¡å‘½ä»¤å½¢å¼ã€‚åè€…çš„ç¤ºä¾‹å½¢å¼ï¼š 1expect -c 'spawn scp root@example:~/xx.txt .; expect \"password:\"; send \"abc1234\\\\r\"; interact;' ä¸Šé¢ä¾‹å­ä¸­ï¼Œspawn åé¢è¡¨ç¤ºéœ€è¦æ‰§è¡Œçš„å‘½ä»¤ (æ­¤å¤„æ˜¯ä¸€ä¸ª scp å‘½ä»¤ï¼Œéœ€è¦è¾“å…¥å¯†ç ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆè¦ expect çš„åŸå› )ï¼Œexpect åé¢æ˜¯è¡¨ç¤ºæ ‡å‡†è¾“å‡ºå‡ºç° â€œpassword:â€ å­—æ ·æ—¶ï¼Œå°±è‡ªåŠ¨è¾“å…¥ send åé¢çš„ä¸œè¥¿ï¼Œä¹Ÿå°±æ˜¯å¯†ç ã€‚æœ€åä¸€ä¸ª interact è¡¨ç¤ºæ¥ä¸‹æ¥å…è®¸ç”¨æˆ·è‡ªå·±äº¤äº’ã€‚ æœ¬æ¥ç›´æ¥ä½¿ç”¨ shell è„šæœ¬å°±å¯ä»¥çš„ã€‚ä¸è¿‡æˆ‘è¿™è®¾è®¡åˆ°æ•°æ®çš„åˆ‡å‰²ï¼Œæ‰€ä»¥å°±ä½¿ç”¨äº† Pythonï¼Œç„¶åéœ€è¦ç”¨åˆ° shell å‘½ä»¤æ—¶ï¼Œæ˜¯ç”± Python è„šæœ¬å†è°ƒç”¨ shell å‘½ä»¤çš„ã€‚ 12345678910111213141516171819202122232425262728293031323334import osdef call_remote_cmd(host, password, cmd): \"\"\" è®©è¿œç¨‹æœåŠ¡å™¨è‡ªå·±æ‰§è¡Œå‘½ä»¤ :param host: è¿œç¨‹æœåŠ¡å™¨ç”¨æˆ·ååŠ åŸŸåï¼Œæ ¼å¼ç¤ºä¾‹ï¼šroot@example.com :param cmd: è¦è®©è¿œç¨‹æœåŠ¡å™¨æ‰§è¡Œçš„å‘½ä»¤ :return: ä¸€äº›ç»“æœï¼Œå…¶ä¸­å¯èƒ½æœ‰ä¸€äº›æç¤ºæ€§æ–‡æœ¬ \"\"\" # ä¸¾ä¸ªä¾‹å­ï¼Œssh root@example.com ls å¯ä»¥è®©è¿œç¨‹æœåŠ¡å™¨æ‰§è¡Œ ls å‘½ä»¤ final_cmd = '/usr/bin/expect -c \\'spawn ssh %s %s; expect \"*Password:\"; send \"%s\\\\r\"; interact;\\'' % (host, cmd, password) res = os.popen(final_cmd).read() print(res) return res # ä¼ ç»™è¿œç¨‹æœåŠ¡å™¨ä¸Šçš„ Python è„šæœ¬ä½œä¸ºå‚æ•° args = &#123;'a': 1, 'b': [1, 2, 3]&#125;# args éœ€è¦ç»è¿‡å¤æ‚çš„æ›¿æ¢ï¼Œæ‰èƒ½ä¿è¯å‡†ç¡®ä¼ é€’åˆ°è¿œç¨‹æœåŠ¡å™¨çš„ Python è„šæœ¬ä¸­args = str(args) args = args.replace('\\'', '\\\\\\\"')args = args.replace(' ', '\\\\ ') args = args.replace(',', '\\\\,') args = args.replace('[', '\\\\[') args = args.replace(']', '\\\\]') args = args.replace('&#123;', '\\\\&#123;') args = args.replace('&#125;', '\\\\&#125;') args = args.replace(';', '\\\\;') args = args.replace('\"', '\\\\\"') cmd = '/usr/local/bin/python3 x.py \\\\\"%s\\\\\"' % args call_remote_cmd('root@example.com', 'password', cmd) ä¸Šé¢æ˜¯æˆ‘å› å·¥ä½œéœ€è¦è€Œå†™å‡ºæ¥çš„è®©è¿œç¨‹æœåŠ¡å™¨æ‰§è¡Œå®ƒçš„ Python è„šæœ¬çš„æœ¬åœ° Python è„šæœ¬ä»£ç ã€‚ä½¿ç”¨çš„æ—¶å€™å°±ç®€å•äº†ã€‚æœåŠ¡å™¨ä¸Šé¢æ”¾ä¸€ä¸ªè¢«è°ƒç”¨çš„ Python è„šæœ¬ã€‚ç„¶åæ‰§è¡Œä¸Šé¢ä»£ç ï¼Œå°±å¯ä»¥äº†ã€‚ æƒ³å¿…ç›´æ¥å†™ shell è„šæœ¬çš„è¯ï¼Œå¯èƒ½ä¼šæ›´ç®€æ´äº›ã€‚ç­‰å•¥æ—¶å€™æœ‰ç©ºäº†è¯•è¯•çœ‹ã€‚","categories":[],"tags":[{"name":"Shell","slug":"Shell","permalink":"https://tao93.top/tags/Shell/"},{"name":"Python","slug":"Python","permalink":"https://tao93.top/tags/Python/"}]},{"title":"Homebrew å°ç»“","slug":"Homebrew å°ç»“","date":"2018-09-26T07:47:46.626Z","updated":"2018-09-26T07:47:46.636Z","comments":true,"path":"2018/09/26/Homebrew å°ç»“/","link":"","permalink":"https://tao93.top/2018/09/26/Homebrew å°ç»“/","excerpt":"","text":"è¯´å®è¯ï¼Œæˆ‘æ— æ³•é€‚åº”æš—è‰²èƒŒæ™¯çš„ç•Œé¢ï¼Œæ¯”å¦‚ jetbrains ç³»åˆ— IDE çš„ Darcula ä¸»é¢˜ (æš—è‰²çš„èƒŒæ™¯)ï¼Œå†æ¯”å¦‚ Terminal çš„ä¸€äº›æš—è‰²èƒŒæ™¯ä¸»é¢˜ï¼Œæ‰€ä»¥æˆ‘ä¹Ÿæ— æ³•ç›´è§† Homebrew ä¸»é¡µçš„èƒŒæ™¯è‰²ï¼Œçœ‹å¾—æˆ‘çœ¼ç›éš¾å—ã€‚ä½†æ˜¯ï¼ŒHomebrew åº”è¯¥æ˜¯ä¸€ä¸ªå¾ˆä¸é”™çš„å·¥å…·ï¼Œæ¯•ç«Ÿå®ƒå‡ ä¹å–ä»£äº† MacPortsã€‚ Homebrew æ˜¯ macOS ä¸Šçš„ä¸€æ¬¾åŒ…ç®¡ç†å·¥å…·ï¼Œä½œç”¨ç±»ä¼¼äº Ubuntu ä¸Šé¢çš„ apt-getã€‚ä¸åŒç‚¹æ˜¯ï¼ŒHomebrew çš„æ“ä½œä¸éœ€è¦ root æƒé™ï¼ŒHomebrew ä¸æ˜¯ç³»ç»Ÿçº§åˆ«çš„å·¥å…·ã€‚Homebrew ç»´æŠ¤ä¸€äº›ç§°ä¸º tap çš„ git repositoryï¼Œæ¯ä¸ª tap é‡Œé¢æ˜¯ä¸€äº› formulaï¼Œæ‰€è°“çš„ formula å°±æ˜¯å¯¹åº”ä¸€ä¸ªè½¯ä»¶åŒ…ï¼ˆæ¯”å›¾ wget å’Œ git å°±æ˜¯ä¸¤ä¸ª formulaï¼‰ã€‚æœ€é‡è¦çš„ tap æ˜¯ homebrew/coreï¼Œè¿™ä¸ª tap ä¹Ÿæ˜¯è‡ªå¸¦çš„ï¼Œå…¶ä¸­æ˜¯å„ç§å‘½ä»¤è¡Œå·¥å…·ï¼Œå®ƒåœ¨å®‰è£…äº† Homebrew çš„ç³»ç»Ÿä¸­ä¸€èˆ¬ä½äº /usr/local/Homebrew/Library/Taps/homebrew/homebrew-coreï¼Œè¿™å¯ä»¥é€šè¿‡ brew â€“repo homebrew/core å¾—çŸ¥ï¼š 1234âœ Downloads brew --repo homebrew/core/usr/local/Homebrew/Library/Taps/homebrew/homebrew-coreâœ Downloads cd /usr/local/Homebrew/Library/Taps/homebrew/homebrew-coreâœ homebrew-core git:(master) ä»ä¸Šé¢å¯çŸ¥ homebrew/core è¿™ä¸ª tap åœ¨æœ¬åœ°æ˜¯ä¸€ä¸ª git é¡¹ç›®ï¼Œå®é™…ä¸Šé‡Œé¢ç»´æŠ¤äº†å››åƒå¤šä¸ª formulaï¼Œä¹Ÿå°±æ˜¯å¯ä¾›ç”¨æˆ·å®‰è£… 4000 å¤šä¸ªå‘½ä»¤è¡Œå·¥å…·ï¼Œæ¯ä¸ª formula éƒ½æ˜¯ç”¨ä¸€ä¸ª ruby æ–‡ä»¶æè¿°çš„ã€‚æ­¤å¤–ï¼Œè¿˜æœ‰ homebrew/science å’Œ homebrew/php ç­‰å®˜æ–¹ tapã€‚é™¤äº†å®˜æ–¹ tap å¤–ï¼Œè¿˜æœ‰è‘—åçš„ caskroom/cask è¿™ä¸ªç”¨æ¥å®‰è£… gui è½¯ä»¶(ä¾‹å¦‚ Sublime Text)çš„ tapã€‚æ’ä¸€å¥ï¼Œåœ¨ caskroom çš„ tap ä¸­ï¼Œä¸æ˜¯ç”¨ formula è¡¨ç¤ºè½¯ä»¶åŒ…ï¼Œè€Œæ˜¯ç”¨ cask æ¥è¡¨ç¤ºï¼Œæ‰€ä»¥å¤§è‡´å¯ä»¥è®¤ä¸º formula è¡¨ç¤ºå‘½ä»¤è¡Œçš„åŒ…ï¼Œè€Œ cask è¡¨ç¤º gui è½¯ä»¶ã€‚å¯¹ç”¨æˆ·æ¥è¯´ï¼ŒHomebrwe å¯ä»¥åšçš„äº‹å°±æ˜¯æœç´¢ã€å®‰è£…ã€å‡çº§ã€æŸ¥çœ‹ã€å¸è½½å„ç§è½¯ä»¶åŒ…ï¼Œæ­¤å¤–ä¹Ÿå¯ä»¥ç®¡ç†å¢åˆ  tapã€‚ é™¤äº† homebrew/core å¤–ï¼Œæˆ‘åªæ·»åŠ äº† caskroom/cask è¿™ä¸€ä¸ª tapã€‚è¦æ·»åŠ æ­¤ tap æˆ–ç§»é™¤å®ƒï¼Œåªéœ€è¦æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ï¼š 12345# æ·»åŠ  brew tap caskroom/cask # ç§»é™¤ brew untap caskroom/cask å½“é•¿æ—¶é—´æ²¡æœ‰æ›´æ–°è¿‡ tap å¯¹åº”çš„æœ¬åœ° git é¡¹ç›®ï¼Œé‚£ä¹ˆä¸‹ä¸€æ¬¡æ›´æ–°æ—¶ï¼Œå› ä¸ºå›½å†…çš„ç½‘ç»œç¯å¢ƒï¼Œæ›´æ–°æ‰€éœ€è¦çš„æ—¶é—´å¯èƒ½è¦å¾ˆä¹…ï¼Œæ‰€ä»¥æˆ‘ä½¿ç”¨äº† USTC Mirror çš„ Homebrew ä»£ç†ã€‚å…·ä½“æ–¹æ³•å…¶å®å°±æ˜¯ï¼ŒæŠŠ homebrew/core å’Œ caskroom/cask è¿™ä¸¤ä¸ª tap å¯¹åº”çš„æœ¬åœ° git é¡¹ç›®çš„ remote url åˆ†åˆ«è®¾ç½®ä¸º https://mirrors.ustc.edu.cn/homebrew-core.git å’Œ https://mirrors.ustc.edu.cn/homebrew-cask.gitï¼Œè¿™æ ·æ›´æ–°å°±å¾ˆå¿«äº†ã€‚å¦å¤–ï¼Œbrew ä¸‹è½½è½¯ä»¶æ˜¯ä»ä¸€ä¸ªæ‰€è°“çš„ bootle å»ä¸‹è½½ (è¿™ä¸ª bootle çš„ URL æ˜¯ https://homebrew.bintray.com/ï¼Œå…¶å®å°±æ˜¯é‡Œé¢æ‰˜ç®¡äº†éå¸¸å¤šå¸¸è§çš„è½¯ä»¶çš„å‹ç¼©åŒ…) æˆ–è€…ä»è½¯ä»¶çš„å®˜ç½‘å»ä¸‹è½½ã€‚å…·ä½“åœ¨å“ªé‡Œä¸‹è½½ï¼Œåˆ™æ˜¯æ ¹æ® formula çš„ ruby æè¿°æ–‡ä»¶ä¸­çš„æè¿°æ¥å®šçš„ã€‚ é‚£æœ‰æ²¡æœ‰ä¸Šé¢è¯´çš„è¿™ä¸ª bottle çš„é•œåƒä»¥ä¾¿å¯ä»¥å¿«é€Ÿä¸‹æ¥è½¯ä»¶å‘¢ï¼Ÿå½“ç„¶æœ‰ï¼ŒåŒæ ·æ˜¯æ¥è‡ªäº USTC Mirror çš„ï¼Œåšæ³•å¾ˆç®€å•ï¼Œè®¾ç½®ä¸€ä¸ªç¯å¢ƒå˜é‡ HOMEBREW_BOTTLE_DOMAINï¼Œå…¶å€¼ä¸º https://mirrors.ustc.edu.cn/homebrew-bottles å³å¯ã€‚ ä¸‹é¢æ˜¯è¿™ä¸€é€šä¿®æ”¹å¯¹åº”çš„å‘½ä»¤ï¼š 123456789101112131415# åˆ‡åˆ° homebrew/core å¯¹åº”çš„ git é¡¹ç›®ç›®å½• cd $(brew --repo homebrew/core) # æ¢ url git remote set-url origin https://mirrors.ustc.edu.cn/homebrew-core.git # same as previous cd $(brew --repo caskroom/cask) # same as previous git remote set-url origin https://mirrors.ustc.edu.cn/homebrew-cask.git # æˆ‘æ˜¯ä½¿ç”¨ zshï¼Œæ‰€ä»¥è¿½åŠ åˆ° .zshrc æœ«å°¾å°±å¯ä»¥ï¼Œå¦‚æœæ˜¯ä½¿ç”¨ bashï¼Œåˆ™ä¸èƒ½è¿™æ · echo 'export HOMEBREW_BOTTLE_DOMAIN=https://mirrors.ustc.edu.cn/homebrew-bottles' &gt;&gt; ~/.zshrcsource ~/.zshrc ä¸‹é¢å¼€å§‹æ˜¯ brew çš„ä¸€äº›å¸¸ç”¨å‘½ä»¤å°ç»“ã€‚ brew search \\&lt;formulaName>: åœ¨å·²å®‰è£… tap ä¸­æŸ¥æ‰¾åŒ…ï¼Œæœç´¢åˆ°çš„ç»“æœç±»ä¼¼å¦‚æœä¸æ˜¯ homebrew/core è¿™ä¸ª tap ä¸­çš„ï¼Œå°†ä¼šä»¥ tapName/formulaName çš„å½¢å¼åˆ—å‡ºã€‚ä¾‹å¦‚ brew search git çš„ç»“æœå¤§è‡´æ˜¯: 123456bagitbash-git-prompt...git...caskroom/cask/git-it brew install \\&lt;formuaName>: å®‰è£…æŒ‡å®š formula çš„æœ€æ–°ç‰ˆæœ¬ï¼Œå®‰è£…è·¯å¾„ä¸€èˆ¬æ˜¯ /usr/local/Cellar// ä¸­ï¼Œæ­¤å¤–ä¼šåœ¨ /usr/local/bin ä¸­å»ºç«‹æŒ‡å‘å¯æ‰§è¡Œæ–‡ä»¶çš„ç¬¦å·é“¾æ¥ï¼Œä»¥ä¾¿å‘½ä»¤è¡Œç›´æ¥è¿è¡Œã€‚ brew uninstall formulaName: å¸è½½æŒ‡å®š formulaï¼Œä¸è¿‡ä¸ä¼šåˆ é™¤å®‰è£…åŒ…æ–‡ä»¶ã€‚ brew upgrade formulaName: å‡çº§æŒ‡å®šçš„ formula åˆ°æœ€æ–°ç‰ˆã€‚ brew cleanup: åœ¨å®‰è£…äº†æ›´æ–°ç‰ˆæœ¬è½¯ä»¶åŒ…åï¼Œä» /usr/local/Cellar åˆ é™¤æ—§ç‰ˆæœ¬çš„è½¯ä»¶åŒ…ã€‚æ²¡é”™ï¼Œå‡çº§æ—¶å¹¶ä¸æ˜¯è¦†ç›–å¼å®‰è£…ï¼Œè€Œæ˜¯åœ¨ /usr/local/Cellar/ ä¸­å¤šäº†ä¸€ä¸ªæ›´é«˜ç‰ˆæœ¬å·çš„ç›®å½•ï¼Œç„¶åç¬¦å·é“¾æ¥æŒ‡å‘æ›´é«˜ç‰ˆæœ¬ç›®å½•ä¸­çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚æ‰€ä»¥ï¼Œå¦‚æœä¸æƒ³è¦è¿™ç§å†—ä½™ï¼Œå°±å¯ä»¥ç”¨ brew cleanup æ¥æ¸…é™¤æ—§ç‰ˆæœ¬çš„ç›®å½•ã€‚ brew outdated: æŸ¥çœ‹å“ªäº› formula å¯ä»¥å‡çº§ã€‚ brew info formulaName: æŸ¥çœ‹ formula çš„ä¿¡æ¯ï¼Œä¾‹å¦‚ brew info git, brew info caskroom/cask/git-it ç­‰ã€‚ brew update: æ›´æ–°æ‰€æœ‰ tap ä¸­çš„åŒ…ä¿¡æ¯ï¼Œå…¶å®ä¹Ÿå°±æ˜¯æŠŠæ¯ä¸ª tap å¯¹åº”çš„æœ¬åœ° git é¡¹ç›®æ›´æ–°åˆ°æœåŠ¡å™¨æœ€æ–°æäº¤ï¼Œä»¥ä¾¿å¯ä»¥æœç´¢åˆ°æœ€æ–°æ·»åŠ çš„åŒ…ä»¥åŠå·²æœ‰åŒ…çš„æœ€æ–°å‘å¸ƒä¿¡æ¯ã€‚ brew list: åˆ—å‡ºå·²å®‰è£…çš„æ‰€æœ‰åŒ…ã€‚ tap çš„ç®¡ç†ï¼šbrew tap tapName: æ–°å¢ä¸€ä¸ª tapã€‚ brew untap tapName: ç§»é™¤ä¸€ä¸ª tapã€‚ brew tap-info tapName: åˆ—å‡ºä¸€ä¸ª tap çš„è¯¦ç»†ä¿¡æ¯ã€‚ æ›´å¤šæ“ä½œï¼Œå¯ä»¥å‚è€ƒå®˜æ–¹æ–‡æ¡£ï¼Œå†…å®¹å¾ˆå…¨é¢ã€‚","categories":[],"tags":[{"name":"Homebrew","slug":"Homebrew","permalink":"https://tao93.top/tags/Homebrew/"},{"name":"macOS","slug":"macOS","permalink":"https://tao93.top/tags/macOS/"}]},{"title":"HomeBrew Cask åŠ å¿«ä¸‹è½½çš„è„šæœ¬","slug":"HomeBrew Cask åŠ å¿«ä¸‹è½½çš„è„šæœ¬","date":"2018-09-26T07:47:46.616Z","updated":"2018-09-26T07:47:46.624Z","comments":true,"path":"2018/09/26/HomeBrew Cask åŠ å¿«ä¸‹è½½çš„è„šæœ¬/","link":"","permalink":"https://tao93.top/2018/09/26/HomeBrew Cask åŠ å¿«ä¸‹è½½çš„è„šæœ¬/","excerpt":"","text":"Homebrew æ˜¯ä¸ªå¥½å·¥å…·ï¼Œé™¤äº†ç”¨å®ƒå®‰è£…å‘½ä»¤è¡Œè½¯ä»¶å¤–ï¼Œæˆ‘ä¹Ÿä¼šç”¨å®ƒæ¥å®‰è£… GUI è½¯ä»¶ã€‚è¿™ä¹ˆåšçš„å¥½å¤„æ˜¯ Homebrew ä¼šç›´æ¥å¸®æˆ‘æ¥è¿é“¾æ¥åˆ° GUI è½¯ä»¶çš„å¯æ‰§è¡Œæ–‡ä»¶çš„ç¬¦å·é“¾æ¥ï¼Œè¿™æ ·ï¼Œæˆ‘åœ¨ç»ˆç«¯ä½¿ç”¨ç¬¦å·é“¾æ¥ï¼Œå°±å¯ä»¥æ‰“ GUI è½¯ä»¶äº†ã€‚ä¾‹å¦‚ï¼ŒSublime Text çš„ç¬¦å·é“¾æ¥æ˜¯ sublï¼Œé‚£ä¹ˆåœ¨ç»ˆç«¯ä»»ä½•ç›®å½•ä¸­ï¼Œä¸€è¡Œ subl â€œnew text.txtâ€ å°±å¯ä»¥ç”¨ Sublime Text æ‰“å¼€new text.txtäº†ã€‚ é—®é¢˜æ˜¯ï¼Œbrew cask install xxx çš„ä¸‹è½½é€Ÿåº¦ç»å¸¸ä¼šéå¸¸æ…¢ï¼Œè€Œæˆ‘æŠŠä¸‹è½½è½¯ä»¶åŒ…çš„ URL ç›´æ¥å¤åˆ¶åˆ° Chrome ä¸­å»ä¸‹è½½ï¼Œåˆ™éå¸¸å¿«ï¼Œè¿™å°±å¾ˆå°´å°¬äº†ã€‚ç»è¿‡ç¨å¾®æ£€æŸ¥ï¼Œæˆ‘å‘ç°brew cask install xxx è¿‡ç¨‹ä¸­ï¼Œä¼šåœ¨ Cache/Cask ç›®å½•(å…¶å®å°±æ˜¯ brew â€“cacheå‘½ä»¤çš„ç»“æœ)ä¸­ç”Ÿæˆä¸€ä¸ªç±»ä¼¼äºxxxâ€“v1.2.3.zip.incompleteè¿™æ ·çš„æ–‡ä»¶ã€‚äºæ˜¯æˆ‘æŠŠè‡ªå·±ç”¨ Chrome ä¸‹è½½çš„æ–‡ä»¶ï¼Œå¤åˆ¶åˆ° Cache/Cask ä¸­æ¥ï¼Œç„¶åæ›´åä¸º xxxâ€“v1.2.3.zipï¼Œä¹Ÿå°±æ˜¯æŠŠ .incomplete å»æ‰ã€‚ç„¶åå† brew cask install xxxä¸€ä¸‹ï¼Œå‘ç° Homebrew æç¤ºè½¯ä»¶åŒ…å·²ç»ä¸‹è½½å¥½äº†ï¼Œäºæ˜¯ç«‹åˆ»å¼€å§‹å®‰è£…äº†ã€‚ ä¸Šé¢è¿™æ ·çš„æ–¹å¼ç¡®å®é¿å…äº†ä¸‹è½½æ…¢çš„é—®é¢˜ï¼Œä¸è¿‡è¿™æ ·æ‰‹åŠ¨æ“ä½œï¼Œæ€»æ˜¯ä¸é‚£ä¹ˆé«˜(yÇ’u)æ•ˆ(bÄ«)ç‡(gÃ©)ï¼Œæ‰€ä»¥æˆ‘å°±æƒ³è¦å†™ä¸ªå°è„šæœ¬æ¥è‡ªåŠ¨åŒ–è¿™ä¸ªè¿‡ç¨‹ã€‚æˆ‘é€‰æ‹©äº†ä½¿ç”¨ shell è„šæœ¬ã€‚æ­¤å¤„è¦åæ§½ä¸€ä¸‹ shell è„šæœ¬çš„è¯­æ³•ï¼Œéš¾è®°ï¼ŒçœŸçš„æ˜¯å¾ˆéš¾è®°(æ¯”å¦‚å­—ç¬¦ä¸²æ“ä½œ)ï¼æ¯”èµ·æ¥ï¼Œå‡ ä¹ä»»ä½•ä¸€é—¨ç¼–ç¨‹è¯­è¨€çš„è¯­æ³•éƒ½è¦å¥½è®°å¾—å¤šã€‚ åºŸè¯è¯´äº†å¾ˆå¤šäº†ï¼Œä¸‹é¢æ˜¯è„šæœ¬å†…å®¹ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041#!/bin/bash if [ \"$#\" -eq \"1\" ]; then # æ‰¾åˆ°æœ¬åœ°æè¿°éœ€è¦å®‰è£…çš„è½¯ä»¶åŒ…çš„ ruby æ–‡ä»¶ tap_path=`brew --repo caskroom/cask` file_path=\"$&#123;tap_path&#125;/Casks/$&#123;1&#125;.rb\" if [ -f \"$file_path\" ]; then # ä»é‡Œé¢è¯»å–ç‰ˆæœ¬ä¿¡æ¯ï¼Œä¸‹è½½çš„ URL while read key value; do if [[ $key == \"version\" ]]; then len=$(($&#123;#value&#125;-2)) version=$&#123;value:1:$&#123;len&#125;&#125; elif [[ $key == \"url\" ]]; then len=$(($&#123;#value&#125;-2)) url=$&#123;value:1:$&#123;len&#125;&#125; url=$&#123;url/\\#\\&#123;version\\&#125;/$version&#125; # ä½¿ç”¨ Chrome æ¥ä¸‹è½½ /Applications/Google\\ Chrome.app/Contents/MacOS/Google\\ Chrome $url fi done &lt; $file_path else echo \"Cask '$1' is unavailable: No Cask with this name exists.\" fi cache_dir=`brew --cache` downloaded_name=$&#123;url##*/&#125; target_name=$1--$&#123;version&#125;.$&#123;downloaded_name##*.&#125; # æ¯ä¸ªä¸‰ç§’é’Ÿæ£€æŸ¥ä¸€ä¸‹ä¸‹è½½å¥½äº†æ²¡ï¼Œå¥½äº†å°±æŠŠä¸‹è½½å¥½çš„æ–‡ä»¶ç§»åŠ¨åˆ° # Cache/Cask ä¸­ï¼Œå¹¶ä¸”æ”¹åä¸º Homebrew æƒ³è¦çš„æ–¹å¼ã€‚ while true; do if [ -e ~/Downloads/$downloaded_name ]; then mv ~/Downloads/$downloaded_name $cache_dir/Cask/$target_name # å®‰è£… brew cask install $1 break else sleep 3 fi doneelse echo \"usage: cask-install Cask-Name\" fi","categories":[],"tags":[{"name":"Homebrew","slug":"Homebrew","permalink":"https://tao93.top/tags/Homebrew/"},{"name":"Shell","slug":"Shell","permalink":"https://tao93.top/tags/Shell/"},{"name":"macOS","slug":"macOS","permalink":"https://tao93.top/tags/macOS/"}]},{"title":"Android Touch äº‹ä»¶çš„ä¼ é€’ä¸å¤„ç†","slug":"Android Touch äº‹ä»¶çš„ä¼ é€’ä¸å¤„ç†","date":"2018-09-26T07:47:46.614Z","updated":"2019-07-05T14:01:14.090Z","comments":true,"path":"2018/09/26/Android Touch äº‹ä»¶çš„ä¼ é€’ä¸å¤„ç†/","link":"","permalink":"https://tao93.top/2018/09/26/Android Touch äº‹ä»¶çš„ä¼ é€’ä¸å¤„ç†/","excerpt":"","text":"ä¸€ã€MotionEvent MotionEvent æ˜¯ Android ç³»ç»Ÿä¸­æŠ¥å‘ŠåŠ¨ä½œè¾“å…¥ï¼ˆå¦‚è§¦æ‘¸å±å¹•ï¼Œæ»šåŠ¨çƒï¼Œé¼ æ ‡ï¼‰ç­‰äº‹ä»¶çš„ç±»ã€‚å…¶ä¸­æœ‰æ•´å½¢æ•°çš„ Action å’Œæè¿°äº‹ä»¶çš„å„ç§æµ®ç‚¹å‹åæ ‡ã€‚MotionEvent çš„ action çš„æœ€ä½ä¸€ä¸ªå­—èŠ‚ï¼Œå…¶å–å€¼æˆ‘ä»¬å¸¸è§çš„ ACTION_DOWN, MOVE, POINTER_DOWN, POINTER_UP, UP, CANCEL (åé¢å¯èƒ½ç®€ç§°ä¸º DOWN ç­‰ç­‰) è¿™äº›äº†ã€‚è™½ç„¶æˆ‘ä»¬å¯èƒ½ä¼šç²—æš´çš„ä½¿ç”¨ä¸‹é¢è¿™æ ·çš„æ–¹å¼ï¼š 123456switch (event.getAction()) &#123; case MotionEvent.ActionDown: ... break; ... &#125; ä½†æ˜¯å…¶å®ä¸Šé¢è¿™æ ·ä»…é€‚ç”¨äºå•ç‚¹è§¦æ§åœºæ™¯ï¼ŒåŸå› æ˜¯ getAction() æ–¹æ³•è¿”å›çš„ç»“æœä¸­ï¼Œæœ€ä½çš„1ä¸ªå­—èŠ‚æ‰å¯¹åº”ä¸Šé¢è¯´çš„ ACTION_DOWNï¼Œè€Œæ¬¡æœ€ä½ä¸€ä¸ªå­—èŠ‚åˆ™è¡¨ç¤º PointerIndex (è¿™ä¸ªæ¦‚å¿µåé¢ä¼šæåˆ°)ï¼Œå¯¹äºå•ç‚¹è§¦æ§åœºæ™¯ï¼ŒPointerIndex å§‹ç»ˆä¸º0ï¼Œæ‰€ä»¥ä¸Šé¢çš„ä»£ç æ‰èƒ½è·‘é€šã€‚æ›´å¥½çš„æ–¹å¼ï¼Œå…¶å®æ˜¯ä½¿ç”¨ getActionMasked() æ–¹æ³•ï¼Œæ­¤å¤„æŸ¥çœ‹æºç å³å¯éå¸¸æ¸…æ™°ã€‚ å¯¹äºä¸€ä¸²è§¦æ‘¸äº‹ä»¶ï¼ˆæŒ‡æ‰‹æ¥è§¦åˆ°å±å¹•åˆ°æ‰‹å®Œå…¨ç¦»å¼€å±å¹•ï¼‰ï¼Œç”¨æˆ·ç¬¬ä¸€ä¸ªæ‰‹æŒ‡æ¥è§¦åˆ°å±å¹•æ—¶ï¼Œè§¦å‘ DOWN, æ‰‹æŒ‡åœ¨å±å¹•ä¸Šç§»åŠ¨æ—¶ï¼ŒæŒç»­è§¦å‘å‡ºå¾ˆå¤š MOVEï¼Œç¬¬äºŒä¸ªä»¥ä¸Šçš„æ‰‹æŒ‡è§¦æ‘¸åˆ°å±å¹•æ˜¯ï¼Œè§¦å‘ POINTER_DOWNï¼Œéæœ€åä¸€ä¸ªç¦»å¼€å±å¹•çš„æ‰‹æŒ‡ç¦»å¼€å±å¹•æ—¶è§¦å‘ POINTER_UP, æœ€åä¸€ä¸ªæ‰‹æŒ‡ç¦»å¼€å±å¹•æ—¶ï¼Œè§¦å‘ UPã€‚ åœ¨ä¸€ä¸²è§¦æ‘¸äº‹ä»¶è¿‡ç¨‹ä¸­ï¼Œè§†å›¾ä» window detach çš„è¯ï¼Œæˆ–è€… View çš„ PFLAG_CANCEL_NEXT_UP_EVENT æ ‡è®°ä½è®¾ç½®äº†æ—¶ï¼Œæˆ–è€… View æœ¬æ¥å¤„ç†äº†ä¸€ä¸ª Down äº‹ä»¶ä½†æ˜¯æ¥ä¸‹æ¥çš„ MOVE ç­‰äº‹ä»¶è¢« ViewGroup æ‹¦æˆªäº†ï¼Œå°†ä¼šè§¦å‘ CANCELã€‚å½“ç„¶ï¼Œåº”è¯¥è¿˜æœ‰åˆ«çš„è§¦å‘ CANCEL äº‹ä»¶çš„åœºæ™¯ã€‚ä¸‹å›¾æ˜¯ä¸€ä¸² Touch äº‹ä»¶çš„ä¾‹å­ï¼š Down â†’ Move â†’...â†’ Move â†’ PointerDown â†’ Move â†’...â†’ PointerUp â†’ Move â†’...â†’ Move â†’ Up MotionEvent ä¸­æœ‰ä¸ª Pointer çš„æ¦‚å¿µï¼ŒPointer å¤§è‡´è¡¨ç¤ºè§¦æ‘¸åˆ°å±å¹•çš„å„ä¸ªæ‰‹æŒ‡ã€‚getPointerCount() å³ä¸ºå¤šç‚¹è§¦æ§çš„ç‚¹æ•°ã€‚æ¯ä¸ª pointer éƒ½æœ‰ä¸€ä¸ª index (å–å€¼æ˜¯0åˆ°getPointerCount()-1)å’Œ idï¼ˆæœ€å¤§æ˜¯31ï¼Œæ„å‘³ç€ä¸€ä¸²è§¦æ‘¸äº‹ä»¶ä¸­ï¼Œæœ€å¤šå…è®¸æ‰‹æŒ‡æ¥è§¦å±å¹•32æ¬¡ï¼‰ï¼Œå‰è€…åœ¨ä¸€ä¸² Touch äº‹ä»¶ä¸­å¯èƒ½ä¼šå˜åŒ–ï¼Œè€Œåè€…ä¿æŒä¸å˜ï¼Œä¾‹å¦‚å¤šç‚¹è§¦æ§æ—¶ï¼Œå¤§æ‹‡æŒ‡å¯¹åº”çš„ index æœ¬æ¥æ˜¯0ï¼Œåé¢å¯èƒ½å˜æˆäº†1äº†. getPointerId(int pointerIndex)å’ŒfindPointerIndex(int pointerId)è¿™ä¸¤ä¸ªæ–¹æ³•æ˜¯ index å’Œ id é—´çš„ä¸€ä¸€æ˜ å°„ã€‚ é‚£ä¸ºä»€ä¹ˆè¦æœ‰ index å’Œ id ä¸¤ä¸ªä¸œè¥¿å‘¢ï¼Ÿ index å’Œ id çš„åŒºåˆ«ã€‚ä¸¾ä¸ªä¾‹å­å°±æ¸…æ¥šäº†ã€‚å‡è®¾èµ·å§‹æ—¶ï¼Œå³æ‰‹çš„é£ŸæŒ‡ï¼Œä¸­æŒ‡ï¼Œæ— åæŒ‡ä¾æ¬¡å…ˆåè½åœ¨å±å¹•ä¸Šï¼Œé‚£ä¹ˆä¸‰ä¸ªæŒ‡å¤´çš„ index å’Œ id åˆ†åˆ«éƒ½æ˜¯ 0, 1, 2ã€‚æ­¤æ—¶æŠ¬èµ·ä¸­æŒ‡ï¼Œé‚£ä¹ˆé£ŸæŒ‡çš„ index å’Œ id ä¸å˜ï¼Œè€Œæ— åæŒ‡çš„ index å˜æˆ1ï¼Œid ä¾ç„¶æ˜¯2ã€‚å³ index æ€»æ˜¯ 0, 1, 2,â€¦, getPointerCount() - 1. è€Œ id åˆ™å¯èƒ½å¤§äº getPointerCount(), å¦ä¸€é¢åˆ™æ˜¯ï¼Œpointer çš„ id åœ¨æ•´ä¸ªä¸€ä¸²è§¦æ‘¸äº‹ä»¶ä¸­ä¿æŒä¸å˜ã€‚ MotionEvent çš„ getX() ä¸ getX(int pointerIndex), å‰è€…ç­‰ä»·äºåè€…çš„ getX(0), getY ç±»ä¼¼. getPointerIdBits() è¿”å›ä¸€ä¸ªç±»ä¼¼äºæ ‡å¿—æ•°çš„ä¸œè¥¿ï¼Œå…¶äºŒè¿›åˆ¶ä»å³å‘å·¦æ•°ï¼Œç¬¬ i ä½ä¸º1è¡¨ç¤ºå­˜åœ¨ id æ˜¯ i çš„ pointerï¼Œæ­¤å¤„åº”çœ‹æºç ã€‚å¯ä»¥æƒ³è§æ­¤ç»“æœçš„äºŒè¿›åˆ¶å½¢å¼ä¸­1çš„ä¸ªæ•°å³ä¸ºå¤šç‚¹è§¦æ§çš„ç‚¹æ•°ã€‚ äºŒã€Touch äº‹ä»¶çš„ç”Ÿæˆ Touch äº‹ä»¶çš„æ ¹æºæ˜¯ä»ç¡¬ä»¶è€Œæ¥ï¼Œè€Œ ViewRootImpl$ViewPostImeInputStage#processPointerEvent æ–¹æ³•æ˜¯ä¸€ä¸ªæ¯”è¾ƒåˆé€‚çš„å¼€å§‹è¿½è¸ª Touch äº‹ä»¶çš„èµ·ç‚¹ï¼Œæ­¤å¤„åº”çœ‹æºç ã€‚äº‹ä»¶å¦‚æœæ²¡æœ‰è¢«æ¶ˆè´¹ï¼Œæœ€ç»ˆå¯èƒ½å°†åœ¨ ViewRootImpl #finishInputEvent ä¸­å›æ”¶æ‰(è¿™ä¸æ˜¯æœ¬æ–‡çš„é‡ç‚¹)ã€‚Touch äº‹ä»¶çš„ä¼ é€’å †æ ˆ (æŒ‰è°ƒç”¨çš„é¡ºåºæ’åˆ—)ï¼š 1234567ViewRootImpl$ViewPostImeInputStage#processPointerEventView#dispatchPointerEventDecorView#dispatchTouchEventActivity#dispatchTouchEventPhoneWindow#superDispatchTouchEventDecorView#superDispatchTouchEventViewGroup#dispatchTouchEvent Touch äº‹ä»¶ä¼ é€’åˆ°äº† ViewGroup çš„ dispatchTouchEvent æ–¹æ³•åï¼Œå°±å¼€å§‹æ˜¯æœ¬æ–‡è¦å…³æ³¨çš„ç„¦ç‚¹äº†ï¼Œå³ä¸€ä¸² Touch äº‹ä»¶åœ¨ View æ ‘ä¸Šæ˜¯å¦‚ä½•ä¼ é€’å’Œæ¶ˆè´¹çš„ã€‚ ä¸‰ã€ä¼ é€’å’Œå¤„ç† Touch äº‹ä»¶ ä¸‹é¢æ˜¯äº‹ä»¶ä¼ é€’å’Œå¤„ç†ä¸­æœ€é‡è¦çš„ 4 ä¸ªæ–¹æ³•ï¼š 1234567View#dispatchTouchEventï¼Œé ViewGroup çš„ View æ¥å— Touch äº‹ä»¶çš„æ–¹æ³•ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä¸é‡è½½å®ƒã€‚View#onTouchEventï¼ŒView(å« ViewGroup)è‡ªå·±å°è¯•å»æ¶ˆè´¹ Touch äº‹ä»¶ï¼Œç»å¸¸ä¼šè¢«é‡è½½ã€‚ViewGroup#dispatchTouchEventï¼Œé‡è½½äº† View çš„åŒåæ–¹æ³•ï¼Œä½œä¸º ViewGroup æ¥å— Touch äº‹ä»¶ï¼Œæ­¤æ–¹æ³•ä¸­åŒ…å«ã€Œä¼ é€’ Touch äº‹ä»¶ç»™ childã€å’Œã€Œå°è¯•è‡ªå·±æ¶ˆè´¹ Touch äº‹ä»¶ã€è¿™æ ·ä¸¤ä¸ªåˆ†æ”¯é€»è¾‘ï¼Œä¸€èˆ¬ä¸é‡è½½å®ƒã€‚ViewGroup#onInterceptTouchEventï¼ŒViewGroup åˆ¤æ–­è‡ªå·±è¦ä¸è¦æ‹¦æˆª Touch äº‹ä»¶çš„æ–¹æ³•ï¼Œæ‹¦æˆªæ„å‘³ç€è‡ªå·±å°è¯•æ¶ˆè´¹æ­¤äº‹ä»¶ï¼Œæœ‰æ—¶å€™è¢«é‡è½½ã€‚ ä¼ é€’: åœ¨ View æ ‘ä¸­ï¼ŒTouch äº‹ä»¶æ˜¯ç”± parent view ä¼ é€’ç»™ child View (child view ä¹Ÿå¯èƒ½æ˜¯ ViewGroup)çš„ã€‚åœ¨ä¸€ä¸² touch äº‹ä»¶ä¸­æ‰“å¤´çš„æ€»æ˜¯ DOWN äº‹ä»¶ï¼Œparent view é€šè¿‡è°ƒç”¨ child view çš„ dispatchTouchEventæ–¹æ³•æŠŠ DOWN äº‹ä»¶ä¼ é€’ç»™ child viewï¼Œè¿™å°±ç»™äº† child ä¸€ä¸ªæ¶ˆè´¹æ­¤äº‹ä»¶çš„æœºä¼šã€‚child çš„ dispatchTouchEvent æ–¹æ³•è¿”å› true çš„è¯ï¼Œå°±è¡¨ç¤º child æ¶ˆè´¹äº† DOWN äº‹ä»¶ï¼Œè¿”å› false å°±è¡¨ç¤ºä¸æ¶ˆè´¹ã€‚å¦‚æœ child æ¶ˆè´¹äº† Down äº‹ä»¶ï¼Œé‚£ä¹ˆæœ€ç®€å•çš„æƒ…å†µå°±æ˜¯åç»­çš„ move ç­‰äº‹ä»¶éƒ½ä¼šé€šè¿‡è°ƒç”¨ child çš„ dispatchTouchEvent æ–¹æ³•ç›´æ¥äº¤ç»™æ­¤ childï¼Œä¸ç®¡å®ƒçš„ dispatchTouchEvent æ–¹æ³•è¿”å›ä»€ä¹ˆï¼›å¦‚æœ child æ²¡æœ‰æ¶ˆè´¹ DOWN äº‹ä»¶ï¼Œé‚£ä¹ˆå•ç‚¹è§¦æ§æƒ…å½¢ä¸‹ï¼Œåç»­çš„ move ç­‰äº‹ä»¶ä¸æ­¤ child å†ä¹Ÿæ— ç¼˜äº†ã€‚ æ¶ˆè´¹ï¼š View(åŒ…æ‹¬ ViewGroup) æ¶ˆè´¹ Touch äº‹ä»¶ï¼Œåœ¨ä»£ç ä¸Šç­‰ä»·äºè°ƒç”¨å½“å‰ç±»çš„ onTouchEvent æ–¹æ³•ã€‚ç„¶å ouTouchEvent çš„è¿”å›ç»“æœä½œä¸ºæ˜¯å¦æ¶ˆè´¹äº†æ­¤äº‹ä»¶çš„ä¾æ®ã€‚ æ‹¦æˆªï¼š æ‹¦æˆªæ˜¯æŒ‡ ViewGroup æœ‰æœºä¼šåœ¨æŠŠ touch äº‹ä»¶ dispatch ç»™ child å‰ï¼Œé€šè¿‡è°ƒç”¨è‡ªå·±çš„ onInterceptTouchEvent æ¥åˆ¤æ–­è¦ä¸è¦æŠŠ touch äº‹ä»¶æˆªä¸‹æ¥ç»™è‡ªå·±å°è¯•æ¶ˆè´¹ã€‚å¯¹äº DOWN äº‹ä»¶ï¼ŒonInterceptTouchEvent æ€»æ˜¯ä¼šè¢«è°ƒç”¨ï¼›å¯¹äºå…¶ä»–äº‹ä»¶ï¼Œchild æœ‰æœºä¼šåœ¨ parent çš„onInterceptTouchEvent è¢«è°ƒç”¨ä¹‹å‰ï¼Œè¯·æ±‚ parent ä¸è¦æ‹¦æˆªï¼Œè¿™ä¸ªè¯·æ±‚å°±æ˜¯é€šè¿‡ child è°ƒç”¨ parent çš„ requestDisallowInterceptTouchEvent æ–¹æ³•æ¥å®ç°çš„ã€‚ DOWN äº‹ä»¶ï¼š DOWN äº‹ä»¶æ˜¯ä¸€ä¸² touch äº‹ä»¶çš„ç¬¬ä¸€ä¸ªäº‹ä»¶ï¼Œåœ¨ ViewGroup çš„ dispatchTouchEvent æ–¹æ³•ä¸­ï¼Œæ¥åˆ°æ­¤äº‹ä»¶æ—¶ï¼Œé¦–å…ˆä¼šåšä¸€äº›æ¸…é™¤å·¥ä½œï¼Œç„¶åæ£€æŸ¥è‡ªå·±è¦ä¸è¦æ‹¦æˆªæ­¤äº‹ä»¶å’Œæ˜¯ä¸æ˜¯è¦è½¬ä¸º CANCEL äº‹ä»¶ã€‚å¦‚æœä¸æ‹¦æˆªä¸”ä¸è½¬ä¸º CANCELï¼Œé‚£ä¹ˆæŒ¨ä¸ªæ£€æŸ¥ childï¼Œåœ¨æ°å½“çš„æ—¶å€™è°ƒç”¨ child çš„ dispatchTouchEvent æ¥çœ‹æœ‰æ²¡æœ‰ child ä¼šæ¶ˆè´¹æ­¤äº‹ä»¶ã€‚ ä¸Šé¢ 4 æ®µè¯ï¼Œç”¨ä¼ªä»£ç æ¥è¡¨ç¤ºï¼Œå¤§æ¦‚å°±æ˜¯ä¸‹é¢è¿™æ ·çš„ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758class ViewGroup extends View &#123; public boolean dispatchTouchEvent(MotionEvent event) &#123; final boolean intercepted; // æ‹¦æˆªå³ä¸æŠŠäº‹ä»¶ä¼ ç»™ child boolean handled = false; // View group æ˜¯å¦æ¶ˆè´¹äº†äº‹ä»¶ if (is DOWN || child ever comsumed previous event) &#123; if (! disallowIntercept) &#123; // PS: å¯¹äº DOWN å…¶å® disallowIntercept ä¸€å®šæ˜¯ false intercepted = onInterceptTouchEvent(event); &#125; else &#123; intercepted = false; &#125; &#125; else &#123; intercepted = true; &#125; if (! canceled &amp;&amp; !intercepted) &#123; for (View child : all children) &#123; if (! child able to consume event) &#123; continue; &#125; if (dispatchTransformedTouchEvent(event, child)) &#123; // åšä¸€äº›è®°å½•å·¥ä½œï¼Œç„¶å break break; &#125; &#125; &#125; // previous event æŒ‡è¿™ä¸€ä¸² touch äº‹ä»¶ä¸­åœ¨ event å‰é¢çš„é‚£äº› if (no child ever consumed previous event) &#123; handled = super.dispatchTransformedTouchEvent(event); // å°è¯•è‡ªè¡Œæ¶ˆè´¹ event &#125; else &#123; // å…¶å®é down äº‹ä»¶æ‰èƒ½èµ°åˆ°è¿™ä¸ª else åˆ†æ”¯ for (child : children who has consumed previous event) &#123; if (child.dispatchTouchEvent(event) handled = true; &#125; &#125; return handled; &#125;&#125; class View &#123; public boolean dispatchTouchEvent(MotionEvent event) &#123; boolean result = false; if (mOnTouchListener != null &amp;&amp; isEnabled &amp;&amp; mOnTouchListener.onTouch(this, event)) &#123; result = true; &#125; // onTouch ä¼˜äº onTouchEvent æ¥ä»£è¡¨ View å°è¯•æ¶ˆè´¹ event if (! result &amp;&amp; onTouchEvent(event)) &#123; result = true; &#125; return result; &#125; public boolean onTouchEvent(MotionEvent event) &#123; if (!isEnabled()) &#123; return isClickable() || isLongClickable(); &#125; if (isClickable || isLongClickable) &#123; ... retrun true; &#125; retrun false; &#125;&#125; å„ä¸ªç±»å’Œæ–¹æ³•çš„è§’è‰²æè¿°å¦‚ä¸‹ï¼š ViewGroup#dispatchTouchEventï¼Œä»£è¡¨ ViewGroup æ¥å—äº‹ä»¶ï¼Œå¤„ç†æ‹¦æˆªé€»è¾‘ï¼Œå°è¯•åˆ†å‘äº‹ä»¶ç»™ childï¼Œè°ƒç”¨ View#dispatchTouchEventæ¥å°è¯•è‡ªè¡Œæ¶ˆè´¹ Touch äº‹ä»¶ã€‚è¿”å›å€¼è¡¨ç¤ºè‡ªå·±è¿™é¢—å­æ ‘æœ‰æ²¡æœ‰æ¶ˆè´¹äº‹ä»¶ã€‚ View#dispatchTouchEvent ä»£è¡¨é ViewGroup çš„ View æ¥å—äº‹ä»¶ï¼Œè°ƒç”¨çœŸæ­£å°è¯•æ¶ˆè´¹äº‹ä»¶çš„ä»£ç ï¼ˆonTouchEvent æˆ–è€… onTouch ä¹‹ç±»çš„æ–¹æ³•ï¼‰ã€‚è¿”å›å€¼è¡¨ç¤ºè‡ªå·±æœ‰æ²¡æœ‰æ¶ˆè´¹äº‹ä»¶ã€‚ ViewGroup#onInterceptTouchEventï¼Œè¿”å›å€¼è¡¨ç¤º ViewGroup è¦ä¸è¦æ‹¦æˆªäº‹ä»¶ã€‚ ViewGroup#requestDisallowInterceptï¼Œè¢« child æ¥è°ƒç”¨ï¼Œè¡¨ç¤ºè¯·æ±‚ parent ä¸è¦æ‹¦æˆªï¼Œè¿™ä¸ªè¯·æ±‚ä»…åœ¨é DOWN äº‹ä»¶æœ‰æ•ˆï¼Œä¸”ä¼šé€’å½’å‘ä¸Šè°ƒç”¨æ‰€æœ‰ parent çš„åŒåæ–¹æ³•ã€‚ TouchTarget ç±»ï¼Œæ­¤ç±»åŒ…å«æ¶ˆè´¹è¿‡ Touch äº‹ä»¶çš„ child å’Œå®ƒæ¶ˆè´¹è¿‡å“ªäº› pointer çš„äº‹ä»¶è¿™äº›ä¿¡æ¯ï¼ŒTouchTarget å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚åœ¨ ViewGroup ä¸­ï¼Œå­˜æœ‰ä¸€ä¸ª TouchTarget é“¾è¡¨ï¼Œéå†æ­¤é“¾è¡¨ï¼Œå³å¯çŸ¥é“ä¸€ä¸ª pointer æ˜¯å¦å·²æœ‰äº‹ä»¶è¢«æŸä¸ª child å¤„ç†è¿‡ã€‚ ä»¥ä¸Šçš„ä»‹ç»ï¼Œå…¶å®æ˜¯çœç•¥äº†ä¸å°‘ä¿¡æ¯ï¼ŒçœŸæ­£çš„äº‹ä»¶åˆ†å‘è¿‡ç¨‹ï¼Œè¦æ›´å¤æ‚ä¸å°‘ï¼Œä¸‹é¢æ˜¯æˆ‘å°è¯•ç”»çš„ä¸€å¼ æµç¨‹å›¾ (æŠŠå›¾å’Œæºç å¯¹ç…§ç€ç†è§£å¯èƒ½ä¼šæœ‰äº›å¸®åŠ©)ï¼š å¯¹äºä¸Šå›¾ï¼Œæœ‰ä¸€äº›éœ€è¦è§£é‡Šçš„åœ°æ–¹ï¼š TouchTarget æŒæœ‰ä¸€ä¸ª child Viewï¼Œå’Œæ­¤ child View æ›¾æ¶ˆè´¹è¿‡ Down æˆ–è€… pointerDown äº‹ä»¶çš„é‚£äº› Pointer çš„ idï¼Œè¿™äº› pointer id æ˜¯ä»¥ id bits çš„å½¢å¼å­˜å‚¨ä¸ºä¸€ä¸ªæ•´æ•°çš„ã€‚ TouchTarget é“¾è¡¨çš„å¤´ç»“ç‚¹æ˜¯ç”± mFirstTouchTarget å¼•ç”¨çš„ã€‚åœ¨ä¸€ä¸²äº‹ä»¶ç»“æŸ(å¤„ç†å®Œ UP)åï¼Œæ­£å¸¸æƒ…å†µé“¾è¡¨åº”è¯¥æ¸…ç©ºï¼Œåœ¨ä¸€ä¸² Touch äº‹ä»¶åˆ°æ¥å‰(å¤„ç† Down å‰)ä¹Ÿä¼šæ¸…ç©ºï¼Œç®—æ˜¯è¡¥åˆ€ã€‚ é“¾è¡¨çš„æ„ä¹‰æ˜¯ï¼Œå­˜å‚¨ child æ›¾ç»æ¶ˆè´¹è¿‡æŸäº› pointer çš„ Down æˆ–è€… PointerDown äº‹ä»¶è¿™ç§ä¿¡æ¯ã€‚å½“ä¸€ä¸ª Pointer ç»“æŸäº†ï¼ˆæ‰‹æŒ‡å¤´ç¦»å¼€å±å¹•ï¼‰ï¼Œé‚£ä¹ˆæ‰€æœ‰æ¶ˆè´¹è¿‡å®ƒçš„ Down æˆ–è€… PointerDown äº‹ä»¶çš„ TouchTarget éƒ½éœ€è¦ç§»é™¤æ‰å®ƒçš„ idï¼Œäº‹å®ä¸Šï¼Œè¿™ä¸€ä¸² touch äº‹ä»¶ä¸­å†ä¹Ÿä¸ä¼šæœ‰è¿™ä¸ª id äº†ï¼›å¦‚æœä¸€ä¸ª TouchTarget çš„ pointer idç§»é™¤å…‰äº†ï¼Œé‚£ä¹ˆæ„å‘³ç€æ­¤ TouchTarget æŒæœ‰çš„ child æ²¡æœ‰æ¶ˆè´¹è¿‡ä»»æ„(ç°å­˜)çš„ pointer çš„ Down æˆ–è€… PointerDownï¼Œäºæ˜¯å¯ä»¥æŠŠæ­¤ TouchTarget ä»é“¾è¡¨ç§»é™¤äº†ã€‚ æ¯æ¬¡ä¸€ä¸ª Down æˆ–è€… PointerDown äº‹ä»¶ ev åˆ°æ¥æ—¶ï¼Œå¯¹äº ViewGroup çš„æ¯ä¸ª child xï¼Œè‹¥ ev çš„åæ ‡è½åœ¨ x çš„èŒƒå›´å†…(å¦åˆ™å°± continueï¼Œè€ƒè™‘ä¸‹ä¸€ä¸ª child)ï¼Œè¿›ä¸€æ­¥ã€Œå¦‚æœ x åœ¨é“¾è¡¨ä¸­(è¯´æ˜ x æ¶ˆè´¹è¿‡ Down æˆ–è€… pointerDown äº‹ä»¶)ï¼Œé‚£ä¹ˆ x å°±æ˜¯è¦è¢«åˆ†å‘çš„ childï¼›å¦åˆ™å¦‚æœ x.dispatchTouchEvent(ev) è¿”å› true äº†ï¼Œé‚£ä¹ˆ x åŒæ ·æ˜¯è¦è¢«åˆ†å‘çš„ childï¼Œè™½ç„¶æ­¤æ—¶åˆ†å‘å·²ç»ç»“æŸäº†ã€ã€‚ æ¯ä¸ª move äº‹ä»¶ ev åˆ°æ¥æ—¶ï¼Œé“¾è¡¨ä¸ºç©ºçš„è¯ï¼Œæ˜¾ç„¶æ²¡æœ‰ child æ¶ˆè´¹è¿‡ down æˆ–è€… pointerDownï¼Œé‚£ä¹ˆç›´æ¥è®© viewGroup å¤„ç† ev å°±å¥½äº†ã€‚é“¾è¡¨ä¸ä¸ºç©ºçš„è¯ï¼Œå¯¹äºé“¾è¡¨çš„æ¯ä¸ª TouchTarget t æŒæœ‰çš„ child xï¼šå¦‚æœè½¬æˆäº† cancel äº‹ä»¶ï¼Œé‚£ä¹ˆå‘ x åˆ†å‘ä¸€ä¸ª cancel äº‹ä»¶ï¼Œå¦å¤–æŠŠ t ä»é“¾è¡¨ç§»é™¤(ç§»é™¤çš„åŸå› æ˜¯ï¼Œä¾‹å¦‚ x æ­£åœ¨ detachingï¼Œæ‰€ä»¥æ‰å¼•å‘ cancelï¼Œé‚£ä¹ˆå½“ç„¶éœ€è¦æŠŠæŒæœ‰ x çš„ t ç§»é™¤)ï¼Œç„¶å overï¼Œå³ move äº‹ä»¶ä¸¢å¤±äº†ï¼›æ²¡è½¬æˆ cancelï¼Œé‚£å°±æ£€æŸ¥ t çš„ idBits ä¸­æœ‰æ²¡æœ‰ ev çš„ä»»æ„ä¸€ä¸ª pointer çš„ idï¼Œæœ‰åˆ™æŠŠ ev äº¤ç»™ xï¼Œæ²¡æœ‰åˆ™ continueã€‚ å››ã€æºç åˆ†æ ä¸‹é¢ç²˜è´´ä¸€å¤§æ®µåŠ ä¸Šäº†æˆ‘çš„ç†è§£ä½œä¸ºæ³¨é‡Šçš„æºç ï¼Œä»£ç çœŸçš„å¾ˆé•¿å¾ˆé•¿ï¼Œè¿™è¿˜ä»…ä»…æ˜¯ ViewGroup#dispatchTouchEvent è¿™ä¸€ä¸ªæ–¹æ³•çš„ä»£ç ã€‚å…³äºå¤šç‚¹è§¦æ§çš„å¤„ç†é€»è¾‘ï¼Œæˆ‘ä¹Ÿæ²¡æœ‰å½»åº•æ˜ç™½ï¼Œsighã€‚ã€‚ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188@Overridepublic boolean dispatchTouchEvent(MotionEvent ev) &#123; boolean handled = false; // è‹¥å½“å‰ç±»ä¸Šé¢è¦†ç›–äº†å…¶ä»–window, ä¸” ev çš„flagå·²æ ‡è®°è¿‡æ»¤ã€Œè¦†ç›–ã€æƒ…å†µä¸‹çš„äº‹ä»¶ï¼Œåˆ™ç›´æ¥è·³è¿‡ if (onFilterTouchEventForSecurity(ev)) &#123; final int action = ev.getAction(); final int actionMasked = action &amp; MotionEvent.ACTION_MASK; // Handle an initial down. if (actionMasked == MotionEvent.ACTION_DOWN) &#123; // Throw away all previous state when starting a new touch gesture. // The framework may have dropped the up or cancel event for the previous gesture // due to an app switch, ANR, or some other state change. cancelAndClearTouchTargets(ev); //å¦‚é“¾è¡¨éç©º, å‘å…¶ä¸­æ‰€æœ‰ touchTarget æŒæœ‰çš„ child å‘ cancel äº‹ä»¶, å¹¶æ¸…ç©ºé“¾è¡¨ resetTouchState(); // reset æ­¤ ViewGroup çš„ CANCEL_NEXT_UP å’Œ DISALLOW_INTERCEPT &#125; // Check for interception. final boolean intercepted; // down äº‹ä»¶, æˆ–è€…é“¾è¡¨ä¸ç©º(æ„æ€æ˜¯æ›¾æœ‰ down äº‹ä»¶è¢«æŸä¸ª child æ¶ˆè´¹è¿‡)æ—¶, è€ƒè™‘æ‹¦æˆª if (actionMasked == MotionEvent.ACTION_DOWN || mFirstTouchTarget != null) &#123; // å‰é¢çš„ resetTouchState() ä½¿å¾— disallowIntercept å¿…å®šæ˜¯ false final boolean disallowIntercept = (mGroupFlags &amp; FLAG_DISALLOW_INTERCEPT) != 0; if (!disallowIntercept) &#123; intercepted = onInterceptTouchEvent(ev); ev.setAction(action); // restore action in case it was changed &#125; else &#123; intercepted = false; &#125; &#125; else &#123; // å…¶ä»–æƒ…å†µ, ä¸ç”¨æŠŠäº‹ä»¶äº¤ç»™ä»»ä½• child, æ‰€ä»¥ç›´æ¥èµ‹å€¼ intercepted = true // There are no touch targets and this action is not an initial down // so this view group continues to intercept touches. intercepted = true; &#125; // Check for cancelation. // æ­¤ ViewGroup æœ‰ cancel_next_up æ ‡å¿—, é‚£ä¹ˆå°±è½¬æˆ cancel äº‹ä»¶ final boolean canceled = resetCancelNextUpFlag(this) || actionMasked == MotionEvent.ACTION_CANCEL; // Update list of touch targets for pointer down, if needed. // API 11 ä»¥ä¸Š, split å¿…ä¸º true final boolean split = (mGroupFlags &amp; FLAG_SPLIT_MOTION_EVENTS) != 0; TouchTarget newTouchTarget = null; // æ ‡è®° down/pointerDown è¢«æŸä¸ª child æ¶ˆè´¹ boolean alreadyDispatchedToNewTouchTarget = false; if (!canceled &amp;&amp; !intercepted) &#123; // down/pointerDown æ‰å¯»æ±‚ child æ¥æ¥ç›˜, å…¶ä½™ç±»å‹çš„äº‹ä»¶éƒ½æ˜¯è°æ¶ˆè´¹äº† down/pointerDown å°±äº¤ç»™è° if (actionMasked == MotionEvent.ACTION_DOWN || (split &amp;&amp; actionMasked == MotionEvent.ACTION_POINTER_DOWN) || actionMasked == MotionEvent.ACTION_HOVER_MOVE) &#123; // å¾—åˆ° ev å½“å‰ action æ‰€æ‰€å±çš„ pointer çš„ index final int actionIndex = ev.getActionIndex(); // always 0 for down // idBitsToAssign åŒ…å«ä¸€ä¸ª id, å³ ev æ‰€å± pointer çš„ id final int idBitsToAssign = split ? 1 &lt;&lt; ev.getPointerId(actionIndex) : TouchTarget.ALL_POINTER_IDS; // Clean up earlier touch targets for this pointer id in case they // have become out of sync. // down/pointerDown æ„å‘³ç€æ–°çš„ pointer, æ¸…é™¤ä¸€ä¸‹é“¾è¡¨ä¸­å’Œæ–° pointer çš„ id ä¹‹é—´çš„ç“œè‘› removePointersFromTouchTargets(idBitsToAssign); final int childrenCount = mChildrenCount; if (newTouchTarget == null &amp;&amp; childrenCount != 0) &#123; final float x = ev.getX(actionIndex); final float y = ev.getY(actionIndex); // Find a child that can receive the event. // Scan children from front to back. final ArrayList&lt;View&gt; preorderedList = buildTouchDispatchChildList(); final boolean customOrder = preorderedList == null &amp;&amp; isChildrenDrawingOrderEnabled(); final View[] children = mChildren; for (int i = childrenCount - 1; i &gt;= 0; i--) &#123; final int childIndex = getAndVerifyPreorderedIndex( childrenCount, i, customOrder); final View child = getAndVerifyPreorderedView( preorderedList, children, childIndex); // ä¸èƒ½æ¥å—æˆ–è€…æ˜¯ ev åæ ‡ä¸åœ¨ child å†…éƒ¨åˆ™ continue if (!canViewReceivePointerEvents(child) || !isTransformedTouchPointInView(x, y, child, null)) &#123; ev.setTargetAccessibilityFocus(false); continue; &#125; newTouchTarget = getTouchTarget(child); if (newTouchTarget != null) &#123; // è¯´æ˜ ev è½åœ¨ child å†…éƒ¨ä¸” child ä»¥å‰å“åº”è¿‡ down/pointerDown, é‚£ä¹ˆç”± child æ¥æ¥ç›˜, æ•… break // å¦‚æœ ev æ˜¯ Down äº‹ä»¶, åˆ—è¡¨å°šç©º, åˆ™èµ°ä¸åˆ°è¿™é‡Œæ¥ // Child is already receiving touch within its bounds. // Give it the new pointer in addition to the ones it is handling. // child æ‰€å± TouchTarget å¯èƒ½å¢åŠ ä¸€ä¸ª pointer id newTouchTarget.pointerIdBits |= idBitsToAssign; break; &#125; resetCancelNextUpFlag(child); // å°è¯•è®© child æ¶ˆè´¹ ev if (dispatchTransformedTouchEvent(ev, false, child, idBitsToAssign)) &#123; // Child wants to receive touch within its bounds. mLastTouchDownTime = ev.getDownTime(); if (preorderedList != null) &#123; // childIndex points into presorted list, find original index for (int j = 0; j &lt; childrenCount; j++) &#123; if (children[childIndex] == mChildren[j]) &#123; mLastTouchDownIndex = j; break; &#125; &#125; &#125; else &#123; mLastTouchDownIndex = childIndex; &#125; mLastTouchDownX = ev.getX(); mLastTouchDownY = ev.getY(); // æ¶ˆè´¹æˆåŠŸçš„è¯, ç”¨ child æ–°å»º TouchTarget, æ’åˆ°é“¾è¡¨å¤´éƒ¨, newTouchTarget = addTouchTarget(child, idBitsToAssign); alreadyDispatchedToNewTouchTarget = true; break; &#125; // The accessibility focus didn't handle the event, so clear // the flag and do a normal dispatch to all children. ev.setTargetAccessibilityFocus(false); &#125; if (preorderedList != null) preorderedList.clear(); &#125; if (newTouchTarget == null &amp;&amp; mFirstTouchTarget != null) &#123; // æ²¡æ‰¾åˆ°æ¥ç›˜çš„, ä¸”é“¾è¡¨ä¸ç©º(æ„æ€æ˜¯æœ‰ Down/pointerDown è¢« child View æ¶ˆè´¹è¿‡) // Did not find a child to receive the event. // Assign the pointer to the least recently added target. // å¼ºè¡Œè®©é“¾è¡¨æœ«å°¾èŠ‚ç‚¹æŒæœ‰çš„ child æ¥æ¥ç›˜ newTouchTarget = mFirstTouchTarget; while (newTouchTarget.next != null) &#123; newTouchTarget = newTouchTarget.next; &#125; newTouchTarget.pointerIdBits |= idBitsToAssign; &#125; &#125; &#125; // Dispatch to touch targets. if (mFirstTouchTarget == null) &#123; // child view å‹æ ¹æ²¡æœ‰æ¶ˆè´¹è¿‡äº‹ä»¶ // No touch targets so treat this as an ordinary view. // view group å°è¯•è‡ªè¡Œæ¶ˆè´¹ handled = dispatchTransformedTouchEvent(ev, canceled, null, TouchTarget.ALL_POINTER_IDS); &#125; else &#123; // Dispatch to touch targets, excluding the new touch target if we already // dispatched to it. Cancel touch targets if necessary. TouchTarget predecessor = null; TouchTarget target = mFirstTouchTarget; // éå†é“¾è¡¨ while (target != null) &#123; final TouchTarget next = target.next; if (alreadyDispatchedToNewTouchTarget &amp;&amp; target == newTouchTarget) &#123; // ev æ˜¯ Down æˆ–è€… pointer Down ä¸”å®ƒè¢« target æŒæœ‰çš„ child æ¶ˆè´¹äº† handled = true; &#125; else &#123; // å¯¹äºå…¶ä»–çš„ Touch target final boolean cancelChild = resetCancelNextUpFlag(target.child) || intercepted; // å‘é€ cancel æˆ–è€… ev ç»™ child, æˆ–è€…å•¥ä¹Ÿä¸åš(target çš„ idBits æ²¡æœ‰ ev ä¸­ä»»æ„çš„ pointer çš„ id) if (dispatchTransformedTouchEvent(ev, cancelChild, target.child, target.pointerIdBits)) &#123; handled = true; &#125; if (cancelChild) &#123; // æ”¶åˆ° cancel å,child å°±ä¸è¯¥å†æ”¶åˆ°äº‹ä»¶äº†, å¯¹åº”çš„ TouchTarget ä¹Ÿè¦ç§»é™¤ if (predecessor == null) &#123; mFirstTouchTarget = next; &#125; else &#123; predecessor.next = next; &#125; target.recycle(); target = next; continue; &#125; &#125; predecessor = target; target = next; &#125; &#125; // Update list of touch targets for pointer up or cancel, if needed. if (canceled || actionMasked == MotionEvent.ACTION_UP || actionMasked == MotionEvent.ACTION_HOVER_MOVE) &#123; resetTouchState(); // up äº‹ä»¶å,è¿™ä¸€ä¸² Touch äº‹ä»¶å°±ç»“æŸäº†, æ¸…ç†é“¾è¡¨ç­‰ &#125; else if (split &amp;&amp; actionMasked == MotionEvent.ACTION_POINTER_UP) &#123; // æŸä¸ª pointer æ²¡äº†, é‚£ä¹ˆæ¸…ç©ºé“¾è¡¨ä¸­å’Œè¿™ä¸ª pointer çš„ç“œè‘› final int actionIndex = ev.getActionIndex(); final int idBitsToRemove = 1 &lt;&lt; ev.getPointerId(actionIndex); removePointersFromTouchTargets(idBitsToRemove); &#125; &#125; if (!handled &amp;&amp; mInputEventConsistencyVerifier != null) &#123; mInputEventConsistencyVerifier.onUnhandledEvent(ev, 1); &#125; return handled;&#125; äº”ã€æ»‘åŠ¨å†²çªåˆ†æç¤ºä¾‹ åœ¨ã€Šå®‰å“å¼€å‘è‰ºæœ¯æ¢ç´¢ã€‹ä¸€ä¹¦ä¸­è®² touch äº‹ä»¶çš„æœ€åï¼Œè®²äº†æ»‘åŠ¨å†²çªçš„è§£å†³æ–¹æ³•ã€‚æ‰€è°“æ»‘åŠ¨å†²çªæœ€ç®€å•çš„æƒ…å½¢å°±æ˜¯ä¸€ä¸ªæ°´å¹³æ»‘åŠ¨çš„ ScrollView é‡Œé¢æ”¾ä¸€ä¸ªç«–ç›´æ»‘åŠ¨çš„ listViewï¼Œä¸¤è€…æ»‘åŠ¨æ–¹å‘ä¸åŒï¼Œå³ä¸ºæ»‘åŠ¨å†²çªã€‚å¯¹äºè¿™ä¸ªæƒ…å½¢ï¼Œè§£å†³æ»‘åŠ¨å†²çªï¼Œå…¶å®å°±æ˜¯åœ¨æ‰‹æŒ‡ä¸Šä¸‹æ»‘æ—¶å§ move äº‹ä»¶ç»™ childï¼ˆlistViewï¼‰å¤„ç†ï¼Œè€Œæ‰‹æŒ‡å·¦å³æ»‘åŠ¨æ—¶ç»™ parent å¤„ç†ï¼ˆScrollViewï¼‰å³å¯ã€‚ä¸‹é¢æ˜¯ä¹¦ä¸­çš„ä¸€ç§è§£å†³æ–¹å¼ï¼Œä½¿ç”¨ä¸Šé¢è®²çš„çŸ¥è¯†ï¼Œæˆ‘ä»¬å¯ä»¥é€å½»çš„åˆ†æè¿™ç§è§£å†³æ–¹å¼ã€‚ ä¸‹é¢æ˜¯ã€Šå®‰å“å¼€å‘è‰ºæœ¯æ¢ç´¢ã€‹ä¸­æä¾›çš„å…¶ä¸­ä¸€ç§è§£å†³æ–¹æ³•ï¼Œæˆ‘åŠ å…¥äº†æ¯”è¾ƒè¯¦ç»†çš„æ³¨é‡Šä½œä¸ºè§£é‡Šï¼Œåœ¨å‰é¢çš„åŸºç¡€ä¸Šï¼Œè¿™ç§è§£å†³æ–¹æ³•çš„é€»è¾‘å°±å¾ˆæ˜ç¡®äº†ã€‚ 1234567891011121314151617181920212223242526272829303132333435class ChildView extends android.view.View &#123; @Override public boolean dispatchTouchEvent(MotionEvent event) &#123; ViewParent parent = getParent(); if (parent != null) &#123; switch (event.getActionMasked()) &#123; case MotionEvent.ACTION_DOWN: // æ­¤æ¬¡è¯·æ±‚å…¶å®åœ¨ Down äº‹ä»¶åçš„é¦–ä¸ª Move ä¼ è‡³ parent ä¸­æ—¶ç”Ÿæ•ˆ // è‹¥ä¸è¯·æ±‚ï¼Œåˆ™å°†ä¼šå‘ç”Ÿæ‹¦æˆªï¼Œåç»­äº‹ä»¶éƒ½å’Œ child æ— ç¼˜ï¼Œæ‰€ä»¥å¿…é¡»è¯·æ±‚åˆ«æ‹¦æˆª parent.requestDisallowInterceptTouchEvent(true); break; case MotionEvent.ACTION_MOVE: // å¦‚æœæœŸæœ› parent æ¥å¤„ç†ï¼Œé‚£ä¹ˆè§£é™¤è¯·æ±‚ï¼Œåˆ™ä¸‹ä¸€æ¬¡ Move äº‹ä»¶æ—¶å¿…å®šæ‹¦æˆªï¼Œåç»­äº‹ä»¶å°±å…¨éƒ¨äº¤ç»™ parent äº†ã€‚ // å¦åˆ™ï¼Œä»€ä¹ˆä¹Ÿä¸åšï¼Œå³äº‹ä»¶ä¼šç»§ç»­æºæºä¸æ–­çš„äº¤ç»™ child if (parent should handle event)&#123; parent.requestDisallowInterceptTouchEvent(false); &#125; break; default: break; &#125; &#125; return super.dispatchTouchEvent(event); &#125;&#125;public class ParentView extends ViewGroup &#123; @Override public boolean onInterceptTouchEvent(MotionEvent ev) &#123; // Down æ—¶ï¼Œå¿…ç„¶è°ƒæ­¤æ–¹æ³•ï¼Œæ­¤æ—¶ä¸åº”æ‹¦æˆªï¼Œå¦åˆ™ child æ°¸è¿œæ— æ³•å¤„ç† move äº‹ä»¶ // å…¶ä»–äº‹ä»¶æ—¶ï¼Œè‹¥ child è¯·æ±‚ä¸æ‹¦æˆªï¼Œé‚£ä¹ˆåé¢çš„äº‹ä»¶éƒ½äº¤ç»™ child äº†ï¼›å¦åˆ™ï¼Œå°±ä¼š // è°ƒç”¨æ­¤æ–¹æ³•ï¼Œæ­¤æ–¹æ³•è¿™æ—¶è¿”å› True å³è¡¨ç¤ºæ‹¦æˆªï¼Œé‚£ä¹ˆä¼šå‘ä¸€ä¸ª cancel ç»™ childï¼Œåç»­çš„äº‹ä»¶å°±å’Œ child æ— ç¼˜äº† return ev.getActionMasked() != MotionEvent.ACTION_DOWN; &#125;&#125; åˆ°æ­¤ï¼Œè¿™ç¯‡é•¿é•¿çš„ã€å¹¶ä¸å®Œç¾çš„åˆ†æä¹Ÿå°±ç»“æŸäº†ã€‚","categories":[],"tags":[{"name":"Android","slug":"Android","permalink":"https://tao93.top/tags/Android/"}]},{"title":"Android ImageView ScaleType","slug":"Android ImageView ScaleType","date":"2018-09-26T07:47:46.598Z","updated":"2018-09-26T07:47:46.598Z","comments":true,"path":"2018/09/26/Android ImageView ScaleType/","link":"","permalink":"https://tao93.top/2018/09/26/Android ImageView ScaleType/","excerpt":"","text":"æˆ‘ç»å¸¸è®°ä¸ä½ Android ä¸­ ImageView çš„å„ç§ ScaleType çš„å«ä¹‰ï¼Œçœ‹æ–‡æ¡£ä¸€æ—¶ä¹Ÿç¡®å®šä¸äº†ï¼Œæ‰€ä»¥å¹²è„†æŠŠæ‰€æœ‰ ScaleType æŒ¨ä¸ªå°è¯•äº†ä¸€éï¼Œç„¶åæ¸…æ¥šçš„è®°å½•ä¸‹æ¥ï¼Œä»¥å¤‡ä»ŠåæŸ¥é˜…ã€‚ CEMTER å›¾ç‰‡å¤§å°ä¸åšä»»ä½•ç¼©æ”¾ï¼Œä»…ä»…æŠŠå›¾ç‰‡ä¸­å¿ƒå’Œè§†å›¾ä¸­å¿ƒé‡åˆã€‚å¯èƒ½å›¾ç‰‡å°äºè§†å›¾æ¡†ï¼Œä¹Ÿå¯èƒ½åè¿‡æ¥ã€‚ CENTER_CROP å°†å›¾ç‰‡æ”¾å¤§æˆ–è€…ç¼©å°ï¼Œç›´åˆ°è§†å›¾æ¡†è¢«å¸ƒæ»¡ï¼Œä¸”å›¾ç‰‡çš„ä¸¤ä¸ªè¾¹ç¼˜æˆ–è€…æ‰€æœ‰è¾¹ç¼˜å’Œè§†å›¾æ¡†çš„å¯¹åº”è¾¹ç¼˜é‡åˆã€‚ CENTER_INSIDE å¯èƒ½å°†å›¾ç‰‡ç¼©å°ï¼Œä½†æ˜¯ä¸ä¼šæ”¾å¤§ï¼Œç›®æ ‡æ˜¯æŠŠå›¾ç‰‡æ”¾ç½®åœ¨è§†å›¾æ¡†ä¹‹å†…ï¼Œä¸èƒ½æœ‰éœ²åœ¨å¤–é¢çš„ï¼Œå›¾ç‰‡ä¸­å¿ƒå’Œè§†å›¾æ¡†ä¸­å¿ƒé‡åˆã€‚ FIT_CENTER å›¾ç‰‡å¯èƒ½æ”¾å¤§ä¹Ÿå¯èƒ½ç¼©å°ï¼Œç›®æ ‡æ˜¯è®©å›¾ç‰‡åœ¨æ˜¯å›¾æ¡†å†…éƒ¨ï¼Œä¸”å›¾ç‰‡å æ®æœ€å¤§çš„å¯ç”¨ç©ºé—´ï¼Œå›¾ç‰‡ä¸­å¿ƒå’Œè§†å›¾æ¡†ä¸­å¿ƒé‡åˆã€‚ FIT_START ç±»ä¼¼äº fit_center åªä¸è¿‡å›¾ç‰‡ä¸­å¿ƒå¯èƒ½å’Œè§†å›¾æ¡†ä¸­å¿ƒä¸é‡åˆï¼Œè€Œæ˜¯å›¾ç‰‡å¤„åœ¨è§†å›¾æ¡†çš„ä¸Šä¾§æˆ–è€…å·¦ä¾§ã€‚ FIT_END ç±»ä¼¼äº fit_center åªä¸è¿‡å›¾ç‰‡ä¸­å¿ƒå¯èƒ½å’Œè§†å›¾æ¡†ä¸­å¿ƒä¸é‡åˆï¼Œè€Œæ˜¯å›¾ç‰‡å¤„åœ¨è§†å›¾æ¡†çš„ä¸‹ä¾§æˆ–è€…å³ä¾§ã€‚ FIT_XY å›¾ç‰‡å¯èƒ½ä¼šè¢«æ‹‰ä¼¸ï¼Œæ•ˆæœæ˜¯å›¾ç‰‡çš„å››ä¸ªè¾¹ç¼˜å’Œè§†å›¾æ¡†çš„å››ä¸ªè¾¹ç¼˜æ— æ¡ä»¶é‡åˆã€‚","categories":[],"tags":[{"name":"Android","slug":"Android","permalink":"https://tao93.top/tags/Android/"}]}]}