<!DOCTYPE html><html lang="en"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="A blog of Liu Tao"><title>从阿里云服务器到个人博客 | Liu Tao</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/8.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">从阿里云服务器到个人博客</h1><a id="logo" href="/.">Liu Tao</a><p class="description">A little older, a little wiser, but happy to see you.</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> Home</i></a><a href="/archives/"><i class="fa fa-archive"> Archive</i></a><a href="/about/"><i class="fa fa-user"> About</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">从阿里云服务器到个人博客</h1><div class="post-meta">Sep 3, 2018</div><a class="disqus-comment-count" data-disqus-identifier="2018/09/03/从阿里云服务器到个人博客/" href="/2018/09/03/从阿里云服务器到个人博客/#disqus_thread"></a><div class="post-content"><h3 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h3><p>(友情提示，想看步骤的话，下面的前言可以跳过不看)</p>
<p>为什么我现在要买阿里云的 VPS (Virtual Private Server) 搞博客系统呢？我也说不上为什么，不过可以讲一下事情的经过。</p>
<p>2016年刚开始工作那会儿，从<a href="http://ewind.us/" target="_blank" rel="noopener">王译锋</a>那里知道了租 VPS、搭建某 socks、nginx 驱动 hexo 博客这样一套东西。当时觉得很新鲜，立马也买了搬瓦工的 VPS，然后一同瞎搞，算是搞成了一个 hexo 静态博客系统了，不过有点尴尬的小插曲，我把 hexo 安装在了 VPS 上面 ，然后把 Markdown 文件推到 VPS 上面，然后再 VPS 再用 hexo 生成静态页面的文件。。。 实际上更合适的是把 hexo 安装在本地，然后本地生成的页面文件推到 nginx 的 web root 目录中去。</p>
<p>后来嘛，搬瓦工，Vultr，Linode 阿里云我都试了个遍，发现除了阿里云意外，虽然都不贵，但是网速稳定性真的很捉急，有时候在终端 ssh 到服务器上面时，输入命令真的是一卡一卡的，这样的网速带来的科学上网体验只能用「能用」两个字来形容。直觉告诉我，可能部署在香港的 VPS 网速会比较快，因为香港离大陆近。我就开始找香港的 VPS 了，一番找呀找，中间也交了些学费，最后找到了一个叫枫叶主机的，速度挺不错，轻松达到 500 KB/S，就是贵了点，我就和某同事一起平摊费用了。这个枫叶主机我一口气买了一年的，不过中间依然因为某些原因而出现网速不稳定的情况。等到枫叶主机过期后，因为穷，我忽然想试试老早就听别人推荐的一个叫云梯的 VPN。这个云梯我曾经使用过，但是的速度确实还不错，哪想到我一口气买了一年的 VPN 后，发现用不了，整个云梯团队都跑路了！！！就留下个网站还在运行，不断的吸钱，真他们坑！吃了大亏的我，开始蹭大学同学的 VPS 的某 socks 服务，挺长时间都没再买过 VPS了，期间，我把静态博客放到了 github.io 页面。然而，自始至终，我其实没写几篇博客，真为自己的懒惰感到惭愧。</p>
<p>直到最近，再次看到珂神和王译锋的博客、掘金搞得风生水起，感叹自己没有能拿的出手的东西，所以就买阿里云 VPS → 注册域名 → 搭博客系统了，期待自己能多写一些有价值的东西，加油！</p>
<h3 id="正文："><a href="#正文：" class="headerlink" title="正文："></a>正文：</h3><h4 id="租阿里云-VPS"><a href="#租阿里云-VPS" class="headerlink" title="租阿里云 VPS"></a>租阿里云 VPS</h4><p>在阿里云官网，这个叫做「云服务器 ECS」，这个其实很简单了，花几百块钱就能租一年，我是 290 几块钱租的 1GB 内存、1Mbps 带宽、40GB 非 SSD 的香港 VPS。其实，对我们而言最敏感的性能指标就是内存和带宽了，硬盘一般是不会用光的，CPU 性能也没多大影响。这里解释一下，为什么选阿里云。有鉴于前面试用了一大波 VPS 服务，我发现只有阿里云算是最稳定的，虽然带宽只有 1Mbps (指从我们个人电脑访问 VPS 的网速，而在 VPS 上面安软件时，下载软件包的速度其实是很快的，因为用的是阿里云的镜像，所以相当于内网传输数据)，但是胜在稳，终端输入命令基本不会有任何延迟。</p>
<p>租完 VPS，ssh 连接到它，然后就是搭建某 socks 服务了，网上资料非常多。需要注意的是，阿里云服务器需要配置安全组规则的，不然无法提供服务。假设某 socks 使用 23333 号端口来提供服务，那么需要下图那样配置一条入方向的规则：</p>
<p><img src="http://tao93.top/images/2018/09/01/1535789407.png" alt=""></p>
<p>入方向表示数据流向 VPS 的，协议类型选 TCP，对绝大部分服务来说，都是 TCP 协议，端口范围就是 VPS 上面提供的服务所使用的端口了。如果没有这个配置，那么我们个人电脑将无法向 23333 号端口发起请求。另外出方向默认全开了，所以不需配置。</p>
<h4 id="注册域名"><a href="#注册域名" class="headerlink" title="注册域名"></a>注册域名</h4><p>我挑了个很便宜的，36块钱 3 年，域名就是 tao93.top，也算是和我的名字和出生年份有些关联吧。</p>
<h4 id="域名绑定-IP"><a href="#域名绑定-IP" class="headerlink" title="域名绑定 IP"></a>域名绑定 IP</h4><p>这个还是要提一下的。在阿里云注册的域名，需要实名认证 (上传单面身份证照片) 才行，一开始我不知道，傻乎乎的总等，一边等，一边 ping 和 nslook 我的域名，好在实名认证很快，基本上提交认证后，1小时内就有人处理。我认证时有点搞笑，我传了一张 jpeg 后缀的图片，然后审核者回复说，需要 jpg 或 bmp 后缀的图片。我有点吃鲸，然后把同一张图片后缀改成了 jpg，上传，然后认证就成功了。。。认证结束后，就可以设置解析规则了：</p>
<p><img src="http://tao93.top/images/2018/09/01/1535789454.png" alt=""></p>
<p>只需要上面红框中的一条规则就可以把 tao93.top 解析了，mail 的那条规则，我现在还用不上。添加规则的时候，如果拿不准，可以在下图中只在记录值填公网 IP 地址即可：</p>
<p><img src="http://tao93.top/images/2018/09/01/1535789477.png" alt=""></p>
<p>我当时也是有点傻，觉得香港的 VPS 算是境外，就在解析线路选了境外，然后傻等了好久，后面换成默认后，基本几分钟就可以解析了。</p>
<h4 id="搭博客系统"><a href="#搭博客系统" class="headerlink" title="搭博客系统"></a>搭博客系统</h4><p>先说下为什么我没用 hexo 静态博客，因为静态博客无法评论，我觉得评论还是挺有必要的，虽然可以嵌入第三方评论服务，但是这种需要评论者用社交账号登录，麻烦，另外评论的数据全在别人手里，我觉得不好。所以我就要自己搭一个有后台的博客了。珂神使用的 zblog 是一个，国产的，看起来不那么华丽；WordPress 是另一个。我两个都装了，先装了 zblog，觉得有点点简单粗糙，然后就删的一干二净，装了 WordPress，然后发现 WordPress 复杂的让我有点迷失，我就想简单的写写东西，不想要那么多东西。然后我就在保留 WordPress 的基础上，又装了 zblog。</p>
<p>zblog 有个 php 版本，和 WordPress 的技术组合一模一样，就是 php + 数据库 + nginx 等 web server，其中 zblog 的数据库还可以用 sqlite，虽然我没成功过。我第一次装 zblog 时，手动安装了 MySQL，php，nginx，然后摸索着各种配置，搞了蛮久才搞定的。而 WordPress 的安装就很简单了，网上有 LNMP (Linux Nginx MySQL PHP) 组合包，等于一键就能装好环境，剩下的就是搞个 WordPress，并且替换掉 LNMP 原有的 web root 目录，就好了。</p>
<p>所以，无论 WordPress 还是 zblog，最简单的方式是，先装 LNMP 环境，然后就快了。需要记住一点的是，LNMP 环境会新建一个 www:www 用户(组) 来用于驱动 web 服务。务必需要让此 www 用户对于 web root 有 rwx 权限。比如 LNMP 默认的 web root 是 /home/wwwroot/default，那么一句 sudo chown -R www:www /home/wwwroot/default 即可。</p>
<h4 id="直接安装-z-blog-的过程"><a href="#直接安装-z-blog-的过程" class="headerlink" title="直接安装 z_blog 的过程"></a>直接安装 z_blog 的过程</h4><p>此过程配置比较麻烦，所以只是记录一下，不建议使用此方式。</p>
<p>装 nginx，设置开机自启，运行起来，然后别急着进浏览器验证，先到阿里云网站增加一下 80 号端口的安全规则，然后验证 nginx 是否可用。</p>
<p>建议更改一下 nginx 配置文件中的 root，即更改 web root 的位置，比如改为自己 home 中的某个目录，这样的话 chown web root 时不会有烦人的警告。</p>
<p>注意，nginx 需要重新加载配置文件，才能让配置文件的修改生效，方法是 sudo nginx -s reload 即可。</p>
<p>安装 Mysql，记得别忘记了 root 密码。</p>
<p>安装 Php，然后就是在 Php.ini 配置文件中，把各种 extension=php_mysql.dll 之类的语句解除注释，意思是 php 需要和 MySQL 数据库连接。但是这样的配置还不够，还需要 sudo apt-get install php7.0-mysql</p>
<p>这时候，可以下载 zblog 的压缩包，解压到 web root 中，然后浏览器打开 <a href="http://tao93.top，就可以开始安装" target="_blank" rel="noopener">http://tao93.top，就可以开始安装</a> zblog 了，安装好后就是各种 GUI 配置方式了。再次强调一下，需要 nginx 对应的 Linux 用户对于 web root 目录递归的有 rwx 权限。我第一次装 zblog 就是没设置权限，然后在后台首页中，「清空缓存并重新编译模板」一直转圈圈。</p>
<h4 id="配置主题，样式自定义，然后开始写博客。"><a href="#配置主题，样式自定义，然后开始写博客。" class="headerlink" title="配置主题，样式自定义，然后开始写博客。"></a>配置主题，样式自定义，然后开始写博客。</h4><p>略</p>
</div><div class="tags"><a href="/tags/VPS/">VPS</a></div><div class="post-nav"><a class="pre" href="/2018/09/03/targetSdkVersion 杂/">targetSdkVersion 杂谈</a><a class="next" href="/2018/09/01/博客系统迁移记录/">博客系统迁移记录</a></div><div id="disqus_thread"><div class="btn_click_load"><button class="disqus_click_btn">阅读评论（请确保 Disqus 可以正常加载）</button></div><script type="text/javascript">var disqus_config = function () {
    this.page.url = 'http://tao93.top/2018/09/03/从阿里云服务器到个人博客/';
    this.page.identifier = '2018/09/03/从阿里云服务器到个人博客/';
    this.page.title = '从阿里云服务器到个人博客';
  };</script><script type="text/javascript" id="disqus-lazy-load-script">$.ajax({
url: 'https://disqus.com/next/config.json',
timeout: 2500,
type: 'GET',
success: function(){
  var d = document;
  var s = d.createElement('script');
  s.src = '//liu-tao.disqus.com/embed.js';
  s.setAttribute('data-timestamp', + new Date());
  (d.head || d.body).appendChild(s);
  $('.disqus_click_btn').css('display', 'none');
},
error: function() {
  $('.disqus_click_btn').css('display', 'block');
}
});</script><script type="text/javascript" id="disqus-click-load">$('.btn_click_load').click(() => {  //click to load comments
    (() => { // DON'T EDIT BELOW THIS LINE
        var d = document;
        var s = d.createElement('script');
        s.src = '//liu-tao.disqus.com/embed.js';
        s.setAttribute('data-timestamp', + new Date());
        (d.head || d.body).appendChild(s);
    })();
    $('.disqus_click_btn').css('display','none');
});</script><script type="text/javascript" id="disqus-count-script">$(function() {
     var xhr = new XMLHttpRequest();
     xhr.open('GET', '//disqus.com/next/config.json', true);
     xhr.timeout = 2500;
     xhr.onreadystatechange = function () {
       if (xhr.readyState === 4 && xhr.status === 200) {
         $('.post-meta .post-comments-count').show();
         var s = document.createElement('script');
         s.id = 'dsq-count-scr';
         s.src = 'https://liu-tao.disqus.com/count.js';
         s.async = true;
         (document.head || document.body).appendChild(s);
       }
     };
     xhr.ontimeout = function () { xhr.abort(); };
     xhr.send(null);
   });
</script></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><div class="search-form"><input id="local-search-input" placeholder="Search" type="text" name="q" results="0"/><div id="local-search-result"></div></div></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> Tags</i></div><div class="tagcloud"><a href="/tags/macOS/" style="font-size: 15px;">macOS</a> <a href="/tags/Linux/" style="font-size: 15px;">Linux</a> <a href="/tags/Android/" style="font-size: 15px;">Android</a> <a href="/tags/MySQL/" style="font-size: 15px;">MySQL</a> <a href="/tags/Homebrew/" style="font-size: 15px;">Homebrew</a> <a href="/tags/Shell/" style="font-size: 15px;">Shell</a> <a href="/tags/Bash/" style="font-size: 15px;">Bash</a> <a href="/tags/Python/" style="font-size: 15px;">Python</a> <a href="/tags/Algorithm/" style="font-size: 15px;">Algorithm</a> <a href="/tags/Other/" style="font-size: 15px;">Other</a> <a href="/tags/AOSP/" style="font-size: 15px;">AOSP</a> <a href="/tags/VPS/" style="font-size: 15px;">VPS</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> Recent</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2018/09/03/targetSdkVersion 杂/">targetSdkVersion 杂谈</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/09/03/从阿里云服务器到个人博客/">从阿里云服务器到个人博客</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/09/01/博客系统迁移记录/">博客系统迁移记录</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/09/01/记一次混淆问题导致的 bug/">记一次混淆问题导致的 bug</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/09/01/记一个简单的递归问题与解法/">记一个简单的递归问题与解法</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/09/01/日常修 Bug/">日常修 Bug</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/09/01/提高开发效率的各种工具/">提高开发效率的各种工具</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/09/01/修车小能手上线/">修车小能手上线</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/09/01/从 Android 中 Message 的 obj 无法跨进程传送自定义 Parcelable 说起/">从 Android 中 Message 的 obj 无法跨进程传送自定义 Parcelable 说起</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/09/01/Python 也能玩跳一跳小游戏/">Python 也能玩跳一跳小游戏</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-comment-o"> Recent Comments</i></div><script type="text/javascript" src="//liu-tao.disqus.com/recent_comments_widget.js?num_items=5&amp;hide_avatars=1&amp;avatar_size=32&amp;excerpt_length=20&amp;hide_mods=1"></script></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2018 <a href="/." rel="nofollow">Liu Tao.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/3.3.5/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/3.3.5/jquery.fancybox.min.css"><script type="text/javascript" src="/js/search.js?v=0.0.0"></script><script>var search_path = 'search.xml';
if (search_path.length == 0) {
   search_path = 'search.xml';
}
var path = '/' + search_path;
searchFunc(path, 'local-search-input', 'local-search-result');
</script><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>