<!DOCTYPE html><html lang="en"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="A blog of Liu Tao"><title>给三星 tablet SM-T830 刷机 | Liu Tao</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/8.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">给三星 tablet SM-T830 刷机</h1><a id="logo" href="/.">Liu Tao</a><p class="description">A little older, a little wiser, but happy to see you.</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> Home</i></a><a href="/archives/"><i class="fa fa-archive"> Archive</i></a><a href="/about/"><i class="fa fa-user"> About</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">给三星 tablet SM-T830 刷机</h1><div class="post-meta">Jul 10, 2019</div><a class="disqus-comment-count" data-disqus-identifier="2019/07/10/Flash stock firmware in SM-T830/" href="/2019/07/10/Flash stock firmware in SM-T830/#disqus_thread"></a><div class="post-content"><h4 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h4><p>前天公司发给我一部三星 tablet 作为测试机，是 Tab S4 wifi 版，具体型号是 SM-T830，虽然不是我期待的 Pixel 3 XL，但是配置也还不错，加上屏幕也比较大。但是坑就坑在，这是一部国行的机器，没有 Google Mobile Service (GMS) 不说，还充斥了不少国内生态的杂物，比如系统设置中的 device storage 界面，居然写着「powered by 360」，还有一些预装的国内应用。</p>
<p>这时摆在我前面的有三种方法：第一，刷机刷入一个原生 Android 系统，这当然是最完美的；第二，找一个三星官方的但是是国外版的系统刷入，这种系统会有 GMS；第三，自己把确实的 Google 服务安装上去，凑活着用。</p>
<p>以上第一种方法，我在网上查了查，几乎不可能，因为这个 机型比较小众，网上根本没有给它刷原生系统的方法，就连 <a href="https://lineageos.org/" target="_blank" rel="noopener">LineageOS</a> 也没有支持这个机型。第二种方法，是比较可行的，这款 tablet 即使小众，也是在全球销售的，国外绝大部分地区销售的都是带有 GMS 的，此外这是个 WiFi 版机型，也不用担心运营商和网络制式的问题，所以刷成功的话，虽不是原生 Android，但也有完整可靠的 GMS 全件套。第三种方法，改动最小，但是也可能有后遗症，因为这样自行补充安装 Google service 的方式有可能是不完备可靠的，指不定啥时候就出点 bug。</p>
<p>所以我就开始实施第二种方法：刷入三星官方固件的国外版本，最后这件事折腾了我一天多。</p>
<h4 id="下载-错误的-固件包"><a href="#下载-错误的-固件包" class="headerlink" title="下载 (错误的) 固件包"></a>下载 (错误的) 固件包</h4><p>首先是获取固件包，在网上找了一通，找到了 xda 上的<a href="https://forum.xda-developers.com/galaxy-tab-s4/how-to/sm-t830-t830xxu1arh1-t3831918" target="_blank" rel="noopener">这个帖子</a>，里面贴出了存放在 Google drive 的适用于 SM-T830 的两个官方固件的链接，一个是法国版，另一个是阿拉伯联合酋长国版。帖子的作者还说，他对刷机可能出现的后果不负任何责任，提供这两个包只是让大家免收一些网站要收费才能下载固件包或者是付费才能提速下载的恶心。话说，SM-T830 的小众，从我搜遍 xda 也没找到几个和它相关的帖子即可略见一斑。</p>
<p>固件包大小约是 3.6 GB，起先我从浏览器直接下载 Google drive 上的固件包，网速很慢只有 100KB/S 的样子，下了挺久最后都失败了。后面我发现，先把固件添加到我自己的 Google drive 空间，然后在手机上的 Google drive 应用中下载，配合公司的网络环境，速度可以很快，差不多半个小时就下载好了。</p>
<h4 id="企图用虚拟机，失败"><a href="#企图用虚拟机，失败" class="headerlink" title="企图用虚拟机，失败"></a>企图用虚拟机，失败</h4><p>三星的内部刷机工具 odin，只能用 Windows 运行，我手里只有 Mac，所以我一开始希望用 virtual box 中的 win10 虚拟机来操作。我从硬盘里面把很久前备份的 win10 的 virtual disk image (也就是一个 .vdi 文件) 拷贝到电脑，然后以此新建一个虚拟机，成功的运行，但是鼓捣了半天，也无法让这个虚拟机连接 USB 设备，别说这台 tablet 不行，连 U 盘都不行。VirtualBox VM Extension Pack 安装了，在 win10 里面也安装了 Guest Additions，USB device filters 也配置了，就是不行，只能放弃，找同事借用 Windows 台式机。</p>
<p><strong>2019年1月1日更新</strong>：我后面 VirtualBox 装 Windows 虚拟机是可以连接到 Android 设备的，并且可以刷机，见<a href="https://tao93.top/2019/01/01/%E7%BB%99%E4%B8%89%E6%98%9F%20tablet%20SM-T830%20%E5%88%B7%E6%9C%BA[%E7%BB%AD]/">给三星 tablet SM-T830 刷机[续]</a> 的最后一部分</p>
<h4 id="失败的刷机"><a href="#失败的刷机" class="headerlink" title="失败的刷机"></a>失败的刷机</h4><p>在同事的台式机上操作之前，我在网上已经看了一段讲解刷机过程的视频，感觉挺简单的，就几个步骤而已。等到开始在 Windows 上面开始弄，我把固件包解压，然后用 odin 开始，这才发现那个视频其实过时了，视频中固件包解压后只有一个文件，但是我解压后其实有 4 个文件。其实这一点 Odin 中都已经提示了，new model 需要 4 个文件：</p>
<p><img src="http://tao93.top/images/2018/12/08/1544280785.png" alt=""></p>
<p>所以我的固件包是比较新的，所以有多个文件，但是仔细对比发现有点问题，odin 需要的是 BL, AP, CP, HOME_CSC 4 部分，但是我的固件包解压后 4 个文件的文件名是如下所示 (文件我已经删掉了，所以没法贴出完整文件名)：</p>
<blockquote>
<p>BL…<br>AP…<br>CSC…<br>HOME_CSC…</p>
</blockquote>
<p>相当于没有 CP 开头的，反而似乎有两个 CSC 的，这时我也没夺多管，依次点击 odin 中的 BL, AP, CP, CSC 四个安装，然后把 4 个文件都添加进去，然后就点 start 了，然后就失败了。于是我把 CP 和 CSC 需要的文件调换了一下，还是失败。</p>
<p>这时候我就查了一下为啥少了 CP 开头的文件，这才发现，原来 WiFi 版就是没有 CP 文件，这是和基带相关的，只有可插卡上网的版本才有。顺便也发现了我的 CSC… 和 HOME_CSC… 两个文件的区别，据说前者是彻底清空数据，后者会保留用户数据，所以这两个文件其实作用是类似的，其实我也注意到它们大小也非常相近，都是 180MB 左右。</p>
<p>于是我就空出 CP 那里不添加文件，其余 3 个添加上，然后 start，结果左边文本框停留在 ‘setupconnection..’，我一查，发现很多说卡在这一步的，纷纷在求 help。没办法我就只能继续查，有说要先运行 odin 后连接 USB 数据线的(试了不行)。查了一阵，终于查到一个看起来比较靠谱的<a href="https://forum.xda-developers.com/sprint-galaxy-s6/help/odin-stuck-setupconnection-t3574320" target="_blank" rel="noopener">方法</a>，依然是 xda 论坛上的：</p>
<p><img src="http://tao93.top/images/2018/12/08/1544281510.png" alt=""></p>
<p>我按照上面说的一步一步走，依然失败，但是没再卡在 setupconnection 了。我总结发现，odin 应该确实有 bug，明明设备连接正常，它就是卡在这一步，这时候可以这么做：1. 重新启动设备，1. 断开 USB 连接，3. 进入 downloading mode，4. 连接 USB 然后再在 odin 中 start，就不会卡在那一步了。</p>
<p>进入 Download 模式的方法：先关机，然后同时按住 Volumn Up 和 Power 键，等屏幕亮后立即松手，此时会进入 Recovery mode (三星自己的 recovery 或者第三方 recovery 比如 TWRP)。如果是三星的 recovery，选择 boot to bootloader 即可，如果是 TWRP，选择进入 Download 模式即可。</p>
<p>回到刚刚说的，虽然没卡在 setupconnection 了，但是依然失败，提示大概是：</p>
<blockquote>
<p><id:0 004=""> abl.elf</id:0></p>
<p><id:0 004=""> FAIL! (Auth)</id:0></p>
<id:0 004="">

<p><id:0 004=""> Complete(Write) operation failed.</id:0></p>
<p><osm> All threads completed. (succeed 0 / failed 1)</osm></p>
</id:0></blockquote>
<p>以 abl.elf 为关键字又是一番在网上搜索，最后发现<a href="http://bbs.gfan.com/android-9245022-1-1.html" target="_blank" rel="noopener">这个帖子有</a>人遇到这个问题最后解决了：</p>
<p><img src="http://tao93.top/images/2018/12/08/1544281993.png" alt=""></p>
<p>起初我对「固件版本落后于现有版本」这句话不以为然，因为我觉得这不就意味着只能升级不能降级嘛，不科学。但后面我忽然想到，这句话意思可能是刷机不能刷那些版本比设备出厂时系统版本还更旧的固件，就上这个人确实解决了问题，并且我前面下的固件包都是 2018 年 8 月份的，确实有点旧，所以我开始想怎么下最新的用于 SM-T830 的固件。</p>
<h4 id="下载最新的固件包"><a href="#下载最新的固件包" class="headerlink" title="下载最新的固件包"></a>下载最新的固件包</h4><p>这时，就又回到开始找固件包的步骤了，网上满是假链接，或者是要注册，要交费的，找得人心累。不过，最后竟然找到一个叫 SamFirm tool 的神器，这个神器可以直接高速下载想要的最新固件，简直不能更棒。如下图所示，输入系统型号，然后选择 auto 模式来查找，就能找到最新的固件，并且下载速度还很快！<a href="https://forum.xda-developers.com/galaxy-tab-s/general/tool-samfirm-samsung-firmware-t2988647" target="_blank" rel="noopener">这个帖子</a>可以下载到这个神器。</p>
<p><img src="http://tao93.top/images/2018/12/08/1544283275.png" alt=""></p>
<p>如上图所示，准确地填入型号，填入要下载的固件的国家或地区代号（这里我要填的就是某个外国或国外地区，这样固件包才会有 GMS）。这个国家或地区代号可以从<a href="https://www.sammobile.com/firmwares/galaxy-tab-s4/SM-T830/" target="_blank" rel="noopener">这里</a>找到，我在上一张图中填入的是 XEF，其实就是代表法国。填好后勾选 Auto，然后点击 Check Update，即可检查到最新固件包的信息，我在今天（2018年12月8日）检查到的 SM-T830 的法国版最新固件包如上图箭头所示，是 2018年10月24日更新的。然后就可以在 SamFirm 右边点下载了。建议勾选 Decrypt automatically，否则 下载好固件包后还需要重新解密，费时间。</p>
<p>国家或地区代号截图：</p>
<p><img src="http://tao93.top/images/2018/12/08/1544283882.png" alt=""></p>
<h4 id="成功刷机"><a href="#成功刷机" class="headerlink" title="成功刷机"></a>成功刷机</h4><p>下载到最新固件后，解压，然后用 odin 依次填入 BL AP CSC 三个地方的文件，点 start，继续卡在 setupconnection，按照我之前的总结跳过这个 setupconnection，然后真正开始刷机，大概 10 分钟不到就刷好了。</p>
<h4 id="写在最后"><a href="#写在最后" class="headerlink" title="写在最后"></a>写在最后</h4><p>刷个机遇到的坑还真是挺多，把这些记录下来，说不定以后公司的国行设备需要刷机，这些记录就能派上用场了。</p>
</div><div class="tags"><a href="/tags/Android/">Android</a><a href="/tags/Firmware/">Firmware</a><a href="/tags/Samsung/">Samsung</a></div><div class="post-nav"><a class="pre" href="/2019/08/09/macOS 效率/">5 分钟提高 macOS 使用效率</a><a class="next" href="/2019/07/05/再次将 hexo blog 放置到 Github Pages/">再次将 hexo blog 放置到 Github Pages</a></div><div id="disqus_thread"><div class="btn_click_load"><button class="disqus_click_btn">阅读评论（请确保 Disqus 可以正常加载）</button></div><script type="text/javascript">var disqus_config = function () {
    this.page.url = 'https://tao93.top/2019/07/10/Flash stock firmware in SM-T830/';
    this.page.identifier = '2019/07/10/Flash stock firmware in SM-T830/';
    this.page.title = '给三星 tablet SM-T830 刷机';
  };</script><script type="text/javascript" id="disqus-lazy-load-script">$.ajax({
url: 'https://disqus.com/next/config.json',
timeout: 2500,
type: 'GET',
success: function(){
  var d = document;
  var s = d.createElement('script');
  s.src = '//liu-tao.disqus.com/embed.js';
  s.setAttribute('data-timestamp', + new Date());
  (d.head || d.body).appendChild(s);
  $('.disqus_click_btn').css('display', 'none');
},
error: function() {
  $('.disqus_click_btn').css('display', 'block');
}
});</script><script type="text/javascript" id="disqus-click-load">$('.btn_click_load').click(() => {  //click to load comments
    (() => { // DON'T EDIT BELOW THIS LINE
        var d = document;
        var s = d.createElement('script');
        s.src = '//liu-tao.disqus.com/embed.js';
        s.setAttribute('data-timestamp', + new Date());
        (d.head || d.body).appendChild(s);
    })();
    $('.disqus_click_btn').css('display','none');
});</script><script type="text/javascript" id="disqus-count-script">$(function() {
     var xhr = new XMLHttpRequest();
     xhr.open('GET', '//disqus.com/next/config.json', true);
     xhr.timeout = 2500;
     xhr.onreadystatechange = function () {
       if (xhr.readyState === 4 && xhr.status === 200) {
         $('.post-meta .post-comments-count').show();
         var s = document.createElement('script');
         s.id = 'dsq-count-scr';
         s.src = 'https://liu-tao.disqus.com/count.js';
         s.async = true;
         (document.head || document.body).appendChild(s);
       }
     };
     xhr.ontimeout = function () { xhr.abort(); };
     xhr.send(null);
   });
</script></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><div class="search-form"><input id="local-search-input" placeholder="Search" type="text" name="q" results="0"/><div id="local-search-result"></div></div></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> Tags</i></div><div class="tagcloud"><a href="/tags/Algorithm/" style="font-size: 15px;">Algorithm</a> <a href="/tags/Android/" style="font-size: 15px;">Android</a> <a href="/tags/Shell/" style="font-size: 15px;">Shell</a> <a href="/tags/macOS/" style="font-size: 15px;">macOS</a> <a href="/tags/MySQL/" style="font-size: 15px;">MySQL</a> <a href="/tags/Python/" style="font-size: 15px;">Python</a> <a href="/tags/Linux/" style="font-size: 15px;">Linux</a> <a href="/tags/AOSP/" style="font-size: 15px;">AOSP</a> <a href="/tags/swift/" style="font-size: 15px;">swift</a> <a href="/tags/Other/" style="font-size: 15px;">Other</a> <a href="/tags/Bash/" style="font-size: 15px;">Bash</a> <a href="/tags/ShadowSocks/" style="font-size: 15px;">ShadowSocks</a> <a href="/tags/Homebrew/" style="font-size: 15px;">Homebrew</a> <a href="/tags/adb/" style="font-size: 15px;">adb</a> <a href="/tags/VPS/" style="font-size: 15px;">VPS</a> <a href="/tags/Firmware/" style="font-size: 15px;">Firmware</a> <a href="/tags/Samsung/" style="font-size: 15px;">Samsung</a> <a href="/tags/Java/" style="font-size: 15px;">Java</a> <a href="/tags/GSI/" style="font-size: 15px;">GSI</a> <a href="/tags/Project-Treble/" style="font-size: 15px;">Project Treble</a> <a href="/tags/Hexo-Blog/" style="font-size: 15px;">Hexo Blog</a> <a href="/tags/Kotlin/" style="font-size: 15px;">Kotlin</a> <a href="/tags/Math/" style="font-size: 15px;">Math</a> <a href="/tags/Cryptography/" style="font-size: 15px;">Cryptography</a> <a href="/tags/TLS/" style="font-size: 15px;">TLS</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> Recent</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2020/05/16/Android 中使用 SVG 简介/">Android 中使用 SVG 简介</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/03/30/Secure communication basics/">Network security basics</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/01/04/Elliptic curve group/">Elliptic curve cryptography basics</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/11/04/Kotlin Summary/">Kotlin Summary</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/08/09/macOS 效率/">5 分钟提高 macOS 使用效率</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/07/10/Flash stock firmware in SM-T830/">给三星 tablet SM-T830 刷机</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/07/05/再次将 hexo blog 放置到 Github Pages/">再次将 hexo blog 放置到 Github Pages</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/04/07/Android 自定义简易 PickerView/">Android 自定义简易 PickerView</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/01/18/一个不一样的 ANR/">一个不一样的 ANR</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/01/12/Android 绘制圆形图片/">Android 绘制圆形图片</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-comment-o"> Recent Comments</i></div><script type="text/javascript" src="//liu-tao.disqus.com/recent_comments_widget.js?num_items=5&amp;hide_avatars=1&amp;avatar_size=32&amp;excerpt_length=20&amp;hide_mods=1"></script></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2020 <a href="/." rel="nofollow">Liu Tao.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/3.3.5/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/3.3.5/jquery.fancybox.min.css"><script type="text/javascript" src="/js/search.js?v=0.0.0"></script><script>var search_path = 'search.xml';
if (search_path.length == 0) {
   search_path = 'search.xml';
}
var path = '/' + search_path;
searchFunc(path, 'local-search-input', 'local-search-result');
</script><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>