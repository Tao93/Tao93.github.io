<!DOCTYPE html><html lang="en"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="A blog of Liu Tao"><title>Kotlin Summary | Liu Tao</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/8.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">Kotlin Summary</h1><a id="logo" href="/.">Liu Tao</a><p class="description">A little older, a little wiser, but happy to see you.</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> Home</i></a><a href="/archives/"><i class="fa fa-archive"> Archive</i></a><a href="/about/"><i class="fa fa-user"> About</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">Kotlin Summary</h1><div class="post-meta">Nov 4, 2019</div><a class="disqus-comment-count" data-disqus-identifier="2019/11/04/Kotlin Summary/" href="/2019/11/04/Kotlin Summary/#disqus_thread"></a><div class="post-content"><h3 id="Table-of-Contents"><a href="#Table-of-Contents" class="headerlink" title="Table of Contents"></a>Table of Contents</h3><ol>
<li><a href="#before-all">Before all</a></li>
<li><a href="#types">Types</a></li>
<li><a href="#conditionals">Conditionals</a></li>
<li><a href="#functions">Functions</a></li>
<li><a href="#anonymous-functions">Anonymous functions</a></li>
<li><a href="#null-safety-and-exceptions">Null Safety and Exceptions</a></li>
<li><a href="#collections">Collections</a></li>
<li><a href="#class-definition">Class definition</a></li>
<li><a href="#object-initialization">Object initialization</a></li>
<li><a href="#inheritance">Inheritance</a></li>
<li><a href="#objects">Objects</a></li>
<li><a href="#generics">Generics</a></li>
<li><a href="#extensions">Extensions</a></li>
<li><a href="#java-interoperability">Java Interoperability</a></li>
<li><a href="#coroutines">Corutines</a></li>
<li><a href="#functional-programming-basics">Functional Programming Basics</a></li>
<li><a href="#references">References</a></li>
</ol>
<h3 id="1-Before-all"><a href="#1-Before-all" class="headerlink" title="1. Before all "></a>1. Before all <a name="before-all"></a></h3><h4 id="Whatâ€™s-Kotlin"><a href="#Whatâ€™s-Kotlin" class="headerlink" title="Whatâ€™s Kotlin"></a>Whatâ€™s Kotlin</h4><ol>
<li>By Jetbrains which created Intellij IDEA</li>
<li>Targeting JVM and more, interoperatable with Java</li>
<li>Concise and safe, with many modern features</li>
</ol>
<h4 id="the-REPL-read-evaluate-print-loop"><a href="#the-REPL-read-evaluate-print-loop" class="headerlink" title="the REPL(read, evaluate, print, loop)"></a>the REPL(read, evaluate, print, loop)</h4><p>Install Kotlin commandline tools in macOS:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install kotlin</span><br></pre></td></tr></table></figure>
<p>Execute <code>kotlinc</code> to start REPL</p>
<p><img src="http://tao93.top/images/2019/11/05/1572994981.png" alt=""></p>
<h3 id="2-Types"><a href="#2-Types" class="headerlink" title="2. Types "></a>2. Types <a name="types"></a></h3><h4 id="Built-in-types"><a href="#Built-in-types" class="headerlink" title="Built-in types"></a>Built-in types</h4><p><code>String, Char, Boolean, Int, Double, List&lt;T&gt;, Set&lt;T&gt;, Map&lt;K, V&gt;, Array&lt;T&gt;</code></p>
<p>Not like Java, Kotlin has no primitives (int, float etc.) hence avoids the boxing between primitives and objects. </p>
<p>However, in byte code generated by Kotlin, primitives are used to improve performance.</p>
<h3 id="3-Conditionals"><a href="#3-Conditionals" class="headerlink" title="3. Conditionals "></a>3. Conditionals <a name="conditionals"></a></h3><h4 id="Conditional-operators"><a href="#Conditional-operators" class="headerlink" title="Conditional operators"></a>Conditional operators</h4><div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">Operator</th>
<th style="text-align:center">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">&lt;</td>
<td style="text-align:center">Evaluates whether the value on the left is less than the value on the right.</td>
</tr>
<tr>
<td style="text-align:center">&lt;=</td>
<td style="text-align:center">Evaluates whether the value on the left is less than or equal to the value on the right.</td>
</tr>
<tr>
<td style="text-align:center">&gt;</td>
<td style="text-align:center">Evaluates whether the value on the left is greater than the value on the right.</td>
</tr>
<tr>
<td style="text-align:center">&gt;=</td>
<td style="text-align:center">Evaluates whether the value on the left is greater than or equal to the value on the right.</td>
</tr>
<tr>
<td style="text-align:center">==</td>
<td style="text-align:center">Evaluates whether the value on the left is equal to the value on the right (like equals in Java).</td>
</tr>
<tr>
<td style="text-align:center">!=</td>
<td style="text-align:center">Evaluates whether the value on the left is not equal to the value on the right.</td>
</tr>
<tr>
<td style="text-align:center">===</td>
<td style="text-align:center">Evaluates whether the two instances point to the same reference (like == in Java).</td>
</tr>
<tr>
<td style="text-align:center">!==</td>
<td style="text-align:center">Evaluates whether the two instances do not point to the same reference.</td>
</tr>
</tbody>
</table>
</div>
<h3 id="4-Functions"><a href="#4-Functions" class="headerlink" title="4. Functions "></a>4. Functions <a name="functions"></a></h3><h4 id="Kotlin-supports-file-level-functions"><a href="#Kotlin-supports-file-level-functions" class="headerlink" title="Kotlin supports file level functions"></a>Kotlin supports file level functions</h4><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    println(fileLevelFunc())</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">fileLevelFunc</span><span class="params">()</span></span> = <span class="string">"file level"</span> <span class="comment">// expression function</span></span><br></pre></td></tr></table></figure>
<h4 id="Default-value-of-parameters"><a href="#Default-value-of-parameters" class="headerlink" title="Default value of parameters"></a>Default value of parameters</h4><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    greeting(<span class="string">"Earth"</span>) <span class="comment">// default value for 2nd parameter</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">greeting</span><span class="params">(name: <span class="type">String</span>, greeting: <span class="type">String</span> = <span class="string">"good morning"</span>)</span></span> &#123;</span><br><span class="line">    println(<span class="string">"<span class="subst">$&#123;greeting.capitalize()&#125;</span>! <span class="variable">$name</span>."</span>) <span class="comment">// e.g. Good morning! Saturn.</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Named-function-parameters"><a href="#Named-function-parameters" class="headerlink" title="Named function parameters"></a>Named function parameters</h4><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    greeting(greeting = <span class="string">"Hello"</span>, name = <span class="string">"Earth"</span>) <span class="comment">// named parameters</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">greeting</span><span class="params">(name: <span class="type">String</span>, greeting: <span class="type">String</span> = <span class="string">"good morning"</span>)</span></span> &#123;</span><br><span class="line">    println(<span class="string">"<span class="subst">$&#123;greeting.capitalize()&#125;</span>! <span class="variable">$name</span>."</span>) <span class="comment">// e.g. Good morning! Saturn.</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Function-names-in-backticks"><a href="#Function-names-in-backticks" class="headerlink" title="Function names in backticks"></a>Function names in backticks</h4><p>Itâ€™s said this is useful to call Java methods whose names are reserved words in Kotlin, or to name some special methods.</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> `ðŸ˜‚`<span class="params">()</span></span> &#123; &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    `ðŸ˜‚`() <span class="comment">// call a function</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Inline-functions"><a href="#Inline-functions" class="headerlink" title="Inline functions"></a>Inline functions</h4><p>Kotlin support inline functions, which is good for performance.</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">inline</span> <span class="function"><span class="keyword">fun</span> <span class="title">factorial</span><span class="params">(n: <span class="type">Int</span>)</span></span>: <span class="built_in">Int</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">if</span> (n &gt; <span class="number">2</span>) &#123;</span><br><span class="line">        n * factorial(n - <span class="number">1</span>)  <span class="comment">// wrong, no recursion inside inline functions</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        n</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="5-Anonymous-functions"><a href="#5-Anonymous-functions" class="headerlink" title="5. Anonymous functions "></a>5. Anonymous functions <a name="anonymous-functions"></a></h3><p>The complete structure of an anoymous function should be like:</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> funcVariable: (ParamType1, ParamType2) -&gt; ReturnType = </span><br><span class="line">&#123; param1: ParamType1, param2: ParamType2 -&gt;</span><br><span class="line">	...</span><br><span class="line">	expr_to_be_returned <span class="comment">// no return keyword, only the returned expression</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>An example of anoymous function:</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> numLetters = <span class="string">"Mississippi"</span>.count(&#123; letter -&gt;</span><br><span class="line">    letter == <span class="string">'s'</span></span><br><span class="line">&#125;)</span><br><span class="line">print(numLetters) <span class="comment">// would Prints 4</span></span><br></pre></td></tr></table></figure>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Returns the number of characters matching the given [predicate].</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">inline</span> <span class="function"><span class="keyword">fun</span> CharSequence.<span class="title">count</span><span class="params">(predicate: (<span class="type">Char</span>)</span></span> -&gt; <span class="built_in">Boolean</span>): <span class="built_in">Int</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> count = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> (element <span class="keyword">in</span> <span class="keyword">this</span>) <span class="keyword">if</span> (predicate(element)) ++count</span><br><span class="line">    <span class="keyword">return</span> count</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Parameter types are usually omitted when they caould be inferred. Single parameterâ€™s name could be omitted if its type could ba inferred, and we take <code>it</code> as the parameter name. Unused parameter name could be marked as <strong><code>_</code></strong>.</p>
<p>Examples:</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> numLetters = <span class="string">"Mississippi"</span>.count(&#123;</span><br><span class="line">    it == <span class="string">'s'</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">val</span> afterFilter = <span class="string">"Mississippi"</span>.filterIndexed(&#123; _, char-&gt;</span><br><span class="line">    char != <span class="string">'s'</span></span><br><span class="line">&#125;)</span><br><span class="line">print(afterFilter) <span class="comment">// prints Miiippi</span></span><br></pre></td></tr></table></figure>
<p><strong><em>Note</em></strong>: an anonymous function must be called immediately, assigned to a variable, or be passed as a parameter.</p>
<p>Anonymous functions as parameter is often in a different style when it is required as the <strong>last</strong> parameter in another function:</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// count starting from a specified index.</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">count</span><span class="params">(str: <span class="type">String</span>, startIdx: <span class="type">Int</span>, predicate: (<span class="type">Char</span>)</span></span> -&gt; <span class="built_in">Boolean</span>): <span class="built_in">Int</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> str.substring(startIdx).count(predicate)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// style 1</span></span><br><span class="line">count(<span class="string">"Mississippi"</span>, <span class="number">5</span>, &#123;</span><br><span class="line">    it == <span class="string">'s'</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// style 2, looks like definition of count, </span></span><br><span class="line"><span class="comment">// but actually it's anonymous function as parameter</span></span><br><span class="line">count(<span class="string">"Mississippi"</span>, <span class="number">5</span>) &#123;</span><br><span class="line">    it == <span class="string">'s'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Want to declare a function type that returns something like <code>void</code> in Java? You need the <code>Unit</code>.</p>
<p>You can also refer a non anonymous function as parameter in call to another function by using <code>::</code>. But I donâ€™t think this is common.</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">isS</span><span class="params">(char: <span class="type">Char</span>)</span></span>: <span class="built_in">Boolean</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> char == <span class="string">'s'</span></span><br><span class="line">&#125;</span><br><span class="line">    </span><br><span class="line"><span class="keyword">val</span> numLetters = <span class="string">"Mississippi"</span>.count(::isS)</span><br></pre></td></tr></table></figure>
<h3 id="6-Null-Safety-and-Exceptions"><a href="#6-Null-Safety-and-Exceptions" class="headerlink" title="6. Null Safety and Exceptions "></a>6. Null Safety and Exceptions <a name="null-safety-and-exceptions"></a></h3><p>For nullable variables, there are some common solutions to handle potential null pointer exceptions.</p>
<p><strong>Safe call operator</strong>:</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> beverage = readLine()?.capitalize() <span class="comment">// the beverage would be String?.</span></span><br></pre></td></tr></table></figure>
<p><strong>Nonnull assertion</strong>:</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> beverage = readLine()!!.capitalize() <span class="comment">// only if you're really confident</span></span><br></pre></td></tr></table></figure>
<p><strong>Check before use</strong>:</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> result = readLine()</span><br><span class="line"><span class="keyword">var</span> beverage = <span class="keyword">if</span> (result != <span class="literal">null</span>) &#123; <span class="comment">// type of beverage would be String.</span></span><br><span class="line">    result.capitalize() + result.toLowerCase()</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="string">""</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>However, check before use isnâ€™t always safe, e.g. a field of an object might be assigned null by another thread between your null checking and usage of the field. For such case, you would need a local variable to get rid of this risk:</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> localVar = a.b</span><br><span class="line"><span class="keyword">if</span> (localVar != <span class="literal">null</span>) &#123;</span><br><span class="line">    <span class="comment">// do something refers localVar</span></span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>Elvis operator</strong>:</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> beverage = readLine()?.capitalize() ?: <span class="string">""</span>  <span class="comment">// beverage would be String.</span></span><br></pre></td></tr></table></figure>
<h4 id="Exceptions-in-Kotlin"><a href="#Exceptions-in-Kotlin" class="headerlink" title="Exceptions in Kotlin"></a>Exceptions in Kotlin</h4><p>Kotlin doesnâ€™t require handling of those checked Exceptions of Java. Therefore you can do IO operations without try-catch and exception declaration in the method signature.</p>
<h3 id="7-Collections"><a href="#7-Collections" class="headerlink" title="7. Collections "></a>7. Collections <a name="collections"></a></h3><h4 id="destructuring"><a href="#destructuring" class="headerlink" title="destructuring"></a>destructuring</h4><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> (type, name, price) = aList  <span class="comment">// fetch the leading 3 elements from a list.</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">val</span> (type, _, price) = aList <span class="comment">// skip elements in specified indexes.</span></span><br></pre></td></tr></table></figure>
<h4 id="protection-of-immutable-list-is-not-valid-at-runtime"><a href="#protection-of-immutable-list-is-not-valid-at-runtime" class="headerlink" title="protection of immutable list is not valid at runtime"></a>protection of immutable list is not valid at runtime</h4><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> a = listOf(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line">(a <span class="keyword">as</span> MutableList&lt;<span class="built_in">Int</span>&gt;).<span class="keyword">set</span>(<span class="number">0</span>, <span class="number">100</span>)</span><br><span class="line">println(a) <span class="comment">// would print [100, 2, 3]</span></span><br></pre></td></tr></table></figure>
<h3 id="8-Class-definition"><a href="#8-Class-definition" class="headerlink" title="8. Class definition "></a>8. Class definition <a name="class-definition"></a></h3><h4 id="Visibility-modifiers-of-class-members"><a href="#Visibility-modifiers-of-class-members" class="headerlink" title="Visibility modifiers of class members"></a>Visibility modifiers of class members</h4><div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">Modifier</th>
<th style="text-align:center">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">public (default)</td>
<td style="text-align:center">The function or property will be accessible by code outside of the class. By default, functions and properties without a visibility modifier are public.</td>
</tr>
<tr>
<td style="text-align:center">private</td>
<td style="text-align:center">The function or property will be accessible only within the same class.</td>
</tr>
<tr>
<td style="text-align:center">protected</td>
<td style="text-align:center">The function or property will be accessible only within the same class or its subclass.</td>
</tr>
<tr>
<td style="text-align:center">internal</td>
<td style="text-align:center">The function or property will be accessible within the same module.</td>
</tr>
</tbody>
</table>
</div>
<h4 id="Class-fields"><a href="#Class-fields" class="headerlink" title="Class fields"></a>Class fields</h4><p>For class fields, default <code>getter</code> is available for <code>val</code> and <code>var</code> fields. But <code>setter</code> is only for <code>var</code> fields. Yet we can override the default <code>setter</code> and <code>getter</code>:</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">X</span></span>(_name: String, _age: <span class="built_in">Int</span>) &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// a field always return capitalized string when you get it</span></span><br><span class="line">    <span class="keyword">val</span> name = _name</span><br><span class="line">        <span class="keyword">get</span>() = field.capitalize()</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// a field only allows increasing</span></span><br><span class="line">    <span class="keyword">var</span> age = _age</span><br><span class="line">        <span class="keyword">set</span>(value) &#123;</span><br><span class="line">            <span class="keyword">if</span> (value &gt; field) &#123;</span><br><span class="line">                field = value</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>You can override the visibility of a setter to make it less permissive then fieldâ€™s visibility. E.g., you want to make a field readable everywhere but only writable in the file:</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">X</span></span>(_age: <span class="built_in">Int</span>) &#123;</span><br><span class="line">    <span class="comment">// a field only allows increasing in current file.</span></span><br><span class="line">    <span class="keyword">var</span> age = _age</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">set</span>(value) &#123;</span><br><span class="line">            <span class="keyword">if</span> (value &gt; field) &#123;</span><br><span class="line">                field = value</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Computed-fields"><a href="#Computed-fields" class="headerlink" title="Computed fields"></a>Computed fields</h4><p>Has getter or/and setter but no real fields to store values.</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dice</span></span>() &#123;</span><br><span class="line">    <span class="keyword">val</span> rolledValue</span><br><span class="line">        <span class="keyword">get</span>() = (<span class="number">1.</span><span class="number">.6</span>).shuffled().first()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="9-Object-initialization"><a href="#9-Object-initialization" class="headerlink" title="9. Object initialization "></a>9. Object initialization <a name="object-initialization"></a></h3><h4 id="The-primary-contructor"><a href="#The-primary-contructor" class="headerlink" title="The primary contructor"></a>The primary contructor</h4><p>Add parameter list inside a pair of parenthesis after the class name, make it looks like a method. For fields <strong>using default getter and setter</strong>, you can declare them inside the parameter list by adding <code>var</code> or <code>val</code>:</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// visibility modifier and default values are also available</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">X</span></span>(<span class="keyword">val</span> name: String, <span class="keyword">private</span> <span class="keyword">var</span> age: <span class="built_in">Int</span> = <span class="number">0</span>)</span><br></pre></td></tr></table></figure>
<h4 id="secondary-constructor"><a href="#secondary-constructor" class="headerlink" title="secondary constructor"></a>secondary constructor</h4><p>Must call the primary constructor or another secondary constructor(of course no cycle call)</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">X</span></span>(<span class="keyword">val</span> name: String, <span class="keyword">private</span> <span class="keyword">var</span> age: <span class="built_in">Int</span> = <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="comment">// call primary constructor with default parameter</span></span><br><span class="line">    <span class="keyword">constructor</span>(): <span class="keyword">this</span>(<span class="string">"Unknown"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Apart from default parameter values, named parameters are also available for constructors.</p>
<h4 id="Lazy-initialization"><a href="#Lazy-initialization" class="headerlink" title="Lazy initialization"></a>Lazy initialization</h4><p>Only initialize a field when itâ€™s accessed (by the getter)</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">X</span> </span>&#123;</span><br><span class="line">    <span class="keyword">val</span> number: <span class="built_in">Int</span> <span class="keyword">by</span> lazy &#123;</span><br><span class="line">        (<span class="number">0</span> until <span class="number">10</span>).shuffled().first() <span class="comment">// not good example</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="10-Inheritance"><a href="#10-Inheritance" class="headerlink" title="10. Inheritance "></a>10. Inheritance <a name="inheritance"></a></h3><p>In Java, we only override methods. But in Kotlin, both class functions and fields could be overridden. Also, in Kotlin, classes, functions and fields must be marked <code>open</code> explicity to make them inheritable or able to be overridden. </p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">open</span> <span class="class"><span class="keyword">class</span> <span class="title">Room</span></span>(<span class="keyword">val</span> name: String) &#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">open</span> <span class="keyword">val</span> dangerLevel = <span class="number">5</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">description</span><span class="params">()</span></span> = <span class="string">"Room: <span class="variable">$name</span>\n"</span> +</span><br><span class="line">            <span class="string">"Danger level: <span class="variable">$dangerLevel</span>"</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">open</span> <span class="function"><span class="keyword">fun</span> <span class="title">load</span><span class="params">()</span></span> = <span class="string">"Nothing much to see here..."</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TownSquare</span> : <span class="type">Room</span></span>(<span class="string">"Town Square"</span>) &#123;</span><br><span class="line">    <span class="keyword">override</span> <span class="keyword">val</span> dangerLevel = <span class="keyword">super</span>.dangerLevel - <span class="number">3</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">load</span><span class="params">()</span></span> = <span class="string">"The villagers cheer as you enter!"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Functions are final by default unless they are inherited from an open class. To prevent inherited functions from being overriden again, we can mark it <code>final</code>.</p>
<p>In Kotlinâ€™s inheritance, we always have:</p>
<p><img src="http://tao93.top/images/2019/11/05/1572968935.png" alt=""></p>
<p>However, when compiled into bytecode, the class Room doesnâ€™t inherits the class Any in JVM rule.</p>
<h3 id="11-Objects"><a href="#11-Objects" class="headerlink" title="11. Objects "></a>11. Objects <a name="objects"></a></h3><h4 id="singleton-by-object-keyword"><a href="#singleton-by-object-keyword" class="headerlink" title="singleton by object keyword"></a>singleton by <code>object</code> keyword</h4><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    UserManager.getUser(<span class="number">2</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// constructors are not allowed for such objects</span></span><br><span class="line"><span class="keyword">object</span> UserManager &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">val</span> users = mutableListOf&lt;String&gt;(<span class="string">"A"</span>, <span class="string">"B"</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">getUser</span><span class="params">(idx: <span class="type">Int</span>)</span></span>: String? &#123;</span><br><span class="line">        <span class="keyword">return</span> users.getOrNull(idx)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Anonymous-inner-class"><a href="#Anonymous-inner-class" class="headerlink" title="Anonymous inner class"></a>Anonymous inner class</h4><p>In java, we often implement interfaces or extend simple classes as anonymous inner class, such as click listeners and view adapters.</p>
<p>In Kotlin, they could be divided into 2 categories. For interfaces with only one method and declared in Java, we can use a format called Lambda:</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">generateButton.setOnClickListener &#123; view -&gt;</span><br><span class="line">    fetchData()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">useI</span><span class="params">(i: <span class="type">I</span>)</span></span> &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">useI(I &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// I.java</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">I</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">f</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>For other cases, the format is like this:</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">listView.adapter = <span class="keyword">object</span> : BaseAdapter() &#123;  <span class="comment">// call the constructor here.</span></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">getView</span><span class="params">(pos: <span class="type">Int</span>, view: <span class="type">View</span>?, parent: <span class="type">ViewGroup</span>?)</span></span>: View &#123;</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">getItem</span><span class="params">(pos: <span class="type">Int</span>)</span></span>: Any &#123;</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">getItemId</span><span class="params">(pos: <span class="type">Int</span>)</span></span>: <span class="built_in">Long</span> &#123;</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">getCount</span><span class="params">()</span></span>: <span class="built_in">Int</span> &#123;</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Nested classes by default cannot access members of the outer class, unless they are marked inner:</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Outer</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">outerFunc</span><span class="params">()</span></span> = <span class="string">"1"</span></span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Nested</span> </span>&#123;</span><br><span class="line">        init &#123;</span><br><span class="line">            outerFunc()  <span class="comment">// wrong, unable to access</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    inner <span class="class"><span class="keyword">class</span> <span class="title">Inner</span> </span>&#123;</span><br><span class="line">        init &#123;</span><br><span class="line">            outerFunc()  <span class="comment">// ok</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">object</span> UserManager &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">val</span> users = mutableListOf&lt;String&gt;(<span class="string">"A"</span>, <span class="string">"B"</span>)</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">        init &#123;</span><br><span class="line">            users <span class="comment">// ok. this is nested class inside an object class.</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Data-classes"><a href="#Data-classes" class="headerlink" title="Data classes"></a>Data classes</h4><p>Data classes are suitable for model, thatâ€™s what the <code>data</code> means.</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">data</span> <span class="class"><span class="keyword">class</span> <span class="title">Coordinate</span></span>(<span class="keyword">var</span> x: <span class="built_in">Int</span>, <span class="keyword">var</span> y: <span class="built_in">Int</span>) &#123;</span><br><span class="line">    <span class="keyword">val</span> inFirstQuadrant = (x &gt;<span class="number">0</span> &amp;&amp; y &gt; <span class="number">0</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>when use the data classes:</p>
<ul>
<li><p>Implementation of <code>toString</code>, <code>equal</code> and <code>copy</code> regarding the fields declared in the primary constructor;</p>
</li>
<li><p>Must have a primary constructor whose all parameters are marked with <code>val</code> or <code>var</code>;</p>
</li>
<li><p>Cannot be <code>abstract</code>, <code>open</code>, or <code>inner</code>.</p>
</li>
</ul>
<h4 id="Operator-overloading"><a href="#Operator-overloading" class="headerlink" title="Operator overloading"></a>Operator overloading</h4><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">data</span> <span class="class"><span class="keyword">class</span> <span class="title">Coordinate</span></span>(<span class="keyword">var</span> x: <span class="built_in">Int</span>, <span class="keyword">var</span> y: <span class="built_in">Int</span>) &#123;</span><br><span class="line">    <span class="keyword">operator</span> <span class="function"><span class="keyword">fun</span> <span class="title">plusAssign</span><span class="params">(another: <span class="type">Coordinate</span>)</span></span> &#123;</span><br><span class="line">        x += another.x</span><br><span class="line">        y += another.y</span><br><span class="line">    &#125;	</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">val</span> coo = Coordinate(<span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line">coo += Coordinate(<span class="number">2</span>, <span class="number">3</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">object</span> Fact &#123;</span><br><span class="line">    <span class="keyword">operator</span> <span class="function"><span class="keyword">fun</span> <span class="title">invoke</span><span class="params">(n: <span class="type">Int</span>)</span></span>: <span class="built_in">Int</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">if</span> (n &gt; <span class="number">2</span>)</span><br><span class="line">            n * <span class="keyword">this</span>(n<span class="number">-1</span>)</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            n</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">println(Fact(<span class="number">5</span>))</span><br></pre></td></tr></table></figure>
<h3 id="12-Generics"><a href="#12-Generics" class="headerlink" title="12 Generics "></a>12 Generics <a name="generics"></a></h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">open</span> <span class="class"><span class="keyword">class</span> <span class="title">Book</span></span>(<span class="keyword">val</span> name: String)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Novel</span></span>(name: String): Book(name)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Textbook</span></span>(name: String): Book(name)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Bookshelf</span>&lt;<span class="type">T: Book</span>&gt;</span>(<span class="keyword">vararg</span> <span class="keyword">val</span> books: T)</span><br><span class="line"></span><br><span class="line"><span class="keyword">val</span> shelf1 = Bookshelf(Novel(<span class="string">"A song of Ice &amp; Fire"</span>), </span><br><span class="line">                       Novel(<span class="string">"The load of the rings"</span>))</span><br><span class="line"><span class="keyword">val</span> shelf2 = Bookshelf(Novel(<span class="string">"A song of Ice &amp; Fire"</span>), </span><br><span class="line">                       Textbook(<span class="string">"Introduction to Algorithms"</span>))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="type">&lt;T: CharSequence&gt;</span> <span class="title">count</span><span class="params">(cs: <span class="type">T</span>, startIdx: <span class="type">Int</span>, char: <span class="type">Char</span>)</span></span> =</span><br><span class="line">    cs.substring(startIdx).count &#123;</span><br><span class="line">        it == char</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> list1: List&lt;Book&gt; = listOf&lt;Novel&gt;(Novel(<span class="string">"A"</span>), Novel(<span class="string">"B"</span>))</span><br><span class="line"><span class="comment">// the following line is wrong!</span></span><br><span class="line"><span class="keyword">val</span> list2: MutableList&lt;Book&gt; = mutableListOf&lt;Novel&gt;(Novel(<span class="string">"A"</span>), Novel(<span class="string">"B"</span>))</span><br></pre></td></tr></table></figure>
<p>Actually the <code>List</code> interface is like this:</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">List</span>&lt;<span class="type">out E</span>&gt; : <span class="type">Collection</span>&lt;<span class="type">E</span>&gt; </span>&#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Here <code>out</code> means: any fields of a List whih the generic type <code>E</code> must be <code>val</code>. Thus <code>E</code> is a type only for readable fields.</p>
<p>On the other hand, there is <code>in</code>, which means a generic type is only for writable variables:</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span>&lt;<span class="type">in T</span>&gt; </span>&#123; <span class="comment">// no fields of type T can be available to outside</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">var</span> item: T? = <span class="literal">null</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">setItem</span><span class="params">(newItem: <span class="type">T</span>)</span></span> &#123;</span><br><span class="line">        item = newItem</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">val</span> a: A&lt;Novel&gt; = A&lt;Book&gt;()</span><br></pre></td></tr></table></figure>
<p>The wildcard in Java generics has some similarities with the <code>in</code> and <code>out</code> in Kotlin, but they are not equivalent concepts.</p>
<h3 id="13-Extensions"><a href="#13-Extensions" class="headerlink" title="13. Extensions "></a>13. Extensions <a name="extensions"></a></h3><p>Based on anonymous function and generics, Kotlin brings the extensions, which enable us to extend classes with new functions and fields without inheritance. The Kotlin standard library contains a large numbers of extensions.</p>
<p>The code below</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">count</span><span class="params">(str: <span class="type">String</span>, startIdx: <span class="type">Int</span>, predicate: (<span class="type">Char</span>)</span></span> -&gt; <span class="built_in">Boolean</span>) =</span><br><span class="line">    str.substring(startIdx).count(predicate)</span><br><span class="line">    </span><br><span class="line">count(<span class="string">"Mississippi"</span>, <span class="number">5</span>) &#123;</span><br><span class="line">    it == <span class="string">'s'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>could be refactored as</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// just like we have extended the String class, a final class.</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> String.<span class="title">count</span><span class="params">(startIdx: <span class="type">Int</span>, predicate: (<span class="type">Char</span>)</span></span> -&gt; <span class="built_in">Boolean</span>) =</span><br><span class="line">    substring(startIdx).count(predicate)</span><br><span class="line"></span><br><span class="line"><span class="string">"Mississippi"</span>.count(<span class="number">5</span>) &#123;</span><br><span class="line">    it == <span class="string">'s'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Extend with fields is also available:</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> String.countS</span><br><span class="line">    <span class="keyword">get</span>() = count &#123; it == <span class="string">'s'</span> || it == <span class="string">'S'</span> &#125;</span><br><span class="line"></span><br><span class="line">println(<span class="string">"Mississippi"</span>.countS) <span class="comment">// would print 4</span></span><br></pre></td></tr></table></figure>
<p>Like computed properties, extended fields have no backing fields, actually the extended fields has no essential differences with extended methods.</p>
<p>Visibility modifiers are also valid for the extensions.</p>
<p>Extensions on nullable types:</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="type">&lt;T&gt;</span> T?.<span class="title">chkNull</span><span class="params">(block1: (<span class="type">T</span>)</span></span> -&gt; <span class="built_in">Unit</span>, block2: () -&gt; <span class="built_in">Unit</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span> != <span class="literal">null</span>) &#123; <span class="comment">// for such extension, the this is nullable</span></span><br><span class="line">        block1(<span class="keyword">this</span>)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        block2()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span></span>(<span class="keyword">val</span> x: String? = listOf&lt;String?&gt;(<span class="string">"s"</span>, <span class="literal">null</span>).shuffled().first())</span><br><span class="line"></span><br><span class="line"><span class="keyword">val</span> c = C()</span><br><span class="line">c.x.chkNull(&#123;   <span class="comment">// no need to write c.x?. even that c.x is nullable.</span></span><br><span class="line">    <span class="comment">// it ...</span></span><br><span class="line">&#125;, &#123;</span><br><span class="line"></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>Generics in extensions:</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="type">&lt;T&gt;</span> T.<span class="title">prt</span><span class="params">()</span></span> &#123;</span><br><span class="line">    println(<span class="keyword">this</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">(<span class="number">1</span> + <span class="number">1</span>).prt()</span><br></pre></td></tr></table></figure>
<p>Extensions in Kotlin standard library:</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Calls the specified function [block] with `this` value as its argument </span></span><br><span class="line"><span class="comment"> * and returns its result.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * For detailed usage information see the documentation for [scope functions]</span></span><br><span class="line"><span class="comment"> * (https://kotlinlang.org/docs/reference/scope-functions.html#let).</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@kotlin</span>.<span class="keyword">internal</span>.InlineOnly</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">inline</span> <span class="function"><span class="keyword">fun</span> <span class="type">&lt;T, R&gt;</span> T.<span class="title">let</span><span class="params">(block: (<span class="type">T</span>)</span></span> -&gt; R): R &#123;</span><br><span class="line">    contract &#123;</span><br><span class="line">        callsInPlace(block, InvocationKind.EXACTLY_ONCE)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> block(<span class="keyword">this</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Usage of the <code>let</code>:</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Y</span></span>(<span class="keyword">val</span> pair: Pair&lt;String, String&gt;?)</span><br><span class="line"></span><br><span class="line"><span class="keyword">val</span> y = Y(Pair(<span class="string">"hello"</span>, <span class="string">"world"</span>))</span><br><span class="line"></span><br><span class="line">y.pair?.let &#123;</span><br><span class="line">    println(it.first + <span class="string">" "</span> + it.second)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">val</span> p = y.pair</span><br><span class="line"><span class="keyword">if</span> (p != <span class="literal">null</span>) &#123;</span><br><span class="line">    println(p.first + <span class="string">" "</span> + p.second)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Extension function type:</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> greetings: String.() -&gt; <span class="built_in">Unit</span> = &#123;</span><br><span class="line">    println(<span class="string">"Hello "</span> + <span class="keyword">this</span>.capitalize())</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="string">"Mississippi"</span>.greetings()</span><br></pre></td></tr></table></figure>
<p>Another extension in Kotlin standard library:</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Calls the specified function [block] with `this` value as its receiver </span></span><br><span class="line"><span class="comment"> * and returns its result.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * For detailed usage information see the documentation for [scope functions]</span></span><br><span class="line"><span class="comment"> * (https://kotlinlang.org/docs/reference/scope-functions.html#run).</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@kotlin</span>.<span class="keyword">internal</span>.InlineOnly</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">inline</span> <span class="function"><span class="keyword">fun</span> <span class="type">&lt;T, R&gt;</span> T.<span class="title">run</span><span class="params">(block: <span class="type">T</span>.()</span></span> -&gt; R): R &#123;</span><br><span class="line">    contract &#123;</span><br><span class="line">        callsInPlace(block, InvocationKind.EXACTLY_ONCE)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> block()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">File(<span class="string">"x.txt"</span>).run &#123;</span><br><span class="line">    setReadable(<span class="literal">true</span>)</span><br><span class="line">    setWritable(<span class="literal">true</span>)</span><br><span class="line">    setExecutable(<span class="literal">false</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="14-Java-Interoperability"><a href="#14-Java-Interoperability" class="headerlink" title="14. Java Interoperability "></a>14. Java Interoperability <a name="java-interoperability"></a></h3><h4 id="Nullity"><a href="#Nullity" class="headerlink" title="Nullity"></a>Nullity</h4><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// in java side, mark non-private fields, return type and parameter type</span></span><br><span class="line"><span class="comment">// with annotations, thus helps Kotlin side handle nullity</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">JavaClass</span> </span>&#123;</span><br><span class="line">    <span class="meta">@NotNull</span></span><br><span class="line">    <span class="keyword">public</span> String x = <span class="string">"x"</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Nullable</span></span><br><span class="line">    <span class="keyword">public</span> String f(<span class="meta">@NotNull</span> String y) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Jetbrains created their annotations like this:<br><img src="http://tao93.top/images/2019/11/05/1572992024.png" alt=""></p>
<p>While the annotations by Google is like this:<br><img src="http://tao93.top/images/2019/11/05/1572992106.png" alt=""></p>
<h3 id="File-level-Kotlin-members"><a href="#File-level-Kotlin-members" class="headerlink" title="File level Kotlin members"></a>File level Kotlin members</h3><p>Letâ€™s say we have a kotlin file Hello.kt which is:</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// in Hello.kt file</span></span><br><span class="line"><span class="comment">// by default, the Hello.kt would generate a JVM class as HelloKt, </span></span><br><span class="line"><span class="comment">// but we can change it like the following line.</span></span><br><span class="line"><span class="meta">@file:JvmName</span>(<span class="string">"Hello"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// file level members would be static members in generated JVM class</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">f</span><span class="params">()</span></span> = <span class="string">"hello from kotlin."</span></span><br></pre></td></tr></table></figure>
<h3 id="Kotlin-functions-with-default-parameter-values"><a href="#Kotlin-functions-with-default-parameter-values" class="headerlink" title="Kotlin functions with default parameter values"></a>Kotlin functions with default parameter values</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// add this annotation to make it generates several overloaded JVM methods</span></span><br><span class="line"><span class="meta">@JvmOverloads</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">f</span><span class="params">(name: <span class="type">String</span> = <span class="string">"Unknown"</span>, age: <span class="type">Int</span> = <span class="number">0</span>)</span></span> &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Access-members-of-companion-object-in-Java"><a href="#Access-members-of-companion-object-in-Java" class="headerlink" title="Access members of companion object in Java"></a>Access members of companion object in Java</h4><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">H</span> </span>&#123;</span><br><span class="line">    <span class="keyword">companion</span> <span class="keyword">object</span> &#123;</span><br><span class="line">        <span class="meta">@JvmField</span>  <span class="comment">// then H.x is ok in Java, or we need H.companion.x</span></span><br><span class="line">        <span class="keyword">val</span> x = <span class="number">10</span></span><br><span class="line"></span><br><span class="line">        <span class="meta">@JvmStatic</span>  <span class="comment">// then H.f is ok in Java</span></span><br><span class="line">        <span class="function"><span class="keyword">fun</span> <span class="title">f</span><span class="params">()</span></span>&#123; &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Exceptions"><a href="#Exceptions" class="headerlink" title="Exceptions"></a>Exceptions</h4><p>As we said earlier, Kotlin doesnâ€™t require we to try-catch code blocks which may throw checked Java Exceptions or add a <code>throws</code> declaration in the method signatures. So if a Java method is called with <code>throws</code> declaration is called in kotlin, we might missed the exceptions warning by the Java method.</p>
<p>For Kotlin methods which would be called by Java and might throw checked exceptions, marked it with annotation:</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Throws(IOException::class)</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">f</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">throw</span> FileNotFoundException()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Referred-functions-of-Kotlin"><a href="#Referred-functions-of-Kotlin" class="headerlink" title="Referred functions of Kotlin"></a>Referred functions of Kotlin</h4><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// in Test.kt file</span></span><br><span class="line"><span class="keyword">val</span> translator = &#123; utterance: String -&gt;</span><br><span class="line">    println(utterance.toLowerCase().capitalize())</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JavaClass</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Function1&lt;String, Unit&gt; translator = RoomKt.getTranslator();</span><br><span class="line">        translator.invoke(<span class="string">"MONey"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Whatâ€™s the <code>Function1</code>:</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** A function that takes 1 argument. */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Function1</span>&lt;<span class="type">in P1, out R</span>&gt; : <span class="type">Function</span>&lt;<span class="type">R</span>&gt; </span>&#123;</span><br><span class="line">    <span class="comment">/** Invokes the function with the specified argument. */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">operator</span> <span class="function"><span class="keyword">fun</span> <span class="title">invoke</span><span class="params">(p1: <span class="type">P1</span>)</span></span>: R</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="15-Corutines"><a href="#15-Corutines" class="headerlink" title="15. Corutines "></a>15. Corutines <a name="coroutines"></a></h3><h4 id="what-are-coroutines"><a href="#what-are-coroutines" class="headerlink" title="what are coroutines"></a>what are coroutines</h4><ul>
<li><p>coroutines are more lightweight than threads</p>
</li>
<li><p>a thread can schedule between multiple coroutines</p>
</li>
<li><p>a coroutine can switch between threads</p>
</li>
</ul>
<h3 id="async-amp-launch"><a href="#async-amp-launch" class="headerlink" title="async &amp; launch"></a><code>async</code> &amp; <code>launch</code></h3><p>the most common ways to create coroutines</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">fun</span> CoroutineScope.<span class="title">launch</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">    context: <span class="type">CoroutineContext</span> = EmptyCoroutineContext,</span></span></span><br><span class="line"><span class="function"><span class="params">    start: <span class="type">CoroutineStart</span> = CoroutineStart.DEFAULT,</span></span></span><br><span class="line"><span class="function"><span class="params">    block: <span class="type">suspend</span> <span class="type">CoroutineScope</span>.()</span></span> -&gt; <span class="built_in">Unit</span></span><br><span class="line">): Job</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Job</span> : <span class="type">CoroutineContext.Element &#123;</span></span></span><br><span class="line">    <span class="keyword">public</span> suspend <span class="function"><span class="keyword">fun</span> <span class="title">join</span><span class="params">()</span></span></span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">fun</span> <span class="type">&lt;T&gt;</span> CoroutineScope.<span class="title">async</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">    context: <span class="type">CoroutineContext</span> = EmptyCoroutineContext,</span></span></span><br><span class="line"><span class="function"><span class="params">    start: <span class="type">CoroutineStart</span> = CoroutineStart.DEFAULT,</span></span></span><br><span class="line"><span class="function"><span class="params">    block: <span class="type">suspend</span> <span class="type">CoroutineScope</span>.()</span></span> -&gt; T</span><br><span class="line">): Deferred&lt;T&gt;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Deferred</span>&lt;<span class="type">out T</span>&gt; : <span class="type">Job &#123;</span></span></span><br><span class="line">    <span class="keyword">public</span> suspend <span class="function"><span class="keyword">fun</span> <span class="title">await</span><span class="params">()</span></span>: T</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>Deferred&lt;T&gt;</code> is also a <code>job</code>, only that we can call its <code>await</code> to fetch an result returned by that coroutine. e.g:</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">fetchData</span><span class="params">()</span></span> &#123;</span><br><span class="line">    GlobalScope.launch(Dispatchers.Main) &#123; </span><br><span class="line">        <span class="comment">// type of result: Deferred&lt;CharacterData&gt;</span></span><br><span class="line">        <span class="keyword">val</span> result = GlobalScope.async(Dispatchers.Default) &#123;</span><br><span class="line">            <span class="keyword">val</span> (race, name, dex, wis, str) = URL(</span><br><span class="line">            <span class="string">"https://chargen-api.herokuapp.com/"</span>).readText().split(<span class="string">","</span>)</span><br><span class="line">            CharacterData(race, name, dex, wis, str)</span><br><span class="line">        &#125;</span><br><span class="line">        characterData = result.await()</span><br><span class="line">        displayCharacterData() <span class="comment">// use the fetched characterData</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">displayCharacterData</span><span class="params">()</span></span> &#123;</span><br><span class="line">    characterData.run &#123;</span><br><span class="line">        nameTextView.text = name</span><br><span class="line">        raceTextView.text = race</span><br><span class="line">        dexterityTextView.text = dex</span><br><span class="line">        wisdomTextView.text = wis</span><br><span class="line">        strengthTextView.text = str</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="suspend-functions"><a href="#suspend-functions" class="headerlink" title="suspend functions"></a><code>suspend</code> functions</h3><p>In my oppnion, a function with <code>suspend</code> means 3 things:</p>
<ol>
<li>it might takes a not short period of time to finish it (but not blocking a thread);</li>
<li>if declared in <code>kotlinx.coroutines</code>, then itâ€™s a cancelable point;</li>
<li>might be a schedule point for threads.</li>
</ol>
<p>The most common <code>suspend</code> method, <code>delay</code>, fulfills the 3 conclusions, so does the <code>Deferred.await</code> method.</p>
<h3 id="the-cancelable-point"><a href="#the-cancelable-point" class="headerlink" title="the cancelable point"></a>the cancelable point</h3><p>Able to cancel:</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">()</span></span> = runBlocking &#123;</span><br><span class="line">    <span class="keyword">val</span> job = launch &#123;</span><br><span class="line">        delay(<span class="number">3000</span>)</span><br><span class="line">        println(<span class="string">"You won't see me since I would be canceled."</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    delay(<span class="number">100</span>)</span><br><span class="line">    job.cancel()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Unable to cancel:</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">()</span></span> = runBlocking &#123;</span><br><span class="line">    <span class="keyword">val</span> job = launch &#123;</span><br><span class="line">        compute()</span><br><span class="line">        println(<span class="string">"No way to cancel me!"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    delay(<span class="number">100</span>)</span><br><span class="line">    job.cancel()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">compute</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">val</span> startTime = System.currentTimeMillis()</span><br><span class="line">    <span class="keyword">var</span> lastTime = startTime</span><br><span class="line">    <span class="keyword">while</span> (lastTime - startTime &lt; <span class="number">3</span>_000) &#123;</span><br><span class="line">        <span class="keyword">if</span> (System.currentTimeMillis() - lastTime &gt;= <span class="number">1000</span>) &#123;</span><br><span class="line">            lastTime += <span class="number">1000</span></span><br><span class="line">            println((lastTime - startTime) / <span class="number">1000</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>Note</strong>: <code>runBlocking</code> would be explained later.</p>
<h3 id="Coroutine-context"><a href="#Coroutine-context" class="headerlink" title="Coroutine context"></a>Coroutine context</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">()</span></span> = runBlocking&lt;<span class="built_in">Unit</span>&gt; &#123;</span><br><span class="line">    launch(Dispatchers.Default + CoroutineName(<span class="string">"test"</span>)) &#123;</span><br><span class="line">        println(<span class="string">"I'm working in thread <span class="subst">$&#123;Thread.currentThread().name&#125;</span>"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Coroutine-scope"><a href="#Coroutine-scope" class="headerlink" title="Coroutine scope"></a>Coroutine scope</h3><p><code>scope</code> is just like variables have scope in most programming languages</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="number">1</span> + <span class="number">1</span> == <span class="number">2</span>) &#123;</span><br><span class="line">        <span class="keyword">val</span> x = <span class="number">3</span> <span class="comment">// x belongs to the if scope</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>the <code>CoroutineScope</code> interface</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">CoroutineScope</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">val</span> coroutineContext: CoroutineContext</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>In kotlin, <code>CoroutineScope</code> is implemented by <code>AbstractCoroutine</code>, hence a coroutine means a <code>CoroutineScope</code>, but not vice versa.</p>
<p>Parent coroutine and child coroutine:</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">GlobalScope.launch &#123; </span><br><span class="line">    <span class="comment">// only inside a coroutine can we call launch &amp; async directly.</span></span><br><span class="line">    launch &#123; </span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Direct calls of <code>launch</code> &amp; <code>async</code> also means children coroutines inherits <code>Dispatchers</code> from parent unless override by providing a <code>Dispatchers</code> parameter. </p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">GlobalScope.launch(Dispatchers.Main) &#123; </span><br><span class="line">    <span class="comment">// only inside a coroutine can we call launch &amp; async directly.</span></span><br><span class="line">    launch(Dispatchers.Default) &#123; </span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Normally, parent finish after all children finish. But there is a extension method of <code>CoroutineScope</code> naming <code>cancel</code>. When itâ€™s called, the whole coroutine tree are canceled.</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Cancels this scope, including its job and all its children with an </span></span><br><span class="line"><span class="comment"> * optional cancellation [cause].</span></span><br><span class="line"><span class="comment"> * A cause can be used to specify an error message or to provide other </span></span><br><span class="line"><span class="comment"> * details on a cancellation reason for debugging purposes.</span></span><br><span class="line"><span class="comment"> * Throws [IllegalStateException] if the scope does not have a job in it.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">fun</span> CoroutineScope.<span class="title">cancel</span><span class="params">(cause: <span class="type">CancellationException</span>? = <span class="literal">null</span>)</span></span></span><br></pre></td></tr></table></figure>
<p>In kotlin, we have a <code>GlobalScope</code> which is an <code>object</code> singleton. Coroutines directly created from <code>GlobalScope</code> can last long as long as the JVM is on. <code>GlobalScope</code> is convenient for demo, however we may want coroutines to be canceled when an <code>Activity</code> is destroyed, for example.</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyActivity</span> : <span class="type">AppCompatActivity</span></span>() &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">val</span> mainScope = MainScope()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onDestroy</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.onDestroy()</span><br><span class="line">        mainScope.cancel()</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    mainScope.launch(Dispatchers.Main) &#123; </span><br><span class="line">        <span class="comment">// type of result: Deferred&lt;CharacterData&gt;</span></span><br><span class="line">        <span class="keyword">val</span> result = mainScope.async(Dispatchers.Default) &#123;</span><br><span class="line">            <span class="keyword">val</span> (race, name, dex, wis, str) = URL(</span><br><span class="line">            <span class="string">"https://chargen-api.herokuapp.com/"</span>).readText().split(<span class="string">","</span>)</span><br><span class="line">            CharacterData(race, name, dex, wis, str)</span><br><span class="line">        &#125;</span><br><span class="line">        characterData = result.await()</span><br><span class="line">        displayCharacterData() <span class="comment">// use the fetched characterData</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Now letâ€™s go back to explain <code>runBlocking</code>. <code>runBlocking</code> also starts a coroutine from <code>GlobeSope</code>, only that <code>runBlocking</code> coroutines prevent JVM from ending.</p>
<h4 id="the-coroutineScope-block-method"><a href="#the-coroutineScope-block-method" class="headerlink" title="the coroutineScope(block) method"></a>the <code>coroutineScope(block)</code> method</h4><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">suspend <span class="function"><span class="keyword">fun</span> <span class="type">&lt;R&gt;</span> <span class="title">coroutineScope</span><span class="params">(block: <span class="type">suspend</span> <span class="type">CoroutineScope</span>.()</span></span> -&gt; R): R</span><br></pre></td></tr></table></figure>
<p>We can create a new scope with this <code>coroutineScope</code> method. The most common usage would be like this:</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">suspend <span class="function"><span class="keyword">fun</span> <span class="title">doSomeThing</span><span class="params">()</span></span>: <span class="built_in">Int</span> = coroutineScope &#123;</span><br><span class="line">    <span class="keyword">val</span> deferred = async(Dispatchers.IO) &#123; </span><br><span class="line">        delay(<span class="number">500</span>)</span><br><span class="line">        <span class="number">3</span></span><br><span class="line">    &#125;</span><br><span class="line">    deferred.await()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">GlobalScope.launch(Dispatchers.Main) &#123; </span><br><span class="line">    <span class="keyword">val</span> result = doSomeThing()</span><br><span class="line">    <span class="comment">// use the result</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>In the above code, we created a scope with <code>coroutineScope</code>. When <code>doSomeThing</code> is called from another coroutine, the scope we created would inherit context from the outer coroutine scope. More importantly, when the outer scope is cancelled, this scope would also be canceled.</p>
<p>In next section, we would see the <code>coroutineScope</code> has important role in exception handling.</p>
<h3 id="Exception-in-coroutines"><a href="#Exception-in-coroutines" class="headerlink" title="Exception in coroutines"></a>Exception in coroutines</h3><p>First, what is a crash in Android app? (excluding ANR).</p>
<p>The simplest and best way to handle exceptions, is catching exceptions locally, i.e. donâ€™t let exceptions be passed between coroutines. Like the following:</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">suspend <span class="function"><span class="keyword">fun</span> <span class="title">doSomeThing</span><span class="params">()</span></span>: <span class="built_in">Int</span> = coroutineScope &#123;</span><br><span class="line">    <span class="keyword">val</span> deferred: Deferred&lt;<span class="built_in">Int</span>&gt; = async(Dispatchers.IO) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// ... the regular code block.</span></span><br><span class="line">            <span class="number">3</span> <span class="comment">// assume 3 is a valid return</span></span><br><span class="line">        &#125; <span class="keyword">catch</span> (e: IndexOutOfBoundsException) &#123;</span><br><span class="line">            <span class="comment">// do something to handle</span></span><br><span class="line">            <span class="number">0</span> <span class="comment">// assume 0 is a default return</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    deferred.await()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Itâ€™s simple, but why best? Because when an exception is not caught inside a coroutine, the exception would mostly cancel the whole coroutine tree. </p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="comment">// all coroutines would be canceled, and the thread would crash</span></span><br><span class="line">    GlobalScope.launch &#123;</span><br><span class="line">        launch &#123;</span><br><span class="line">            delay(<span class="number">200</span>)</span><br><span class="line">            println(<span class="string">"You won't see me since I would be canceled."</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        launch &#123;</span><br><span class="line">            <span class="keyword">throw</span> IndexOutOfBoundsException()</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        delay(<span class="number">200</span>)</span><br><span class="line">        println(<span class="string">"You won't see me since I would be canceled."</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    runBlocking &#123; delay(<span class="number">500</span>) &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>However, with the <code>coroutineScope</code> method, we can do more.</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">suspend <span class="function"><span class="keyword">fun</span> <span class="title">doSomeThing</span><span class="params">()</span></span>: <span class="built_in">Int</span> = coroutineScope &#123;</span><br><span class="line">    <span class="keyword">val</span> deferred: Deferred&lt;<span class="built_in">Int</span>&gt; = async(Dispatchers.IO) &#123;</span><br><span class="line">        <span class="keyword">throw</span> IndexOutOfBoundsException()</span><br><span class="line">    &#125;</span><br><span class="line">    launch &#123; <span class="comment">// this would be canceled</span></span><br><span class="line">        delay(<span class="number">200</span>)</span><br><span class="line">        println(<span class="string">"You won't see me since I would be canceled."</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    deferred.await()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    GlobalScope.launch &#123;</span><br><span class="line">        launch &#123;</span><br><span class="line">            delay(<span class="number">200</span>)</span><br><span class="line">            println(<span class="string">"I wouldn't be canceled."</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        launch &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123; doSomeThing() &#125; <span class="comment">// doSomeThing throws the exception</span></span><br><span class="line">            <span class="keyword">catch</span> (e: IndexOutOfBoundsException) &#123;</span><br><span class="line">                println(<span class="string">"caught the exception: <span class="variable">$e</span>"</span>)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        delay(<span class="number">200</span>)</span><br><span class="line">        println(<span class="string">"I wouldn't be canceled, either."</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    runBlocking &#123; delay(<span class="number">500</span>) &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="the-CancellationException"><a href="#the-CancellationException" class="headerlink" title="the CancellationException"></a>the <code>CancellationException</code></h3><p>It is thrown when a coroutine is canceled, but wonâ€™t crash the JVM thread.</p>
<p>just like nothing happen:</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="comment">// just like nothing happen</span></span><br><span class="line">    GlobalScope.launch &#123;</span><br><span class="line">        <span class="keyword">throw</span> CancellationException()</span><br><span class="line">    &#125;</span><br><span class="line">    runBlocking &#123; delay(<span class="number">500</span>) &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>JVM thread would crash:</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    GlobalScope.launch &#123;</span><br><span class="line">        <span class="keyword">throw</span> IndexOutOfBoundsException()</span><br><span class="line">    &#125;</span><br><span class="line">    runBlocking &#123; delay(<span class="number">500</span>) &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>CancellationException</code> seems useless, but it can be caught if you want. Just surround the cancel point inside a coroutine with try-catch.</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="comment">// just like nothing happen</span></span><br><span class="line">    GlobalScope.launch &#123;</span><br><span class="line">        launch &#123;</span><br><span class="line">            delay(<span class="number">100</span>)</span><br><span class="line">            <span class="keyword">throw</span> IndexOutOfBoundsException()</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">try</span> &#123; delay(<span class="number">50</span>) &#125; <span class="keyword">catch</span> (e: CancellationException) &#123;</span><br><span class="line">            println(<span class="string">"caught 1: <span class="variable">$e</span>"</span>)</span><br><span class="line">            <span class="keyword">throw</span> e <span class="comment">// usually you should throw it again</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">try</span> &#123; delay(<span class="number">60</span>) &#125; <span class="keyword">catch</span> (e: CancellationException) &#123;</span><br><span class="line">            println(<span class="string">"caught 2: <span class="variable">$e</span>"</span>)</span><br><span class="line">            <span class="keyword">throw</span> e <span class="comment">// usually you should throw it again</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">    &#125;</span><br><span class="line">    runBlocking &#123; delay(<span class="number">500</span>) &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Look the the code above, if you donâ€™t throw again the <code>CancellationException</code> again, the coroutine would continue executing, which usually is abnormal.</p>
<h3 id="the-CoroutineExceptionHandler"><a href="#the-CoroutineExceptionHandler" class="headerlink" title="the CoroutineExceptionHandler"></a>the <code>CoroutineExceptionHandler</code></h3><p>We can set an <code>CoroutineExceptionHandler</code> to the root scope or the root coroutine to let the handler handle exceptions throws inside all coroutines.</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">val</span> ceh = CoroutineExceptionHandler &#123; _, e -&gt;</span><br><span class="line">        println(<span class="string">"Handled crash: <span class="variable">$e</span>"</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//CoroutineScope(Dispatchers.IO).launch(ceh) &#123;  // this also works</span></span><br><span class="line">    CoroutineScope(Dispatchers.IO + ceh).launch &#123;</span><br><span class="line">        launch(Dispatchers.Default) &#123;</span><br><span class="line">            <span class="keyword">throw</span> IndexOutOfBoundsException()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    runBlocking &#123; delay(<span class="number">500</span>) &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// would crash!!</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">val</span> ceh = CoroutineExceptionHandler &#123; _, e -&gt;</span><br><span class="line">        println(<span class="string">"Handled crash: <span class="variable">$e</span>"</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    CoroutineScope(Dispatchers.IO).launch &#123;</span><br><span class="line">        launch(Dispatchers.Default + ceh) &#123;</span><br><span class="line">            <span class="keyword">throw</span> IndexOutOfBoundsException()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    runBlocking &#123; delay(<span class="number">500</span>) &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>If a coroutine is created from <code>async</code>, the <code>await</code> function would also throw the exception escaped from the coroutine:</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">val</span> ceh = CoroutineExceptionHandler &#123; _, e -&gt;</span><br><span class="line">        println(<span class="string">"Handled crash: <span class="variable">$e</span>"</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    CoroutineScope(Dispatchers.IO).launch(ceh) &#123;</span><br><span class="line">        <span class="keyword">val</span> d: Deferred&lt;<span class="built_in">Int</span>&gt; = async() &#123; oops(); <span class="number">3</span> &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            println(d.await())</span><br><span class="line">        &#125; <span class="keyword">catch</span> (e: IndexOutOfBoundsException) &#123;</span><br><span class="line">            println(<span class="string">"caught: <span class="variable">$e</span>"</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    runBlocking &#123; delay(<span class="number">500</span>) &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">oops</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">throw</span> IndexOutOfBoundsException()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="16-Functional-Programming-Basics"><a href="#16-Functional-Programming-Basics" class="headerlink" title="16. Functional Programming Basics "></a>16. Functional Programming Basics <a name="functional-programming-basics"></a></h3><h3 id="Transforms"><a href="#Transforms" class="headerlink" title="Transforms"></a>Transforms</h3><p>A transform function works on the contents of a collection by walking through the collection and transforming each item with a transformer function provided as an argument.</p>
<p>the <code>map</code> method</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Returns a list containing the results of applying the given [transform] </span></span><br><span class="line"><span class="comment"> * function to each element in the original collection.</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@sample</span> samples.collections.Collections.Transformations.map</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">inline</span> <span class="function"><span class="keyword">fun</span> <span class="type">&lt;T, R&gt;</span> Iterable<span class="type">&lt;T&gt;</span>.<span class="title">map</span><span class="params">(transform: (<span class="type">T</span>)</span></span> -&gt; R): List&lt;R&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> mapTo(ArrayList&lt;R&gt;(collectionSizeOrDefault(<span class="number">10</span>)), transform)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Filters"><a href="#Filters" class="headerlink" title="Filters"></a>Filters</h3><p>A filter function accepts a predicate function that checks each element in a collection against a condition and returns either true or false.</p>
<p>the <code>filter</code> method</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Returns a list containing only elements matching the given [predicate].</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">inline</span> <span class="function"><span class="keyword">fun</span> <span class="type">&lt;T&gt;</span> Iterable<span class="type">&lt;T&gt;</span>.<span class="title">filter</span><span class="params">(predicate: (<span class="type">T</span>)</span></span> -&gt; <span class="built_in">Boolean</span>): List&lt;T&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> filterTo(ArrayList&lt;T&gt;(), predicate)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Combines"><a href="#Combines" class="headerlink" title="Combines"></a>Combines</h3><p>Combining functions take different collections and merge them into a new one.</p>
<p>the <code>zip</code> method</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Returns a sequence of values built from the elements of `this` sequence </span></span><br><span class="line"><span class="comment"> * and the [other] sequence with the same index.</span></span><br><span class="line"><span class="comment"> * The resulting sequence ends as soon as the shortest input sequence ends.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * The operation is _intermediate_ and _stateless_.</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@sample</span> samples.collections.Sequences.Transformations.zip</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">infix</span> <span class="function"><span class="keyword">fun</span> <span class="type">&lt;T, R&gt;</span> Sequence<span class="type">&lt;T&gt;</span>.<span class="title">zip</span><span class="params">(other: <span class="type">Sequence</span>&lt;<span class="type">R</span>&gt;)</span></span>: </span><br><span class="line">Sequence&lt;Pair&lt;T, R&gt;&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> MergingSequence(<span class="keyword">this</span>, other) &#123; t1, t2 -&gt; t1 to t2 &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Examples</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// get primes</span></span><br><span class="line">(<span class="number">2.</span><span class="number">.1000</span>).filter &#123; num-&gt;</span><br><span class="line">    (<span class="number">2</span> until num).filter &#123; </span><br><span class="line">        num % it == <span class="number">0</span></span><br><span class="line">    &#125;.isEmpty()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// get primes with the none</span></span><br><span class="line"><span class="keyword">val</span> primes = (<span class="number">2.</span><span class="number">.1000</span>).filter &#123; num-&gt;</span><br><span class="line">    (<span class="number">2</span> until num).none &#123;</span><br><span class="line">        num % it == <span class="number">0</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="References"><a href="#References" class="headerlink" title="References "></a>References <a name="references"></a></h3><ol>
<li><a href="https://www.bignerdranch.com/books/kotlin-programming-the-big-nerd-ranch-guide-2/" target="_blank" rel="noopener">Kotlin Programming: The Big Nerd Ranch Guide</a>, awailable in the <a href="https://learning.oreilly.com/home/" target="_blank" rel="noopener">Oâ€™Reilly Learning</a> platform.</li>
<li>Official <a href="https://kotlinlang.org/docs/reference/coroutines/coroutines-guide.html" target="_blank" rel="noopener">Kotlin coroutine guide</a>.</li>
<li><a href="https://medium.com/the-kotlin-chronicle/coroutine-exceptions-3378f51a7d33" target="_blank" rel="noopener">Exceptional Exceptions for Coroutines made easyâ€¦?</a></li>
</ol>
</div><div class="tags"><a href="/tags/Kotlin/">Kotlin</a></div><div class="post-nav"><a class="pre" href="/2020/01/04/Elliptic curve group/">Elliptic curve cryptography basics</a><a class="next" href="/2019/08/09/macOS æ•ˆçŽ‡/">5 åˆ†é’Ÿæé«˜ macOS ä½¿ç”¨æ•ˆçŽ‡</a></div><div id="disqus_thread"><div class="btn_click_load"><button class="disqus_click_btn">é˜…è¯»è¯„è®ºï¼ˆè¯·ç¡®ä¿ Disqus å¯ä»¥æ­£å¸¸åŠ è½½ï¼‰</button></div><script type="text/javascript">var disqus_config = function () {
    this.page.url = 'https://tao93.top/2019/11/04/Kotlin Summary/';
    this.page.identifier = '2019/11/04/Kotlin Summary/';
    this.page.title = 'Kotlin Summary';
  };</script><script type="text/javascript" id="disqus-lazy-load-script">$.ajax({
url: 'https://disqus.com/next/config.json',
timeout: 2500,
type: 'GET',
success: function(){
  var d = document;
  var s = d.createElement('script');
  s.src = '//liu-tao.disqus.com/embed.js';
  s.setAttribute('data-timestamp', + new Date());
  (d.head || d.body).appendChild(s);
  $('.disqus_click_btn').css('display', 'none');
},
error: function() {
  $('.disqus_click_btn').css('display', 'block');
}
});</script><script type="text/javascript" id="disqus-click-load">$('.btn_click_load').click(() => {  //click to load comments
    (() => { // DON'T EDIT BELOW THIS LINE
        var d = document;
        var s = d.createElement('script');
        s.src = '//liu-tao.disqus.com/embed.js';
        s.setAttribute('data-timestamp', + new Date());
        (d.head || d.body).appendChild(s);
    })();
    $('.disqus_click_btn').css('display','none');
});</script><script type="text/javascript" id="disqus-count-script">$(function() {
     var xhr = new XMLHttpRequest();
     xhr.open('GET', '//disqus.com/next/config.json', true);
     xhr.timeout = 2500;
     xhr.onreadystatechange = function () {
       if (xhr.readyState === 4 && xhr.status === 200) {
         $('.post-meta .post-comments-count').show();
         var s = document.createElement('script');
         s.id = 'dsq-count-scr';
         s.src = 'https://liu-tao.disqus.com/count.js';
         s.async = true;
         (document.head || document.body).appendChild(s);
       }
     };
     xhr.ontimeout = function () { xhr.abort(); };
     xhr.send(null);
   });
</script></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><div class="search-form"><input id="local-search-input" placeholder="Search" type="text" name="q" results="0"/><div id="local-search-result"></div></div></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> Tags</i></div><div class="tagcloud"><a href="/tags/Algorithm/" style="font-size: 15px;">Algorithm</a> <a href="/tags/Android/" style="font-size: 15px;">Android</a> <a href="/tags/Shell/" style="font-size: 15px;">Shell</a> <a href="/tags/macOS/" style="font-size: 15px;">macOS</a> <a href="/tags/MySQL/" style="font-size: 15px;">MySQL</a> <a href="/tags/Python/" style="font-size: 15px;">Python</a> <a href="/tags/Linux/" style="font-size: 15px;">Linux</a> <a href="/tags/AOSP/" style="font-size: 15px;">AOSP</a> <a href="/tags/swift/" style="font-size: 15px;">swift</a> <a href="/tags/Other/" style="font-size: 15px;">Other</a> <a href="/tags/Bash/" style="font-size: 15px;">Bash</a> <a href="/tags/ShadowSocks/" style="font-size: 15px;">ShadowSocks</a> <a href="/tags/Homebrew/" style="font-size: 15px;">Homebrew</a> <a href="/tags/adb/" style="font-size: 15px;">adb</a> <a href="/tags/VPS/" style="font-size: 15px;">VPS</a> <a href="/tags/Firmware/" style="font-size: 15px;">Firmware</a> <a href="/tags/Samsung/" style="font-size: 15px;">Samsung</a> <a href="/tags/Java/" style="font-size: 15px;">Java</a> <a href="/tags/GSI/" style="font-size: 15px;">GSI</a> <a href="/tags/Project-Treble/" style="font-size: 15px;">Project Treble</a> <a href="/tags/Hexo-Blog/" style="font-size: 15px;">Hexo Blog</a> <a href="/tags/Kotlin/" style="font-size: 15px;">Kotlin</a> <a href="/tags/Math/" style="font-size: 15px;">Math</a> <a href="/tags/Cryptography/" style="font-size: 15px;">Cryptography</a> <a href="/tags/TLS/" style="font-size: 15px;">TLS</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> Recent</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2020/05/16/Android ä¸­ä½¿ç”¨ SVG ç®€ä»‹/">Android ä¸­ä½¿ç”¨ SVG ç®€ä»‹</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/03/30/Secure communication basics/">Network security basics</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/01/04/Elliptic curve group/">Elliptic curve cryptography basics</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/11/04/Kotlin Summary/">Kotlin Summary</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/08/09/macOS æ•ˆçŽ‡/">5 åˆ†é’Ÿæé«˜ macOS ä½¿ç”¨æ•ˆçŽ‡</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/07/10/Flash stock firmware in SM-T830/">ç»™ä¸‰æ˜Ÿ tablet SM-T830 åˆ·æœº</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/07/05/å†æ¬¡å°† hexo blog æ”¾ç½®åˆ° Github Pages/">å†æ¬¡å°† hexo blog æ”¾ç½®åˆ° Github Pages</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/04/07/Android è‡ªå®šä¹‰ç®€æ˜“ PickerView/">Android è‡ªå®šä¹‰ç®€æ˜“ PickerView</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/01/18/ä¸€ä¸ªä¸ä¸€æ ·çš„ ANR/">ä¸€ä¸ªä¸ä¸€æ ·çš„ ANR</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/01/12/Android ç»˜åˆ¶åœ†å½¢å›¾ç‰‡/">Android ç»˜åˆ¶åœ†å½¢å›¾ç‰‡</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-comment-o"> Recent Comments</i></div><script type="text/javascript" src="//liu-tao.disqus.com/recent_comments_widget.js?num_items=5&amp;hide_avatars=1&amp;avatar_size=32&amp;excerpt_length=20&amp;hide_mods=1"></script></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> Links</i></div><ul></ul><a href="https://zxshamson.github.io/" title="Xingshan Zeng (æ›¾å¹¸å±±)" target="_blank">Xingshan Zeng (æ›¾å¹¸å±±)</a><ul></ul><a href="https://shikaiwi.github.io/" title="ShiKaiWi" target="_blank">ShiKaiWi</a><ul></ul><a href="http://jairo.top/" title="Jairo" target="_blank">Jairo</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright Â© 2020 <a href="/." rel="nofollow">Liu Tao.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/3.3.5/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/3.3.5/jquery.fancybox.min.css"><script type="text/javascript" src="/js/search.js?v=0.0.0"></script><script>var search_path = 'search.xml';
if (search_path.length == 0) {
   search_path = 'search.xml';
}
var path = '/' + search_path;
searchFunc(path, 'local-search-input', 'local-search-result');
</script><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>